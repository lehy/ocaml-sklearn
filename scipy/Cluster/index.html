
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>Cluster - OCaml scikit-learn interface</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hierarchy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="OCaml scikit-learn interface" class="md-header-nav__button md-logo" aria-label="OCaml scikit-learn interface">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OCaml scikit-learn interface
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Cluster
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/lehy/ocaml-sklearn/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lehy/ocaml-sklearn
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OCaml scikit-learn interface" class="md-nav__button md-logo" aria-label="OCaml scikit-learn interface">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OCaml scikit-learn interface
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/lehy/ocaml-sklearn/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lehy/ocaml-sklearn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      Np
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Np" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Np
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/" class="md-nav__link">
      Numpy for OCaml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/Numpy/" class="md-nav__link">
      Numpy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/NumpyRaw/" class="md-nav__link">
      NumpyRaw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/PyList/" class="md-nav__link">
      PyList
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/dtype/" class="md-nav__link">
      Dtype
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/obj/" class="md-nav__link">
      Obj
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    <label class="md-nav__link" for="nav-3">
      Scipy
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Scipy" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Scipy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" class="md-nav__link">
      SciPy library for OCaml
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Cluster
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Cluster
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hierarchy" class="md-nav__link">
    Hierarchy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clusternode" class="md-nav__link">
    ClusterNode
  </a>
  
    <nav class="md-nav" aria-label="ClusterNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_count" class="md-nav__link">
    get_count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_id" class="md-nav__link">
    get_id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_left" class="md-nav__link">
    get_left
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_right" class="md-nav__link">
    get_right
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_leaf" class="md-nav__link">
    is_leaf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre_order" class="md-nav__link">
    pre_order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clusterwarning" class="md-nav__link">
    ClusterWarning
  </a>
  
    <nav class="md-nav" aria-label="ClusterWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_1" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_1" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_1" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deque" class="md-nav__link">
    Deque
  </a>
  
    <nav class="md-nav" aria-label="Deque">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getitem" class="md-nav__link">
    getitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iter" class="md-nav__link">
    iter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setitem" class="md-nav__link">
    setitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count" class="md-nav__link">
    count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert" class="md-nav__link">
    insert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    remove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_2" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_2" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_2" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#average" class="md-nav__link">
    average
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#centroid" class="md-nav__link">
    centroid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete" class="md-nav__link">
    complete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cophenet" class="md-nav__link">
    cophenet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correspond" class="md-nav__link">
    correspond
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cut_tree" class="md-nav__link">
    cut_tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dendrogram" class="md-nav__link">
    dendrogram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fcluster" class="md-nav__link">
    fcluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fclusterdata" class="md-nav__link">
    fclusterdata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_mlab_linkage" class="md-nav__link">
    from_mlab_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inconsistent" class="md-nav__link">
    inconsistent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_isomorphic" class="md-nav__link">
    is_isomorphic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_monotonic" class="md-nav__link">
    is_monotonic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_valid_im" class="md-nav__link">
    is_valid_im
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_valid_linkage" class="md-nav__link">
    is_valid_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaders" class="md-nav__link">
    leaders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaves_list" class="md-nav__link">
    leaves_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage" class="md-nav__link">
    linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxrstat" class="md-nav__link">
    maxRstat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxdists" class="md-nav__link">
    maxdists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxinconsts" class="md-nav__link">
    maxinconsts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#median" class="md-nav__link">
    median
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_obs_linkage" class="md-nav__link">
    num_obs_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimal_leaf_ordering" class="md-nav__link">
    optimal_leaf_ordering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_link_color_palette" class="md-nav__link">
    set_link_color_palette
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single" class="md-nav__link">
    single
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_mlab_linkage" class="md-nav__link">
    to_mlab_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_tree" class="md-nav__link">
    to_tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ward" class="md-nav__link">
    ward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weighted" class="md-nav__link">
    weighted
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vq" class="md-nav__link">
    Vq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clustererror" class="md-nav__link">
    ClusterError
  </a>
  
    <nav class="md-nav" aria-label="ClusterError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_1" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_3" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_3" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_3" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deque_1" class="md-nav__link">
    Deque
  </a>
  
    <nav class="md-nav" aria-label="Deque">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getitem_1" class="md-nav__link">
    getitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iter_1" class="md-nav__link">
    iter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setitem_1" class="md-nav__link">
    setitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count_1" class="md-nav__link">
    count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert_1" class="md-nav__link">
    insert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_1" class="md-nav__link">
    remove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_4" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_4" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_4" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cdist" class="md-nav__link">
    cdist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmeans" class="md-nav__link">
    kmeans
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmeans2" class="md-nav__link">
    kmeans2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_vq" class="md-nav__link">
    py_vq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_vq2" class="md-nav__link">
    py_vq2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vq_1" class="md-nav__link">
    vq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whiten" class="md-nav__link">
    whiten
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Conftest/" class="md-nav__link">
      Conftest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Constants/" class="md-nav__link">
      Constants
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fft/" class="md-nav__link">
      Fft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fftpack/" class="md-nav__link">
      Fftpack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Integrate/" class="md-nav__link">
      Integrate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Interpolate/" class="md-nav__link">
      Interpolate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Io/" class="md-nav__link">
      Io
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Linalg/" class="md-nav__link">
      Linalg
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Misc/" class="md-nav__link">
      Misc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Ndimage/" class="md-nav__link">
      Ndimage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Odr/" class="md-nav__link">
      Odr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Optimize/" class="md-nav__link">
      Optimize
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Setup/" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Signal/" class="md-nav__link">
      Signal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sparse/" class="md-nav__link">
      Sparse
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Spatial/" class="md-nav__link">
      Spatial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Special/" class="md-nav__link">
      Special
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Stats/" class="md-nav__link">
      Stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Version/" class="md-nav__link">
      Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wrap_version/" class="md-nav__link">
      Wrap version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Sklearn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sklearn" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Sklearn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Calibration/" class="md-nav__link">
      Calibration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Cluster/" class="md-nav__link">
      Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Compose/" class="md-nav__link">
      Compose
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Conftest/" class="md-nav__link">
      Conftest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Covariance/" class="md-nav__link">
      Covariance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Cross_decomposition/" class="md-nav__link">
      Cross decomposition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Datasets/" class="md-nav__link">
      Datasets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Decomposition/" class="md-nav__link">
      Decomposition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Discriminant_analysis/" class="md-nav__link">
      Discriminant analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Dummy/" class="md-nav__link">
      Dummy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Ensemble/" class="md-nav__link">
      Ensemble
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Exceptions/" class="md-nav__link">
      Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Experimental/" class="md-nav__link">
      Experimental
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Externals/" class="md-nav__link">
      Externals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Feature_extraction/" class="md-nav__link">
      Feature extraction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Feature_selection/" class="md-nav__link">
      Feature selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Gaussian_process/" class="md-nav__link">
      Gaussian process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Impute/" class="md-nav__link">
      Impute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Inspection/" class="md-nav__link">
      Inspection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Isotonic/" class="md-nav__link">
      Isotonic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Kernel_approximation/" class="md-nav__link">
      Kernel approximation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Kernel_ridge/" class="md-nav__link">
      Kernel ridge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Linear_model/" class="md-nav__link">
      Linear model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Manifold/" class="md-nav__link">
      Manifold
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Metrics/" class="md-nav__link">
      Metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Mixture/" class="md-nav__link">
      Mixture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Model_selection/" class="md-nav__link">
      Model selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Multiclass/" class="md-nav__link">
      Multiclass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Multioutput/" class="md-nav__link">
      Multioutput
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Naive_bayes/" class="md-nav__link">
      Naive bayes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Neighbors/" class="md-nav__link">
      Neighbors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Neural_network/" class="md-nav__link">
      Neural network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Pipeline/" class="md-nav__link">
      Pipeline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Preprocessing/" class="md-nav__link">
      Preprocessing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Random_projection/" class="md-nav__link">
      Random projection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Semi_supervised/" class="md-nav__link">
      Semi supervised
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Setup/" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Svm/" class="md-nav__link">
      Svm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Tests/" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Tree/" class="md-nav__link">
      Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Utils/" class="md-nav__link">
      Utils
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/arr/" class="md-nav__link">
      Arr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/dict/" class="md-nav__link">
      Dict
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/wrap_version/" class="md-nav__link">
      Wrap version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hierarchy" class="md-nav__link">
    Hierarchy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clusternode" class="md-nav__link">
    ClusterNode
  </a>
  
    <nav class="md-nav" aria-label="ClusterNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_count" class="md-nav__link">
    get_count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_id" class="md-nav__link">
    get_id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_left" class="md-nav__link">
    get_left
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_right" class="md-nav__link">
    get_right
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_leaf" class="md-nav__link">
    is_leaf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre_order" class="md-nav__link">
    pre_order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clusterwarning" class="md-nav__link">
    ClusterWarning
  </a>
  
    <nav class="md-nav" aria-label="ClusterWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_1" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_1" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_1" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deque" class="md-nav__link">
    Deque
  </a>
  
    <nav class="md-nav" aria-label="Deque">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getitem" class="md-nav__link">
    getitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iter" class="md-nav__link">
    iter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setitem" class="md-nav__link">
    setitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count" class="md-nav__link">
    count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert" class="md-nav__link">
    insert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    remove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_2" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_2" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_2" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#average" class="md-nav__link">
    average
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#centroid" class="md-nav__link">
    centroid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete" class="md-nav__link">
    complete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cophenet" class="md-nav__link">
    cophenet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correspond" class="md-nav__link">
    correspond
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cut_tree" class="md-nav__link">
    cut_tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dendrogram" class="md-nav__link">
    dendrogram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fcluster" class="md-nav__link">
    fcluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fclusterdata" class="md-nav__link">
    fclusterdata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_mlab_linkage" class="md-nav__link">
    from_mlab_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inconsistent" class="md-nav__link">
    inconsistent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_isomorphic" class="md-nav__link">
    is_isomorphic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_monotonic" class="md-nav__link">
    is_monotonic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_valid_im" class="md-nav__link">
    is_valid_im
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_valid_linkage" class="md-nav__link">
    is_valid_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaders" class="md-nav__link">
    leaders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaves_list" class="md-nav__link">
    leaves_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage" class="md-nav__link">
    linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxrstat" class="md-nav__link">
    maxRstat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxdists" class="md-nav__link">
    maxdists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxinconsts" class="md-nav__link">
    maxinconsts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#median" class="md-nav__link">
    median
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_obs_linkage" class="md-nav__link">
    num_obs_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimal_leaf_ordering" class="md-nav__link">
    optimal_leaf_ordering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_link_color_palette" class="md-nav__link">
    set_link_color_palette
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single" class="md-nav__link">
    single
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_mlab_linkage" class="md-nav__link">
    to_mlab_linkage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_tree" class="md-nav__link">
    to_tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ward" class="md-nav__link">
    ward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weighted" class="md-nav__link">
    weighted
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vq" class="md-nav__link">
    Vq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clustererror" class="md-nav__link">
    ClusterError
  </a>
  
    <nav class="md-nav" aria-label="ClusterError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_1" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_3" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_3" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_3" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deque_1" class="md-nav__link">
    Deque
  </a>
  
    <nav class="md-nav" aria-label="Deque">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getitem_1" class="md-nav__link">
    getitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iter_1" class="md-nav__link">
    iter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setitem_1" class="md-nav__link">
    setitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count_1" class="md-nav__link">
    count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert_1" class="md-nav__link">
    insert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_1" class="md-nav__link">
    remove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_4" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_4" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_4" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cdist" class="md-nav__link">
    cdist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmeans" class="md-nav__link">
    kmeans
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmeans2" class="md-nav__link">
    kmeans2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_vq" class="md-nav__link">
    py_vq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_vq2" class="md-nav__link">
    py_vq2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vq_1" class="md-nav__link">
    vq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whiten" class="md-nav__link">
    whiten
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/lehy/ocaml-sklearn/edit/master/docs/scipy/Cluster.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h2 id="hierarchy">Hierarchy<a class="headerlink" href="#hierarchy" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Hierarchy</code> wraps Python module <code>scipy.cluster.hierarchy</code>.</p>
<h2 id="clusternode">ClusterNode<a class="headerlink" href="#clusternode" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Hierarchy.​ClusterNode</code> wraps Python class <code>scipy.cluster.hierarchy.ClusterNode</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create">create<a class="headerlink" href="#create" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">left</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">right</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dist</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">count</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">id</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>A tree node class for representing a cluster.</p>
<p>Leaf nodes correspond to original observations, while non-leaf nodes
correspond to non-singleton clusters.</p>
<p>The <code>to_tree</code> function converts a matrix returned by the linkage
function into an easy-to-use tree representation.</p>
<p>All parameter names are also attributes.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>id : int</summary><p>The node id.</p>
</details>
<details class="info" open="open"><summary>left : ClusterNode instance, optional</summary><p>The left child tree node.</p>
</details>
<details class="info" open="open"><summary>right : ClusterNode instance, optional</summary><p>The right child tree node.</p>
</details>
<details class="info" open="open"><summary>dist : float, optional</summary><p>Distance for this cluster in the linkage matrix.</p>
</details>
<details class="info" open="open"><summary>count : int, optional</summary><p>The number of samples in this cluster.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>to_tree : for converting a linkage matrix <code>Z</code> into a tree object.</summary></details>
</details>
<h3 id="get_count">get_count<a class="headerlink" href="#get_count" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_count</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">int</span>
</code></pre></div>

<p>The number of leaf nodes (original observations) belonging to
the cluster node nd. If the target node is a leaf, 1 is
returned.</p>
<h4>Returns</h4>
<details class="info" open="open"><summary>get_count : int</summary><p>The number of leaf nodes below the target node.</p>
</details>
</details>
<h3 id="get_id">get_id<a class="headerlink" href="#get_id" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_id</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">int</span>
</code></pre></div>

<p>The identifier of the target node.</p>
<p>For <code>0 &lt;= i &lt; n</code>, <code>i</code> corresponds to original observation i.
For <code>n &lt;= i &lt; 2n-1</code>, <code>i</code> corresponds to non-singleton cluster formed
at iteration <code>i-n</code>.</p>
<h4>Returns</h4>
<details class="info" open="open"><summary>id : int</summary><p>The identifier of the target node.</p>
</details>
</details>
<h3 id="get_left">get_left<a class="headerlink" href="#get_left" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_left</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a reference to the left child tree object.</p>
<h4>Returns</h4>
<details class="info" open="open"><summary>left : ClusterNode</summary><p>The left child of the target node. If the node is a leaf,
None is returned.</p>
</details>
</details>
<h3 id="get_right">get_right<a class="headerlink" href="#get_right" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_right</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a reference to the right child tree object.</p>
<h4>Returns</h4>
<details class="info" open="open"><summary>right : ClusterNode</summary><p>The left child of the target node. If the node is a leaf,
None is returned.</p>
</details>
</details>
<h3 id="is_leaf">is_leaf<a class="headerlink" href="#is_leaf" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_leaf</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Return True if the target node is a leaf.</p>
<h4>Returns</h4>
<details class="info" open="open"><summary>leafness : bool</summary><p>True if the target node is a leaf node.</p>
</details>
</details>
<h3 id="pre_order">pre_order<a class="headerlink" href="#pre_order" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pre_order</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform pre-order traversal without recursive function calls.</p>
<p>When a leaf node is first encountered, <code>func</code> is called with
the leaf node as its argument, and its result is appended to
the list.</p>
<p>For example, the statement::</p>
<p>ids = root.pre_order(lambda x: x.id)</p>
<p>returns a list of the node ids corresponding to the leaf nodes
of the tree as they appear from left to right.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>func : function</summary><p>Applied to each leaf ClusterNode object in the pre-order traversal.
Given the <code>i</code>-th leaf node in the pre-order traversal <code>n[i]</code>,
the result of <code>func(n[i])</code> is stored in <code>L[i]</code>. If not
provided, the index of the original observation to which the node
corresponds is used.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>L : list</summary><p>The pre-order traversal.</p>
</details>
</details>
<h3 id="to_string">to_string<a class="headerlink" href="#to_string" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show">show<a class="headerlink" href="#show" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp">pp<a class="headerlink" href="#pp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="clusterwarning">ClusterWarning<a class="headerlink" href="#clusterwarning" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Hierarchy.​ClusterWarning</code> wraps Python class <code>scipy.cluster.hierarchy.ClusterWarning</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback">with_traceback<a class="headerlink" href="#with_traceback" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_1">to_string<a class="headerlink" href="#to_string_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_1">show<a class="headerlink" href="#show_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_1">pp<a class="headerlink" href="#pp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="deque">Deque<a class="headerlink" href="#deque" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Hierarchy.​Deque</code> wraps Python class <code>scipy.cluster.hierarchy.deque</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="getitem"><strong>getitem</strong><a class="headerlink" href="#getitem" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">getitem__</span> <span class="o">:</span>
  <span class="n">key</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return self[key].</p>
</details>
<h3 id="iter"><strong>iter</strong><a class="headerlink" href="#iter" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">iter__</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Implement iter(self).</p>
</details>
<h3 id="setitem"><strong>setitem</strong><a class="headerlink" href="#setitem" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">setitem__</span> <span class="o">:</span>
  <span class="n">key</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="k">value</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Set self[key] to value.</p>
</details>
<h3 id="count">count<a class="headerlink" href="#count" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">count</span> <span class="o">:</span>
  <span class="k">value</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>D.count(value) -&gt; integer -- return number of occurrences of value</p>
</details>
<h3 id="insert">insert<a class="headerlink" href="#insert" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">insert</span> <span class="o">:</span>
  <span class="n">index</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">object_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>D.insert(index, object) -- insert object before index</p>
</details>
<h3 id="remove">remove<a class="headerlink" href="#remove" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">remove</span> <span class="o">:</span>
  <span class="k">value</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>D.remove(value) -- remove first occurrence of value.</p>
</details>
<h3 id="to_string_2">to_string<a class="headerlink" href="#to_string_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_2">show<a class="headerlink" href="#show_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_2">pp<a class="headerlink" href="#pp_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="average">average<a class="headerlink" href="#average" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">average</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform average/UPGMA linkage on a condensed distance matrix.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>The upper triangular of the distance matrix. The result of
<code>pdist</code> is returned in this form.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>A linkage matrix containing the hierarchical clustering. See
<code>linkage</code> for more information on its structure.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">average</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">average</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.39675184</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.39675184</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">4.09206523</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h3 id="centroid">centroid<a class="headerlink" href="#centroid" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">centroid</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform centroid/UPGMC linkage.</p>
<p>See <code>linkage</code> for more information on the input matrix,
return structure, and algorithm.</p>
<p>The following are common calling conventions:</p>
<ol>
<li><code>Z = centroid(y)</code></li>
</ol>
<p>Performs centroid/UPGMC linkage on the condensed distance
   matrix <code>y</code>.</p>
<ol>
<li><code>Z = centroid(X)</code></li>
</ol>
<p>Performs centroid/UPGMC linkage on the observation matrix <code>X</code>
   using Euclidean distance as the distance metric.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>A condensed distance matrix. A condensed
distance matrix is a flat array containing the upper
triangular of the distance matrix. This is the form that
<code>pdist</code> returns. Alternatively, a collection of
m observation vectors in n dimensions may be passed as
an m by n array.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>A linkage matrix containing the hierarchical clustering. See
the <code>linkage</code> function documentation for more information
on its structure.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">centroid</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">centroid</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.33333333</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.33333333</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">3.33333333</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h3 id="complete">complete<a class="headerlink" href="#complete" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">complete</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform complete/max/farthest point linkage on a condensed distance matrix.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>The upper triangular of the distance matrix. The result of
<code>pdist</code> is returned in this form.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>A linkage matrix containing the hierarchical clustering. See
the <code>linkage</code> function documentation for more information
on its structure.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">complete</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">complete</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.41421356</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.41421356</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.41421356</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.41421356</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">4.12310563</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">4.12310563</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">5.65685425</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h3 id="cophenet">cophenet<a class="headerlink" href="#cophenet" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">cophenet</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">y</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Calculate the cophenetic distances between each observation in
the hierarchical clustering defined by the linkage <code>Z</code>.</p>
<p>Suppose <code>p</code> and <code>q</code> are original observations in
disjoint clusters <code>s</code> and <code>t</code>, respectively and
<code>s</code> and <code>t</code> are joined by a direct parent cluster
<code>u</code>. The cophenetic distance between observations
<code>i</code> and <code>j</code> is simply the distance between
clusters <code>s</code> and <code>t</code>.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as an array
(see <code>linkage</code> function).</p>
</details>
<details class="info" open="open"><summary>Y : ndarray (optional)</summary><p>Calculates the cophenetic correlation coefficient <code>c</code> of a
hierarchical clustering defined by the linkage matrix <code>Z</code>
of a set of :math:<code>n</code> observations in :math:<code>m</code>
dimensions. <code>Y</code> is the condensed distance matrix from which
<code>Z</code> was generated.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>c : ndarray</summary><p>The cophentic correlation distance (if <code>Y</code> is passed).</p>
</details>
<details class="info" open="open"><summary>d : ndarray</summary><p>The cophenetic distance matrix in condensed form. The
:math:<code>ij</code> th entry is the cophenetic distance between
original observations :math:<code>i</code> and :math:<code>j</code>.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.squareform: transforming condensed matrices into square ones.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">single</span><span class="p">,</span> <span class="n">cophenet</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">squareform</span>
</code></pre></div>

<p>Given a dataset <code>X</code> and a linkage matrix <code>Z</code>, the cophenetic distance
between two points of <code>X</code> is the distance between the largest two
distinct clusters that each of the points:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p><code>X</code> corresponds to this dataset ::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">single</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span><span class="p">,</span> <span class="mf">18.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">13.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">17.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">19.</span><span class="p">,</span> <span class="mf">21.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cophenet</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span>
       <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span>
       <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span>
       <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
</code></pre></div>

<p>The output of the <code>scipy.cluster.hierarchy.cophenet</code> method is
represented in condensed form. We can use
<code>scipy.spatial.distance.squareform</code> to see the output as a
regular matrix (where each element <code>ij</code> denotes the cophenetic distance
between each <code>i</code>, <code>j</code> pair of points in <code>X</code>):</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">squareform</span><span class="p">(</span><span class="n">cophenet</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<p>In this example, the cophenetic distance between points on <code>X</code> that are
very close (i.e., in the same corner) is 1. For other pairs of points is 2,
because the points will be located in clusters at different
corners - thus, the distance between these clusters will be larger.</p>
</details>
<h3 id="correspond">correspond<a class="headerlink" href="#correspond" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">correspond</span> <span class="o">:</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">y</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Check for correspondence between linkage and condensed distance matrices.</p>
<p>They must have the same number of original observations for
the check to succeed.</p>
<p>This function is useful as a sanity check in algorithms that make
extensive use of linkage and distance matrices that must
correspond to the same set of original observations.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : array_like</summary><p>The linkage matrix to check for correspondence.</p>
</details>
<details class="info" open="open"><summary>Y : array_like</summary><p>The condensed distance matrix to check for correspondence.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>b : bool</summary><p>A boolean indicating whether the linkage matrix and distance
matrix could possibly correspond to one another.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">correspond</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>This method can be used to check if a given linkage matrix <code>Z</code> has been
obtained from the application of a cluster method over a dataset <code>X</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X_condensed</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">X_condensed</span><span class="p">)</span>
</code></pre></div>

<p>Here, we can compare <code>Z</code> and <code>X</code> (in condensed form):</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">correspond</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X_condensed</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="cut_tree">cut_tree<a class="headerlink" href="#cut_tree" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">cut_tree</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">n_clusters</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">height</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Given a linkage matrix Z, return the cut tree.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : scipy.cluster.linkage array</summary><p>The linkage matrix.</p>
</details>
<details class="info" open="open"><summary>n_clusters : array_like, optional</summary><p>Number of clusters in the tree at the cut point.</p>
</details>
<details class="info" open="open"><summary>height : array_like, optional</summary><p>The height at which to cut the tree. Only possible for ultrametric
trees.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>cutree : array</summary><p>An array indicating group membership at each agglomeration step. I.e.,
for a full cut tree, in the first column each data point is in its own
cluster. At the next step, two nodes are merged. Finally, all
singleton and non-singleton clusters are in one group. If <code>n_clusters</code>
or <code>height</code> are given, the columns correspond to the columns of
<code>n_clusters</code> or <code>height</code>.</p>
</details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">cluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">ward</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cutree</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">cut_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cutree</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="dendrogram">dendrogram<a class="headerlink" href="#dendrogram" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dendrogram</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">p</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">truncate_mode</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">color_threshold</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">get_leaves</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">orientation</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">labels</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">count_sort</span><span class="o">:[`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">distance_sort</span><span class="o">:[`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">show_leaf_counts</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">no_plot</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">no_labels</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">leaf_font_size</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">leaf_rotation</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">leaf_label_func</span><span class="o">:[`</span><span class="nc">Lambda</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">show_contracted</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">link_color_func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ax</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">above_threshold_color</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Plot the hierarchical clustering as a dendrogram.</p>
<p>The dendrogram illustrates how each cluster is
composed by drawing a U-shaped link between a non-singleton
cluster and its children. The top of the U-link indicates a
cluster merge. The two legs of the U-link indicate which clusters
were merged. The length of the two legs of the U-link represents
the distance between the child clusters. It is also the
cophenetic distance between original observations in the two
children clusters.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The linkage matrix encoding the hierarchical clustering to
render as a dendrogram. See the <code>linkage</code> function for more
information on the format of <code>Z</code>.</p>
</details>
<details class="info" open="open"><summary>p : int, optional</summary><p>The <code>p</code> parameter for <code>truncate_mode</code>.</p>
</details>
<details class="info" open="open"><summary>truncate_mode : str, optional</summary><p>The dendrogram can be hard to read when the original
observation matrix from which the linkage is derived is
large. Truncation is used to condense the dendrogram. There
are several modes:</p>
<p><code>None</code>
  No truncation is performed (default).</p>
</details>
<details class="info" open="open"><summary>Note: <code>'none'</code> is an alias for <code>None</code> that's kept for</summary><p>backward compatibility.</p>
<p><code>'lastp'</code>
  The last <code>p</code> non-singleton clusters formed in the linkage are the
  only non-leaf nodes in the linkage; they correspond to rows
  <code>Z[n-p-2:end]</code> in <code>Z</code>. All other non-singleton clusters are
  contracted into leaf nodes.</p>
<p><code>'level'</code>
  No more than <code>p</code> levels of the dendrogram tree are displayed.
  A 'level' includes all nodes with <code>p</code> merges from the last merge.</p>
</details>
<details class="info" open="open"><summary>Note: <code>'mtica'</code> is an alias for <code>'level'</code> that's kept for</summary><p>backward compatibility.</p>
</details>
<details class="info" open="open"><summary>color_threshold : double, optional</summary><p>For brevity, let :math:<code>t</code> be the <code>color_threshold</code>.
Colors all the descendent links below a cluster node
:math:<code>k</code> the same color if :math:<code>k</code> is the first node below
the cut threshold :math:<code>t</code>. All links connecting nodes with
distances greater than or equal to the threshold are colored
with de default matplotlib color <code>'C0'</code>. If :math:<code>t</code> is less
than or equal to zero, all nodes are colored <code>'C0'</code>.
If <code>color_threshold</code> is None or 'default',
corresponding with MATLAB(TM) behavior, the threshold is set to
<code>0.7*max(Z[:,2])</code>.</p>
</details>
<details class="info" open="open"><summary>get_leaves : bool, optional</summary><p>Includes a list <code>R['leaves']=H</code> in the result
dictionary. For each :math:<code>i</code>, <code>H[i] == j</code>, cluster node
<code>j</code> appears in position <code>i</code> in the left-to-right traversal
of the leaves, where :math:<code>j &lt; 2n-1</code> and :math:<code>i &lt; n</code>.</p>
</details>
<details class="info" open="open"><summary>orientation : str, optional</summary><p>The direction to plot the dendrogram, which can be any
of the following strings:</p>
<p><code>'top'</code>
  Plots the root at the top, and plot descendent links going downwards.
  (default).</p>
<p><code>'bottom'</code>
  Plots the root at the bottom, and plot descendent links going
  upwards.</p>
<p><code>'left'</code>
  Plots the root at the left, and plot descendent links going right.</p>
<p><code>'right'</code>
  Plots the root at the right, and plot descendent links going left.</p>
</details>
<details class="info" open="open"><summary>labels : ndarray, optional</summary><p>By default, <code>labels</code> is None so the index of the original observation
is used to label the leaf nodes.  Otherwise, this is an :math:<code>n</code>-sized
sequence, with <code>n == Z.shape[0] + 1</code>. The <code>labels[i]</code> value is the
text to put under the :math:<code>i</code> th leaf node only if it corresponds to
an original observation and not a non-singleton cluster.</p>
</details>
<details class="info" open="open"><summary>count_sort : str or bool, optional</summary><p>For each node n, the order (visually, from left-to-right) n's
two descendent links are plotted is determined by this
parameter, which can be any of the following values:</p>
<p><code>False</code>
  Nothing is done.</p>
<p><code>'ascending'</code> or <code>True</code>
  The child with the minimum number of original objects in its cluster
  is plotted first.</p>
<p><code>'descending'</code>
  The child with the maximum number of original objects in its cluster
  is plotted first.</p>
<p>Note, <code>distance_sort</code> and <code>count_sort</code> cannot both be True.</p>
</details>
<details class="info" open="open"><summary>distance_sort : str or bool, optional</summary><p>For each node n, the order (visually, from left-to-right) n's
two descendent links are plotted is determined by this
parameter, which can be any of the following values:</p>
<p><code>False</code>
  Nothing is done.</p>
<p><code>'ascending'</code> or <code>True</code>
  The child with the minimum distance between its direct descendents is
  plotted first.</p>
<p><code>'descending'</code>
  The child with the maximum distance between its direct descendents is
  plotted first.</p>
<p>Note <code>distance_sort</code> and <code>count_sort</code> cannot both be True.</p>
</details>
<details class="info" open="open"><summary>show_leaf_counts : bool, optional</summary><p>When True, leaf nodes representing :math:<code>k&gt;1</code> original
 observation are labeled with the number of observations they
 contain in parentheses.</p>
</details>
<details class="info" open="open"><summary>no_plot : bool, optional</summary><p>When True, the final rendering is not performed. This is
useful if only the data structures computed for the rendering
are needed or if matplotlib is not available.</p>
</details>
<details class="info" open="open"><summary>no_labels : bool, optional</summary><p>When True, no labels appear next to the leaf nodes in the
rendering of the dendrogram.</p>
</details>
<details class="info" open="open"><summary>leaf_rotation : double, optional</summary><p>Specifies the angle (in degrees) to rotate the leaf
labels. When unspecified, the rotation is based on the number of
nodes in the dendrogram (default is 0).</p>
</details>
<details class="info" open="open"><summary>leaf_font_size : int, optional</summary><p>Specifies the font size (in points) of the leaf labels. When
unspecified, the size based on the number of nodes in the
dendrogram.</p>
</details>
<details class="info" open="open"><summary>leaf_label_func : lambda or function, optional</summary><p>When leaf_label_func is a callable function, for each
leaf with cluster index :math:<code>k &lt; 2n-1</code>. The function
is expected to return a string with the label for the
leaf.</p>
</details>
<details class="info" open="open"><summary>Indices :math:<code>k &lt; n</code> correspond to original observations</summary><p>while indices :math:<code>k \geq n</code> correspond to non-singleton
clusters.</p>
<p>For example, to label singletons with their node id and
non-singletons with their id, count, and inconsistency
coefficient, simply do::</p>
<div class="codehilite"><pre><span></span><code># First define the leaf label function.
def llf(id):
    if id &lt; n:
        return str(id)
    else:
        return &#39;[%d %d %1.2f]&#39; % (id, count, R[n-id,3])
# The text for the leaf nodes is going to be big so force
# a rotation of 90 degrees.
dendrogram(Z, leaf_label_func=llf, leaf_rotation=90)
</code></pre></div>


</details>
<details class="info" open="open"><summary>show_contracted : bool, optional</summary><p>When True the heights of non-singleton nodes contracted
into a leaf node are plotted as crosses along the link
connecting that leaf node.  This really is only useful when
truncation is used (see <code>truncate_mode</code> parameter).</p>
</details>
<details class="info" open="open"><summary>link_color_func : callable, optional</summary><p>If given, <code>link_color_function</code> is called with each non-singleton id
corresponding to each U-shaped link it will paint. The function is
expected to return the color to paint the link, encoded as a matplotlib
color string code. For example::</p>
<div class="codehilite"><pre><span></span><code>dendrogram(Z, link_color_func=lambda k: colors[k])
</code></pre></div>


<p>colors the direct links below each untruncated non-singleton node
<code>k</code> using <code>colors[k]</code>.</p>
</details>
<details class="info" open="open"><summary>ax : matplotlib Axes instance, optional</summary><p>If None and <code>no_plot</code> is not True, the dendrogram will be plotted
on the current axes.  Otherwise if <code>no_plot</code> is not True the
dendrogram will be plotted on the given <code>Axes</code> instance. This can be
useful if the dendrogram is part of a more complex figure.</p>
</details>
<details class="info" open="open"><summary>above_threshold_color : str, optional</summary><p>This matplotlib color string sets the color of the links above the
color_threshold. The default is <code>'C0'</code>.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>R : dict</summary><p>A dictionary of data structures computed to render the
dendrogram. Its has the following keys:</p>
<p><code>'color_list'</code>
  A list of color names. The k'th element represents the color of the
  k'th link.</p>
<p><code>'icoord'</code> and <code>'dcoord'</code>
  Each of them is a list of lists. Let <code>icoord = [I1, I2, ..., Ip]</code>
  where <code>Ik = [xk1, xk2, xk3, xk4]</code> and <code>dcoord = [D1, D2, ..., Dp]</code>
  where <code>Dk = [yk1, yk2, yk3, yk4]</code>, then the k'th link painted is
  <code>(xk1, yk1)</code> - <code>(xk2, yk2)</code> - <code>(xk3, yk3)</code> - <code>(xk4, yk4)</code>.</p>
<p><code>'ivl'</code>
  A list of labels corresponding to the leaf nodes.</p>
<p><code>'leaves'</code>
  For each i, <code>H[i] == j</code>, cluster node <code>j</code> appears in position
  <code>i</code> in the left-to-right traversal of the leaves, where
  :math:<code>j &lt; 2n-1</code> and :math:<code>i &lt; n</code>. If <code>j</code> is less than <code>n</code>, the
  <code>i</code>-th leaf node corresponds to an original observation.
  Otherwise, it corresponds to a non-singleton cluster.</p>
</details>
<h4>See Also</h4>
<p>linkage, set_link_color_palette</p>
<h4>Notes</h4>
<p>It is expected that the distances in <code>Z[:,2]</code> be monotonic, otherwise
crossings appear in the dendrogram.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">hierarchy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>

<p>A very basic example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">ytdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">662.</span><span class="p">,</span> <span class="mf">877.</span><span class="p">,</span> <span class="mf">255.</span><span class="p">,</span> <span class="mf">412.</span><span class="p">,</span> <span class="mf">996.</span><span class="p">,</span> <span class="mf">295.</span><span class="p">,</span> <span class="mf">468.</span><span class="p">,</span> <span class="mf">268.</span><span class="p">,</span>
<span class="o">...</span>                    <span class="mf">400.</span><span class="p">,</span> <span class="mf">754.</span><span class="p">,</span> <span class="mf">564.</span><span class="p">,</span> <span class="mf">138.</span><span class="p">,</span> <span class="mf">219.</span><span class="p">,</span> <span class="mf">869.</span><span class="p">,</span> <span class="mf">669.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">ytdist</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</code></pre></div>

<p>Now, plot in given axes, improve the color scheme and use both vertical and
horizontal orientations:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">set_link_color_palette</span><span class="p">([</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn1</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
<span class="o">...</span>                            <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn2</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>                            <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;#bcbddc&#39;</span><span class="p">,</span>
<span class="o">...</span>                            <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">set_link_color_palette</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># reset to default after use</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="fcluster">fcluster<a class="headerlink" href="#fcluster" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fcluster</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">criterion</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">depth</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">r</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">monocrit</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Form flat clusters from the hierarchical clustering defined by
the given linkage matrix.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded with the matrix returned
by the <code>linkage</code> function.</p>
</details>
<details class="info" open="open"><summary>t : scalar</summary><p>For criteria 'inconsistent', 'distance' or 'monocrit',
 this is the threshold to apply when forming flat clusters.
For 'maxclust' or 'maxclust_monocrit' criteria,
 this would be max number of clusters requested.</p>
</details>
<details class="info" open="open"><summary>criterion : str, optional</summary><p>The criterion to use in forming flat clusters. This can
be any of the following values:</p>
<p><code>inconsistent</code> :
      If a cluster node and all its
      descendants have an inconsistent value less than or equal
      to <code>t</code>, then all its leaf descendants belong to the
      same flat cluster. When no non-singleton cluster meets
      this criterion, every node is assigned to its own
      cluster. (Default)</p>
<p><code>distance</code> :
      Forms flat clusters so that the original
      observations in each flat cluster have no greater a
      cophenetic distance than <code>t</code>.</p>
<p><code>maxclust</code> :
      Finds a minimum threshold <code>r</code> so that
      the cophenetic distance between any two original
      observations in the same flat cluster is no more than
      <code>r</code> and no more than <code>t</code> flat clusters are formed.</p>
<p><code>monocrit</code> :
      Forms a flat cluster from a cluster node c
      with index i when <code>monocrit[j] &lt;= t</code>.</p>
<div class="codehilite"><pre><span></span><code>  For example, to threshold on the maximum mean distance
  as computed in the inconsistency matrix R with a
  threshold of 0.8 do::

      MR = maxRstat(Z, R, 3)
      cluster(Z, t=0.8, criterion=&#39;monocrit&#39;, monocrit=MR)
</code></pre></div>


<p><code>maxclust_monocrit</code> :
      Forms a flat cluster from a
      non-singleton cluster node <code>c</code> when <code>monocrit[i] &lt;=
      r</code> for all cluster indices <code>i</code> below and including
      <code>c</code>. <code>r</code> is minimized such that no more than <code>t</code>
      flat clusters are formed. monocrit must be
      monotonic. For example, to minimize the threshold t on
      maximum inconsistency values so that no more than 3 flat
      clusters are formed, do::</p>
<div class="codehilite"><pre><span></span><code>      MI = maxinconsts(Z, R)
      cluster(Z, t=3, criterion=&#39;maxclust_monocrit&#39;, monocrit=MI)
</code></pre></div>


</details>
<details class="info" open="open"><summary>depth : int, optional</summary><p>The maximum depth to perform the inconsistency calculation.
It has no meaning for the other criteria. Default is 2.</p>
</details>
<details class="info" open="open"><summary>R : ndarray, optional</summary><p>The inconsistency matrix to use for the 'inconsistent'
criterion. This matrix is computed if not provided.</p>
</details>
<details class="info" open="open"><summary>monocrit : ndarray, optional</summary><p>An array of length n-1. <code>monocrit[i]</code> is the
statistics upon which non-singleton i is thresholded. The
monocrit vector must be monotonic, i.e., given a node c with
index i, for all node indices j corresponding to nodes
below c, <code>monocrit[i] &gt;= monocrit[j]</code>.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>fcluster : ndarray</summary><p>An array of length <code>n</code>. <code>T[i]</code> is the flat cluster number to
which original observation <code>i</code> belongs.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage : for information about hierarchical clustering methods work.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>All cluster linkage methods - e.g., <code>scipy.cluster.hierarchy.ward</code>
generate a linkage matrix <code>Z</code> as their output:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>This matrix represents a dendrogram, where the first and second elements
are the two clusters merged at each step, the third element is the
distance between these clusters, and the fourth element is the size of
the new cluster - the number of original data points included.</p>
<p><code>scipy.cluster.hierarchy.fcluster</code> can be used to flatten the
dendrogram, obtaining as a result an assignation of the original data
points to single clusters.</p>
<p>This assignation mostly depends on a distance threshold <code>t</code> - the maximum
inter-cluster distance allowed:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>In the first case, the threshold <code>t</code> is too small to allow any two
samples in the data to form a cluster, so 12 different clusters are
returned.</p>
<p>In the second case, the threshold is large enough to allow the first
4 points to be merged with their nearest neighbors. So, here, only 8
clusters are returned.</p>
<p>The third case, with a much higher threshold, allows for up to 8 data
points to be connected - so 4 clusters are returned here.</p>
<p>Lastly, the threshold of the fourth case is large enough to allow for
all data points to be merged together - so a single cluster is returned.</p>
</details>
<h3 id="fclusterdata">fclusterdata<a class="headerlink" href="#fclusterdata" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fclusterdata</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">criterion</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">metric</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">depth</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">r</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Cluster observation data using a given metric.</p>
<p>Clusters the original observations in the n-by-m data
matrix X (n observations in m dimensions), using the euclidean
distance metric to calculate distances between original observations,
performs hierarchical clustering using the single linkage algorithm,
and forms flat clusters using the inconsistency method with <code>t</code> as the
cut-off threshold.</p>
<p>A 1-D array <code>T</code> of length <code>n</code> is returned. <code>T[i]</code> is
the index of the flat cluster to which the original observation <code>i</code>
belongs.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>X : (N, M) ndarray</summary><p>N by M data matrix with N observations in M dimensions.</p>
</details>
<details class="info" open="open"><summary>t : scalar</summary><p>For criteria 'inconsistent', 'distance' or 'monocrit',
 this is the threshold to apply when forming flat clusters.
For 'maxclust' or 'maxclust_monocrit' criteria,
 this would be max number of clusters requested.</p>
</details>
<details class="info" open="open"><summary>criterion : str, optional</summary><p>Specifies the criterion for forming flat clusters. Valid
values are 'inconsistent' (default), 'distance', or 'maxclust'
cluster formation algorithms. See <code>fcluster</code> for descriptions.</p>
</details>
<details class="info" open="open"><summary>metric : str or function, optional</summary><p>The distance metric for calculating pairwise distances. See
<code>distance.pdist</code> for descriptions and linkage to verify
compatibility with the linkage method.</p>
</details>
<details class="info" open="open"><summary>depth : int, optional</summary><p>The maximum depth for the inconsistency calculation. See
<code>inconsistent</code> for more information.</p>
</details>
<details class="info" open="open"><summary>method : str, optional</summary><p>The linkage method to use (single, complete, average,
weighted, median centroid, ward). See <code>linkage</code> for more
information. Default is 'single'.</p>
</details>
<details class="info" open="open"><summary>R : ndarray, optional</summary><p>The inconsistency matrix. It will be computed if necessary
if it is not passed.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>fclusterdata : ndarray</summary><p>A vector of length n. T[i] is the flat cluster number to
which original observation i belongs.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Notes</h4>
<p>This function is similar to the MATLAB function <code>clusterdata</code>.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">fclusterdata</span>
</code></pre></div>

<p>This is a convenience method that abstracts all the steps to perform in a
typical SciPy's hierarchical clustering workflow.</p>
<ul>
<li>
<p>Transform the input data into a condensed matrix with <code>scipy.spatial.distance.pdist</code>.</p>
</li>
<li>
<p>Apply a clustering method.</p>
</li>
<li>
<p>Obtain flat clusters at a user defined distance threshold <code>t</code> using <code>scipy.cluster.hierarchy.fcluster</code>.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fclusterdata</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>The output here (for the dataset <code>X</code>, distance threshold <code>t</code>, and the
default settings) is four clusters with three data points each.</p>
</details>
<h3 id="from_mlab_linkage">from_mlab_linkage<a class="headerlink" href="#from_mlab_linkage" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">from_mlab_linkage</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert a linkage matrix generated by MATLAB(TM) to a new
linkage matrix compatible with this module.</p>
<p>The conversion does two things:</p>
<ul>
<li>
<p>the indices are converted from <code>1..N</code> to <code>0..(N-1)</code> form,
   and</p>
</li>
<li>
<p>a fourth column <code>Z[:,3]</code> is added where <code>Z[i,3]</code> represents the
   number of original observations (leaves) in the non-singleton
   cluster <code>i</code>.</p>
</li>
</ul>
<p>This function is useful when loading in linkages from legacy data
files generated by MATLAB.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>A linkage matrix generated by MATLAB(TM).</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>ZS : ndarray</summary><p>A linkage matrix compatible with <code>scipy.cluster.hierarchy</code>.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>to_mlab_linkage: transform from SciPy to MATLAB format.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">from_mlab_linkage</span>
</code></pre></div>

<p>Given a linkage matrix in MATLAB format <code>mZ</code>, we can use
<code>scipy.cluster.hierarchy.from_mlab_linkage</code> to import
it into SciPy format:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">mZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mf">1.29099445</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mf">1.29099445</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">1.29099445</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">1.29099445</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mf">5.77350269</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">5.77350269</span><span class="p">],</span>
<span class="o">...</span>                <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">from_mlab_linkage</span><span class="p">(</span><span class="n">mZ</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span>  <span class="mf">0.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">3.</span>        <span class="p">,</span>   <span class="mf">4.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">6.</span>        <span class="p">,</span>   <span class="mf">7.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">9.</span>        <span class="p">,</span>  <span class="mf">10.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">2.</span>        <span class="p">,</span>  <span class="mf">12.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">,</span>   <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">5.</span>        <span class="p">,</span>  <span class="mf">13.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">,</span>   <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">8.</span>        <span class="p">,</span>  <span class="mf">14.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">,</span>   <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">11.</span>        <span class="p">,</span>  <span class="mf">15.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">,</span>   <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">16.</span>        <span class="p">,</span>  <span class="mf">17.</span>        <span class="p">,</span>   <span class="mf">5.77350269</span><span class="p">,</span>   <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">18.</span>        <span class="p">,</span>  <span class="mf">19.</span>        <span class="p">,</span>   <span class="mf">5.77350269</span><span class="p">,</span>   <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">20.</span>        <span class="p">,</span>  <span class="mf">21.</span>        <span class="p">,</span>   <span class="mf">8.16496581</span><span class="p">,</span>  <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>As expected, the linkage matrix <code>Z</code> returned includes an
additional column counting the number of original samples in
each cluster. Also, all cluster indices are reduced by 1
(MATLAB format uses 1-indexing, whereas SciPy uses 0-indexing).</p>
</details>
<h3 id="inconsistent">inconsistent<a class="headerlink" href="#inconsistent" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">inconsistent</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">d</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Calculate inconsistency statistics on a linkage matrix.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary></details>
<details class="info" open="open"><summary>The :math:<code>(n-1)</code> by 4 matrix encoding the linkage (hierarchical</summary><p>clustering).  See <code>linkage</code> documentation for more information on its
form.</p>
</details>
<details class="info" open="open"><summary>d : int, optional</summary><p>The number of links up to <code>d</code> levels below each non-singleton cluster.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>R : ndarray</summary></details>
<details class="info" open="open"><summary>A :math:<code>(n-1)</code> by 4 matrix where the <code>i</code>'th row contains the link</summary><p>statistics for the non-singleton cluster <code>i</code>. The link statistics are
computed over the link heights for links :math:<code>d</code> levels below the
cluster <code>i</code>. <code>R[i,0]</code> and <code>R[i,1]</code> are the mean and standard
deviation of the link heights, respectively; <code>R[i,2]</code> is the number
of links included in the calculation; and <code>R[i,3]</code> is the
inconsistency coefficient,</p>
<p>.. math:: \frac{\mathtt{Z[i,2]} - \mathtt{R[i,0]}} {R[i,1]}</p>
</details>
<h4>Notes</h4>
<p>This function behaves similarly to the MATLAB(TM) <code>inconsistent</code>
function.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">inconsistent</span><span class="p">,</span> <span class="n">linkage</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="p">[[</span> <span class="mf">5.</span>          <span class="mf">6.</span>          <span class="mf">0.</span>          <span class="mf">2.</span>        <span class="p">]</span>
 <span class="p">[</span> <span class="mf">2.</span>          <span class="mf">7.</span>          <span class="mf">0.</span>          <span class="mf">2.</span>        <span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.</span>          <span class="mf">4.</span>          <span class="mf">1.</span>          <span class="mf">2.</span>        <span class="p">]</span>
 <span class="p">[</span> <span class="mf">1.</span>          <span class="mf">8.</span>          <span class="mf">1.15470054</span>  <span class="mf">3.</span>        <span class="p">]</span>
 <span class="p">[</span> <span class="mf">9.</span>         <span class="mf">10.</span>          <span class="mf">2.12132034</span>  <span class="mf">4.</span>        <span class="p">]</span>
 <span class="p">[</span> <span class="mf">3.</span>         <span class="mf">12.</span>          <span class="mf">4.11096096</span>  <span class="mf">5.</span>        <span class="p">]</span>
 <span class="p">[</span><span class="mf">11.</span>         <span class="mf">13.</span>         <span class="mf">14.07183949</span>  <span class="mf">8.</span>        <span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.57735027</span><span class="p">,</span>  <span class="mf">0.81649658</span><span class="p">,</span>  <span class="mf">2.</span>        <span class="p">,</span>  <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.04044011</span><span class="p">,</span>  <span class="mf">1.06123822</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">1.01850858</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.11614065</span><span class="p">,</span>  <span class="mf">1.40688837</span><span class="p">,</span>  <span class="mf">2.</span>        <span class="p">,</span>  <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.44583366</span><span class="p">,</span>  <span class="mf">6.76770586</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">1.12682288</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="is_isomorphic">is_isomorphic<a class="headerlink" href="#is_isomorphic" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_isomorphic</span> <span class="o">:</span>
  <span class="n">t1</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t2</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Determine if two different cluster assignments are equivalent.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>T1 : array_like</summary><p>An assignment of singleton cluster ids to flat cluster ids.</p>
</details>
<details class="info" open="open"><summary>T2 : array_like</summary><p>An assignment of singleton cluster ids to flat cluster ids.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>b : bool</summary><p>Whether the flat cluster assignments <code>T1</code> and <code>T2</code> are
equivalent.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>fcluster: for the creation of flat cluster assignments.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">fcluster</span><span class="p">,</span> <span class="n">is_isomorphic</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">single</span><span class="p">,</span> <span class="n">complete</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>Two flat cluster assignments can be isomorphic if they represent the same
cluster assignment, with different labels.</p>
<p>For example, we can use the <code>scipy.cluster.hierarchy.single</code>: method
and flatten the output to four clusters:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">single</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">T</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>We can then do the same using the
<code>scipy.cluster.hierarchy.complete</code>: method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">complete</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">T_</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">T_</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>As we can see, in both cases we obtain four clusters and all the data
points are distributed in the same way - the only thing that changes
are the flat cluster labels (3 =&gt; 1, 4 =&gt;2, 2 =&gt;3 and 4 =&gt;1), so both
cluster assignments are isomorphic:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">is_isomorphic</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">T_</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="is_monotonic">is_monotonic<a class="headerlink" href="#is_monotonic" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_monotonic</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Return True if the linkage passed is monotonic.</p>
<p>The linkage is monotonic if for every cluster :math:<code>s</code> and :math:<code>t</code>
joined, the distance between them is no less than the distance
between any previously joined clusters.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The linkage matrix to check for monotonicity.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>b : bool</summary><p>A boolean indicating whether the linkage is monotonic.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">median</span><span class="p">,</span> <span class="n">ward</span><span class="p">,</span> <span class="n">is_monotonic</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>By definition, some hierarchical clustering algorithms - such as
<code>scipy.cluster.hierarchy.ward</code> - produce monotonic assignments of
samples to clusters; however, this is not always true for other
hierarchical methods - e.g. <code>scipy.cluster.hierarchy.median</code>.</p>
<p>Given a linkage matrix <code>Z</code> (as the result of a hierarchical clustering
method) we can test programmatically whether it has the monotonicity
property or not, using <code>scipy.cluster.hierarchy.is_monotonic</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_monotonic</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.5</span>       <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">3.25</span>      <span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_monotonic</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>

<p>Note that this method is equivalent to just verifying that the distances
in the third column of the linkage matrix appear in a monotonically
increasing order.</p>
</details>
<h3 id="is_valid_im">is_valid_im<a class="headerlink" href="#is_valid_im" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_valid_im</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">warning</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">throw</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">name</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="n">r</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Return True if the inconsistency matrix passed is valid.</p>
<p>It must be a :math:<code>n</code> by 4 array of doubles. The standard
deviations <code>R[:,1]</code> must be nonnegative. The link counts
<code>R[:,2]</code> must be positive and no greater than :math:<code>n-1</code>.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>R : ndarray</summary><p>The inconsistency matrix to check for validity.</p>
</details>
<details class="info" open="open"><summary>warning : bool, optional</summary><p>When True, issues a Python warning if the linkage
 matrix passed is invalid.</p>
</details>
<details class="info" open="open"><summary>throw : bool, optional</summary><p>When True, throws a Python exception if the linkage
 matrix passed is invalid.</p>
</details>
<details class="info" open="open"><summary>name : str, optional</summary><p>This string refers to the variable name of the invalid
 linkage matrix.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>b : bool</summary><p>True if the inconsistency matrix is valid.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>inconsistent: for the creation of a inconsistency matrix.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">inconsistent</span><span class="p">,</span> <span class="n">is_valid_im</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>Given a data set <code>X</code>, we can apply a clustering method to obtain a
linkage matrix <code>Z</code>. <code>scipy.cluster.hierarchy.inconsistent</code> can
be also used to obtain the inconsistency matrix <code>R</code> associated to
this clustering process:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">R</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.14549722</span><span class="p">,</span> <span class="mf">0.20576415</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.14549722</span><span class="p">,</span> <span class="mf">0.20576415</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.14549722</span><span class="p">,</span> <span class="mf">0.20576415</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.14549722</span><span class="p">,</span> <span class="mf">0.20576415</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.78516386</span><span class="p">,</span> <span class="mf">2.58797734</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.78516386</span><span class="p">,</span> <span class="mf">2.58797734</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">6.57065706</span><span class="p">,</span> <span class="mf">1.38071187</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">]])</span>
</code></pre></div>

<p>Now we can use <code>scipy.cluster.hierarchy.is_valid_im</code> to verify that
<code>R</code> is correct:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">is_valid_im</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<p>However, if <code>R</code> is wrongly constructed (e.g., one of the standard
deviations is set to a negative value), then the check will fail:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_valid_im</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>

</details>
<h3 id="is_valid_linkage">is_valid_linkage<a class="headerlink" href="#is_valid_linkage" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_valid_linkage</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">warning</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">throw</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">name</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Check the validity of a linkage matrix.</p>
<p>A linkage matrix is valid if it is a 2-D array (type double)</p>
<details class="info" open="open"><summary>with :math:<code>n</code> rows and 4 columns. The first two columns must contain</summary></details>
<p>indices between 0 and :math:<code>2n-1</code>. For a given row <code>i</code>, the following
two expressions have to hold:</p>
<div>
<div class="MathJax_Preview">
    0 \leq \mathtt{Z[i,0]} \leq i+n-1
    0 \leq Z[i,1] \leq i+n-1
</div>
<script type="math/tex; mode=display">
    0 \leq \mathtt{Z[i,0]} \leq i+n-1
    0 \leq Z[i,1] \leq i+n-1
</script>
</div>
<p>I.e., a cluster cannot join another cluster unless the cluster being joined
has been generated.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : array_like</summary><p>Linkage matrix.</p>
</details>
<details class="info" open="open"><summary>warning : bool, optional</summary><p>When True, issues a Python warning if the linkage
matrix passed is invalid.</p>
</details>
<details class="info" open="open"><summary>throw : bool, optional</summary><p>When True, throws a Python exception if the linkage
matrix passed is invalid.</p>
</details>
<details class="info" open="open"><summary>name : str, optional</summary><p>This string refers to the variable name of the invalid
linkage matrix.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>b : bool</summary><p>True if the inconsistency matrix is valid.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">is_valid_linkage</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>All linkage matrices generated by the clustering methods in this module
will be valid (i.e., they will have the appropriate dimensions and the two
required expressions will hold for all the rows).</p>
<p>We can check this using <code>scipy.cluster.hierarchy.is_valid_linkage</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<p>However, if we create a linkage matrix in a wrong way - or if we modify
a valid one in a way that any of the required expressions don't hold
anymore, then the check will fail:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>    <span class="c1"># the cluster number 20 is not defined at this point</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_valid_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>

</details>
<h3 id="leaders">leaders<a class="headerlink" href="#leaders" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">leaders</span> <span class="o">:</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Return the root nodes in a hierarchical clustering.</p>
<p>Returns the root nodes in a hierarchical clustering corresponding
to a cut defined by a flat cluster assignment vector <code>T</code>. See
the <code>fcluster</code> function for more information on the format of <code>T</code>.</p>
<p>For each flat cluster :math:<code>j</code> of the :math:<code>k</code> flat clusters
represented in the n-sized flat cluster assignment vector <code>T</code>,
this function finds the lowest cluster node :math:<code>i</code> in the linkage
tree Z, such that:</p>
<ul>
<li>
<p>leaf descendants belong only to flat cluster j
    (i.e., <code>T[p]==j</code> for all :math:<code>p</code> in :math:<code>S(i)</code>, where
    :math:<code>S(i)</code> is the set of leaf ids of descendant leaf nodes
    with cluster node :math:<code>i</code>)</p>
</li>
<li>
<p>there does not exist a leaf that is not a descendant with
    :math:<code>i</code> that also belongs to cluster :math:<code>j</code>
    (i.e., <code>T[q]!=j</code> for all :math:<code>q</code> not in :math:<code>S(i)</code>). If
    this condition is violated, <code>T</code> is not a valid cluster
    assignment vector, and an exception will be thrown.</p>
</li>
</ul>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a matrix. See
<code>linkage</code> for more information.</p>
</details>
<details class="info" open="open"><summary>T : ndarray</summary><p>The flat cluster assignment vector.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>L : ndarray</summary><p>The leader linkage node id's stored as a k-element 1-D array,
where <code>k</code> is the number of flat clusters found in <code>T</code>.</p>
<p><code>L[j]=i</code> is the linkage cluster node id that is the
leader of flat cluster with id M[j]. If <code>i &lt; n</code>, <code>i</code>
corresponds to an original observation, otherwise it
corresponds to a non-singleton cluster.</p>
</details>
<details class="info" open="open"><summary>M : ndarray</summary><p>The leader linkage node id's stored as a k-element 1-D array, where
<code>k</code> is the number of flat clusters found in <code>T</code>. This allows the
set of flat cluster ids to be any arbitrary set of <code>k</code> integers.</p>
<p>For example: if <code>L[3]=2</code> and <code>M[3]=8</code>, the flat cluster with
id 8's leader is linkage node 2.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>fcluster: for the creation of flat cluster assignments.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">fcluster</span><span class="p">,</span> <span class="n">leaders</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>Given a linkage matrix <code>Z</code> - obtained after apply a clustering method
to a dataset <code>X</code> - and a flat cluster assignment array <code>T</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">T</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p><code>scipy.cluster.hierarchy.leaders</code> returns the indices of the nodes
in the dendrogram that are the leaders of each flat cluster:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">leaders</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">L</span>
<span class="n">array</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>(remember that indices 0-11 point to the 12 data points in <code>X</code>,
whereas indices 12-22 point to the 11 rows of <code>Z</code>)</p>
<p><code>scipy.cluster.hierarchy.leaders</code> also returns the indices of
the flat clusters in <code>T</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">M</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="leaves_list">leaves_list<a class="headerlink" href="#leaves_list" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">leaves_list</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a list of leaf node ids.</p>
<p>The return corresponds to the observation vector index as it appears
in the tree from left to right. Z is a linkage matrix.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a matrix.  <code>Z</code> is
a linkage matrix.  See <code>linkage</code> for more information.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>leaves_list : ndarray</summary><p>The list of leaf node ids.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>dendrogram: for information about dendrogram structure.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">leaves_list</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram, that is, a tree that
encodes the structure of the clustering performed.
<code>scipy.cluster.hierarchy.leaves_list</code> shows the mapping between
indices in the <code>X</code> dataset and leaves in the dendrogram:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">leaves_list</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="linkage">linkage<a class="headerlink" href="#linkage" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">linkage</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">metric</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">optimal_ordering</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">y</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform hierarchical/agglomerative clustering.</p>
<p>The input y may be either a 1-D condensed distance matrix
or a 2-D array of observation vectors.</p>
<p>If y is a 1-D condensed distance matrix,
then y must be a :math:<code>\binom{n}{2}</code> sized
vector, where n is the number of original observations paired
in the distance matrix. The behavior of this function is very
similar to the MATLAB linkage function.</p>
<details class="info" open="open"><summary>A :math:<code>(n-1)</code> by 4 matrix <code>Z</code> is returned. At the</summary></details>
<p>:math:<code>i</code>-th iteration, clusters with indices <code>Z[i, 0]</code> and
<code>Z[i, 1]</code> are combined to form cluster :math:<code>n + i</code>. A
cluster with an index less than :math:<code>n</code> corresponds to one of</p>
<details class="info" open="open"><summary>the :math:<code>n</code> original observations. The distance between</summary></details>
<p>clusters <code>Z[i, 0]</code> and <code>Z[i, 1]</code> is given by <code>Z[i, 2]</code>. The
fourth value <code>Z[i, 3]</code> represents the number of original
observations in the newly formed cluster.</p>
<p>The following linkage methods are used to compute the distance
:math:<code>d(s, t)</code> between two clusters :math:<code>s</code> and
:math:<code>t</code>. The algorithm begins with a forest of clusters that
have yet to be used in the hierarchy being formed. When two</p>
<details class="info" open="open"><summary>clusters :math:<code>s</code> and :math:<code>t</code> from this forest are combined</summary></details>
<p>into a single cluster :math:<code>u</code>, :math:<code>s</code> and :math:<code>t</code> are
removed from the forest, and :math:<code>u</code> is added to the
forest. When only one cluster remains in the forest, the algorithm
stops, and this cluster becomes the root.</p>
<p>A distance matrix is maintained at each iteration. The <code>d[i,j]</code>
entry corresponds to the distance between cluster :math:<code>i</code> and
:math:<code>j</code> in the original forest.</p>
<p>At each iteration, the algorithm must update the distance matrix
to reflect the distance of the newly formed cluster u with the
remaining clusters in the forest.</p>
<p>Suppose there are :math:<code>|u|</code> original observations
:math:<code>u[0], \ldots, u[|u|-1]</code> in cluster :math:<code>u</code> and
:math:<code>|v|</code> original objects :math:<code>v[0], \ldots, v[|v|-1]</code> in</p>
<details class="info" open="open"><summary>cluster :math:<code>v</code>. Recall, :math:<code>s</code> and :math:<code>t</code> are</summary></details>
<p>combined to form cluster :math:<code>u</code>. Let :math:<code>v</code> be any
remaining cluster in the forest that is not :math:<code>u</code>.</p>
<p>The following are methods for calculating the distance between the
newly formed cluster :math:<code>u</code> and each :math:<code>v</code>.</p>
<ul>
<li>
<p>method='single' assigns</p>
<p>.. math::
   d(u,v) = \min(dist(u[i],v[j]))</p>
<p>for all points :math:<code>i</code> in cluster :math:<code>u</code> and
:math:<code>j</code> in cluster :math:<code>v</code>. This is also known as the
Nearest Point Algorithm.</p>
</li>
<li>
<p>method='complete' assigns</p>
<p>.. math::
   d(u, v) = \max(dist(u[i],v[j]))</p>
<p>for all points :math:<code>i</code> in cluster u and :math:<code>j</code> in</p>
</li>
</ul>
<details class="info" open="open"><summary>cluster :math:<code>v</code>. This is also known by the Farthest Point</summary><p>Algorithm or Voor Hees Algorithm.</p>
</details>
<ul>
<li>
<p>method='average' assigns</p>
<p>.. math::
   d(u,v) = \sum_{ij} \frac{d(u[i], v[j])}
                           {(|u|*|v|)}</p>
<p>for all points :math:<code>i</code> and :math:<code>j</code> where :math:<code>|u|</code></p>
</li>
</ul>
<details class="info" open="open"><summary>and :math:<code>|v|</code> are the cardinalities of clusters :math:<code>u</code></summary></details>
<details class="info" open="open"><summary>and :math:<code>v</code>, respectively. This is also called the UPGMA</summary><p>algorithm.</p>
</details>
<ul>
<li>
<p>method='weighted' assigns</p>
<p>.. math::
   d(u,v) = (dist(s,v) + dist(t,v))/2</p>
<p>where cluster u was formed with cluster s and t and v
is a remaining cluster in the forest (also called WPGMA).</p>
</li>
<li>
<p>method='centroid' assigns</p>
<p>.. math::
   dist(s,t) = ||c_s-c_t||_2</p>
</li>
</ul>
<details class="info" open="open"><summary>where :math:<code>c_s</code> and :math:<code>c_t</code> are the centroids of</summary></details>
<details class="info" open="open"><summary>clusters :math:<code>s</code> and :math:<code>t</code>, respectively. When two</summary></details>
<details class="info" open="open"><summary>clusters :math:<code>s</code> and :math:<code>t</code> are combined into a new</summary></details>
<details class="info" open="open"><summary>cluster :math:<code>u</code>, the new centroid is computed over all the</summary><p>original objects in clusters :math:<code>s</code> and :math:<code>t</code>. The
distance then becomes the Euclidean distance between the
centroid of :math:<code>u</code> and the centroid of a remaining cluster
:math:<code>v</code> in the forest. This is also known as the UPGMC
algorithm.</p>
</details>
<ul>
<li>
<p>method='median' assigns :math:<code>d(s,t)</code> like the <code>centroid</code>
    method. When two clusters :math:<code>s</code> and :math:<code>t</code> are combined
    into a new cluster :math:<code>u</code>, the average of centroids s and t
    give the new centroid :math:<code>u</code>. This is also known as the
    WPGMC algorithm.</p>
</li>
<li>
<p>method='ward' uses the Ward variance minimization algorithm.
    The new entry :math:<code>d(u,v)</code> is computed as follows,</p>
<p>.. math::</p>
<p>d(u,v) = \sqrt{\frac{ |v|+|s| }
                       {T}d(v,s)^2
                + \frac{ |v|+|t| }
                       {T}d(v,t)^2
                - \frac{ |v| }
                       {T}d(s,t)^2}</p>
</li>
</ul>
<details class="info" open="open"><summary>where :math:<code>u</code> is the newly joined cluster consisting of</summary></details>
<details class="info" open="open"><summary>clusters :math:<code>s</code> and :math:<code>t</code>, :math:<code>v</code> is an unused</summary><p>cluster in the forest, :math:<code>T=|v|+|s|+|t|</code>, and
:math:<code>|*|</code> is the cardinality of its argument. This is also
known as the incremental algorithm.</p>
</details>
<details class="info" open="open"><summary>Warning: When the minimum distance pair in the forest is chosen, there</summary></details>
<p>may be two or more pairs with the same minimum distance. This
implementation may choose a different minimum than the MATLAB
version.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>A condensed distance matrix. A condensed distance matrix
is a flat array containing the upper triangular of the distance matrix.
This is the form that <code>pdist</code> returns. Alternatively, a collection of
:math:<code>m</code> observation vectors in :math:<code>n</code> dimensions may be passed as</p>
</details>
<details class="info" open="open"><summary>an :math:<code>m</code> by :math:<code>n</code> array. All elements of the condensed distance</summary><p>matrix must be finite, i.e., no NaNs or infs.</p>
</details>
<details class="info" open="open"><summary>method : str, optional</summary><p>The linkage algorithm to use. See the <code>Linkage Methods</code> section below
for full descriptions.</p>
</details>
<details class="info" open="open"><summary>metric : str or function, optional</summary><p>The distance metric to use in the case that y is a collection of
observation vectors; ignored otherwise. See the <code>pdist</code>
function for a list of valid distance metrics. A custom distance
function can also be used.</p>
</details>
<details class="info" open="open"><summary>optimal_ordering : bool, optional</summary><p>If True, the linkage matrix will be reordered so that the distance
between successive leaves is minimal. This results in a more intuitive
tree structure when the data are visualized. defaults to False, because
this algorithm can be slow, particularly on large datasets [2]_. See
also the <code>optimal_leaf_ordering</code> function.</p>
<p>.. versionadded:: 1.0.0</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a linkage matrix.</p>
</details>
<h4>Notes</h4>
<ol>
<li>For method 'single', an optimized algorithm based on minimum spanning
   tree is implemented. It has time complexity :math:<code>O(n^2)</code>.
   For methods 'complete', 'average', 'weighted' and 'ward', an algorithm
   called nearest-neighbors chain is implemented. It also has time</li>
</ol>
<details class="info" open="open"><summary>complexity :math:<code>O(n^2)</code>.</summary></details>
<p>For other methods, a naive algorithm is implemented with :math:<code>O(n^3)</code>
   time complexity.
   All algorithms use :math:<code>O(n^2)</code> memory.
   Refer to [1]_ for details about the algorithms.
2. Methods 'centroid', 'median', and 'ward' are correctly defined only if
   Euclidean pairwise metric is used. If <code>y</code> is passed as precomputed
   pairwise distances, then it is the user's responsibility to assure that
   these distances are in fact Euclidean, otherwise the produced result
   will be incorrect.</p>
<h4>See Also</h4>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>References</h4>
<p>.. [1] Daniel Mullner, 'Modern hierarchical, agglomerative clustering</p>
<details class="info" open="open"><summary>algorithms', :arXiv:<code>1109.2378v1</code>.</summary></details>
<p>.. [2] Ziv Bar-Joseph, David K. Gifford, Tommi S. Jaakkola, 'Fast optimal
       leaf ordering for hierarchical clustering', 2001. Bioinformatics
       :doi:<code>10.1093/bioinformatics/17.suppl_1.S22</code></p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="maxrstat">maxRstat<a class="headerlink" href="#maxrstat" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxRstat</span> <span class="o">:</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">r</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">i</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the maximum statistic for each non-singleton cluster and its
children.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : array_like</summary><p>The hierarchical clustering encoded as a matrix. See <code>linkage</code> for more
information.</p>
</details>
<details class="info" open="open"><summary>R : array_like</summary><p>The inconsistency matrix.</p>
</details>
<details class="info" open="open"><summary>i : int</summary><p>The column of <code>R</code> to use as the statistic.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>MR : ndarray</summary><p>Calculates the maximum statistic for the i'th column of the
inconsistency matrix <code>R</code> for each non-singleton cluster
node. <code>MR[j]</code> is the maximum over <code>R[Q(j)-n, i]</code>, where
<code>Q(j)</code> the set of all node ids corresponding to nodes below
and including <code>j</code>.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>inconsistent: for the creation of a inconsistency matrix.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">median</span><span class="p">,</span> <span class="n">inconsistent</span><span class="p">,</span> <span class="n">maxRstat</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>Given a data set <code>X</code>, we can apply a clustering method to obtain a
linkage matrix <code>Z</code>. <code>scipy.cluster.hierarchy.inconsistent</code> can
be also used to obtain the inconsistency matrix <code>R</code> associated to
this clustering process:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">R</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.74535599</span><span class="p">,</span> <span class="mf">1.08655358</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.91202266</span><span class="p">,</span> <span class="mf">1.37522872</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.25</span>      <span class="p">,</span> <span class="mf">0.25</span>      <span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">]])</span>
</code></pre></div>

<p><code>scipy.cluster.hierarchy.maxRstat</code> can be used to compute
the maximum value of each column of <code>R</code>, for each non-singleton
cluster and its children:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">maxRstat</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.05901699</span><span class="p">,</span>
       <span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">1.74535599</span><span class="p">,</span> <span class="mf">1.91202266</span><span class="p">,</span>
       <span class="mf">3.25</span>      <span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">maxRstat</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span>
       <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">1.08655358</span><span class="p">,</span> <span class="mf">1.37522872</span><span class="p">,</span>
       <span class="mf">1.37522872</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">maxRstat</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">,</span>
       <span class="mf">0.70710678</span><span class="p">,</span> <span class="mf">0.70710678</span><span class="p">,</span> <span class="mf">0.70710678</span><span class="p">,</span> <span class="mf">1.15470054</span><span class="p">,</span> <span class="mf">1.15470054</span><span class="p">,</span>
       <span class="mf">1.15470054</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="maxdists">maxdists<a class="headerlink" href="#maxdists" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxdists</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the maximum distance between any non-singleton cluster.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a matrix. See
<code>linkage</code> for more information.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>maxdists : ndarray</summary><p>A <code>(n-1)</code> sized numpy array of doubles; <code>MD[i]</code> represents
the maximum distance between any cluster (including
singletons) below and including the node with index i. More
specifically, <code>MD[i] = Z[Q(i)-n, 2].max()</code> where <code>Q(i)</code> is the
set of all node indices below and including node i.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>is_monotonic: for testing for monotonicity of a linkage matrix.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">median</span><span class="p">,</span> <span class="n">maxdists</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>Given a linkage matrix <code>Z</code>, <code>scipy.cluster.hierarchy.maxdists</code>
computes for each new cluster generated (i.e., for each row of the linkage
matrix) what is the maximum distance between any two child clusters.</p>
<p>Due to the nature of hierarchical clustering, in many cases this is going
to be just the distance between the two child clusters that were merged
to form the current one - that is, Z[:,2].</p>
<p>However, for non-monotonic cluster assignments such as
<code>scipy.cluster.hierarchy.median</code> clustering this is not always the</p>
<details class="info" open="open"><summary>case: There may be cluster formations were the distance between the two</summary></details>
<p>clusters merged is smaller than the distance between their children.</p>
<p>We can see this in an example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.5</span>       <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">3.25</span>      <span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">maxdists</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">1.11803399</span><span class="p">,</span>
       <span class="mf">1.11803399</span><span class="p">,</span> <span class="mf">1.11803399</span><span class="p">,</span> <span class="mf">1.11803399</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">3.5</span>       <span class="p">,</span>
       <span class="mf">3.5</span>       <span class="p">])</span>
</code></pre></div>

<p>Note that while the distance between the two clusters merged when creating the
last cluster is 3.25, there are two children (clusters 16 and 17) whose distance
is larger (3.5). Thus, <code>scipy.cluster.hierarchy.maxdists</code> returns 3.5 in
this case.</p>
</details>
<h3 id="maxinconsts">maxinconsts<a class="headerlink" href="#maxinconsts" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxinconsts</span> <span class="o">:</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">r</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the maximum inconsistency coefficient for each
non-singleton cluster and its children.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a matrix. See
<code>linkage</code> for more information.</p>
</details>
<details class="info" open="open"><summary>R : ndarray</summary><p>The inconsistency matrix.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>MI : ndarray</summary><p>A monotonic <code>(n-1)</code>-sized numpy array of doubles.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>inconsistent: for the creation of a inconsistency matrix.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">median</span><span class="p">,</span> <span class="n">inconsistent</span><span class="p">,</span> <span class="n">maxinconsts</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>Given a data set <code>X</code>, we can apply a clustering method to obtain a
linkage matrix <code>Z</code>. <code>scipy.cluster.hierarchy.inconsistent</code> can
be also used to obtain the inconsistency matrix <code>R</code> associated to
this clustering process:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">inconsistent</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.5</span>       <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">3.25</span>      <span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">R</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05901699</span><span class="p">,</span> <span class="mf">0.08346263</span><span class="p">,</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.74535599</span><span class="p">,</span> <span class="mf">1.08655358</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.91202266</span><span class="p">,</span> <span class="mf">1.37522872</span><span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">1.15470054</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.25</span>      <span class="p">,</span> <span class="mf">0.25</span>      <span class="p">,</span> <span class="mf">3.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">]])</span>
</code></pre></div>

<p>Here, <code>scipy.cluster.hierarchy.maxinconsts</code> can be used to compute
the maximum value of the inconsistency statistic (the last column of
<code>R</code>) for each non-singleton cluster and its children:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">maxinconsts</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.70710678</span><span class="p">,</span>
       <span class="mf">0.70710678</span><span class="p">,</span> <span class="mf">0.70710678</span><span class="p">,</span> <span class="mf">0.70710678</span><span class="p">,</span> <span class="mf">1.15470054</span><span class="p">,</span> <span class="mf">1.15470054</span><span class="p">,</span>
       <span class="mf">1.15470054</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="median">median<a class="headerlink" href="#median" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">median</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform median/WPGMC linkage.</p>
<p>See <code>linkage</code> for more information on the return structure
and algorithm.</p>
<p>The following are common calling conventions:</p>
<ol>
<li>
<p><code>Z = median(y)</code></p>
<p>Performs median/WPGMC linkage on the condensed distance matrix
<code>y</code>.  See <code>linkage</code> for more information on the return
structure and algorithm.</p>
</li>
<li>
<p><code>Z = median(X)</code></p>
<p>Performs median/WPGMC linkage on the observation matrix <code>X</code>
using Euclidean distance as the distance metric. See <code>linkage</code>
for more information on the return structure and algorithm.</p>
</li>
</ol>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>A condensed distance matrix. A condensed
distance matrix is a flat array containing the upper
triangular of the distance matrix. This is the form that
<code>pdist</code> returns.  Alternatively, a collection of
m observation vectors in n dimensions may be passed as
an m by n array.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a linkage matrix.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">median</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.11803399</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.5</span>       <span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">3.25</span>      <span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h3 id="num_obs_linkage">num_obs_linkage<a class="headerlink" href="#num_obs_linkage" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">num_obs_linkage</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">int</span>
</code></pre></div>

<p>Return the number of original observations of the linkage matrix passed.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The linkage matrix on which to perform the operation.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>n : int</summary><p>The number of original observations in the linkage.</p>
</details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">num_obs_linkage</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</code></pre></div>

<p><code>Z</code> is a linkage matrix obtained after using the Ward clustering method
with <code>X</code>, a dataset with 12 data points.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">num_obs_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="mi">12</span>
</code></pre></div>

</details>
<h3 id="optimal_leaf_ordering">optimal_leaf_ordering<a class="headerlink" href="#optimal_leaf_ordering" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">optimal_leaf_ordering</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">metric</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">y</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Given a linkage matrix Z and distance, reorder the cut tree.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a linkage matrix. See
<code>linkage</code> for more information on the return structure and
algorithm.</p>
</details>
<details class="info" open="open"><summary>y : ndarray</summary><p>The condensed distance matrix from which Z was generated.
Alternatively, a collection of m observation vectors in n
dimensions may be passed as an m by n array.</p>
</details>
<details class="info" open="open"><summary>metric : str or function, optional</summary><p>The distance metric to use in the case that y is a collection of
observation vectors; ignored otherwise. See the <code>pdist</code>
function for a list of valid distance metrics. A custom distance
function can also be used.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z_ordered : ndarray</summary><p>A copy of the linkage matrix Z, reordered to minimize the distance
between adjacent leaves.</p>
</details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">hierarchy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">ward</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">leaves_list</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">leaves_list</span><span class="p">(</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">optimal_leaf_ordering</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="set_link_color_palette">set_link_color_palette<a class="headerlink" href="#set_link_color_palette" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">set_link_color_palette</span> <span class="o">:</span>
  <span class="o">[`</span><span class="nc">StringList</span> <span class="k">of</span> <span class="kt">string</span> <span class="kt">list</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Set list of matplotlib color codes for use by dendrogram.</p>
<p>Note that this palette is global (i.e., setting it once changes the colors
for all subsequent calls to <code>dendrogram</code>) and that it affects only the
the colors below <code>color_threshold</code>.</p>
<p>Note that <code>dendrogram</code> also accepts a custom coloring function through its
<code>link_color_func</code> keyword, which is more flexible and non-global.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>palette : list of str or None</summary><p>A list of matplotlib color codes.  The order of the color codes is the
order in which the colors are cycled through when color thresholding in
the dendrogram.</p>
<p>If <code>None</code>, resets the palette to its default (which are matplotlib
default colors C1 to C9).</p>
</details>
<h4>Returns</h4>
<p>None</p>
<h4>See Also</h4>
<p>dendrogram</p>
<h4>Notes</h4>
<p>Ability to reset the palette with <code>None</code> added in SciPy 0.17.0.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">hierarchy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ytdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">662.</span><span class="p">,</span> <span class="mf">877.</span><span class="p">,</span> <span class="mf">255.</span><span class="p">,</span> <span class="mf">412.</span><span class="p">,</span> <span class="mf">996.</span><span class="p">,</span> <span class="mf">295.</span><span class="p">,</span> <span class="mf">468.</span><span class="p">,</span> <span class="mf">268.</span><span class="p">,</span>
<span class="o">...</span>                    <span class="mf">400.</span><span class="p">,</span> <span class="mf">754.</span><span class="p">,</span> <span class="mf">564.</span><span class="p">,</span> <span class="mf">138.</span><span class="p">,</span> <span class="mf">219.</span><span class="p">,</span> <span class="mf">869.</span><span class="p">,</span> <span class="mf">669.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">ytdist</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">no_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span><span class="p">[</span><span class="s1">&#39;color_list&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">set_link_color_palette</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">no_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span><span class="p">[</span><span class="s1">&#39;color_list&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">no_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_threshold</span><span class="o">=</span><span class="mi">267</span><span class="p">,</span>
<span class="o">...</span>                           <span class="n">above_threshold_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dn</span><span class="p">[</span><span class="s1">&#39;color_list&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
</code></pre></div>

<p>Now, reset the color palette to its default:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">set_link_color_palette</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="single">single<a class="headerlink" href="#single" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">single</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform single/min/nearest linkage on the condensed distance matrix <code>y</code>.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>The upper triangular of the distance matrix. The result of
<code>pdist</code> is returned in this form.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The linkage matrix.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">single</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">single</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span><span class="p">,</span> <span class="mf">18.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">13.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">17.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">19.</span><span class="p">,</span> <span class="mf">21.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h3 id="to_mlab_linkage">to_mlab_linkage<a class="headerlink" href="#to_mlab_linkage" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_mlab_linkage</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert a linkage matrix to a MATLAB(TM) compatible one.</p>
<p>Converts a linkage matrix <code>Z</code> generated by the linkage function
of this module to a MATLAB(TM) compatible one. The return linkage
matrix has the last column removed and the cluster indices are
converted to <code>1..N</code> indexing.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>A linkage matrix generated by <code>scipy.cluster.hierarchy</code>.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>to_mlab_linkage : ndarray</summary><p>A linkage matrix compatible with MATLAB(TM)'s hierarchical
clustering functions.</p>
<p>The return linkage matrix has the last column removed
and the cluster indices are converted to <code>1..N</code> indexing.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for a description of what a linkage matrix is.</summary></details>
<details class="info" open="open"><summary>from_mlab_linkage: transform from Matlab to SciPy format.</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">to_mlab_linkage</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>After a linkage matrix <code>Z</code> has been created, we can use
<code>scipy.cluster.hierarchy.to_mlab_linkage</code> to convert it
into MATLAB format:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">mZ</span> <span class="o">=</span> <span class="n">to_mlab_linkage</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mZ</span>
<span class="n">array</span><span class="p">([[</span>  <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">2.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">4.</span>        <span class="p">,</span>   <span class="mf">5.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">7.</span>        <span class="p">,</span>   <span class="mf">8.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">11.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">13.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">14.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">9.</span>        <span class="p">,</span>  <span class="mf">15.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">16.</span>        <span class="p">,</span>   <span class="mf">1.29099445</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">18.</span>        <span class="p">,</span>   <span class="mf">5.77350269</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">20.</span>        <span class="p">,</span>   <span class="mf">5.77350269</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">22.</span>        <span class="p">,</span>   <span class="mf">8.16496581</span><span class="p">]])</span>
</code></pre></div>

<p>The new linkage matrix <code>mZ</code> uses 1-indexing for all the
clusters (instead of 0-indexing). Also, the last column of
the original linkage matrix has been dropped.</p>
</details>
<h3 id="to_tree">to_tree<a class="headerlink" href="#to_tree" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_tree</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">rd</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">z</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert a linkage matrix into an easy-to-use tree object.</p>
<p>The reference to the root <code>ClusterNode</code> object is returned (by default).</p>
<p>Each <code>ClusterNode</code> object has a <code>left</code>, <code>right</code>, <code>dist</code>, <code>id</code>,
and <code>count</code> attribute. The left and right attributes point to
ClusterNode objects that were combined to generate the cluster.
If both are None then the <code>ClusterNode</code> object is a leaf node, its count
must be 1, and its distance is meaningless but set to 0.</p>
<details class="info" open="open"><summary>*Note: This function is provided for the convenience of the library</summary></details>
<p>user. ClusterNodes are not used as input to any of the functions in this
library.*</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The linkage matrix in proper form (see the <code>linkage</code>
function documentation).</p>
</details>
<details class="info" open="open"><summary>rd : bool, optional</summary><p>When False (default), a reference to the root <code>ClusterNode</code> object is
returned.  Otherwise, a tuple <code>(r, d)</code> is returned. <code>r</code> is a
reference to the root node while <code>d</code> is a list of <code>ClusterNode</code>
objects - one per original entry in the linkage matrix plus entries
for all clustering steps. If a cluster id is
less than the number of samples <code>n</code> in the data that the linkage
matrix describes, then it corresponds to a singleton cluster (leaf
node).
See <code>linkage</code> for more information on the assignment of cluster ids
to clusters.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>tree : ClusterNode or tuple (ClusterNode, list of ClusterNode)</summary><p>If <code>rd</code> is False, a <code>ClusterNode</code>.
If <code>rd</code> is True, a list of length <code>2*n - 1</code>, with <code>n</code> the number
of samples.  See the description of <code>rd</code> above for more details.</p>
</details>
<h4>See Also</h4>
<p>linkage, is_valid_linkage, ClusterNode</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">hierarchy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">to_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">scipy</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">ClusterNode</span> <span class="nb">object</span> <span class="n">at</span> <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rootnode</span><span class="p">,</span> <span class="n">nodelist</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="o">.</span><span class="n">to_tree</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rootnode</span>
<span class="o">&lt;</span><span class="n">scipy</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">ClusterNode</span> <span class="nb">object</span> <span class="n">at</span> <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodelist</span><span class="p">)</span>
<span class="mi">9</span>
</code></pre></div>

</details>
<h3 id="ward">ward<a class="headerlink" href="#ward" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">ward</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform Ward's linkage on a condensed distance matrix.</p>
<p>See <code>linkage</code> for more information on the return structure
and algorithm.</p>
<p>The following are common calling conventions:</p>
<ol>
<li>
<p><code>Z = ward(y)</code>
   Performs Ward's linkage on the condensed distance matrix <code>y</code>.</p>
</li>
<li>
<p><code>Z = ward(X)</code>
   Performs Ward's linkage on the observation matrix <code>X</code> using
   Euclidean distance as the distance metric.</p>
</li>
</ol>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>A condensed distance matrix. A condensed
distance matrix is a flat array containing the upper
triangular of the distance matrix. This is the form that
<code>pdist</code> returns.  Alternatively, a collection of
m observation vectors in n dimensions may be passed as
an m by n array.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>The hierarchical clustering encoded as a linkage matrix. See
<code>linkage</code> for more information on the return structure and
algorithm.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage: for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">11.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.29099445</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">5.77350269</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">8.16496581</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h3 id="weighted">weighted<a class="headerlink" href="#weighted" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">weighted</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform weighted/WPGMA linkage on the condensed distance matrix.</p>
<p>See <code>linkage</code> for more information on the return
structure and algorithm.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>y : ndarray</summary><p>The upper triangular of the distance matrix. The result of
<code>pdist</code> is returned in this form.</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Z : ndarray</summary><p>A linkage matrix containing the hierarchical clustering. See
<code>linkage</code> for more information on its structure.</p>
</details>
<h4>See Also</h4>
<details class="info" open="open"><summary>linkage : for advanced creation of hierarchical clusterings.</summary></details>
<details class="info" open="open"><summary>scipy.spatial.distance.pdist : pairwise distance metrics</summary></details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">weighted</span><span class="p">,</span> <span class="n">fcluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
</code></pre></div>

<p>First, we need a toy dataset to play with::</p>
<div class="codehilite"><pre><span></span><code>x x    x x
x        x

x        x
x x    x x
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</code></pre></div>

<p>Then, we get a condensed distance matrix from this dataset:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>Finally, we can perform the clustering:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">weighted</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span>        <span class="p">,</span>  <span class="mf">7.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span>        <span class="p">,</span>  <span class="mf">4.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">9.</span>        <span class="p">,</span> <span class="mf">11.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">2.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span>        <span class="p">,</span> <span class="mf">12.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span>        <span class="p">,</span> <span class="mf">13.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">14.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">10.</span>        <span class="p">,</span> <span class="mf">15.</span>        <span class="p">,</span>  <span class="mf">1.20710678</span><span class="p">,</span>  <span class="mf">3.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">18.</span>        <span class="p">,</span> <span class="mf">19.</span>        <span class="p">,</span>  <span class="mf">3.05595762</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">16.</span>        <span class="p">,</span> <span class="mf">17.</span>        <span class="p">,</span>  <span class="mf">3.32379407</span><span class="p">,</span>  <span class="mf">6.</span>        <span class="p">],</span>
       <span class="p">[</span><span class="mf">20.</span>        <span class="p">,</span> <span class="mf">21.</span>        <span class="p">,</span>  <span class="mf">4.06357713</span><span class="p">,</span> <span class="mf">12.</span>        <span class="p">]])</span>
</code></pre></div>

<p>The linkage matrix <code>Z</code> represents a dendrogram - see
<code>scipy.cluster.hierarchy.linkage</code> for a detailed explanation of its
contents.</p>
<p>We can use <code>scipy.cluster.hierarchy.fcluster</code> to see to which cluster
each initial point would belong given a distance threshold:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>

<p>Also, <code>scipy.cluster.hierarchy.dendrogram</code> can be used to generate a
plot of the dendrogram.</p>
</details>
<h2 id="vq">Vq<a class="headerlink" href="#vq" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Vq</code> wraps Python module <code>scipy.cluster.vq</code>.</p>
<h2 id="clustererror">ClusterError<a class="headerlink" href="#clustererror" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Vq.​ClusterError</code> wraps Python class <code>scipy.cluster.vq.ClusterError</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback_1">with_traceback<a class="headerlink" href="#with_traceback_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_3">to_string<a class="headerlink" href="#to_string_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_3">show<a class="headerlink" href="#show_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_3">pp<a class="headerlink" href="#pp_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="deque_1">Deque<a class="headerlink" href="#deque_1" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Cluster.​Vq.​Deque</code> wraps Python class <code>scipy.cluster.vq.deque</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="getitem_1"><strong>getitem</strong><a class="headerlink" href="#getitem_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">getitem__</span> <span class="o">:</span>
  <span class="n">key</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return self[key].</p>
</details>
<h3 id="iter_1"><strong>iter</strong><a class="headerlink" href="#iter_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">iter__</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Implement iter(self).</p>
</details>
<h3 id="setitem_1"><strong>setitem</strong><a class="headerlink" href="#setitem_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">setitem__</span> <span class="o">:</span>
  <span class="n">key</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="k">value</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Set self[key] to value.</p>
</details>
<h3 id="count_1">count<a class="headerlink" href="#count_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">count</span> <span class="o">:</span>
  <span class="k">value</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>D.count(value) -&gt; integer -- return number of occurrences of value</p>
</details>
<h3 id="insert_1">insert<a class="headerlink" href="#insert_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">insert</span> <span class="o">:</span>
  <span class="n">index</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">object_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>D.insert(index, object) -- insert object before index</p>
</details>
<h3 id="remove_1">remove<a class="headerlink" href="#remove_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">remove</span> <span class="o">:</span>
  <span class="k">value</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>D.remove(value) -- remove first occurrence of value.</p>
</details>
<h3 id="to_string_4">to_string<a class="headerlink" href="#to_string_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_4">show<a class="headerlink" href="#show_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_4">pp<a class="headerlink" href="#pp_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="cdist">cdist<a class="headerlink" href="#cdist" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">cdist</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">metric</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">xa</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xb</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute distance between each pair of the two collections of inputs.</p>
<p>See Notes for common calling conventions.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>XA : ndarray</summary></details>
<details class="info" open="open"><summary>An :math:<code>m_A</code> by :math:<code>n</code> array of :math:<code>m_A</code></summary><p>original observations in an :math:<code>n</code>-dimensional space.
Inputs are converted to float type.</p>
</details>
<details class="info" open="open"><summary>XB : ndarray</summary></details>
<details class="info" open="open"><summary>An :math:<code>m_B</code> by :math:<code>n</code> array of :math:<code>m_B</code></summary><p>original observations in an :math:<code>n</code>-dimensional space.
Inputs are converted to float type.</p>
</details>
<details class="info" open="open"><summary>metric : str or callable, optional</summary><p>The distance metric to use.  If a string, the distance function can be
'braycurtis', 'canberra', 'chebyshev', 'cityblock', 'correlation',
'cosine', 'dice', 'euclidean', 'hamming', 'jaccard', 'jensenshannon',
'kulsinski', 'mahalanobis', 'matching', 'minkowski', 'rogerstanimoto',
'russellrao', 'seuclidean', 'sokalmichener', 'sokalsneath', 'sqeuclidean',
'wminkowski', 'yule'.</p>
</details>
<details class="info" open="open"><summary>*args : tuple. Deprecated.</summary><p>Additional arguments should be passed as keyword arguments</p>
</details>
<details class="info" open="open"><summary>**kwargs : dict, optional</summary><p>Extra arguments to <code>metric</code>: refer to each metric documentation for a
list of all possible arguments.</p>
<p>Some possible arguments:</p>
</details>
<details class="info" open="open"><summary>p : scalar</summary><p>The p-norm to apply for Minkowski, weighted and unweighted.</p>
</details>
<details class="info" open="open"><summary>Default: 2.</summary></details>
<details class="info" open="open"><summary>w : ndarray</summary><p>The weight vector for metrics that support weights (e.g., Minkowski).</p>
</details>
<details class="info" open="open"><summary>V : ndarray</summary><p>The variance vector for standardized Euclidean.</p>
</details>
<details class="info" open="open"><summary>Default: var(vstack([XA, XB]), axis=0, ddof=1)</summary></details>
<details class="info" open="open"><summary>VI : ndarray</summary><p>The inverse of the covariance matrix for Mahalanobis.</p>
</details>
<details class="info" open="open"><summary>Default: inv(cov(vstack([XA, XB].T))).T</summary></details>
<details class="info" open="open"><summary>out : ndarray</summary><p>The output array
If not None, the distance matrix Y is stored in this array.</p>
</details>
<details class="info" open="open"><summary>Note: metric independent, it will become a regular keyword arg in a</summary><p>future scipy version</p>
</details>
<h4>Returns</h4>
<details class="info" open="open"><summary>Y : ndarray</summary></details>
<details class="info" open="open"><summary>A :math:<code>m_A</code> by :math:<code>m_B</code> distance matrix is returned.</summary><p>For each :math:<code>i</code> and :math:<code>j</code>, the metric
<code>dist(u=XA[i], v=XB[j])</code> is computed and stored in the
:math:<code>ij</code> th entry.</p>
</details>
<h4>Raises</h4>
<p>ValueError
    An exception is thrown if <code>XA</code> and <code>XB</code> do not have
    the same number of columns.</p>
<h4>Notes</h4>
<p>The following are common calling conventions:</p>
<ol>
<li><code>Y = cdist(XA, XB, 'euclidean')</code></li>
</ol>
<p>Computes the distance between :math:<code>m</code> points using
   Euclidean distance (2-norm) as the distance metric between the
   points. The points are arranged as :math:<code>m</code>
   :math:<code>n</code>-dimensional row vectors in the matrix X.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'minkowski', p=2.)</code></li>
</ol>
<p>Computes the distances using the Minkowski distance
   :math:<code>||u-v||_p</code> (:math:<code>p</code>-norm) where :math:<code>p \geq 1</code>.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'cityblock')</code></li>
</ol>
<p>Computes the city block or Manhattan distance between the
   points.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'seuclidean', V=None)</code></li>
</ol>
<p>Computes the standardized Euclidean distance. The standardized
   Euclidean distance between two n-vectors <code>u</code> and <code>v</code> is</p>
<p>.. math::</p>
<div class="codehilite"><pre><span></span><code>  \sqrt{\sum {(u_i-v_i)^2 / V[x_i]}}.
</code></pre></div>


<p>V is the variance vector; V[i] is the variance computed over all
   the i'th components of the points. If not passed, it is
   automatically computed.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'sqeuclidean')</code></li>
</ol>
<p>Computes the squared Euclidean distance :math:<code>||u-v||_2^2</code> between
   the vectors.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'cosine')</code></li>
</ol>
<p>Computes the cosine distance between vectors u and v,</p>
<p>.. math::</p>
<div class="codehilite"><pre><span></span><code>  1 - \frac{u \cdot v}
           {{ ||u|| }_2 { ||v|| }_2}
</code></pre></div>


<details class="info" open="open"><summary>where :math:<code>||*||_2</code> is the 2-norm of its argument <code>*</code>, and</summary></details>
<p>:math:<code>u \cdot v</code> is the dot product of :math:<code>u</code> and :math:<code>v</code>.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'correlation')</code></li>
</ol>
<p>Computes the correlation distance between vectors u and v. This is</p>
<p>.. math::</p>
<div class="codehilite"><pre><span></span><code>  1 - \frac{(u - \bar{u}) \cdot (v - \bar{v})}
           {{ ||(u - \bar{u})|| }_2 { ||(v - \bar{v})|| }_2}
</code></pre></div>


<details class="info" open="open"><summary>where :math:<code>\bar{v}</code> is the mean of the elements of vector v,</summary></details>
<details class="info" open="open"><summary>and :math:<code>x \cdot y</code> is the dot product of :math:<code>x</code> and :math:<code>y</code>.</summary></details>
<ol>
<li><code>Y = cdist(XA, XB, 'hamming')</code></li>
</ol>
<p>Computes the normalized Hamming distance, or the proportion of
   those vector elements between two n-vectors <code>u</code> and <code>v</code>
   which disagree. To save memory, the matrix <code>X</code> can be of type
   boolean.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'jaccard')</code></li>
</ol>
<p>Computes the Jaccard distance between the points. Given two
   vectors, <code>u</code> and <code>v</code>, the Jaccard distance is the
   proportion of those elements <code>u[i]</code> and <code>v[i]</code> that
   disagree where at least one of them is non-zero.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'chebyshev')</code></li>
</ol>
<p>Computes the Chebyshev distance between the points. The
   Chebyshev distance between two n-vectors <code>u</code> and <code>v</code> is the
   maximum norm-1 distance between their respective elements. More
   precisely, the distance is given by</p>
<p>.. math::</p>
<div class="codehilite"><pre><span></span><code>  d(u,v) = \max_i { |u_i-v_i| }.
</code></pre></div>


<ol>
<li><code>Y = cdist(XA, XB, 'canberra')</code></li>
</ol>
<p>Computes the Canberra distance between the points. The
   Canberra distance between two points <code>u</code> and <code>v</code> is</p>
<p>.. math::</p>
<div class="codehilite"><pre><span></span><code> d(u,v) = \sum_i \frac{ |u_i-v_i| }
                      { |u_i|+|v_i| }.
</code></pre></div>


<ol>
<li><code>Y = cdist(XA, XB, 'braycurtis')</code></li>
</ol>
<p>Computes the Bray-Curtis distance between the points. The
   Bray-Curtis distance between two points <code>u</code> and <code>v</code> is</p>
<p>.. math::</p>
<div class="codehilite"><pre><span></span><code>    d(u,v) = \frac{\sum_i (|u_i-v_i|)}
                  {\sum_i (|u_i+v_i|)}
</code></pre></div>


<ol>
<li><code>Y = cdist(XA, XB, 'mahalanobis', VI=None)</code></li>
</ol>
<p>Computes the Mahalanobis distance between the points. The
   Mahalanobis distance between two points <code>u</code> and <code>v</code> is
   :math:<code>\sqrt{(u-v)(1/V)(u-v)^T}</code> where :math:<code>(1/V)</code> (the <code>VI</code>
   variable) is the inverse covariance. If <code>VI</code> is not None,
   <code>VI</code> will be used as the inverse covariance matrix.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'yule')</code></li>
</ol>
<p>Computes the Yule distance between the boolean
   vectors. (see <code>yule</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'matching')</code></li>
</ol>
<p>Synonym for 'hamming'.</p>
<ol>
<li><code>Y = cdist(XA, XB, 'dice')</code></li>
</ol>
<p>Computes the Dice distance between the boolean vectors. (see
   <code>dice</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'kulsinski')</code></li>
</ol>
<p>Computes the Kulsinski distance between the boolean
   vectors. (see <code>kulsinski</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'rogerstanimoto')</code></li>
</ol>
<p>Computes the Rogers-Tanimoto distance between the boolean
   vectors. (see <code>rogerstanimoto</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'russellrao')</code></li>
</ol>
<p>Computes the Russell-Rao distance between the boolean
   vectors. (see <code>russellrao</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'sokalmichener')</code></li>
</ol>
<p>Computes the Sokal-Michener distance between the boolean
   vectors. (see <code>sokalmichener</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'sokalsneath')</code></li>
</ol>
<p>Computes the Sokal-Sneath distance between the vectors. (see
   <code>sokalsneath</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, 'wminkowski', p=2., w=w)</code></li>
</ol>
<p>Computes the weighted Minkowski distance between the
   vectors. (see <code>wminkowski</code> function documentation)</p>
<ol>
<li><code>Y = cdist(XA, XB, f)</code></li>
</ol>
<p>Computes the distance between all pairs of vectors in X
   using the user supplied 2-arity function f. For example,
   Euclidean distance between the vectors could be computed
   as follows::</p>
<div class="codehilite"><pre><span></span><code> dm = cdist(XA, XB, lambda u, v: np.sqrt(((u-v)**2).sum()))
</code></pre></div>


<p>Note that you should avoid passing a reference to one of
   the distance functions defined in this library. For example,::</p>
<div class="codehilite"><pre><span></span><code> dm = cdist(XA, XB, sokalsneath)
</code></pre></div>


<p>would calculate the pair-wise distances between the vectors in
   X using the Python function <code>sokalsneath</code>. This would result in
   sokalsneath being called :math:<code>{n \choose 2}</code> times, which
   is inefficient. Instead, the optimized C version is more
   efficient, and we call it using the following syntax::</p>
<div class="codehilite"><pre><span></span><code> dm = cdist(XA, XB, &#39;sokalsneath&#39;)
</code></pre></div>


<h4>Examples</h4>
<p>Find the Euclidean distances between four 2-D coordinates:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">distance</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">35.0456</span><span class="p">,</span> <span class="o">-</span><span class="mf">85.2672</span><span class="p">),</span>
<span class="o">...</span>           <span class="p">(</span><span class="mf">35.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.9711</span><span class="p">),</span>
<span class="o">...</span>           <span class="p">(</span><span class="mf">35.9728</span><span class="p">,</span> <span class="o">-</span><span class="mf">83.9422</span><span class="p">),</span>
<span class="o">...</span>           <span class="p">(</span><span class="mf">36.1667</span><span class="p">,</span> <span class="o">-</span><span class="mf">86.7833</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">4.7044</span><span class="p">,</span>  <span class="mf">1.6172</span><span class="p">,</span>  <span class="mf">1.8856</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">4.7044</span><span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">6.0893</span><span class="p">,</span>  <span class="mf">3.3561</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.6172</span><span class="p">,</span>  <span class="mf">6.0893</span><span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">2.8477</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.8856</span><span class="p">,</span>  <span class="mf">3.3561</span><span class="p">,</span>  <span class="mf">2.8477</span><span class="p">,</span>  <span class="mf">0.</span>    <span class="p">]])</span>
</code></pre></div>

<p>Find the Manhattan distance from a 3-D point to the corners of the unit
cube:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>               <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;cityblock&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.9</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.1</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.3</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="kmeans">kmeans<a class="headerlink" href="#kmeans" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">kmeans</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">thresh</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">obs</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">k_or_guess</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span><span class="o">)</span>
</code></pre></div>

<p>Performs k-means on a set of observation vectors forming k clusters.</p>
<p>The k-means algorithm adjusts the classification of the observations
into clusters and updates the cluster centroids until the position of
the centroids is stable over successive iterations. In this
implementation of the algorithm, the stability of the centroids is
determined by comparing the absolute value of the change in the average
Euclidean distance between the observations and their corresponding
centroids against a threshold. This yields
a code book mapping centroids to codes and vice versa.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>obs : ndarray</summary></details>
<p>Each row of the M by N array is an observation vector. The
   columns are the features seen during each observation.
   The features must be whitened first with the <code>whiten</code> function.</p>
<details class="info" open="open"><summary>k_or_guess : int or ndarray</summary></details>
<p>The number of centroids to generate. A code is assigned to
   each centroid, which is also the row index of the centroid
   in the code_book matrix generated.</p>
<p>The initial k centroids are chosen by randomly selecting
   observations from the observation matrix. Alternatively,
   passing a k by N array specifies the initial k centroids.</p>
<details class="info" open="open"><summary>iter : int, optional</summary></details>
<p>The number of times to run k-means, returning the codebook
   with the lowest distortion. This argument is ignored if
   initial centroids are specified with an array for the
   <code>k_or_guess</code> parameter. This parameter does not represent the
   number of iterations of the k-means algorithm.</p>
<details class="info" open="open"><summary>thresh : float, optional</summary></details>
<p>Terminates the k-means algorithm if the change in
   distortion since the last k-means iteration is less than
   or equal to threshold.</p>
<details class="info" open="open"><summary>check_finite : bool, optional</summary><p>Whether to check that the input matrices contain only finite numbers.
Disabling may give a performance gain, but may result in problems
(crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</details>
<details class="info" open="open"><summary>Default: True</summary></details>
<h4>Returns</h4>
<details class="info" open="open"><summary>codebook : ndarray</summary></details>
<p>A k by N array of k centroids. The ith centroid
   codebook[i] is represented with the code i. The centroids
   and codes generated represent the lowest distortion seen,
   not necessarily the globally minimal distortion.</p>
<details class="info" open="open"><summary>distortion : float</summary></details>
<p>The mean (non-squared) Euclidean distance between the observations
   passed and the centroids generated. Note the difference to the standard
   definition of distortion in the context of the k-means algorithm, which
   is the sum of the squared distances.</p>
<h4>See Also</h4>
<details class="info" open="open"><summary>kmeans2 : a different implementation of k-means clustering</summary></details>
<p>with more methods for generating initial centroids but without
   using a distortion change threshold as a stopping criterion.</p>
<details class="info" open="open"><summary>whiten : must be called prior to passing an observation matrix</summary></details>
<p>to kmeans.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">vq</span><span class="p">,</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">whiten</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">features</span>  <span class="o">=</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">1.9</span><span class="p">,</span><span class="mf">2.3</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">0.8</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">0.4</span><span class="p">,</span><span class="mf">1.8</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">0.2</span><span class="p">,</span><span class="mf">1.8</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">2.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">0.3</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">whitened</span> <span class="o">=</span> <span class="n">whiten</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">book</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">whitened</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">whitened</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">whitened</span><span class="p">,</span><span class="n">book</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.3110306</span> <span class="p">,</span>  <span class="mf">2.86287398</span><span class="p">],</span>    <span class="c1"># random</span>
       <span class="p">[</span> <span class="mf">0.93218041</span><span class="p">,</span>  <span class="mf">1.24398691</span><span class="p">]]),</span> <span class="mf">0.85684700941625547</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">random</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">codes</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">whitened</span><span class="p">,</span><span class="n">codes</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.3110306</span> <span class="p">,</span>  <span class="mf">2.86287398</span><span class="p">],</span>    <span class="c1"># random</span>
       <span class="p">[</span> <span class="mf">1.32544402</span><span class="p">,</span>  <span class="mf">0.65607529</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.40782893</span><span class="p">,</span>  <span class="mf">2.02786907</span><span class="p">]]),</span> <span class="mf">0.5196582527686241</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create 50 datapoints in two clusters a and b</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pts</span> <span class="o">=</span> <span class="mi">50</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="n">pts</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="o">...</span>                                   <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
<span class="o">...</span>                                   <span class="n">size</span><span class="o">=</span><span class="n">pts</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Whiten data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">whitened</span> <span class="o">=</span> <span class="n">whiten</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Find 2 clusters in the data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">codebook</span><span class="p">,</span> <span class="n">distortion</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">whitened</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Plot whitened data and cluster centers in red</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">whitened</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">whitened</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">codebook</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">codebook</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="kmeans2">kmeans2<a class="headerlink" href="#kmeans2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">kmeans2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">thresh</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">minit</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">missing</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">data</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">k</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Classify a set of observations into k clusters using the k-means algorithm.</p>
<p>The algorithm attempts to minimize the Euclidean distance between
observations and centroids. Several initialization methods are
included.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>data : ndarray</summary><p>A 'M' by 'N' array of 'M' observations in 'N' dimensions or a length
'M' array of 'M' 1-D observations.</p>
</details>
<details class="info" open="open"><summary>k : int or ndarray</summary><p>The number of clusters to form as well as the number of
centroids to generate. If <code>minit</code> initialization string is
'matrix', or if a ndarray is given instead, it is
interpreted as initial cluster to use instead.</p>
</details>
<details class="info" open="open"><summary>iter : int, optional</summary><p>Number of iterations of the k-means algorithm to run. Note
that this differs in meaning from the iters parameter to
the kmeans function.</p>
</details>
<details class="info" open="open"><summary>thresh : float, optional</summary><p>(not used yet)</p>
</details>
<details class="info" open="open"><summary>minit : str, optional</summary><p>Method for initialization. Available methods are 'random',
'points', '++' and 'matrix':</p>
<p>'random': generate k centroids from a Gaussian with mean and
variance estimated from the data.</p>
<p>'points': choose k observations (rows) at random from data for
the initial centroids.</p>
<p>'++': choose k observations accordingly to the kmeans++ method
(careful seeding)</p>
<p>'matrix': interpret the k parameter as a k by M (or length k
array for 1-D data) array of initial centroids.</p>
</details>
<details class="info" open="open"><summary>missing : str, optional</summary><p>Method to deal with empty clusters. Available methods are
'warn' and 'raise':</p>
<p>'warn': give a warning and continue.</p>
<p>'raise': raise an ClusterError and terminate the algorithm.</p>
</details>
<details class="info" open="open"><summary>check_finite : bool, optional</summary><p>Whether to check that the input matrices contain only finite numbers.
Disabling may give a performance gain, but may result in problems
(crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</details>
<details class="info" open="open"><summary>Default: True</summary></details>
<h4>Returns</h4>
<details class="info" open="open"><summary>centroid : ndarray</summary><p>A 'k' by 'N' array of centroids found at the last iteration of
k-means.</p>
</details>
<details class="info" open="open"><summary>label : ndarray</summary><p>label[i] is the code or index of the centroid the
ith observation is closest to.</p>
</details>
<h4>See Also</h4>
<p>kmeans</p>
<h4>References</h4>
<p>.. [1] D. Arthur and S. Vassilvitskii, 'k-means++: the advantages of
   careful seeding', Proceedings of the Eighteenth Annual ACM-SIAM Symposium
   on Discrete Algorithms, 2007.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">kmeans2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>

<p>Create z, an array with shape (100, 2) containing a mixture of samples
from three multivariate normal distributions.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345678</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</code></pre></div>

<p>Compute three clusters.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">centroid</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">minit</span><span class="o">=</span><span class="s1">&#39;points&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">centroid</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.35770296</span><span class="p">,</span>  <span class="mf">5.31342524</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.32210289</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50551972</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.17653859</span><span class="p">,</span>  <span class="mf">4.16719247</span><span class="p">]])</span>
</code></pre></div>

<p>How many points are in each cluster?</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">counts</span>
<span class="n">array</span><span class="p">([</span><span class="mi">52</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">21</span><span class="p">])</span>
</code></pre></div>

<p>Plot the clusters.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">w0</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">w0</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cluster 0&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">w1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cluster 1&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">w2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cluster 2&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centroid</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centroid</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k*&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;centroids&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="py_vq">py_vq<a class="headerlink" href="#py_vq" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">py_vq</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">obs</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">code_book</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Python version of vq algorithm.</p>
<p>The algorithm computes the Euclidean distance between each
observation and every frame in the code_book.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>obs : ndarray</summary><p>Expects a rank 2 array. Each row is one observation.</p>
</details>
<details class="info" open="open"><summary>code_book : ndarray</summary><p>Code book to use. Same format than obs. Should have same number of
features (e.g., columns) than obs.</p>
</details>
<details class="info" open="open"><summary>check_finite : bool, optional</summary><p>Whether to check that the input matrices contain only finite numbers.
Disabling may give a performance gain, but may result in problems
(crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</details>
<details class="info" open="open"><summary>Default: True</summary></details>
<h4>Returns</h4>
<details class="info" open="open"><summary>code : ndarray</summary><p>code[i] gives the label of the ith obversation; its code is
code_book[code[i]].</p>
</details>
<details class="info" open="open"><summary>mind_dist : ndarray</summary><p>min_dist[i] gives the distance between the ith observation and its
corresponding code.</p>
</details>
<h4>Notes</h4>
<p>This function is slower than the C version but works for
all input types. If the inputs have the wrong types for the
C versions of the function, this one is called as a last resort.</p>
<p>It is about 20 times slower than the C version.</p>
</details>
<h3 id="py_vq2">py_vq2<a class="headerlink" href="#py_vq2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">py_vq2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kwds</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p><code>py_vq2</code> is deprecated, use <code>py_vq</code> instead!</p>
<p>Python version of vq algorithm.</p>
<p>The algorithm computes the Euclidean distance between each
observation and every frame in the code_book.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>obs : ndarray</summary><p>Expects a rank 2 array. Each row is one observation.</p>
</details>
<details class="info" open="open"><summary>code_book : ndarray</summary><p>Code book to use. Same format than obs. Should have same number of
features (e.g., columns) than obs.</p>
</details>
<details class="info" open="open"><summary>check_finite : bool, optional</summary><p>Whether to check that the input matrices contain only finite numbers.
Disabling may give a performance gain, but may result in problems
(crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</details>
<details class="info" open="open"><summary>Default: True</summary></details>
<h4>Returns</h4>
<details class="info" open="open"><summary>code : ndarray</summary><p>code[i] gives the label of the ith obversation; its code is
code_book[code[i]].</p>
</details>
<details class="info" open="open"><summary>mind_dist : ndarray</summary><p>min_dist[i] gives the distance between the ith observation and its
corresponding code.</p>
</details>
<h4>Notes</h4>
<p>This function is slower than the C version but works for
all input types. If the inputs have the wrong types for the
C versions of the function, this one is called as a last resort.</p>
<p>It is about 20 times slower than the C version.</p>
</details>
<h3 id="vq_1">vq<a class="headerlink" href="#vq_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">vq</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">obs</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">code_book</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Assign codes from a code book to observations.</p>
<p>Assigns a code from a code book to each observation. Each
observation vector in the 'M' by 'N' <code>obs</code> array is compared with the
centroids in the code book and assigned the code of the closest
centroid.</p>
<p>The features in <code>obs</code> should have unit variance, which can be
achieved by passing them through the whiten function. The code
book can be created with the k-means algorithm or a different
encoding algorithm.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>obs : ndarray</summary><p>Each row of the 'M' x 'N' array is an observation. The columns are
the 'features' seen during each observation. The features must be
whitened first using the whiten function or something equivalent.</p>
</details>
<details class="info" open="open"><summary>code_book : ndarray</summary><p>The code book is usually generated using the k-means algorithm.
Each row of the array holds a different code, and the columns are
the features of the code.</p>
<blockquote>
<blockquote>
<blockquote>
<h1>f0    f1    f2   f3</h1>
<p>code_book = [
 ...             [  1.,   2.,   3.,   4.],  #c0
 ...             [  1.,   2.,   3.,   4.],  #c1
 ...             [  1.,   2.,   3.,   4.]]  #c2</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="info" open="open"><summary>check_finite : bool, optional</summary><p>Whether to check that the input matrices contain only finite numbers.
Disabling may give a performance gain, but may result in problems
(crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</details>
<details class="info" open="open"><summary>Default: True</summary></details>
<h4>Returns</h4>
<details class="info" open="open"><summary>code : ndarray</summary><p>A length M array holding the code book index for each observation.</p>
</details>
<details class="info" open="open"><summary>dist : ndarray</summary><p>The distortion (distance) between the observation and its nearest
code.</p>
</details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">vq</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">code_book</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">features</span>  <span class="o">=</span> <span class="n">array</span><span class="p">([[</span>  <span class="mf">1.9</span><span class="p">,</span><span class="mf">2.3</span><span class="p">,</span><span class="mf">1.7</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span>  <span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.2</span><span class="p">],</span>
<span class="o">...</span>                    <span class="p">[</span>  <span class="mf">0.8</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">1.7</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vq</span><span class="p">(</span><span class="n">features</span><span class="p">,</span><span class="n">code_book</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.43588989</span><span class="p">,</span>  <span class="mf">0.73484692</span><span class="p">,</span>  <span class="mf">0.83066239</span><span class="p">]))</span>
</code></pre></div>

</details>
<h3 id="whiten">whiten<a class="headerlink" href="#whiten" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">whiten</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">obs</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Normalize a group of observations on a per feature basis.</p>
<p>Before running k-means, it is beneficial to rescale each feature
dimension of the observation set with whitening. Each feature is
divided by its standard deviation across all observations to give
it unit variance.</p>
<h4>Parameters</h4>
<details class="info" open="open"><summary>obs : ndarray</summary><p>Each row of the array is an observation.  The
columns are the features seen during each observation.</p>
<blockquote>
<blockquote>
<blockquote>
<h1>f0    f1    f2</h1>
<p>obs = [[  1.,   1.,   1.],  #o0
...        [  2.,   2.,   2.],  #o1
...        [  3.,   3.,   3.],  #o2
...        [  4.,   4.,   4.]]  #o3</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="info" open="open"><summary>check_finite : bool, optional</summary><p>Whether to check that the input matrices contain only finite numbers.
Disabling may give a performance gain, but may result in problems
(crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</details>
<details class="info" open="open"><summary>Default: True</summary></details>
<h4>Returns</h4>
<details class="info" open="open"><summary>result : ndarray</summary><p>Contains the values in <code>obs</code> scaled by the standard deviation
of each column.</p>
</details>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">whiten</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">features</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">],</span>
<span class="o">...</span>                       <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">],</span>
<span class="o">...</span>                       <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">whiten</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">4.17944278</span><span class="p">,</span>  <span class="mf">2.69811351</span><span class="p">,</span>  <span class="mf">7.21248917</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.29956009</span><span class="p">,</span>  <span class="mf">2.93273208</span><span class="p">,</span>  <span class="mf">9.33380951</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.75976538</span><span class="p">,</span>  <span class="mf">0.7038557</span> <span class="p">,</span>  <span class="mf">7.21248917</span><span class="p">]])</span>
</code></pre></div>

</details>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                SciPy library for OCaml
              </div>
            </div>
          </a>
        
        
          <a href="../Conftest/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Conftest
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['instant', 'tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>