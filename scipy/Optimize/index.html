
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>Optimize - OCaml scikit-learn interface</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bfgs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="OCaml scikit-learn interface" class="md-header-nav__button md-logo" aria-label="OCaml scikit-learn interface">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OCaml scikit-learn interface
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Optimize
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/lehy/ocaml-sklearn/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lehy/ocaml-sklearn
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OCaml scikit-learn interface" class="md-nav__button md-logo" aria-label="OCaml scikit-learn interface">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OCaml scikit-learn interface
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/lehy/ocaml-sklearn/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lehy/ocaml-sklearn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      Np
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Np" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Np
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/" class="md-nav__link">
      Numpy for OCaml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/Numpy/" class="md-nav__link">
      Numpy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/NumpyRaw/" class="md-nav__link">
      NumpyRaw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/PyList/" class="md-nav__link">
      PyList
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/dtype/" class="md-nav__link">
      Dtype
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../np/obj/" class="md-nav__link">
      Obj
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    <label class="md-nav__link" for="nav-3">
      Scipy
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Scipy" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Scipy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" class="md-nav__link">
      SciPy library for OCaml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Cluster/" class="md-nav__link">
      Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Conftest/" class="md-nav__link">
      Conftest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Constants/" class="md-nav__link">
      Constants
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fft/" class="md-nav__link">
      Fft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fftpack/" class="md-nav__link">
      Fftpack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Integrate/" class="md-nav__link">
      Integrate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Interpolate/" class="md-nav__link">
      Interpolate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Io/" class="md-nav__link">
      Io
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Linalg/" class="md-nav__link">
      Linalg
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Misc/" class="md-nav__link">
      Misc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Ndimage/" class="md-nav__link">
      Ndimage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Odr/" class="md-nav__link">
      Odr
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Optimize
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Optimize
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bfgs" class="md-nav__link">
    BFGS
  </a>
  
    <nav class="md-nav" aria-label="BFGS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_matrix" class="md-nav__link">
    get_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize" class="md-nav__link">
    initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bounds" class="md-nav__link">
    Bounds
  </a>
  
    <nav class="md-nav" aria-label="Bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_1" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_1" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_1" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_1" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hessianupdatestrategy" class="md-nav__link">
    HessianUpdateStrategy
  </a>
  
    <nav class="md-nav" aria-label="HessianUpdateStrategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_2" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_1" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_matrix_1" class="md-nav__link">
    get_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize_1" class="md-nav__link">
    initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_1" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_2" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_2" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_2" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lbfgsinvhessproduct" class="md-nav__link">
    LbfgsInvHessProduct
  </a>
  
    <nav class="md-nav" aria-label="LbfgsInvHessProduct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_3" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjoint" class="md-nav__link">
    adjoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_2" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matmat" class="md-nav__link">
    matmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatmat" class="md-nav__link">
    rmatmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose" class="md-nav__link">
    transpose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_3" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_3" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_3" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linearconstraint" class="md-nav__link">
    LinearConstraint
  </a>
  
    <nav class="md-nav" aria-label="LinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_4" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_4" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_4" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_4" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlinearconstraint" class="md-nav__link">
    NonlinearConstraint
  </a>
  
    <nav class="md-nav" aria-label="NonlinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_5" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_5" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_5" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_5" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimizeresult" class="md-nav__link">
    OptimizeResult
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#x" class="md-nav__link">
    x
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#success" class="md-nav__link">
    success
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message" class="md-nav__link">
    message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hess_inv" class="md-nav__link">
    hess_inv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nit" class="md-nav__link">
    nit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxcv" class="md-nav__link">
    maxcv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_6" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_6" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_6" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimizewarning" class="md-nav__link">
    OptimizeWarning
  </a>
  
    <nav class="md-nav" aria-label="OptimizeWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_7" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_7" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_7" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rootresults" class="md-nav__link">
    RootResults
  </a>
  
    <nav class="md-nav" aria-label="RootResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_6" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root" class="md-nav__link">
    root
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterations" class="md-nav__link">
    iterations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function_calls" class="md-nav__link">
    function_calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converged" class="md-nav__link">
    converged
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    flag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_8" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_8" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_8" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sr1" class="md-nav__link">
    SR1
  </a>
  
    <nav class="md-nav" aria-label="SR1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_7" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_3" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_matrix_2" class="md-nav__link">
    get_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize_2" class="md-nav__link">
    initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_2" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_9" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_9" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_9" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobyla" class="md-nav__link">
    Cobyla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#izip" class="md-nav__link">
    Izip
  </a>
  
    <nav class="md-nav" aria-label="Izip">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_8" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iter" class="md-nav__link">
    iter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_10" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_10" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_10" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rlock" class="md-nav__link">
    rLock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cobyla" class="md-nav__link">
    fmin_cobyla
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronized" class="md-nav__link">
    synchronized
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lbfgsb" class="md-nav__link">
    Lbfgsb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linearoperator" class="md-nav__link">
    LinearOperator
  </a>
  
    <nav class="md-nav" aria-label="LinearOperator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_9" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjoint_1" class="md-nav__link">
    adjoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_4" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matmat_1" class="md-nav__link">
    matmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_1" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatmat_1" class="md-nav__link">
    rmatmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_1" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose_1" class="md-nav__link">
    transpose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndim" class="md-nav__link">
    ndim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_11" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_11" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_11" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memoizejac" class="md-nav__link">
    MemoizeJac
  </a>
  
    <nav class="md-nav" aria-label="MemoizeJac">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_10" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivative" class="md-nav__link">
    derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_12" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_12" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_12" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#float64" class="md-nav__link">
    Float64
  </a>
  
    <nav class="md-nav" aria-label="Float64">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_11" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getitem" class="md-nav__link">
    getitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fromhex" class="md-nav__link">
    fromhex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hex" class="md-nav__link">
    hex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_integer" class="md-nav__link">
    is_integer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newbyteorder" class="md-nav__link">
    newbyteorder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_13" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_13" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_13" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array" class="md-nav__link">
    array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_l_bfgs_b" class="md-nav__link">
    fmin_l_bfgs_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old_bound_to_new" class="md-nav__link">
    old_bound_to_new
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linesearch" class="md-nav__link">
    Linesearch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linesearchwarning" class="md-nav__link">
    LineSearchWarning
  </a>
  
    <nav class="md-nav" aria-label="LineSearchWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_1" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_14" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_14" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_14" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search" class="md-nav__link">
    line_search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_bfgs" class="md-nav__link">
    line_search_BFGS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_armijo" class="md-nav__link">
    line_search_armijo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe1" class="md-nav__link">
    line_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe2" class="md-nav__link">
    line_search_wolfe2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_armijo" class="md-nav__link">
    scalar_search_armijo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_wolfe1" class="md-nav__link">
    scalar_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_wolfe2" class="md-nav__link">
    scalar_search_wolfe2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warn" class="md-nav__link">
    warn
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minpack" class="md-nav__link">
    Minpack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error" class="md-nav__link">
    Error
  </a>
  
    <nav class="md-nav" aria-label="Error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_2" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_15" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_15" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_15" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finfo" class="md-nav__link">
    Finfo
  </a>
  
    <nav class="md-nav" aria-label="Finfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_12" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bits" class="md-nav__link">
    bits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eps" class="md-nav__link">
    eps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#epsneg" class="md-nav__link">
    epsneg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iexp" class="md-nav__link">
    iexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machar" class="md-nav__link">
    machar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machep" class="md-nav__link">
    machep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max" class="md-nav__link">
    max
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxexp" class="md-nav__link">
    maxexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min" class="md-nav__link">
    min
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minexp" class="md-nav__link">
    minexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negep" class="md-nav__link">
    negep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nexp" class="md-nav__link">
    nexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmant" class="md-nav__link">
    nmant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision" class="md-nav__link">
    precision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution" class="md-nav__link">
    resolution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tiny" class="md-nav__link">
    tiny
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_16" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_16" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_16" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray_1" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atleast_1d" class="md-nav__link">
    atleast_1d
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_gradient" class="md-nav__link">
    check_gradient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cholesky" class="md-nav__link">
    cholesky
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curve_fit" class="md-nav__link">
    curve_fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_5" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eye" class="md-nav__link">
    eye
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed_point" class="md-nav__link">
    fixed_point
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsolve" class="md-nav__link">
    fsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#greater" class="md-nav__link">
    greater
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inv" class="md-nav__link">
    inv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issubdtype" class="md-nav__link">
    issubdtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#least_squares" class="md-nav__link">
    least_squares
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leastsq" class="md-nav__link">
    leastsq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare_bounds" class="md-nav__link">
    prepare_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prod" class="md-nav__link">
    prod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_triangular" class="md-nav__link">
    solve_triangular
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd" class="md-nav__link">
    svd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take" class="md-nav__link">
    take
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose_2" class="md-nav__link">
    transpose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#triu" class="md-nav__link">
    triu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_1" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minpack2" class="md-nav__link">
    Minpack2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#moduletnc" class="md-nav__link">
    ModuleTNC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlin" class="md-nav__link">
    Nonlin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anderson" class="md-nav__link">
    Anderson
  </a>
  
    <nav class="md-nav" aria-label="Anderson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_13" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_2" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_3" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_17" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_17" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_17" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broydenfirst" class="md-nav__link">
    BroydenFirst
  </a>
  
    <nav class="md-nav" aria-label="BroydenFirst">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_14" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_1" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_3" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_2" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_1" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_1" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_1" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_4" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_18" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_18" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_18" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broydensecond" class="md-nav__link">
    BroydenSecond
  </a>
  
    <nav class="md-nav" aria-label="BroydenSecond">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_15" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_2" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_4" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_3" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_1" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_2" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_2" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_2" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_5" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_19" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_19" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_19" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagbroyden" class="md-nav__link">
    DiagBroyden
  </a>
  
    <nav class="md-nav" aria-label="DiagBroyden">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_16" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_3" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_5" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_4" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_2" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_3" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_3" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_3" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_6" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_20" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_20" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_20" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excitingmixing" class="md-nav__link">
    ExcitingMixing
  </a>
  
    <nav class="md-nav" aria-label="ExcitingMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_17" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_4" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_6" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_5" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_3" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_4" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_4" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_4" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_7" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_21" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_21" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_21" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genericbroyden" class="md-nav__link">
    GenericBroyden
  </a>
  
    <nav class="md-nav" aria-label="GenericBroyden">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_18" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_5" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_5" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_5" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_8" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_22" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_22" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_22" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inversejacobian" class="md-nav__link">
    InverseJacobian
  </a>
  
    <nav class="md-nav" aria-label="InverseJacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_19" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_23" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_23" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_23" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jacobian" class="md-nav__link">
    Jacobian
  </a>
  
    <nav class="md-nav" aria-label="Jacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_20" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_6" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_6" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_6" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_9" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape_1" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func" class="md-nav__link">
    func
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_24" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_24" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_24" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#krylovjacobian" class="md-nav__link">
    KrylovJacobian
  </a>
  
    <nav class="md-nav" aria-label="KrylovJacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_21" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_7" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_7" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_7" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_7" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_10" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_25" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_25" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_25" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linearmixing" class="md-nav__link">
    LinearMixing
  </a>
  
    <nav class="md-nav" aria-label="LinearMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_22" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_8" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_8" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_6" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_4" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_8" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_8" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_5" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_11" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_26" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_26" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_26" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lowrankmatrix" class="md-nav__link">
    LowRankMatrix
  </a>
  
    <nav class="md-nav" aria-label="LowRankMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_23" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append" class="md-nav__link">
    append
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collapse" class="md-nav__link">
    collapse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_9" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart_reduce" class="md-nav__link">
    restart_reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_7" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_5" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple_reduce" class="md-nav__link">
    simple_reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_9" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd_reduce" class="md-nav__link">
    svd_reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_27" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_27" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_27" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#noconvergence" class="md-nav__link">
    NoConvergence
  </a>
  
    <nav class="md-nav" aria-label="NoConvergence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_3" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_28" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_28" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_28" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminationcondition" class="md-nav__link">
    TerminationCondition
  </a>
  
    <nav class="md-nav" aria-label="TerminationCondition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_24" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_29" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_29" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_29" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anderson_1" class="md-nav__link">
    anderson
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray_2" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asjacobian" class="md-nav__link">
    asjacobian
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden1" class="md-nav__link">
    broyden1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden2" class="md-nav__link">
    broyden2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagbroyden_1" class="md-nav__link">
    diagbroyden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_6" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excitingmixing_1" class="md-nav__link">
    excitingmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_blas_funcs" class="md-nav__link">
    get_blas_funcs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inv_1" class="md-nav__link">
    inv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmixing_1" class="md-nav__link">
    linearmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxnorm" class="md-nav__link">
    maxnorm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_krylov" class="md-nav__link">
    newton_krylov
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlin_solve" class="md-nav__link">
    nonlin_solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norm" class="md-nav__link">
    norm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qr" class="md-nav__link">
    qr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_armijo_1" class="md-nav__link">
    scalar_search_armijo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_wolfe1_1" class="md-nav__link">
    scalar_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_10" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd_1" class="md-nav__link">
    svd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vdot" class="md-nav__link">
    vdot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimize" class="md-nav__link">
    Optimize
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brent" class="md-nav__link">
    Brent
  </a>
  
    <nav class="md-nav" aria-label="Brent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_25" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_bracket_info" class="md-nav__link">
    get_bracket_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_result" class="md-nav__link">
    get_result
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimize_1" class="md-nav__link">
    optimize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_bracket" class="md-nav__link">
    set_bracket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_30" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_30" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_30" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linesearchwarning_1" class="md-nav__link">
    LineSearchWarning
  </a>
  
    <nav class="md-nav" aria-label="LineSearchWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_4" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_31" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_31" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_31" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapwrapper" class="md-nav__link">
    MapWrapper
  </a>
  
    <nav class="md-nav" aria-label="MapWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_26" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#close" class="md-nav__link">
    close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminate" class="md-nav__link">
    terminate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_32" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_32" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_32" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scalarfunction" class="md-nav__link">
    ScalarFunction
  </a>
  
    <nav class="md-nav" aria-label="ScalarFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_27" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fun_" class="md-nav__link">
    fun_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fun_and_grad" class="md-nav__link">
    fun_and_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grad" class="md-nav__link">
    grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hess" class="md-nav__link">
    hess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_33" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_33" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_33" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_derivative" class="md-nav__link">
    approx_derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_fhess_p" class="md-nav__link">
    approx_fhess_p
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_fprime" class="md-nav__link">
    approx_fprime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#argmin" class="md-nav__link">
    argmin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray_3" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asfarray" class="md-nav__link">
    asfarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atleast_1d_1" class="md-nav__link">
    atleast_1d
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bracket" class="md-nav__link">
    bracket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brent_1" class="md-nav__link">
    brent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brute" class="md-nav__link">
    brute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_grad" class="md-nav__link">
    check_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eye_1" class="md-nav__link">
    eye
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin" class="md-nav__link">
    fmin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_bfgs" class="md-nav__link">
    fmin_bfgs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cg" class="md-nav__link">
    fmin_cg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_ncg" class="md-nav__link">
    fmin_ncg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_powell" class="md-nav__link">
    fmin_powell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fminbound" class="md-nav__link">
    fminbound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golden" class="md-nav__link">
    golden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_array_scalar" class="md-nav__link">
    is_array_scalar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isinf" class="md-nav__link">
    isinf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_1" class="md-nav__link">
    line_search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe1_1" class="md-nav__link">
    line_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe2_1" class="md-nav__link">
    line_search_wolfe2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#main" class="md-nav__link">
    main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen" class="md-nav__link">
    rosen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_der" class="md-nav__link">
    rosen_der
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess" class="md-nav__link">
    rosen_hess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess_prod" class="md-nav__link">
    rosen_hess_prod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape_2" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_options" class="md-nav__link">
    show_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqrt" class="md-nav__link">
    sqrt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#squeeze" class="md-nav__link">
    squeeze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vecnorm" class="md-nav__link">
    vecnorm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wrap_function" class="md-nav__link">
    wrap_function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_2" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slsqp" class="md-nav__link">
    Slsqp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finfo_1" class="md-nav__link">
    Finfo
  </a>
  
    <nav class="md-nav" aria-label="Finfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_28" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bits_1" class="md-nav__link">
    bits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eps_1" class="md-nav__link">
    eps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#epsneg_1" class="md-nav__link">
    epsneg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iexp_1" class="md-nav__link">
    iexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machar_1" class="md-nav__link">
    machar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machep_1" class="md-nav__link">
    machep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_1" class="md-nav__link">
    max
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxexp_1" class="md-nav__link">
    maxexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_1" class="md-nav__link">
    min
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minexp_1" class="md-nav__link">
    minexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negep_1" class="md-nav__link">
    negep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nexp_1" class="md-nav__link">
    nexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmant_1" class="md-nav__link">
    nmant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision_1" class="md-nav__link">
    precision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution_1" class="md-nav__link">
    resolution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tiny_1" class="md-nav__link">
    tiny
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_34" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_34" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_34" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append_1" class="md-nav__link">
    append
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_derivative_1" class="md-nav__link">
    approx_derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_jacobian" class="md-nav__link">
    approx_jacobian
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_1" class="md-nav__link">
    array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asfarray_1" class="md-nav__link">
    asfarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atleast_1d_2" class="md-nav__link">
    atleast_1d
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate" class="md-nav__link">
    concatenate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exp" class="md-nav__link">
    exp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_slsqp" class="md-nav__link">
    fmin_slsqp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isfinite" class="md-nav__link">
    isfinite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old_bound_to_new_1" class="md-nav__link">
    old_bound_to_new
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqrt_1" class="md-nav__link">
    sqrt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vstack" class="md-nav__link">
    vstack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_3" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tnc" class="md-nav__link">
    Tnc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memoizejac_1" class="md-nav__link">
    MemoizeJac
  </a>
  
    <nav class="md-nav" aria-label="MemoizeJac">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_29" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivative_1" class="md-nav__link">
    derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_35" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_35" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_35" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_2" class="md-nav__link">
    array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asfarray_2" class="md-nav__link">
    asfarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_tnc" class="md-nav__link">
    fmin_tnc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old_bound_to_new_2" class="md-nav__link">
    old_bound_to_new
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_4" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeros_5" class="md-nav__link">
    Zeros
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toms748solver" class="md-nav__link">
    TOMS748Solver
  </a>
  
    <nav class="md-nav" aria-label="TOMS748Solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_30" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure" class="md-nav__link">
    configure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_result_1" class="md-nav__link">
    get_result
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_status" class="md-nav__link">
    get_status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterate" class="md-nav__link">
    iterate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_11" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_36" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_36" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_36" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bisect" class="md-nav__link">
    bisect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brenth" class="md-nav__link">
    brenth
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brentq" class="md-nav__link">
    brentq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namedtuple" class="md-nav__link">
    namedtuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton" class="md-nav__link">
    newton
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results_c" class="md-nav__link">
    results_c
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ridder" class="md-nav__link">
    ridder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toms748" class="md-nav__link">
    toms748
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anderson_2" class="md-nav__link">
    anderson
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_fprime_1" class="md-nav__link">
    approx_fprime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basinhopping" class="md-nav__link">
    basinhopping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bisect_1" class="md-nav__link">
    bisect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bracket_1" class="md-nav__link">
    bracket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brent_2" class="md-nav__link">
    brent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brenth_1" class="md-nav__link">
    brenth
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brentq_1" class="md-nav__link">
    brentq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden1_1" class="md-nav__link">
    broyden1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden2_1" class="md-nav__link">
    broyden2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brute_1" class="md-nav__link">
    brute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_grad_1" class="md-nav__link">
    check_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curve_fit_1" class="md-nav__link">
    curve_fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagbroyden_2" class="md-nav__link">
    diagbroyden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differential_evolution" class="md-nav__link">
    differential_evolution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dual_annealing" class="md-nav__link">
    dual_annealing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excitingmixing_2" class="md-nav__link">
    excitingmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed_point_1" class="md-nav__link">
    fixed_point
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_1" class="md-nav__link">
    fmin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_bfgs_1" class="md-nav__link">
    fmin_bfgs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cg_1" class="md-nav__link">
    fmin_cg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cobyla_1" class="md-nav__link">
    fmin_cobyla
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_l_bfgs_b_1" class="md-nav__link">
    fmin_l_bfgs_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_ncg_1" class="md-nav__link">
    fmin_ncg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_powell_1" class="md-nav__link">
    fmin_powell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_slsqp_1" class="md-nav__link">
    fmin_slsqp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_tnc_1" class="md-nav__link">
    fmin_tnc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fminbound_1" class="md-nav__link">
    fminbound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsolve_1" class="md-nav__link">
    fsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golden_1" class="md-nav__link">
    golden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#least_squares_1" class="md-nav__link">
    least_squares
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leastsq_1" class="md-nav__link">
    leastsq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_2" class="md-nav__link">
    line_search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linear_sum_assignment" class="md-nav__link">
    linear_sum_assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmixing_2" class="md-nav__link">
    linearmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linprog" class="md-nav__link">
    linprog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linprog_verbose_callback" class="md-nav__link">
    linprog_verbose_callback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsq_linear" class="md-nav__link">
    lsq_linear
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimize" class="md-nav__link">
    minimize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimize_scalar" class="md-nav__link">
    minimize_scalar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_1" class="md-nav__link">
    newton
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_krylov_1" class="md-nav__link">
    newton_krylov
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nnls" class="md-nav__link">
    nnls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ridder_1" class="md-nav__link">
    ridder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root_1" class="md-nav__link">
    root
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root_scalar" class="md-nav__link">
    root_scalar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_1" class="md-nav__link">
    rosen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_der_1" class="md-nav__link">
    rosen_der
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess_1" class="md-nav__link">
    rosen_hess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess_prod_1" class="md-nav__link">
    rosen_hess_prod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shgo" class="md-nav__link">
    shgo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_options_1" class="md-nav__link">
    show_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toms748_1" class="md-nav__link">
    toms748
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Setup/" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Signal/" class="md-nav__link">
      Signal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sparse/" class="md-nav__link">
      Sparse
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Spatial/" class="md-nav__link">
      Spatial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Special/" class="md-nav__link">
      Special
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Stats/" class="md-nav__link">
      Stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Version/" class="md-nav__link">
      Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wrap_version/" class="md-nav__link">
      Wrap version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Sklearn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sklearn" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Sklearn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Calibration/" class="md-nav__link">
      Calibration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Cluster/" class="md-nav__link">
      Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Compose/" class="md-nav__link">
      Compose
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Conftest/" class="md-nav__link">
      Conftest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Covariance/" class="md-nav__link">
      Covariance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Cross_decomposition/" class="md-nav__link">
      Cross decomposition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Datasets/" class="md-nav__link">
      Datasets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Decomposition/" class="md-nav__link">
      Decomposition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Discriminant_analysis/" class="md-nav__link">
      Discriminant analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Dummy/" class="md-nav__link">
      Dummy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Ensemble/" class="md-nav__link">
      Ensemble
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Exceptions/" class="md-nav__link">
      Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Experimental/" class="md-nav__link">
      Experimental
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Externals/" class="md-nav__link">
      Externals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Feature_extraction/" class="md-nav__link">
      Feature extraction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Feature_selection/" class="md-nav__link">
      Feature selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Gaussian_process/" class="md-nav__link">
      Gaussian process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Impute/" class="md-nav__link">
      Impute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Inspection/" class="md-nav__link">
      Inspection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Isotonic/" class="md-nav__link">
      Isotonic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Kernel_approximation/" class="md-nav__link">
      Kernel approximation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Kernel_ridge/" class="md-nav__link">
      Kernel ridge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Linear_model/" class="md-nav__link">
      Linear model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Manifold/" class="md-nav__link">
      Manifold
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Metrics/" class="md-nav__link">
      Metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Mixture/" class="md-nav__link">
      Mixture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Model_selection/" class="md-nav__link">
      Model selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Multiclass/" class="md-nav__link">
      Multiclass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Multioutput/" class="md-nav__link">
      Multioutput
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Naive_bayes/" class="md-nav__link">
      Naive bayes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Neighbors/" class="md-nav__link">
      Neighbors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Neural_network/" class="md-nav__link">
      Neural network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Pipeline/" class="md-nav__link">
      Pipeline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Preprocessing/" class="md-nav__link">
      Preprocessing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Random_projection/" class="md-nav__link">
      Random projection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Semi_supervised/" class="md-nav__link">
      Semi supervised
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Setup/" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Svm/" class="md-nav__link">
      Svm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Tests/" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Tree/" class="md-nav__link">
      Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/Utils/" class="md-nav__link">
      Utils
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/arr/" class="md-nav__link">
      Arr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/dict/" class="md-nav__link">
      Dict
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sklearn/wrap_version/" class="md-nav__link">
      Wrap version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bfgs" class="md-nav__link">
    BFGS
  </a>
  
    <nav class="md-nav" aria-label="BFGS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_matrix" class="md-nav__link">
    get_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize" class="md-nav__link">
    initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bounds" class="md-nav__link">
    Bounds
  </a>
  
    <nav class="md-nav" aria-label="Bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_1" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_1" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_1" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_1" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hessianupdatestrategy" class="md-nav__link">
    HessianUpdateStrategy
  </a>
  
    <nav class="md-nav" aria-label="HessianUpdateStrategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_2" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_1" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_matrix_1" class="md-nav__link">
    get_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize_1" class="md-nav__link">
    initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_1" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_2" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_2" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_2" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lbfgsinvhessproduct" class="md-nav__link">
    LbfgsInvHessProduct
  </a>
  
    <nav class="md-nav" aria-label="LbfgsInvHessProduct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_3" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjoint" class="md-nav__link">
    adjoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_2" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matmat" class="md-nav__link">
    matmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatmat" class="md-nav__link">
    rmatmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose" class="md-nav__link">
    transpose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_3" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_3" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_3" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linearconstraint" class="md-nav__link">
    LinearConstraint
  </a>
  
    <nav class="md-nav" aria-label="LinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_4" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_4" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_4" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_4" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlinearconstraint" class="md-nav__link">
    NonlinearConstraint
  </a>
  
    <nav class="md-nav" aria-label="NonlinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_5" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_5" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_5" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_5" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimizeresult" class="md-nav__link">
    OptimizeResult
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#x" class="md-nav__link">
    x
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#success" class="md-nav__link">
    success
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message" class="md-nav__link">
    message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hess_inv" class="md-nav__link">
    hess_inv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nit" class="md-nav__link">
    nit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxcv" class="md-nav__link">
    maxcv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_6" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_6" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_6" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimizewarning" class="md-nav__link">
    OptimizeWarning
  </a>
  
    <nav class="md-nav" aria-label="OptimizeWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_7" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_7" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_7" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rootresults" class="md-nav__link">
    RootResults
  </a>
  
    <nav class="md-nav" aria-label="RootResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_6" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root" class="md-nav__link">
    root
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterations" class="md-nav__link">
    iterations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function_calls" class="md-nav__link">
    function_calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converged" class="md-nav__link">
    converged
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    flag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_8" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_8" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_8" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sr1" class="md-nav__link">
    SR1
  </a>
  
    <nav class="md-nav" aria-label="SR1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_7" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_3" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_matrix_2" class="md-nav__link">
    get_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize_2" class="md-nav__link">
    initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_2" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_9" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_9" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_9" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobyla" class="md-nav__link">
    Cobyla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#izip" class="md-nav__link">
    Izip
  </a>
  
    <nav class="md-nav" aria-label="Izip">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_8" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iter" class="md-nav__link">
    iter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_10" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_10" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_10" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rlock" class="md-nav__link">
    rLock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cobyla" class="md-nav__link">
    fmin_cobyla
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronized" class="md-nav__link">
    synchronized
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lbfgsb" class="md-nav__link">
    Lbfgsb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linearoperator" class="md-nav__link">
    LinearOperator
  </a>
  
    <nav class="md-nav" aria-label="LinearOperator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_9" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjoint_1" class="md-nav__link">
    adjoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_4" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matmat_1" class="md-nav__link">
    matmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_1" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatmat_1" class="md-nav__link">
    rmatmat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_1" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose_1" class="md-nav__link">
    transpose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndim" class="md-nav__link">
    ndim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_11" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_11" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_11" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memoizejac" class="md-nav__link">
    MemoizeJac
  </a>
  
    <nav class="md-nav" aria-label="MemoizeJac">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_10" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivative" class="md-nav__link">
    derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_12" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_12" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_12" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#float64" class="md-nav__link">
    Float64
  </a>
  
    <nav class="md-nav" aria-label="Float64">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_11" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getitem" class="md-nav__link">
    getitem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fromhex" class="md-nav__link">
    fromhex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hex" class="md-nav__link">
    hex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_integer" class="md-nav__link">
    is_integer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newbyteorder" class="md-nav__link">
    newbyteorder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_13" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_13" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_13" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array" class="md-nav__link">
    array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_l_bfgs_b" class="md-nav__link">
    fmin_l_bfgs_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old_bound_to_new" class="md-nav__link">
    old_bound_to_new
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linesearch" class="md-nav__link">
    Linesearch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linesearchwarning" class="md-nav__link">
    LineSearchWarning
  </a>
  
    <nav class="md-nav" aria-label="LineSearchWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_1" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_14" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_14" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_14" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search" class="md-nav__link">
    line_search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_bfgs" class="md-nav__link">
    line_search_BFGS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_armijo" class="md-nav__link">
    line_search_armijo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe1" class="md-nav__link">
    line_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe2" class="md-nav__link">
    line_search_wolfe2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_armijo" class="md-nav__link">
    scalar_search_armijo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_wolfe1" class="md-nav__link">
    scalar_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_wolfe2" class="md-nav__link">
    scalar_search_wolfe2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warn" class="md-nav__link">
    warn
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minpack" class="md-nav__link">
    Minpack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error" class="md-nav__link">
    Error
  </a>
  
    <nav class="md-nav" aria-label="Error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_2" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_15" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_15" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_15" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finfo" class="md-nav__link">
    Finfo
  </a>
  
    <nav class="md-nav" aria-label="Finfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_12" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bits" class="md-nav__link">
    bits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eps" class="md-nav__link">
    eps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#epsneg" class="md-nav__link">
    epsneg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iexp" class="md-nav__link">
    iexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machar" class="md-nav__link">
    machar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machep" class="md-nav__link">
    machep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max" class="md-nav__link">
    max
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxexp" class="md-nav__link">
    maxexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min" class="md-nav__link">
    min
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minexp" class="md-nav__link">
    minexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negep" class="md-nav__link">
    negep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nexp" class="md-nav__link">
    nexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmant" class="md-nav__link">
    nmant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision" class="md-nav__link">
    precision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution" class="md-nav__link">
    resolution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tiny" class="md-nav__link">
    tiny
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_16" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_16" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_16" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray_1" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atleast_1d" class="md-nav__link">
    atleast_1d
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_gradient" class="md-nav__link">
    check_gradient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cholesky" class="md-nav__link">
    cholesky
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curve_fit" class="md-nav__link">
    curve_fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_5" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eye" class="md-nav__link">
    eye
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed_point" class="md-nav__link">
    fixed_point
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsolve" class="md-nav__link">
    fsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#greater" class="md-nav__link">
    greater
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inv" class="md-nav__link">
    inv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issubdtype" class="md-nav__link">
    issubdtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#least_squares" class="md-nav__link">
    least_squares
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leastsq" class="md-nav__link">
    leastsq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare_bounds" class="md-nav__link">
    prepare_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prod" class="md-nav__link">
    prod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_triangular" class="md-nav__link">
    solve_triangular
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd" class="md-nav__link">
    svd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take" class="md-nav__link">
    take
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose_2" class="md-nav__link">
    transpose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#triu" class="md-nav__link">
    triu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_1" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minpack2" class="md-nav__link">
    Minpack2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#moduletnc" class="md-nav__link">
    ModuleTNC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlin" class="md-nav__link">
    Nonlin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anderson" class="md-nav__link">
    Anderson
  </a>
  
    <nav class="md-nav" aria-label="Anderson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_13" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_2" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_3" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_17" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_17" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_17" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broydenfirst" class="md-nav__link">
    BroydenFirst
  </a>
  
    <nav class="md-nav" aria-label="BroydenFirst">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_14" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_1" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_3" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_2" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_1" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_1" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_1" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_4" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_18" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_18" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_18" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broydensecond" class="md-nav__link">
    BroydenSecond
  </a>
  
    <nav class="md-nav" aria-label="BroydenSecond">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_15" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_2" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_4" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_3" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_1" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_2" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_2" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_2" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_5" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_19" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_19" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_19" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagbroyden" class="md-nav__link">
    DiagBroyden
  </a>
  
    <nav class="md-nav" aria-label="DiagBroyden">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_16" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_3" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_5" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_4" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_2" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_3" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_3" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_3" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_6" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_20" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_20" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_20" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excitingmixing" class="md-nav__link">
    ExcitingMixing
  </a>
  
    <nav class="md-nav" aria-label="ExcitingMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_17" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_4" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_6" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_5" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_3" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_4" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_4" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_4" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_7" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_21" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_21" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_21" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genericbroyden" class="md-nav__link">
    GenericBroyden
  </a>
  
    <nav class="md-nav" aria-label="GenericBroyden">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_18" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_5" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_5" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_5" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_8" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_22" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_22" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_22" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inversejacobian" class="md-nav__link">
    InverseJacobian
  </a>
  
    <nav class="md-nav" aria-label="InverseJacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_19" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_23" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_23" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_23" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jacobian" class="md-nav__link">
    Jacobian
  </a>
  
    <nav class="md-nav" aria-label="Jacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_20" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_6" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_6" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_6" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_9" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape_1" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func" class="md-nav__link">
    func
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_24" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_24" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_24" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#krylovjacobian" class="md-nav__link">
    KrylovJacobian
  </a>
  
    <nav class="md-nav" aria-label="KrylovJacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_21" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_7" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_7" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_7" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_7" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_10" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_25" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_25" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_25" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linearmixing" class="md-nav__link">
    LinearMixing
  </a>
  
    <nav class="md-nav" aria-label="LinearMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_22" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aspreconditioner_8" class="md-nav__link">
    aspreconditioner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_8" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_6" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_4" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_8" class="md-nav__link">
    setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_8" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todense_5" class="md-nav__link">
    todense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_11" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_26" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_26" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_26" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lowrankmatrix" class="md-nav__link">
    LowRankMatrix
  </a>
  
    <nav class="md-nav" aria-label="LowRankMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_23" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append" class="md-nav__link">
    append
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collapse" class="md-nav__link">
    collapse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matvec_9" class="md-nav__link">
    matvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart_reduce" class="md-nav__link">
    restart_reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rmatvec_7" class="md-nav__link">
    rmatvec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsolve_5" class="md-nav__link">
    rsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple_reduce" class="md-nav__link">
    simple_reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_9" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd_reduce" class="md-nav__link">
    svd_reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_27" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_27" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_27" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#noconvergence" class="md-nav__link">
    NoConvergence
  </a>
  
    <nav class="md-nav" aria-label="NoConvergence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_3" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_28" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_28" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_28" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminationcondition" class="md-nav__link">
    TerminationCondition
  </a>
  
    <nav class="md-nav" aria-label="TerminationCondition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_24" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_29" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_29" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_29" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anderson_1" class="md-nav__link">
    anderson
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray_2" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asjacobian" class="md-nav__link">
    asjacobian
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden1" class="md-nav__link">
    broyden1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden2" class="md-nav__link">
    broyden2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagbroyden_1" class="md-nav__link">
    diagbroyden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dot_6" class="md-nav__link">
    dot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excitingmixing_1" class="md-nav__link">
    excitingmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_blas_funcs" class="md-nav__link">
    get_blas_funcs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inv_1" class="md-nav__link">
    inv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmixing_1" class="md-nav__link">
    linearmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxnorm" class="md-nav__link">
    maxnorm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_krylov" class="md-nav__link">
    newton_krylov
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlin_solve" class="md-nav__link">
    nonlin_solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norm" class="md-nav__link">
    norm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qr" class="md-nav__link">
    qr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_armijo_1" class="md-nav__link">
    scalar_search_armijo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar_search_wolfe1_1" class="md-nav__link">
    scalar_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_10" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd_1" class="md-nav__link">
    svd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vdot" class="md-nav__link">
    vdot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimize" class="md-nav__link">
    Optimize
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brent" class="md-nav__link">
    Brent
  </a>
  
    <nav class="md-nav" aria-label="Brent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_25" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_bracket_info" class="md-nav__link">
    get_bracket_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_result" class="md-nav__link">
    get_result
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimize_1" class="md-nav__link">
    optimize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_bracket" class="md-nav__link">
    set_bracket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_30" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_30" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_30" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linesearchwarning_1" class="md-nav__link">
    LineSearchWarning
  </a>
  
    <nav class="md-nav" aria-label="LineSearchWarning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with_traceback_4" class="md-nav__link">
    with_traceback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_31" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_31" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_31" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapwrapper" class="md-nav__link">
    MapWrapper
  </a>
  
    <nav class="md-nav" aria-label="MapWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_26" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#close" class="md-nav__link">
    close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminate" class="md-nav__link">
    terminate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_32" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_32" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_32" class="md-nav__link">
    pp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scalarfunction" class="md-nav__link">
    ScalarFunction
  </a>
  
    <nav class="md-nav" aria-label="ScalarFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_27" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fun_" class="md-nav__link">
    fun_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fun_and_grad" class="md-nav__link">
    fun_and_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grad" class="md-nav__link">
    grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hess" class="md-nav__link">
    hess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_33" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_33" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_33" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_derivative" class="md-nav__link">
    approx_derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_fhess_p" class="md-nav__link">
    approx_fhess_p
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_fprime" class="md-nav__link">
    approx_fprime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#argmin" class="md-nav__link">
    argmin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asarray_3" class="md-nav__link">
    asarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asfarray" class="md-nav__link">
    asfarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atleast_1d_1" class="md-nav__link">
    atleast_1d
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bracket" class="md-nav__link">
    bracket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brent_1" class="md-nav__link">
    brent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brute" class="md-nav__link">
    brute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_grad" class="md-nav__link">
    check_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eye_1" class="md-nav__link">
    eye
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin" class="md-nav__link">
    fmin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_bfgs" class="md-nav__link">
    fmin_bfgs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cg" class="md-nav__link">
    fmin_cg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_ncg" class="md-nav__link">
    fmin_ncg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_powell" class="md-nav__link">
    fmin_powell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fminbound" class="md-nav__link">
    fminbound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golden" class="md-nav__link">
    golden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_array_scalar" class="md-nav__link">
    is_array_scalar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isinf" class="md-nav__link">
    isinf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_1" class="md-nav__link">
    line_search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe1_1" class="md-nav__link">
    line_search_wolfe1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_wolfe2_1" class="md-nav__link">
    line_search_wolfe2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#main" class="md-nav__link">
    main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen" class="md-nav__link">
    rosen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_der" class="md-nav__link">
    rosen_der
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess" class="md-nav__link">
    rosen_hess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess_prod" class="md-nav__link">
    rosen_hess_prod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape_2" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_options" class="md-nav__link">
    show_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqrt" class="md-nav__link">
    sqrt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#squeeze" class="md-nav__link">
    squeeze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vecnorm" class="md-nav__link">
    vecnorm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wrap_function" class="md-nav__link">
    wrap_function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_2" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slsqp" class="md-nav__link">
    Slsqp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finfo_1" class="md-nav__link">
    Finfo
  </a>
  
    <nav class="md-nav" aria-label="Finfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_28" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bits_1" class="md-nav__link">
    bits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eps_1" class="md-nav__link">
    eps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#epsneg_1" class="md-nav__link">
    epsneg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iexp_1" class="md-nav__link">
    iexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machar_1" class="md-nav__link">
    machar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machep_1" class="md-nav__link">
    machep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_1" class="md-nav__link">
    max
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxexp_1" class="md-nav__link">
    maxexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_1" class="md-nav__link">
    min
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minexp_1" class="md-nav__link">
    minexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negep_1" class="md-nav__link">
    negep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nexp_1" class="md-nav__link">
    nexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmant_1" class="md-nav__link">
    nmant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision_1" class="md-nav__link">
    precision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution_1" class="md-nav__link">
    resolution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tiny_1" class="md-nav__link">
    tiny
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_34" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_34" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_34" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append_1" class="md-nav__link">
    append
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_derivative_1" class="md-nav__link">
    approx_derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_jacobian" class="md-nav__link">
    approx_jacobian
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_1" class="md-nav__link">
    array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asfarray_1" class="md-nav__link">
    asfarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#atleast_1d_2" class="md-nav__link">
    atleast_1d
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate" class="md-nav__link">
    concatenate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exp" class="md-nav__link">
    exp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_slsqp" class="md-nav__link">
    fmin_slsqp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isfinite" class="md-nav__link">
    isfinite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old_bound_to_new_1" class="md-nav__link">
    old_bound_to_new
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqrt_1" class="md-nav__link">
    sqrt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vstack" class="md-nav__link">
    vstack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_3" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tnc" class="md-nav__link">
    Tnc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memoizejac_1" class="md-nav__link">
    MemoizeJac
  </a>
  
    <nav class="md-nav" aria-label="MemoizeJac">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_29" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivative_1" class="md-nav__link">
    derivative
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_35" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_35" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_35" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_2" class="md-nav__link">
    array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asfarray_2" class="md-nav__link">
    asfarray
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_tnc" class="md-nav__link">
    fmin_tnc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old_bound_to_new_2" class="md-nav__link">
    old_bound_to_new
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeros_4" class="md-nav__link">
    zeros
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeros_5" class="md-nav__link">
    Zeros
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toms748solver" class="md-nav__link">
    TOMS748Solver
  </a>
  
    <nav class="md-nav" aria-label="TOMS748Solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_30" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure" class="md-nav__link">
    configure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_result_1" class="md-nav__link">
    get_result
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_status" class="md-nav__link">
    get_status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterate" class="md-nav__link">
    iterate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve_11" class="md-nav__link">
    solve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_string_36" class="md-nav__link">
    to_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_36" class="md-nav__link">
    show
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pp_36" class="md-nav__link">
    pp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bisect" class="md-nav__link">
    bisect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brenth" class="md-nav__link">
    brenth
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brentq" class="md-nav__link">
    brentq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namedtuple" class="md-nav__link">
    namedtuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton" class="md-nav__link">
    newton
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results_c" class="md-nav__link">
    results_c
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ridder" class="md-nav__link">
    ridder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toms748" class="md-nav__link">
    toms748
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anderson_2" class="md-nav__link">
    anderson
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approx_fprime_1" class="md-nav__link">
    approx_fprime
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basinhopping" class="md-nav__link">
    basinhopping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bisect_1" class="md-nav__link">
    bisect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bracket_1" class="md-nav__link">
    bracket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brent_2" class="md-nav__link">
    brent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brenth_1" class="md-nav__link">
    brenth
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brentq_1" class="md-nav__link">
    brentq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden1_1" class="md-nav__link">
    broyden1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broyden2_1" class="md-nav__link">
    broyden2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brute_1" class="md-nav__link">
    brute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_grad_1" class="md-nav__link">
    check_grad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curve_fit_1" class="md-nav__link">
    curve_fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagbroyden_2" class="md-nav__link">
    diagbroyden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differential_evolution" class="md-nav__link">
    differential_evolution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dual_annealing" class="md-nav__link">
    dual_annealing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excitingmixing_2" class="md-nav__link">
    excitingmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed_point_1" class="md-nav__link">
    fixed_point
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_1" class="md-nav__link">
    fmin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_bfgs_1" class="md-nav__link">
    fmin_bfgs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cg_1" class="md-nav__link">
    fmin_cg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_cobyla_1" class="md-nav__link">
    fmin_cobyla
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_l_bfgs_b_1" class="md-nav__link">
    fmin_l_bfgs_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_ncg_1" class="md-nav__link">
    fmin_ncg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_powell_1" class="md-nav__link">
    fmin_powell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_slsqp_1" class="md-nav__link">
    fmin_slsqp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmin_tnc_1" class="md-nav__link">
    fmin_tnc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fminbound_1" class="md-nav__link">
    fminbound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsolve_1" class="md-nav__link">
    fsolve
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golden_1" class="md-nav__link">
    golden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#least_squares_1" class="md-nav__link">
    least_squares
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leastsq_1" class="md-nav__link">
    leastsq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line_search_2" class="md-nav__link">
    line_search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linear_sum_assignment" class="md-nav__link">
    linear_sum_assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmixing_2" class="md-nav__link">
    linearmixing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linprog" class="md-nav__link">
    linprog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linprog_verbose_callback" class="md-nav__link">
    linprog_verbose_callback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsq_linear" class="md-nav__link">
    lsq_linear
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimize" class="md-nav__link">
    minimize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimize_scalar" class="md-nav__link">
    minimize_scalar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_1" class="md-nav__link">
    newton
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_krylov_1" class="md-nav__link">
    newton_krylov
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nnls" class="md-nav__link">
    nnls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ridder_1" class="md-nav__link">
    ridder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root_1" class="md-nav__link">
    root
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root_scalar" class="md-nav__link">
    root_scalar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_1" class="md-nav__link">
    rosen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_der_1" class="md-nav__link">
    rosen_der
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess_1" class="md-nav__link">
    rosen_hess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rosen_hess_prod_1" class="md-nav__link">
    rosen_hess_prod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shgo" class="md-nav__link">
    shgo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_options_1" class="md-nav__link">
    show_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toms748_1" class="md-nav__link">
    toms748
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/lehy/ocaml-sklearn/edit/master/docs/scipy/Optimize.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Optimize</h1>
                
                <h2 id="bfgs">BFGS<a class="headerlink" href="#bfgs" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​BFGS</code> wraps Python class <code>scipy.optimize.BFGS</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create">create<a class="headerlink" href="#create" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">exception_strategy</span><span class="o">:[`</span><span class="nc">Skip_update</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Damp_update</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">min_curvature</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">init_scale</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Auto</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Broyden-Fletcher-Goldfarb-Shanno (BFGS) Hessian update strategy.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>exception_strategy : {'skip_update', 'damp_update'}, optional</strong>
    Define how to proceed when the curvature condition is violated.
    Set it to 'skip_update' to just skip the update. Or, alternatively,
    set it to 'damp_update' to interpolate between the actual BFGS
    result and the unmodified matrix. Both exceptions strategies
    are explained  in [1]_, p.536-537.</p>
</li>
<li>
<p><strong>min_curvature : float</strong>
    This number, scaled by a normalization factor, defines the
    minimum curvature <code>dot(delta_grad, delta_x)</code> allowed to go
    unaffected by the exception strategy. By default is equal to
    1e-8 when <code>exception_strategy = 'skip_update'</code> and equal
    to 0.2 when <code>exception_strategy = 'damp_update'</code>.</p>
</li>
<li>
<p><strong>init_scale : {float, 'auto'}</strong>
    Matrix scale at first iteration. At the first
    iteration the Hessian matrix or its inverse will be initialized
    with <code>init_scale*np.eye(n)</code>, where <code>n</code> is the problem dimension.
    Set it to 'auto' in order to use an automatic heuristic for choosing
    the initial scale. The heuristic is described in [1]_, p.143.
    By default uses 'auto'.</p>
</li>
</ul>
<h4>Notes</h4>
<p>The update is based on the description in [1]_, p.140.</p>
<h4>References</h4>
<p>.. [1] Nocedal, Jorge, and Stephen J. Wright. 'Numerical optimization'
       Second Edition (2006).</p>
</details>
<h3 id="dot">dot<a class="headerlink" href="#dot" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="n">p</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute the product of the internal matrix with the given vector.</p>
<h4>Parameters</h4>
<ul>
<li><strong>p : array_like</strong>
    1-D array representing a vector.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Hp : array</strong>
    1-D represents the result of multiplying the approximation matrix
    by vector p.</li>
</ul>
</details>
<h3 id="get_matrix">get_matrix<a class="headerlink" href="#get_matrix" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_matrix</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_matrix</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the current internal matrix.</p>
<h4>Returns</h4>
<ul>
<li><strong>M : ndarray, shape (n, n)</strong>
    Dense matrix containing either the Hessian or its inverse
    (depending on how <code>approx_type</code> was defined).</li>
</ul>
</details>
<h3 id="initialize">initialize<a class="headerlink" href="#initialize" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method initialize</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">initialize</span> <span class="o">:</span>
  <span class="n">n</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">approx_type</span><span class="o">:[`</span><span class="nc">Hess</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Inv_hess</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Initialize internal matrix.</p>
<p>Allocate internal memory for storing and updating
the Hessian or its inverse.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>n : int</strong>
    Problem dimension.</p>
</li>
<li>
<p><strong>approx_type : {'hess', 'inv_hess'}</strong>
    Selects either the Hessian or the inverse Hessian.
    When set to 'hess' the Hessian will be stored and updated.
    When set to 'inv_hess' its inverse will be used instead.</p>
</li>
</ul>
</details>
<h3 id="update">update<a class="headerlink" href="#update" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">delta_x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">delta_grad</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Update internal matrix.</p>
<p>Update Hessian matrix or its inverse (depending on how 'approx_type'
is defined) using information about the last evaluated points.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>delta_x : ndarray</strong>
    The difference between two points the gradient
    function have been evaluated at: <code>delta_x = x2 - x1</code>.</p>
</li>
<li>
<p><strong>delta_grad : ndarray</strong>
    The difference between the gradients:
    <code>delta_grad = grad(x2) - grad(x1)</code>.</p>
</li>
</ul>
</details>
<h3 id="to_string">to_string<a class="headerlink" href="#to_string" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show">show<a class="headerlink" href="#show" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp">pp<a class="headerlink" href="#pp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="bounds">Bounds<a class="headerlink" href="#bounds" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Bounds</code> wraps Python class <code>scipy.optimize.Bounds</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_1">create<a class="headerlink" href="#create_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">keep_feasible</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">lb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">ub</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Bounds constraint on the variables.</p>
<p>The constraint has the general inequality form::</p>
<div class="codehilite"><pre><span></span><code>lb &lt;= x &lt;= ub
</code></pre></div>


<p>It is possible to use equal bounds to represent an equality constraint or
infinite bounds to represent a one-sided constraint.</p>
<h4>Parameters</h4>
<p>lb, ub : array_like, optional
    Lower and upper bounds on independent variables. Each array must
    have the same size as x or be a scalar, in which case a bound will be
    the same for all the variables. Set components of <code>lb</code> and <code>ub</code> equal
    to fix a variable. Use <code>np.inf</code> with an appropriate sign to disable
    bounds on all or some variables. Note that you can mix constraints of
    different types: interval, one-sided or equality, by setting different
    components of <code>lb</code> and <code>ub</code> as necessary.</p>
<ul>
<li><strong>keep_feasible : array_like of bool, optional</strong>
    Whether to keep the constraint components feasible throughout
    iterations. A single value set this property for all components.
    Default is False. Has no effect for equality constraints.</li>
</ul>
</details>
<h3 id="to_string_1">to_string<a class="headerlink" href="#to_string_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_1">show<a class="headerlink" href="#show_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_1">pp<a class="headerlink" href="#pp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="hessianupdatestrategy">HessianUpdateStrategy<a class="headerlink" href="#hessianupdatestrategy" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​HessianUpdateStrategy</code> wraps Python class <code>scipy.optimize.HessianUpdateStrategy</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_2">create<a class="headerlink" href="#create_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Interface for implementing Hessian update strategies.</p>
<p>Many optimization methods make use of Hessian (or inverse Hessian)
approximations, such as the quasi-Newton methods BFGS, SR1, L-BFGS.
Some of these  approximations, however, do not actually need to store
the entire matrix or can compute the internal matrix product with a
given vector in a very efficiently manner. This class serves as an
abstract interface between the optimization algorithm and the
quasi-Newton update strategies, giving freedom of implementation
to store and update the internal matrix as efficiently as possible.
Different choices of initialization and update procedure will result
in different quasi-Newton strategies.</p>
<p>Four methods should be implemented in derived classes: <code>initialize</code>,
<code>update</code>, <code>dot</code> and <code>get_matrix</code>.</p>
<h4>Notes</h4>
<p>Any instance of a class that implements this interface,
can be accepted by the method <code>minimize</code> and used by
the compatible solvers to approximate the Hessian (or
inverse Hessian) used by the optimization algorithms.</p>
</details>
<h3 id="dot_1">dot<a class="headerlink" href="#dot_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="n">p</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute the product of the internal matrix with the given vector.</p>
<h4>Parameters</h4>
<ul>
<li><strong>p : array_like</strong>
    1-D array representing a vector.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Hp : array</strong>
    1-D represents the result of multiplying the approximation matrix
    by vector p.</li>
</ul>
</details>
<h3 id="get_matrix_1">get_matrix<a class="headerlink" href="#get_matrix_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_matrix</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_matrix</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return current internal matrix.</p>
<h4>Returns</h4>
<ul>
<li><strong>H : ndarray, shape (n, n)</strong>
    Dense matrix containing either the Hessian
    or its inverse (depending on how 'approx_type'
    is defined).</li>
</ul>
</details>
<h3 id="initialize_1">initialize<a class="headerlink" href="#initialize_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method initialize</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">initialize</span> <span class="o">:</span>
  <span class="n">n</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">approx_type</span><span class="o">:[`</span><span class="nc">Hess</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Inv_hess</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Initialize internal matrix.</p>
<p>Allocate internal memory for storing and updating
the Hessian or its inverse.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>n : int</strong>
    Problem dimension.</p>
</li>
<li>
<p><strong>approx_type : {'hess', 'inv_hess'}</strong>
    Selects either the Hessian or the inverse Hessian.
    When set to 'hess' the Hessian will be stored and updated.
    When set to 'inv_hess' its inverse will be used instead.</p>
</li>
</ul>
</details>
<h3 id="update_1">update<a class="headerlink" href="#update_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">delta_x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">delta_grad</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Update internal matrix.</p>
<p>Update Hessian matrix or its inverse (depending on how 'approx_type'
is defined) using information about the last evaluated points.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>delta_x : ndarray</strong>
    The difference between two points the gradient
    function have been evaluated at: <code>delta_x = x2 - x1</code>.</p>
</li>
<li>
<p><strong>delta_grad : ndarray</strong>
    The difference between the gradients:
    <code>delta_grad = grad(x2) - grad(x1)</code>.</p>
</li>
</ul>
</details>
<h3 id="to_string_2">to_string<a class="headerlink" href="#to_string_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_2">show<a class="headerlink" href="#show_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_2">pp<a class="headerlink" href="#pp_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="lbfgsinvhessproduct">LbfgsInvHessProduct<a class="headerlink" href="#lbfgsinvhessproduct" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​LbfgsInvHessProduct</code> wraps Python class <code>scipy.optimize.LbfgsInvHessProduct</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_3">create<a class="headerlink" href="#create_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Linear operator for the L-BFGS approximate inverse Hessian.</p>
<p>This operator computes the product of a vector with the approximate inverse
of the Hessian of the objective function, using the L-BFGS limited
memory approximation to the inverse Hessian, accumulated during the
optimization.</p>
<p>Objects of this class implement the <code>scipy.sparse.linalg.LinearOperator</code>
interface.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>sk : array_like, shape=(n_corr, n)</strong>
    Array of <code>n_corr</code> most recent updates to the solution vector.
    (See [1]).</p>
</li>
<li>
<p><strong>yk : array_like, shape=(n_corr, n)</strong>
    Array of <code>n_corr</code> most recent updates to the gradient. (See [1]).</p>
</li>
</ul>
<h4>References</h4>
<p>.. [1] Nocedal, Jorge. 'Updating quasi-Newton matrices with limited
   storage.' Mathematics of computation 35.151 (1980): 773-782.</p>
</details>
<h3 id="adjoint">adjoint<a class="headerlink" href="#adjoint" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method adjoint</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">adjoint</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Hermitian adjoint.</p>
<p>Returns the Hermitian adjoint of self, aka the Hermitian
conjugate or Hermitian transpose. For a complex matrix, the
Hermitian adjoint is equal to the conjugate transpose.</p>
<p>Can be abbreviated self.H instead of self.adjoint().</p>
<h4>Returns</h4>
<ul>
<li><strong>A_H : LinearOperator</strong>
    Hermitian adjoint of self.</li>
</ul>
</details>
<h3 id="dot_2">dot<a class="headerlink" href="#dot_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix-matrix or matrix-vector multiplication.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-d or 2-d array, representing a vector or matrix.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Ax : array</strong>
    1-d or 2-d array (depending on the shape of x) that represents
    the result of applying this linear operator on x.</li>
</ul>
</details>
<h3 id="matmat">matmat<a class="headerlink" href="#matmat" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matmat</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matmat</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix-matrix multiplication.</p>
<p>Performs the operation y=A<em>X where A is an MxN linear
operator and X dense N</em>K matrix or ndarray.</p>
<h4>Parameters</h4>
<ul>
<li><strong>X : {matrix, ndarray}</strong>
    An array with shape (N,K).</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Y : {matrix, ndarray}</strong>
    A matrix or ndarray with shape (M,K) depending on
    the type of the X argument.</li>
</ul>
<h4>Notes</h4>
<p>This matmat wraps any user-specified matmat routine or overridden
_matmat method to ensure that y has the correct type.</p>
</details>
<h3 id="matvec">matvec<a class="headerlink" href="#matvec" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix-vector multiplication.</p>
<p>Performs the operation y=A*x where A is an MxN linear
operator and x is a column vector or 1-d array.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : {matrix, ndarray}</strong>
    An array with shape (N,) or (N,1).</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : {matrix, ndarray}</strong>
    A matrix or ndarray with shape (M,) or (M,1) depending
    on the type and shape of the x argument.</li>
</ul>
<h4>Notes</h4>
<p>This matvec wraps the user-specified matvec routine or overridden
_matvec method to ensure that y has the correct shape and type.</p>
</details>
<h3 id="rmatmat">rmatmat<a class="headerlink" href="#rmatmat" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatmat</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatmat</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Adjoint matrix-matrix multiplication.</p>
<p>Performs the operation y = A^H * x where A is an MxN linear
operator and x is a column vector or 1-d array, or 2-d array.
The default implementation defers to the adjoint.</p>
<h4>Parameters</h4>
<ul>
<li><strong>X : {matrix, ndarray}</strong>
    A matrix or 2D array.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Y : {matrix, ndarray}</strong>
    A matrix or 2D array depending on the type of the input.</li>
</ul>
<h4>Notes</h4>
<p>This rmatmat wraps the user-specified rmatmat routine.</p>
</details>
<h3 id="rmatvec">rmatvec<a class="headerlink" href="#rmatvec" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Adjoint matrix-vector multiplication.</p>
<p>Performs the operation y = A^H * x where A is an MxN linear
operator and x is a column vector or 1-d array.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : {matrix, ndarray}</strong>
    An array with shape (M,) or (M,1).</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : {matrix, ndarray}</strong>
    A matrix or ndarray with shape (N,) or (N,1) depending
    on the type and shape of the x argument.</li>
</ul>
<h4>Notes</h4>
<p>This rmatvec wraps the user-specified rmatvec routine or overridden
_rmatvec method to ensure that y has the correct shape and type.</p>
</details>
<h3 id="todense">todense<a class="headerlink" href="#todense" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method todense</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">todense</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a dense array representation of this operator.</p>
<h4>Returns</h4>
<ul>
<li><strong>arr : ndarray, shape=(n, n)</strong>
    An array with the same shape and containing
    the same data represented by this <code>LinearOperator</code>.</li>
</ul>
</details>
<h3 id="transpose">transpose<a class="headerlink" href="#transpose" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method transpose</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">transpose</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Transpose this linear operator.</p>
<p>Returns a LinearOperator that represents the transpose of this one.
Can be abbreviated self.T instead of self.transpose().</p>
</details>
<h3 id="to_string_3">to_string<a class="headerlink" href="#to_string_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_3">show<a class="headerlink" href="#show_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_3">pp<a class="headerlink" href="#pp_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="linearconstraint">LinearConstraint<a class="headerlink" href="#linearconstraint" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​LinearConstraint</code> wraps Python class <code>scipy.optimize.LinearConstraint</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_4">create<a class="headerlink" href="#create_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">keep_feasible</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">lb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">ub</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Linear constraint on the variables.</p>
<p>The constraint has the general inequality form::</p>
<div class="codehilite"><pre><span></span><code>lb &lt;= A.dot(x) &lt;= ub
</code></pre></div>


<p>Here the vector of independent variables x is passed as ndarray of shape
(n,) and the matrix A has shape (m, n).</p>
<p>It is possible to use equal bounds to represent an equality constraint or
infinite bounds to represent a one-sided constraint.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>A : {array_like, sparse matrix}, shape (m, n)</strong>
    Matrix defining the constraint.
lb, ub : array_like
    Lower and upper bounds on the constraint. Each array must have the
    shape (m,) or be a scalar, in the latter case a bound will be the same
    for all components of the constraint. Use <code>np.inf</code> with an
    appropriate sign to specify a one-sided constraint.
    Set components of <code>lb</code> and <code>ub</code> equal to represent an equality
    constraint. Note that you can mix constraints of different types:
    interval, one-sided or equality, by setting different components of
    <code>lb</code> and <code>ub</code> as  necessary.</p>
</li>
<li>
<p><strong>keep_feasible : array_like of bool, optional</strong>
    Whether to keep the constraint components feasible throughout
    iterations. A single value set this property for all components.
    Default is False. Has no effect for equality constraints.</p>
</li>
</ul>
</details>
<h3 id="to_string_4">to_string<a class="headerlink" href="#to_string_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_4">show<a class="headerlink" href="#show_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_4">pp<a class="headerlink" href="#pp_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="nonlinearconstraint">NonlinearConstraint<a class="headerlink" href="#nonlinearconstraint" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​NonlinearConstraint</code> wraps Python class <code>scipy.optimize.NonlinearConstraint</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_5">create<a class="headerlink" href="#create_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:[`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">hess</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">HessianUpdateStrategy</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">keep_feasible</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">finite_diff_rel_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">finite_diff_jac_sparsity</span><span class="o">:[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">lb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">ub</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Nonlinear constraint on the variables.</p>
<p>The constraint has the general inequality form::</p>
<div class="codehilite"><pre><span></span><code>lb &lt;= fun(x) &lt;= ub
</code></pre></div>


<p>Here the vector of independent variables x is passed as ndarray of shape
(n,) and <code>fun</code> returns a vector with m components.</p>
<p>It is possible to use equal bounds to represent an equality constraint or
infinite bounds to represent a one-sided constraint.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    The function defining the constraint.
    The signature is <code>fun(x) -&gt; array_like, shape (m,)</code>.
lb, ub : array_like
    Lower and upper bounds on the constraint. Each array must have the
    shape (m,) or be a scalar, in the latter case a bound will be the same
    for all components of the constraint. Use <code>np.inf</code> with an
    appropriate sign to specify a one-sided constraint.
    Set components of <code>lb</code> and <code>ub</code> equal to represent an equality
    constraint. Note that you can mix constraints of different types:
    interval, one-sided or equality, by setting different components of
    <code>lb</code> and <code>ub</code> as  necessary.</p>
</li>
<li>
<p><strong>jac : {callable,  '2-point', '3-point', 'cs'}, optional</strong>
    Method of computing the Jacobian matrix (an m-by-n matrix,
    where element (i, j) is the partial derivative of f[i] with
    respect to x[j]).  The keywords {'2-point', '3-point',
    'cs'} select a finite difference scheme for the numerical estimation.
    A callable must have the following signature:
    <code>jac(x) -&gt; {ndarray, sparse matrix}, shape (m, n)</code>.
    Default is '2-point'.</p>
</li>
<li>
<p><strong>hess : {callable, '2-point', '3-point', 'cs', HessianUpdateStrategy, None}, optional</strong>
    Method for computing the Hessian matrix. The keywords
    {'2-point', '3-point', 'cs'} select a finite difference scheme for
    numerical  estimation.  Alternatively, objects implementing
    <code>HessianUpdateStrategy</code> interface can be used to approximate the
    Hessian. Currently available implementations are:</p>
<div class="codehilite"><pre><span></span><code>- `BFGS` (default option)
- `SR1`
</code></pre></div>


<p>A callable must return the Hessian matrix of <code>dot(fun, v)</code> and
must have the following signature:
<code>hess(x, v) -&gt; {LinearOperator, sparse matrix, array_like}, shape (n, n)</code>.
Here <code>v</code> is ndarray with shape (m,) containing Lagrange multipliers.</p>
</li>
<li>
<p><strong>keep_feasible : array_like of bool, optional</strong>
    Whether to keep the constraint components feasible throughout
    iterations. A single value set this property for all components.
    Default is False. Has no effect for equality constraints.</p>
</li>
<li>
<p><strong>finite_diff_rel_step: None or array_like, optional</strong>
    Relative step size for the finite difference approximation. Default is
    None, which will select a reasonable value automatically depending
    on a finite difference scheme.</p>
</li>
<li>
<p><strong>finite_diff_jac_sparsity: {None, array_like, sparse matrix}, optional</strong>
    Defines the sparsity structure of the Jacobian matrix for finite
    difference estimation, its shape must be (m, n). If the Jacobian has
    only few non-zero elements in <em>each</em> row, providing the sparsity
    structure will greatly speed up the computations. A zero entry means
    that a corresponding element in the Jacobian is identically zero.
    If provided, forces the use of 'lsmr' trust-region solver.
    If None (default) then dense differencing will be used.</p>
</li>
</ul>
<h4>Notes</h4>
<p>Finite difference schemes {'2-point', '3-point', 'cs'} may be used for
approximating either the Jacobian or the Hessian. We, however, do not allow
its use for approximating both simultaneously. Hence whenever the Jacobian
is estimated via finite-differences, we require the Hessian to be estimated
using one of the quasi-Newton strategies.</p>
<p>The scheme 'cs' is potentially the most accurate, but requires the function
to correctly handles complex inputs and be analytically continuable to the
complex plane. The scheme '3-point' is more accurate than '2-point' but
requires twice as many operations.</p>
<h4>Examples</h4>
<p>Constrain <code>x[0] &lt; sin(x[1]) + 1.9</code></p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">NonlinearConstraint</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">con</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nlc</span> <span class="o">=</span> <span class="n">NonlinearConstraint</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="to_string_5">to_string<a class="headerlink" href="#to_string_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_5">show<a class="headerlink" href="#show_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_5">pp<a class="headerlink" href="#pp_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="optimizeresult">OptimizeResult<a class="headerlink" href="#optimizeresult" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​OptimizeResult</code> wraps Python class <code>scipy.optimize.OptimizeResult</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="x">x<a class="headerlink" href="#x" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute x</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">x</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">x_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="success">success<a class="headerlink" href="#success" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute success</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">success</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">bool</span>
<span class="k">val</span> <span class="n">success_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">bool</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="status">status<a class="headerlink" href="#status" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute status</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">status</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">status_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="message">message<a class="headerlink" href="#message" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute message</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">message</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
<span class="k">val</span> <span class="n">message_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">string</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="hess_inv">hess_inv<a class="headerlink" href="#hess_inv" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute hess_inv</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">hess_inv</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">hess_inv_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="nit">nit<a class="headerlink" href="#nit" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute nit</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nit</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">nit_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="maxcv">maxcv<a class="headerlink" href="#maxcv" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute maxcv</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxcv</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">maxcv_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="to_string_6">to_string<a class="headerlink" href="#to_string_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_6">show<a class="headerlink" href="#show_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_6">pp<a class="headerlink" href="#pp_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="optimizewarning">OptimizeWarning<a class="headerlink" href="#optimizewarning" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​OptimizeWarning</code> wraps Python class <code>scipy.optimize.OptimizeWarning</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback">with_traceback<a class="headerlink" href="#with_traceback" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method with_traceback</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_7">to_string<a class="headerlink" href="#to_string_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_7">show<a class="headerlink" href="#show_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_7">pp<a class="headerlink" href="#pp_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="rootresults">RootResults<a class="headerlink" href="#rootresults" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​RootResults</code> wraps Python class <code>scipy.optimize.RootResults</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_6">create<a class="headerlink" href="#create_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="n">root</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">iterations</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">function_calls</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">flag</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Represents the root finding result.</p>
<h4>Attributes</h4>
<ul>
<li>
<p><strong>root : float</strong>
    Estimated root location.</p>
</li>
<li>
<p><strong>iterations : int</strong>
    Number of iterations needed to find the root.</p>
</li>
<li>
<p><strong>function_calls : int</strong>
    Number of times the function was called.</p>
</li>
<li>
<p><strong>converged : bool</strong>
    True if the routine converged.</p>
</li>
<li>
<p><strong>flag : str</strong>
    Description of the cause of termination.</p>
</li>
</ul>
</details>
<h3 id="root">root<a class="headerlink" href="#root" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute root</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">root</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">root_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="iterations">iterations<a class="headerlink" href="#iterations" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute iterations</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">iterations</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">iterations_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="function_calls">function_calls<a class="headerlink" href="#function_calls" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute function_calls</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">function_calls</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">function_calls_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="converged">converged<a class="headerlink" href="#converged" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute converged</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">converged</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">bool</span>
<span class="k">val</span> <span class="n">converged_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">bool</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="flag">flag<a class="headerlink" href="#flag" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute flag</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">flag</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
<span class="k">val</span> <span class="n">flag_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">string</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="to_string_8">to_string<a class="headerlink" href="#to_string_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_8">show<a class="headerlink" href="#show_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_8">pp<a class="headerlink" href="#pp_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="sr1">SR1<a class="headerlink" href="#sr1" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​SR1</code> wraps Python class <code>scipy.optimize.SR1</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_7">create<a class="headerlink" href="#create_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">min_denominator</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">init_scale</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Auto</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Symmetric-rank-1 Hessian update strategy.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>min_denominator : float</strong>
    This number, scaled by a normalization factor,
    defines the minimum denominator magnitude allowed
    in the update. When the condition is violated we skip
    the update. By default uses <code>1e-8</code>.</p>
</li>
<li>
<p><strong>init_scale : {float, 'auto'}, optional</strong>
    Matrix scale at first iteration. At the first
    iteration the Hessian matrix or its inverse will be initialized
    with <code>init_scale*np.eye(n)</code>, where <code>n</code> is the problem dimension.
    Set it to 'auto' in order to use an automatic heuristic for choosing
    the initial scale. The heuristic is described in [1]_, p.143.
    By default uses 'auto'.</p>
</li>
</ul>
<h4>Notes</h4>
<p>The update is based on the description in [1]_, p.144-146.</p>
<h4>References</h4>
<p>.. [1] Nocedal, Jorge, and Stephen J. Wright. 'Numerical optimization'
       Second Edition (2006).</p>
</details>
<h3 id="dot_3">dot<a class="headerlink" href="#dot_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="n">p</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute the product of the internal matrix with the given vector.</p>
<h4>Parameters</h4>
<ul>
<li><strong>p : array_like</strong>
    1-D array representing a vector.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Hp : array</strong>
    1-D represents the result of multiplying the approximation matrix
    by vector p.</li>
</ul>
</details>
<h3 id="get_matrix_2">get_matrix<a class="headerlink" href="#get_matrix_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_matrix</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_matrix</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the current internal matrix.</p>
<h4>Returns</h4>
<ul>
<li><strong>M : ndarray, shape (n, n)</strong>
    Dense matrix containing either the Hessian or its inverse
    (depending on how <code>approx_type</code> was defined).</li>
</ul>
</details>
<h3 id="initialize_2">initialize<a class="headerlink" href="#initialize_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method initialize</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">initialize</span> <span class="o">:</span>
  <span class="n">n</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">approx_type</span><span class="o">:[`</span><span class="nc">Hess</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Inv_hess</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Initialize internal matrix.</p>
<p>Allocate internal memory for storing and updating
the Hessian or its inverse.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>n : int</strong>
    Problem dimension.</p>
</li>
<li>
<p><strong>approx_type : {'hess', 'inv_hess'}</strong>
    Selects either the Hessian or the inverse Hessian.
    When set to 'hess' the Hessian will be stored and updated.
    When set to 'inv_hess' its inverse will be used instead.</p>
</li>
</ul>
</details>
<h3 id="update_2">update<a class="headerlink" href="#update_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">delta_x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">delta_grad</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Update internal matrix.</p>
<p>Update Hessian matrix or its inverse (depending on how 'approx_type'
is defined) using information about the last evaluated points.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>delta_x : ndarray</strong>
    The difference between two points the gradient
    function have been evaluated at: <code>delta_x = x2 - x1</code>.</p>
</li>
<li>
<p><strong>delta_grad : ndarray</strong>
    The difference between the gradients:
    <code>delta_grad = grad(x2) - grad(x1)</code>.</p>
</li>
</ul>
</details>
<h3 id="to_string_9">to_string<a class="headerlink" href="#to_string_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_9">show<a class="headerlink" href="#show_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_9">pp<a class="headerlink" href="#pp_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="cobyla">Cobyla<a class="headerlink" href="#cobyla" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Cobyla</code> wraps Python module <code>scipy.optimize.cobyla</code>.</p>
<h2 id="izip">Izip<a class="headerlink" href="#izip" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Cobyla.​Izip</code> wraps Python class <code>scipy.optimize.cobyla.izip</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_8">create<a class="headerlink" href="#create_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>zip( *iterables) --&gt; A zip object yielding tuples until an input is exhausted.</p>
<blockquote>
<blockquote>
<blockquote>
<p>list(zip('abcdefg', range(3), range(4)))
   [('a', 0, 0), ('b', 1, 1), ('c', 2, 2)]</p>
</blockquote>
</blockquote>
</blockquote>
<p>The zip object yields n-length tuples, where n is the number of iterables
passed as positional arguments to zip().  The i-th element in every tuple
comes from the i-th iterable argument to zip().  This continues until the
shortest argument is exhausted.</p>
</details>
<h3 id="iter"><strong>iter</strong><a class="headerlink" href="#iter" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method <strong>iter</strong></summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">iter__</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Implement iter(self).</p>
</details>
<h3 id="to_string_10">to_string<a class="headerlink" href="#to_string_10" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_10">show<a class="headerlink" href="#show_10" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_10">pp<a class="headerlink" href="#pp_10" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="rlock">rLock<a class="headerlink" href="#rlock" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rLock</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rLock</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Factory function that returns a new reentrant lock.</p>
<p>A reentrant lock must be released by the thread that acquired it. Once a
thread has acquired a reentrant lock, the same thread may acquire it again
without blocking; the thread must release it once for each time it has
acquired it.</p>
</details>
<h3 id="fmin_cobyla">fmin_cobyla<a class="headerlink" href="#fmin_cobyla" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_cobyla</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_cobyla</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">consargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rhobeg</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rhoend</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:[`</span><span class="nc">One</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Zero</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Three</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Two</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">catol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">cons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimize a function using the Constrained Optimization By Linear
Approximation (COBYLA) method. This method wraps a FORTRAN
implementation of the algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    Function to minimize. In the form func(x, *args).</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>cons : sequence</strong>
    Constraint functions; must all be <code>&gt;=0</code> (a single function
    if only 1 constraint). Each function takes the parameters <code>x</code>
    as its first argument, and it can return either a single number or
    an array or list of numbers.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments to pass to function.</p>
</li>
<li>
<p><strong>consargs : tuple, optional</strong>
    Extra arguments to pass to constraint functions (default of None means
    use same extra arguments as those passed to func).
    Use <code>()</code> for no extra arguments.</p>
</li>
<li>
<p><strong>rhobeg : float, optional</strong>
    Reasonable initial changes to the variables.</p>
</li>
<li>
<p><strong>rhoend : float, optional</strong>
    Final accuracy in the optimization (not precisely guaranteed). This
    is a lower bound on the size of the trust region.</p>
</li>
<li>
<p><strong>disp : {0, 1, 2, 3}, optional</strong>
    Controls the frequency of output; 0 implies no output.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations.</p>
</li>
<li>
<p><strong>catol : float, optional</strong>
    Absolute tolerance for constraint violations.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>x : ndarray</strong>
    The argument that minimises <code>f</code>.</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'COBYLA' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm is based on linear approximations to the objective
function and each constraint. We briefly describe the algorithm.</p>
<p>Suppose the function is being minimized over k variables. At the
jth iteration the algorithm has k+1 points v_1, ..., v_(k+1),
an approximate solution x_j, and a radius RHO_j.
(i.e., linear plus a constant) approximations to the objective
function and constraint functions such that their function values
agree with the linear approximation on the k+1 points v_1,.., v_(k+1).
This gives a linear program to solve (where the linear approximations
of the constraint functions are constrained to be non-negative).</p>
<p>However, the linear approximations are likely only good
approximations near the current simplex, so the linear program is
given the further requirement that the solution, which
will become x_(j+1), must be within RHO_j from x_j. RHO_j only
decreases, never increases. The initial RHO_j is rhobeg and the
final RHO_j is rhoend. In this way COBYLA's iterations behave
like a trust region algorithm.</p>
<p>Additionally, the linear program may be inconsistent, or the
approximation may give poor improvement. For details about
how these issues are resolved, as well as how the points v_i are
updated, refer to the source code or the references below.</p>
<h4>References</h4>
<p>Powell M.J.D. (1994), 'A direct search optimization method that models
the objective and constraint functions by linear interpolation.', in
Advances in Optimization and Numerical Analysis, eds. S. Gomez and
J-P Hennart, Kluwer Academic (Dordrecht), pp. 51-67</p>
<p>Powell M.J.D. (1998), 'Direct search algorithms for optimization
calculations', Acta Numerica 7, 287-336</p>
<p>Powell M.J.D. (2007), 'A view of algorithms for optimization without
derivatives', Cambridge University Technical Report DAMTP 2007/NA03</p>
<h4>Examples</h4>
<p>Minimize the objective function f(x,y) = x<em>y subject
to the constraints x</em><em>2 + y</em>*2 &lt; 1 and y &gt; 0::</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; def objective(x):
...     return x[0]*x[1]
...
&gt;&gt;&gt; def constr1(x):
...     return 1 - (x[0]**2 + x[1]**2)
...
&gt;&gt;&gt; def constr2(x):
...     return x[1]
...
&gt;&gt;&gt; from scipy.optimize import fmin_cobyla
&gt;&gt;&gt; fmin_cobyla(objective, [0.0, 0.1], [constr1, constr2], rhoend=1e-7)
array([-0.70710685,  0.70710671])
</code></pre></div>


<p>The exact solution is (-sqrt(2)/2, sqrt(2)/2).</p>
</details>
<h3 id="synchronized">synchronized<a class="headerlink" href="#synchronized" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function synchronized</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">synchronized</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h2 id="lbfgsb">Lbfgsb<a class="headerlink" href="#lbfgsb" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Lbfgsb</code> wraps Python module <code>scipy.optimize.lbfgsb</code>.</p>
<h2 id="linearoperator">LinearOperator<a class="headerlink" href="#linearoperator" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Lbfgsb.​LinearOperator</code> wraps Python class <code>scipy.optimize.lbfgsb.LinearOperator</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_9">create<a class="headerlink" href="#create_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Common interface for performing matrix vector products</p>
<p>Many iterative methods (e.g. cg, gmres) do not need to know the
individual entries of a matrix to solve a linear system A<em>x=b.
Such solvers only require the computation of matrix vector
products, A</em>v where v is a dense vector.  This class serves as
an abstract interface between iterative solvers and matrix-like
objects.</p>
<p>To construct a concrete LinearOperator, either pass appropriate
callables to the constructor of this class, or subclass it.</p>
<p>A subclass must implement either one of the methods <code>_matvec</code>
and <code>_matmat</code>, and the attributes/properties <code>shape</code> (pair of
integers) and <code>dtype</code> (may be None). It may call the <code>__init__</code>
on this class to have these attributes validated. Implementing
<code>_matvec</code> automatically implements <code>_matmat</code> (using a naive
algorithm) and vice-versa.</p>
<p>Optionally, a subclass may implement <code>_rmatvec</code> or <code>_adjoint</code>
to implement the Hermitian adjoint (conjugate transpose). As with
<code>_matvec</code> and <code>_matmat</code>, implementing either <code>_rmatvec</code> or
<code>_adjoint</code> implements the other automatically. Implementing
<code>_adjoint</code> is preferable; <code>_rmatvec</code> is mostly there for
backwards compatibility.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>shape : tuple</strong>
    Matrix dimensions (M, N).</p>
</li>
<li>
<p><strong>matvec : callable f(v)</strong>
    Returns returns A * v.</p>
</li>
<li>
<p><strong>rmatvec : callable f(v)</strong>
    Returns A^H * v, where A^H is the conjugate transpose of A.</p>
</li>
<li>
<p><strong>matmat : callable f(V)</strong>
    Returns A * V, where V is a dense matrix with dimensions (N, K).</p>
</li>
<li>
<p><strong>dtype : dtype</strong>
    Data type of the matrix.</p>
</li>
<li>
<p><strong>rmatmat : callable f(V)</strong>
    Returns A^H * V, where V is a dense matrix with dimensions (M, K).</p>
</li>
</ul>
<h4>Attributes</h4>
<ul>
<li>
<p><strong>args : tuple</strong>
    For linear operators describing products etc. of other linear
    operators, the operands of the binary operation.</p>
</li>
<li>
<p><strong>ndim : int</strong>
    Number of dimensions (this is always 2)</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>aslinearoperator : Construct LinearOperators</strong></li>
</ul>
<h4>Notes</h4>
<p>The user-defined matvec() function must properly handle the case
where v has shape (N,) as well as the (N,1) case.  The shape of
the return type is handled internally by LinearOperator.</p>
<p>LinearOperator instances can also be multiplied, added with each
other and exponentiated, all lazily: the result of these operations
is always a new, composite LinearOperator, that defers linear
operations to the original operators and combines the results.</p>
<p>More details regarding how to subclass a LinearOperator and several
examples of concrete LinearOperator instances can be found in the
external project <code>PyLops &lt;https://pylops.readthedocs.io&gt;</code>_.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">LinearOperator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">mv</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">matvec</span><span class="o">=</span><span class="n">mv</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">x2</span> <span class="n">_CustomLinearOperator</span> <span class="k">with</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">matvec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="adjoint_1">adjoint<a class="headerlink" href="#adjoint_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method adjoint</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">adjoint</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Hermitian adjoint.</p>
<p>Returns the Hermitian adjoint of self, aka the Hermitian
conjugate or Hermitian transpose. For a complex matrix, the
Hermitian adjoint is equal to the conjugate transpose.</p>
<p>Can be abbreviated self.H instead of self.adjoint().</p>
<h4>Returns</h4>
<ul>
<li><strong>A_H : LinearOperator</strong>
    Hermitian adjoint of self.</li>
</ul>
</details>
<h3 id="dot_4">dot<a class="headerlink" href="#dot_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix-matrix or matrix-vector multiplication.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-d or 2-d array, representing a vector or matrix.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Ax : array</strong>
    1-d or 2-d array (depending on the shape of x) that represents
    the result of applying this linear operator on x.</li>
</ul>
</details>
<h3 id="matmat_1">matmat<a class="headerlink" href="#matmat_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matmat</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matmat</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix-matrix multiplication.</p>
<p>Performs the operation y=A<em>X where A is an MxN linear
operator and X dense N</em>K matrix or ndarray.</p>
<h4>Parameters</h4>
<ul>
<li><strong>X : {matrix, ndarray}</strong>
    An array with shape (N,K).</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Y : {matrix, ndarray}</strong>
    A matrix or ndarray with shape (M,K) depending on
    the type of the X argument.</li>
</ul>
<h4>Notes</h4>
<p>This matmat wraps any user-specified matmat routine or overridden
_matmat method to ensure that y has the correct type.</p>
</details>
<h3 id="matvec_1">matvec<a class="headerlink" href="#matvec_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix-vector multiplication.</p>
<p>Performs the operation y=A*x where A is an MxN linear
operator and x is a column vector or 1-d array.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : {matrix, ndarray}</strong>
    An array with shape (N,) or (N,1).</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : {matrix, ndarray}</strong>
    A matrix or ndarray with shape (M,) or (M,1) depending
    on the type and shape of the x argument.</li>
</ul>
<h4>Notes</h4>
<p>This matvec wraps the user-specified matvec routine or overridden
_matvec method to ensure that y has the correct shape and type.</p>
</details>
<h3 id="rmatmat_1">rmatmat<a class="headerlink" href="#rmatmat_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatmat</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatmat</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Adjoint matrix-matrix multiplication.</p>
<p>Performs the operation y = A^H * x where A is an MxN linear
operator and x is a column vector or 1-d array, or 2-d array.
The default implementation defers to the adjoint.</p>
<h4>Parameters</h4>
<ul>
<li><strong>X : {matrix, ndarray}</strong>
    A matrix or 2D array.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>Y : {matrix, ndarray}</strong>
    A matrix or 2D array depending on the type of the input.</li>
</ul>
<h4>Notes</h4>
<p>This rmatmat wraps the user-specified rmatmat routine.</p>
</details>
<h3 id="rmatvec_1">rmatvec<a class="headerlink" href="#rmatvec_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Adjoint matrix-vector multiplication.</p>
<p>Performs the operation y = A^H * x where A is an MxN linear
operator and x is a column vector or 1-d array.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : {matrix, ndarray}</strong>
    An array with shape (M,) or (M,1).</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : {matrix, ndarray}</strong>
    A matrix or ndarray with shape (N,) or (N,1) depending
    on the type and shape of the x argument.</li>
</ul>
<h4>Notes</h4>
<p>This rmatvec wraps the user-specified rmatvec routine or overridden
_rmatvec method to ensure that y has the correct shape and type.</p>
</details>
<h3 id="transpose_1">transpose<a class="headerlink" href="#transpose_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method transpose</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">transpose</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Transpose this linear operator.</p>
<p>Returns a LinearOperator that represents the transpose of this one.
Can be abbreviated self.T instead of self.transpose().</p>
</details>
<h3 id="args">args<a class="headerlink" href="#args" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute args</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">args</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">args_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="ndim">ndim<a class="headerlink" href="#ndim" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute ndim</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">ndim</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">ndim_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="to_string_11">to_string<a class="headerlink" href="#to_string_11" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_11">show<a class="headerlink" href="#show_11" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_11">pp<a class="headerlink" href="#pp_11" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="memoizejac">MemoizeJac<a class="headerlink" href="#memoizejac" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Lbfgsb.​MemoizeJac</code> wraps Python class <code>scipy.optimize.lbfgsb.MemoizeJac</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_10">create<a class="headerlink" href="#create_10" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Decorator that caches the return values of a function returning <code>(fun, grad)</code>
each time it is called. </p>
</details>
<h3 id="derivative">derivative<a class="headerlink" href="#derivative" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method derivative</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">derivative</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_12">to_string<a class="headerlink" href="#to_string_12" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_12">show<a class="headerlink" href="#show_12" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_12">pp<a class="headerlink" href="#pp_12" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="float64">Float64<a class="headerlink" href="#float64" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Lbfgsb.​Float64</code> wraps Python class <code>scipy.optimize.lbfgsb.float64</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_11">create<a class="headerlink" href="#create_11" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Double-precision floating-point number type, compatible with Python <code>float</code>
and C <code>double</code>.
Character code: <code>'d'</code>.
Canonical name: <code>np.double</code>.</p>
<ul>
<li><strong>Alias: <code>np.float_</code>.</strong>
Alias <em>on this platform</em>: <code>np.float64</code>: 64-bit precision floating-point number type: sign bit, 11 bits exponent, 52 bits mantissa.</li>
</ul>
</details>
<h3 id="getitem"><strong>getitem</strong><a class="headerlink" href="#getitem" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method <strong>getitem</strong></summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="o">__</span><span class="n">getitem__</span> <span class="o">:</span>
  <span class="n">key</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return self[key].</p>
</details>
<h3 id="fromhex">fromhex<a class="headerlink" href="#fromhex" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method fromhex</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fromhex</span> <span class="o">:</span>
  <span class="kt">string</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Create a floating-point number from a hexadecimal string.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">float</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;0x1.ffffp10&#39;</span><span class="p">)</span>
<span class="mf">2047.984375</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">float</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;-0x1p-1074&#39;</span><span class="p">)</span>
<span class="o">-</span><span class="mf">5e-324</span>
</code></pre></div>

</details>
<h3 id="hex">hex<a class="headerlink" href="#hex" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method hex</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">hex</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a hexadecimal representation of a floating-point number.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
<span class="s1">&#39;-0x1.999999999999ap-4&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mf">3.14159</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
<span class="s1">&#39;0x1.921f9f01b866ep+1&#39;</span>
</code></pre></div>

</details>
<h3 id="is_integer">is_integer<a class="headerlink" href="#is_integer" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method is_integer</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_integer</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return True if the float is an integer.</p>
</details>
<h3 id="newbyteorder">newbyteorder<a class="headerlink" href="#newbyteorder" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method newbyteorder</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">newbyteorder</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">new_order</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>newbyteorder(new_order='S')</p>
<p>Return a new <code>dtype</code> with a different byte order.</p>
<p>Changes are also made in all fields and sub-arrays of the data type.</p>
<p>The <code>new_order</code> code can be any from the following:</p>
<ul>
<li>'S' - swap dtype from current to opposite endian</li>
<li>{'&lt;', 'L'} - little endian</li>
<li>{'&gt;', 'B'} - big endian</li>
<li>{'=', 'N'} - native order</li>
<li>{'|', 'I'} - ignore (no change to byte order)</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><strong>new_order : str, optional</strong>
    Byte order to force; a value from the byte order specifications
    above.  The default value ('S') results in swapping the current
    byte order. The code does a case-insensitive check on the first
    letter of <code>new_order</code> for the alternatives above.  For example,
    any of 'B' or 'b' or 'biggish' are valid to specify big-endian.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>new_dtype : dtype</strong>
    New <code>dtype</code> object with the given change to the byte order.</li>
</ul>
</details>
<h3 id="to_string_13">to_string<a class="headerlink" href="#to_string_13" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_13">show<a class="headerlink" href="#show_13" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_13">pp<a class="headerlink" href="#pp_13" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="array">array<a class="headerlink" href="#array" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function array</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="kt">array</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">copy</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">K</span> <span class="o">|</span> <span class="o">`</span><span class="nc">A</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">subok</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ndmin</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">object_</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>array(object, dtype=None, *, copy=True, order='K', subok=False, ndmin=0)</p>
<p>Create an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>object : array_like</strong>
    An array, any object exposing the array interface, an object whose
    <strong>array</strong> method returns an array, or any (nested) sequence.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array.  If not given, then the type will
    be determined as the minimum type required to hold the objects in the
    sequence.</p>
</li>
<li>
<p><strong>copy : bool, optional</strong>
    If true (default), then the object is copied.  Otherwise, a copy will
    only be made if <strong>array</strong> returns a copy, if obj is a nested sequence,
    or if a copy is needed to satisfy any of the other requirements
    (<code>dtype</code>, <code>order</code>, etc.).</p>
</li>
<li>
<p><strong>order : {'K', 'A', 'C', 'F'}, optional</strong>
    Specify the memory layout of the array. If object is not an array, the
    newly created array will be in C order (row major) unless 'F' is
    specified, in which case it will be in Fortran order (column major).
    If object is an array the following holds.</p>
<p>===== ========= ===================================================
order  no copy                     copy=True
===== ========= ===================================================
'K'   unchanged F &amp; C order preserved, otherwise most similar order
'A'   unchanged F order if input is F and not C, otherwise C order
'C'   C order   C order
'F'   F order   F order
===== ========= ===================================================</p>
<p>When <code>copy=False</code> and a copy is made for other reasons, the result is
the same as if <code>copy=True</code>, with some exceptions for <code>A</code>, see the
Notes section. The default order is 'K'.</p>
</li>
<li>
<p><strong>subok : bool, optional</strong>
    If True, then sub-classes will be passed-through, otherwise
    the returned array will be forced to be a base-class array (default).</p>
</li>
<li>
<p><strong>ndmin : int, optional</strong>
    Specifies the minimum number of dimensions that the resulting
    array should have.  Ones will be pre-pended to the shape as
    needed to meet this requirement.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    An array object satisfying the specified requirements.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>empty_like : Return an empty array with shape and type of input.</strong></p>
</li>
<li>
<p><strong>ones_like : Return an array of ones with shape and type of input.</strong></p>
</li>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>full_like : Return a new array with shape of input filled with value.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>zeros : Return a new array setting values to zero.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>When order is 'A' and <code>object</code> is an array in neither 'C' nor 'F' order,
and a copy is forced by a change in dtype, then the order of the result is
not necessarily 'C' as expected. This is likely a bug.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>

<p>Upcasting:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

<p>More than one dimension:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<p>Minimum dimensions 2:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</code></pre></div>

<p>Type provided:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">2.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">3.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">])</span>
</code></pre></div>

<p>Data-type consisting of more than one element:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">),(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>

<p>Creating an array from sub-classes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">),</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="asarray">asarray<a class="headerlink" href="#asarray" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">F</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the input to an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input data, in any form that can be converted to an array.  This
    includes lists, lists of tuples, tuples, tuples of tuples, tuples
    of lists and ndarrays.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    By default, the data-type is inferred from the input data.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional</strong>
    Whether to use row-major (C-style) or
    column-major (Fortran-style) memory representation.
    Defaults to 'C'.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array interpretation of <code>a</code>.  No copy is performed if the input
    is already an ndarray with matching dtype and order.  If <code>a</code> is a
    subclass of ndarray, a base class ndarray is returned.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>asanyarray : Similar function which passes through subclasses.</strong></p>
</li>
<li>
<p><strong>ascontiguousarray : Convert input to a contiguous array.</strong></p>
</li>
<li>
<p><strong>asfarray : Convert input to a floating point ndarray.</strong></p>
</li>
<li>
<p><strong>asfortranarray : Convert input to an ndarray with column-major</strong>
                 memory order.</p>
</li>
<li>
<p><strong>asarray_chkfinite : Similar function which checks input for NaNs and Infs.</strong></p>
</li>
<li>
<p><strong>fromiter : Create an array from an iterator.</strong></p>
</li>
<li>
<p><strong>fromfunction : Construct an array by executing a function on grid</strong>
               positions.</p>
</li>
</ul>
<h4>Examples</h4>
<p>Convert a list into an array:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div>

<p>Existing arrays are not copied:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

<p>If <code>dtype</code> is set, array is copied only if dtype does not match:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
</code></pre></div>

<p>Contrary to <code>asanyarray</code>, ndarray subclasses are not passed through:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4,i4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="fmin_l_bfgs_b">fmin_l_bfgs_b<a class="headerlink" href="#fmin_l_bfgs_b" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_l_bfgs_b</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_l_bfgs_b</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">approx_grad</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">factr</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">pgtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iprint</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxls</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function func using the L-BFGS-B algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Function to minimize.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>fprime : callable fprime(x,*args), optional</strong>
    The gradient of <code>func</code>. If None, then <code>func</code> returns the function
    value and the gradient (<code>f, g = func(x, *args)</code>), unless
    <code>approx_grad</code> is True in which case <code>func</code> returns only <code>f</code>.</p>
</li>
<li>
<p><strong>args : sequence, optional</strong>
    Arguments to pass to <code>func</code> and <code>fprime</code>.</p>
</li>
<li>
<p><strong>approx_grad : bool, optional</strong>
    Whether to approximate the gradient numerically (in which case
    <code>func</code> returns only the function value).</p>
</li>
<li>
<p><strong>bounds : list, optional</strong>
    <code>(min, max)</code> pairs for each element in <code>x</code>, defining
    the bounds on that parameter. Use None or +-inf for one of <code>min</code> or
    <code>max</code> when there is no bound in that direction.</p>
</li>
<li>
<p><strong>m : int, optional</strong>
    The maximum number of variable metric corrections
    used to define the limited memory matrix. (The limited memory BFGS
    method does not store the full hessian but uses this many terms in an
    approximation to it.)</p>
</li>
<li>
<p><strong>factr : float, optional</strong>
    The iteration stops when
    <code>(f^k - f^{k+1})/max{ |f^k|,|f^{k+1}|,1} &lt;= factr * eps</code>,
    where <code>eps</code> is the machine precision, which is automatically
    generated by the code. Typical values for <code>factr</code> are: 1e12 for
    low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
    high accuracy. See Notes for relationship to <code>ftol</code>, which is exposed
    (instead of <code>factr</code>) by the <code>scipy.optimize.minimize</code> interface to
    L-BFGS-B.</p>
</li>
<li>
<p><strong>pgtol : float, optional</strong>
    The iteration will stop when
    <code>max{ |proj g_i | i = 1, ..., n} &lt;= pgtol</code>
    where <code>pg_i</code> is the i-th component of the projected gradient.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    Step size used when <code>approx_grad</code> is True, for numerically
    calculating the gradient</p>
</li>
<li>
<p><strong>iprint : int, optional</strong>
    Controls the frequency of output. <code>iprint &lt; 0</code> means no output;
    <code>iprint = 0</code>    print only one line at the last iteration;
    <code>0 &lt; iprint &lt; 99</code> print also f and <code>|proj g|</code> every iprint iterations;
    <code>iprint = 99</code>   print details of every iteration except n-vectors;
    <code>iprint = 100</code>  print also the changes of active set and final x;
    <code>iprint &gt; 100</code>  print details of every iteration including x and g.</p>
</li>
<li>
<p><strong>disp : int, optional</strong>
    If zero, then no output. If a positive number, then this over-rides
    <code>iprint</code> (i.e., <code>iprint</code> gets the value of <code>disp</code>).</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as <code>callback(xk)</code>, where <code>xk</code> is the
    current parameter vector.</p>
</li>
<li>
<p><strong>maxls : int, optional</strong>
    Maximum number of line search steps (per iteration). Default is 20.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    Estimated position of the minimum.</p>
</li>
<li>
<p><strong>f : float</strong>
    Value of <code>func</code> at the minimum.</p>
</li>
<li>
<p><strong>d : dict</strong>
    Information dictionary.</p>
<ul>
<li>
<p>d['warnflag'] is</p>
</li>
<li>
<p>0 if converged,</p>
</li>
<li>1 if too many function evaluations or too many iterations,</li>
<li>
<p>2 if stopped for another reason, given in d['task']</p>
</li>
<li>
<p>d['grad'] is the gradient at the minimum (should be 0 ish)</p>
</li>
<li>d['funcalls'] is the number of function calls made.</li>
<li>d['nit'] is the number of iterations.</li>
</ul>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'L-BFGS-B' <code>method</code> in particular. Note that the
    <code>ftol</code> option is made available via that interface, while <code>factr</code> is
    provided via this interface, where <code>factr</code> is the factor multiplying
    the default machine floating-point precision to arrive at <code>ftol</code>:
    <code>ftol = factr * numpy.finfo(float).eps</code>.</li>
</ul>
<h4>Notes</h4>
<p>License of L-BFGS-B (FORTRAN code):</p>
<p>The version included here (in fortran code) is 3.0
(released April 25, 2011). It was written by Ciyou Zhu, Richard Byrd,
and Jorge Nocedal <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#99;&#101;&#100;&#97;&#108;&#64;&#101;&#99;&#101;&#46;&#110;&#119;&#117;&#46;&#101;&#100;&#117;">&#110;&#111;&#99;&#101;&#100;&#97;&#108;&#64;&#101;&#99;&#101;&#46;&#110;&#119;&#117;&#46;&#101;&#100;&#117;</a>. It carries the following
condition for use:</p>
<p>This software is freely available, but we expect that all publications
describing work using this software, or all commercial products using it,
quote at least one of the references given below. This software is released
under the BSD License.</p>
<h4>References</h4>
<ul>
<li>R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
  Constrained Optimization, (1995), SIAM Journal on Scientific and
  Statistical Computing, 16, 5, pp. 1190-1208.</li>
<li>C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
  FORTRAN routines for large scale bound constrained optimization (1997),
  ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.</li>
<li>J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,
  FORTRAN routines for large scale bound constrained optimization (2011),
  ACM Transactions on Mathematical Software, 38, 1.</li>
</ul>
</details>
<h3 id="old_bound_to_new">old_bound_to_new<a class="headerlink" href="#old_bound_to_new" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function old_bound_to_new</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">old_bound_to_new</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the old bounds representation to the new one.</p>
<p>The new representation is a tuple (lb, ub) and the old one is a list
containing n tuples, ith containing lower and upper bound on a ith
variable.
If any of the entries in lb/ub are None they are replaced by
-np.inf/np.inf.</p>
</details>
<h3 id="zeros">zeros<a class="headerlink" href="#zeros" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function zeros</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">zeros</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">shape</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>zeros(shape, dtype=float, order='C')</p>
<p>Return a new array of given shape and type, filled with zeros.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>shape : int or tuple of ints</strong>
    Shape of the new array, e.g., <code>(2, 3)</code> or <code>2</code>.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array, e.g., <code>numpy.int8</code>.  Default is
    <code>numpy.float64</code>.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional, default: 'C'</strong>
    Whether to store multi-dimensional data in row-major
    (C-style) or column-major (Fortran-style) order in
    memory.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array of zeros with the given shape, dtype, and order.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span> <span class="c1"># custom dtype</span>
<span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
</code></pre></div>

</details>
<h2 id="linesearch">Linesearch<a class="headerlink" href="#linesearch" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Linesearch</code> wraps Python module <code>scipy.optimize.linesearch</code>.</p>
<h2 id="linesearchwarning">LineSearchWarning<a class="headerlink" href="#linesearchwarning" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Linesearch.​LineSearchWarning</code> wraps Python class <code>scipy.optimize.linesearch.LineSearchWarning</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback_1">with_traceback<a class="headerlink" href="#with_traceback_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method with_traceback</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_14">to_string<a class="headerlink" href="#to_string_14" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_14">show<a class="headerlink" href="#show_14" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_14">pp<a class="headerlink" href="#pp_14" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="line_search">line_search<a class="headerlink" href="#line_search" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>As <code>scalar_search_wolfe1</code> but do a line search to direction <code>pk</code></p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    Function <code>f(x)</code></p>
</li>
<li>
<p><strong>fprime : callable</strong>
    Gradient of <code>f</code></p>
</li>
<li>
<p><strong>xk : array_like</strong>
    Current point</p>
</li>
<li>
<p><strong>pk : array_like</strong>
    Search direction</p>
</li>
<li>
<p><strong>gfk : array_like, optional</strong>
    Gradient of <code>f</code> at point <code>xk</code></p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Value of <code>f</code> at point <code>xk</code></p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Value of <code>f</code> at point preceding <code>xk</code></p>
</li>
</ul>
<p>The rest of the parameters are the same as for <code>scalar_search_wolfe1</code>.</p>
<h4>Returns</h4>
<p>stp, f_count, g_count, fval, old_fval
    As in <code>line_search_wolfe1</code></p>
<ul>
<li><strong>gval : array</strong>
    Gradient of <code>f</code> at the final point</li>
</ul>
</details>
<h3 id="line_search_bfgs">line_search_BFGS<a class="headerlink" href="#line_search_bfgs" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search_BFGS</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search_BFGS</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">gfk</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">old_fval</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compatibility wrapper for <code>line_search_armijo</code></p>
</details>
<h3 id="line_search_armijo">line_search_armijo<a class="headerlink" href="#line_search_armijo" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search_armijo</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search_armijo</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimize over alpha, the function <code>f(xk+alpha pk)</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    Function to be minimized.</p>
</li>
<li>
<p><strong>xk : array_like</strong>
    Current point.</p>
</li>
<li>
<p><strong>pk : array_like</strong>
    Search direction.</p>
</li>
<li>
<p><strong>gfk : array_like</strong>
    Gradient of <code>f</code> at point <code>xk</code>.</p>
</li>
<li>
<p><strong>old_fval : float</strong>
    Value of <code>f</code> at point <code>xk</code>.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Optional arguments.</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Value to control stopping criterion.</p>
</li>
<li>
<p><strong>alpha0 : scalar, optional</strong>
    Value of <code>alpha</code> at start of the optimization.</p>
</li>
</ul>
<h4>Returns</h4>
<p>alpha
f_count
f_val_at_alpha</p>
<h4>Notes</h4>
<p>Uses the interpolation algorithm (Armijo backtracking) as suggested by
Wright and Nocedal in 'Numerical Optimization', 1999, pp. 56-57</p>
</details>
<h3 id="line_search_wolfe1">line_search_wolfe1<a class="headerlink" href="#line_search_wolfe1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search_wolfe1</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search_wolfe1</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>As <code>scalar_search_wolfe1</code> but do a line search to direction <code>pk</code></p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    Function <code>f(x)</code></p>
</li>
<li>
<p><strong>fprime : callable</strong>
    Gradient of <code>f</code></p>
</li>
<li>
<p><strong>xk : array_like</strong>
    Current point</p>
</li>
<li>
<p><strong>pk : array_like</strong>
    Search direction</p>
</li>
<li>
<p><strong>gfk : array_like, optional</strong>
    Gradient of <code>f</code> at point <code>xk</code></p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Value of <code>f</code> at point <code>xk</code></p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Value of <code>f</code> at point preceding <code>xk</code></p>
</li>
</ul>
<p>The rest of the parameters are the same as for <code>scalar_search_wolfe1</code>.</p>
<h4>Returns</h4>
<p>stp, f_count, g_count, fval, old_fval
    As in <code>line_search_wolfe1</code></p>
<ul>
<li><strong>gval : array</strong>
    Gradient of <code>f</code> at the final point</li>
</ul>
</details>
<h3 id="line_search_wolfe2">line_search_wolfe2<a class="headerlink" href="#line_search_wolfe2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search_wolfe2</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search_wolfe2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">extra_condition</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">myfprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span><span class="o">)</span>
</code></pre></div>

<p>Find alpha that satisfies strong Wolfe conditions.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable f(x,*args)</strong>
    Objective function.</p>
</li>
<li>
<p><strong>myfprime : callable f'(x,*args)</strong>
    Objective function gradient.</p>
</li>
<li>
<p><strong>xk : ndarray</strong>
    Starting point.</p>
</li>
<li>
<p><strong>pk : ndarray</strong>
    Search direction.</p>
</li>
<li>
<p><strong>gfk : ndarray, optional</strong>
    Gradient value for x=xk (xk being the current parameter
    estimate). Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Function value for x=xk. Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Function value for the point preceding x=xk.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments passed to objective function.</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.</p>
</li>
<li>
<p><strong>amax : float, optional</strong>
    Maximum step size</p>
</li>
<li>
<p><strong>extra_condition : callable, optional</strong>
    A callable of the form <code>extra_condition(alpha, x, f, g)</code>
    returning a boolean. Arguments are the proposed step <code>alpha</code>
    and the corresponding <code>x</code>, <code>f</code> and <code>g</code> values. The line search
    accepts the value of <code>alpha</code> only if this
    callable returns <code>True</code>. If the callable returns <code>False</code>
    for the step length, the algorithm will continue with
    new iterates. The callable is only called for iterates
    satisfying the strong Wolfe conditions.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha : float or None</strong>
    Alpha for which <code>x_new = x0 + alpha * pk</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>fc : int</strong>
    Number of function evaluations made.</p>
</li>
<li>
<p><strong>gc : int</strong>
    Number of gradient evaluations made.</p>
</li>
<li>
<p><strong>new_fval : float or None</strong>
    New function value <code>f(x_new)=f(x0+alpha*pk)</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>old_fval : float</strong>
    Old function value <code>f(x0)</code>.</p>
</li>
<li>
<p><strong>new_slope : float or None</strong>
    The local slope along the search direction at the
    new value <code>&lt;myfprime(x_new), pk&gt;</code>,
    or None if the line search algorithm did not converge.</p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses the line search algorithm to enforce strong Wolfe
conditions. See Wright and Nocedal, 'Numerical Optimization',
1999, pp. 59-61.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">line_search</span>
</code></pre></div>

<p>A objective function and its gradient are defined.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

<p>We can find alpha that satisfies strong Wolfe conditions.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">start_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">search_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">line_search</span><span class="p">(</span><span class="n">obj_func</span><span class="p">,</span> <span class="n">obj_grad</span><span class="p">,</span> <span class="n">start_point</span><span class="p">,</span> <span class="n">search_gradient</span><span class="p">)</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1300000000000001</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="scalar_search_armijo">scalar_search_armijo<a class="headerlink" href="#scalar_search_armijo" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function scalar_search_armijo</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">scalar_search_armijo</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">phi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">phi0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">derphi0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimize over alpha, the function <code>phi(alpha)</code>.</p>
<p>Uses the interpolation algorithm (Armijo backtracking) as suggested by
Wright and Nocedal in 'Numerical Optimization', 1999, pp. 56-57</p>
<p>alpha &gt; 0 is assumed to be a descent direction.</p>
<h4>Returns</h4>
<p>alpha
phi1</p>
</details>
<h3 id="scalar_search_wolfe1">scalar_search_wolfe1<a class="headerlink" href="#scalar_search_wolfe1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function scalar_search_wolfe1</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">scalar_search_wolfe1</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">phi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_phi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">derphi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="n">phi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">derphi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span><span class="o">)</span>
</code></pre></div>

<p>Scalar function search for alpha that satisfies strong Wolfe conditions</p>
<p>alpha &gt; 0 is assumed to be a descent direction.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>phi : callable phi(alpha)</strong>
    Function at point <code>alpha</code></p>
</li>
<li>
<p><strong>derphi : callable phi'(alpha)</strong>
    Objective function derivative. Returns a scalar.</p>
</li>
<li>
<p><strong>phi0 : float, optional</strong>
    Value of phi at 0</p>
</li>
<li>
<p><strong>old_phi0 : float, optional</strong>
    Value of phi at previous point</p>
</li>
<li>
<p><strong>derphi0 : float, optional</strong>
    Value derphi at 0</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.
amax, amin : float, optional
    Maximum and minimum step size</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Relative tolerance for an acceptable step.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha : float</strong>
    Step size, or None if no suitable step was found</p>
</li>
<li>
<p><strong>phi : float</strong>
    Value of <code>phi</code> at the new point <code>alpha</code></p>
</li>
<li>
<p><strong>phi0 : float</strong>
    Value of <code>phi</code> at <code>alpha=0</code></p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses routine DCSRCH from MINPACK.</p>
</details>
<h3 id="scalar_search_wolfe2">scalar_search_wolfe2<a class="headerlink" href="#scalar_search_wolfe2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function scalar_search_wolfe2</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">scalar_search_wolfe2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">phi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_phi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">derphi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">extra_condition</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">phi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">derphi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span><span class="o">)</span>
</code></pre></div>

<p>Find alpha that satisfies strong Wolfe conditions.</p>
<p>alpha &gt; 0 is assumed to be a descent direction.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>phi : callable phi(alpha)</strong>
    Objective scalar function.</p>
</li>
<li>
<p><strong>derphi : callable phi'(alpha)</strong>
    Objective function derivative. Returns a scalar.</p>
</li>
<li>
<p><strong>phi0 : float, optional</strong>
    Value of phi at 0.</p>
</li>
<li>
<p><strong>old_phi0 : float, optional</strong>
    Value of phi at previous point.</p>
</li>
<li>
<p><strong>derphi0 : float, optional</strong>
    Value of derphi at 0</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.</p>
</li>
<li>
<p><strong>amax : float, optional</strong>
    Maximum step size.</p>
</li>
<li>
<p><strong>extra_condition : callable, optional</strong>
    A callable of the form <code>extra_condition(alpha, phi_value)</code>
    returning a boolean. The line search accepts the value
    of <code>alpha</code> only if this callable returns <code>True</code>.
    If the callable returns <code>False</code> for the step length,
    the algorithm will continue with new iterates.
    The callable is only called for iterates satisfying
    the strong Wolfe conditions.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha_star : float or None</strong>
    Best alpha, or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>phi_star : float</strong>
    phi at alpha_star.</p>
</li>
<li>
<p><strong>phi0 : float</strong>
    phi at 0.</p>
</li>
<li>
<p><strong>derphi_star : float or None</strong>
    derphi at alpha_star, or None if the line search algorithm
    did not converge.</p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses the line search algorithm to enforce strong Wolfe
conditions. See Wright and Nocedal, 'Numerical Optimization',
1999, pp. 59-61.</p>
</details>
<h3 id="warn">warn<a class="headerlink" href="#warn" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function warn</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">warn</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">category</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">stacklevel</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">source</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">message</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Issue a warning, or maybe ignore it or raise an exception.</p>
</details>
<h2 id="minpack">Minpack<a class="headerlink" href="#minpack" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Minpack</code> wraps Python module <code>scipy.optimize.minpack</code>.</p>
<h2 id="error">Error<a class="headerlink" href="#error" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Minpack.​Error</code> wraps Python class <code>scipy.optimize.minpack.error</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback_2">with_traceback<a class="headerlink" href="#with_traceback_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method with_traceback</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_15">to_string<a class="headerlink" href="#to_string_15" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_15">show<a class="headerlink" href="#show_15" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_15">pp<a class="headerlink" href="#pp_15" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="finfo">Finfo<a class="headerlink" href="#finfo" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Minpack.​Finfo</code> wraps Python class <code>scipy.optimize.minpack.finfo</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_12">create<a class="headerlink" href="#create_12" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dtype</span> <span class="k">of</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Instance</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>finfo(dtype)</p>
<p>Machine limits for floating point types.</p>
<h4>Attributes</h4>
<ul>
<li>
<p><strong>bits : int</strong>
    The number of bits occupied by the type.</p>
</li>
<li>
<p><strong>eps : float</strong>
    The difference between 1.0 and the next smallest representable float
    larger than 1.0. For example, for 64-bit binary floats in the IEEE-754
    standard, <code>eps = 2**-52</code>, approximately 2.22e-16.</p>
</li>
<li>
<p><strong>epsneg : float</strong>
    The difference between 1.0 and the next smallest representable float
    less than 1.0. For example, for 64-bit binary floats in the IEEE-754
    standard, <code>epsneg = 2**-53</code>, approximately 1.11e-16.</p>
</li>
<li>
<p><strong>iexp : int</strong>
    The number of bits in the exponent portion of the floating point
    representation.</p>
</li>
<li>
<p><strong>machar : MachAr</strong>
    The object which calculated these parameters and holds more
    detailed information.</p>
</li>
<li>
<p><strong>machep : int</strong>
    The exponent that yields <code>eps</code>.</p>
</li>
<li>
<p><strong>max : floating point number of the appropriate type</strong>
    The largest representable number.</p>
</li>
<li>
<p><strong>maxexp : int</strong>
    The smallest positive power of the base (2) that causes overflow.</p>
</li>
<li>
<p><strong>min : floating point number of the appropriate type</strong>
    The smallest representable number, typically <code>-max</code>.</p>
</li>
<li>
<p><strong>minexp : int</strong>
    The most negative power of the base (2) consistent with there
    being no leading 0's in the mantissa.</p>
</li>
<li>
<p><strong>negep : int</strong>
    The exponent that yields <code>epsneg</code>.</p>
</li>
<li>
<p><strong>nexp : int</strong>
    The number of bits in the exponent including its sign and bias.</p>
</li>
<li>
<p><strong>nmant : int</strong>
    The number of bits in the mantissa.</p>
</li>
<li>
<p><strong>precision : int</strong>
    The approximate number of decimal digits to which this kind of
    float is precise.</p>
</li>
<li>
<p><strong>resolution : floating point number of the appropriate type</strong>
    The approximate decimal resolution of this type, i.e.,
    <code>10**-precision</code>.</p>
</li>
<li>
<p><strong>tiny : float</strong>
    The smallest positive usable number.  Type of <code>tiny</code> is an
    appropriate floating point type.</p>
</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><strong>dtype : float, dtype, or instance</strong>
    Kind of floating point data-type about which to get information.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>MachAr : The implementation of the tests that produce this information.</strong></p>
</li>
<li>
<p><strong>iinfo : The equivalent for integer data types.</strong></p>
</li>
<li>
<p><strong>spacing : The distance between a value and the nearest adjacent number</strong></p>
</li>
<li>
<p><strong>nextafter : The next floating point value after x1 towards x2</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>For developers of NumPy: do not instantiate this at the module level.
The initial calculation of these parameters is expensive and negatively
impacts import times.  These objects are cached, so calling <code>finfo()</code>
repeatedly inside your functions is not a problem.</p>
</details>
<h3 id="bits">bits<a class="headerlink" href="#bits" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute bits</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">bits</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">bits_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="eps">eps<a class="headerlink" href="#eps" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute eps</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">eps</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">eps_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="epsneg">epsneg<a class="headerlink" href="#epsneg" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute epsneg</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">epsneg</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">epsneg_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="iexp">iexp<a class="headerlink" href="#iexp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute iexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">iexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">iexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="machar">machar<a class="headerlink" href="#machar" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute machar</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">machar</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">machar_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="machep">machep<a class="headerlink" href="#machep" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute machep</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">machep</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">machep_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="max">max<a class="headerlink" href="#max" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute max</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">max</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">max_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="maxexp">maxexp<a class="headerlink" href="#maxexp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute maxexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">maxexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="min">min<a class="headerlink" href="#min" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute min</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">min</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">min_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="minexp">minexp<a class="headerlink" href="#minexp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute minexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">minexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">minexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="negep">negep<a class="headerlink" href="#negep" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute negep</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">negep</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">negep_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="nexp">nexp<a class="headerlink" href="#nexp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute nexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">nexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="nmant">nmant<a class="headerlink" href="#nmant" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute nmant</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nmant</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">nmant_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="precision">precision<a class="headerlink" href="#precision" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute precision</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">precision</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">precision_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="resolution">resolution<a class="headerlink" href="#resolution" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute resolution</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">resolution</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">resolution_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="tiny">tiny<a class="headerlink" href="#tiny" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute tiny</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">tiny</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">tiny_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="to_string_16">to_string<a class="headerlink" href="#to_string_16" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_16">show<a class="headerlink" href="#show_16" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_16">pp<a class="headerlink" href="#pp_16" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="asarray_1">asarray<a class="headerlink" href="#asarray_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">F</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the input to an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input data, in any form that can be converted to an array.  This
    includes lists, lists of tuples, tuples, tuples of tuples, tuples
    of lists and ndarrays.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    By default, the data-type is inferred from the input data.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional</strong>
    Whether to use row-major (C-style) or
    column-major (Fortran-style) memory representation.
    Defaults to 'C'.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array interpretation of <code>a</code>.  No copy is performed if the input
    is already an ndarray with matching dtype and order.  If <code>a</code> is a
    subclass of ndarray, a base class ndarray is returned.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>asanyarray : Similar function which passes through subclasses.</strong></p>
</li>
<li>
<p><strong>ascontiguousarray : Convert input to a contiguous array.</strong></p>
</li>
<li>
<p><strong>asfarray : Convert input to a floating point ndarray.</strong></p>
</li>
<li>
<p><strong>asfortranarray : Convert input to an ndarray with column-major</strong>
                 memory order.</p>
</li>
<li>
<p><strong>asarray_chkfinite : Similar function which checks input for NaNs and Infs.</strong></p>
</li>
<li>
<p><strong>fromiter : Create an array from an iterator.</strong></p>
</li>
<li>
<p><strong>fromfunction : Construct an array by executing a function on grid</strong>
               positions.</p>
</li>
</ul>
<h4>Examples</h4>
<p>Convert a list into an array:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div>

<p>Existing arrays are not copied:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

<p>If <code>dtype</code> is set, array is copied only if dtype does not match:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
</code></pre></div>

<p>Contrary to <code>asanyarray</code>, ndarray subclasses are not passed through:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4,i4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="atleast_1d">atleast_1d<a class="headerlink" href="#atleast_1d" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function atleast_1d</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">atleast_1d</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert inputs to arrays with at least one dimension.</p>
<p>Scalar inputs are converted to 1-dimensional arrays, whilst
higher-dimensional inputs are preserved.</p>
<h4>Parameters</h4>
<p>arys1, arys2, ... : array_like
    One or more input arrays.</p>
<h4>Returns</h4>
<ul>
<li><strong>ret : ndarray</strong>
    An array, or list of arrays, each with <code>a.ndim &gt;= 1</code>.
    Copies are made only if necessary.</li>
</ul>
<h4>See Also</h4>
<p>atleast_2d, atleast_3d</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="n">x</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">[</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])]</span>
</code></pre></div>

</details>
<h3 id="check_gradient">check_gradient<a class="headerlink" href="#check_gradient" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function check_gradient</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">check_gradient</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">col_deriv</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fcn</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">dfcn</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform a simple check on the gradient for correctness.</p>
</details>
<h3 id="cholesky">cholesky<a class="headerlink" href="#cholesky" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function cholesky</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">cholesky</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">lower</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute the Cholesky decomposition of a matrix.</p>
<p>Returns the Cholesky decomposition, :math:<code>A = L L^*</code> or
:math:<code>A = U^* U</code> of a Hermitian positive-definite matrix A.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (M, M) array_like</strong>
    Matrix to be decomposed</p>
</li>
<li>
<p><strong>lower : bool, optional</strong>
    Whether to compute the upper- or lower-triangular Cholesky
    factorization.  Default is upper-triangular.</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Whether to overwrite data in <code>a</code> (may improve performance).</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>c : (M, M) ndarray</strong>
    Upper- or lower-triangular Cholesky factor of <code>a</code>.</li>
</ul>
<h4>Raises</h4>
<ul>
<li><strong>LinAlgError : if decomposition fails.</strong></li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">cholesky</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">],[</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">cholesky</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">L</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">2.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">@</span> <span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">-</span><span class="mf">2.</span><span class="n">j</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">2.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">5.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="curve_fit">curve_fit<a class="headerlink" href="#curve_fit" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function curve_fit</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">curve_fit</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">p0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">sigma</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">absolute_sigma</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Trf</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lm</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dogbox</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xdata</span><span class="o">:[`</span><span class="nc">PyObject</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">ydata</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Use non-linear least squares to fit a function, f, to data.</p>
<p>Assumes <code>ydata = f(xdata, *params) + eps</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    The model function, f(x, ...). It must take the independent
    variable as the first argument and the parameters to fit as
    separate remaining arguments.</p>
</li>
<li>
<p><strong>xdata : array_like or object</strong>
    The independent variable where the data is measured.
    Should usually be an M-length sequence or an (k,M)-shaped array for
    functions with k predictors, but can actually be any object.</p>
</li>
<li>
<p><strong>ydata : array_like</strong>
    The dependent data, a length M array - nominally <code>f(xdata, ...)</code>.</p>
</li>
<li>
<p><strong>p0 : array_like, optional</strong>
    Initial guess for the parameters (length N). If None, then the
    initial values will all be 1 (if the number of parameters for the
    function can be determined using introspection, otherwise a
    ValueError is raised).</p>
</li>
<li>
<p><strong>sigma : None or M-length sequence or MxM array, optional</strong>
    Determines the uncertainty in <code>ydata</code>. If we define residuals as
    <code>r = ydata - f(xdata, *popt)</code>, then the interpretation of <code>sigma</code>
    depends on its number of dimensions:</p>
<div class="codehilite"><pre><span></span><code>- A 1-D `sigma` should contain values of standard deviations of
  errors in `ydata`. In this case, the optimized function is
  ``chisq = sum((r / sigma) ** 2)``.

- A 2-D `sigma` should contain the covariance matrix of
  errors in `ydata`. In this case, the optimized function is
  ``chisq = r.T @ inv(sigma) @ r``.

  .. versionadded:: 0.19
</code></pre></div>


<p>None (default) is equivalent of 1-D <code>sigma</code> filled with ones.</p>
</li>
<li>
<p><strong>absolute_sigma : bool, optional</strong>
    If True, <code>sigma</code> is used in an absolute sense and the estimated parameter
    covariance <code>pcov</code> reflects these absolute values.</p>
<p>If False (default), only the relative magnitudes of the <code>sigma</code> values matter.
The returned parameter covariance matrix <code>pcov</code> is based on scaling
<code>sigma</code> by a constant factor. This constant is set by demanding that the
reduced <code>chisq</code> for the optimal parameters <code>popt</code> when using the
<em>scaled</em> <code>sigma</code> equals unity. In other words, <code>sigma</code> is scaled to
match the sample variance of the residuals after the fit. Default is False.
Mathematically,
<code>pcov(absolute_sigma=False) = pcov(absolute_sigma=True) * chisq(popt)/(M-N)</code></p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    If True, check that the input arrays do not contain nans of infs,
    and raise a ValueError if they do. Setting this parameter to
    False may silently produce nonsensical results if the input arrays
    do contain nans. Default is True.</p>
</li>
<li>
<p><strong>bounds : 2-tuple of array_like, optional</strong>
    Lower and upper bounds on parameters. Defaults to no bounds.
    Each element of the tuple must be either an array with the length equal
    to the number of parameters, or a scalar (in which case the bound is
    taken to be the same for all parameters). Use <code>np.inf</code> with an
    appropriate sign to disable bounds on all or some parameters.</p>
<p>.. versionadded:: 0.17</p>
</li>
<li>
<p><strong>method : {'lm', 'trf', 'dogbox'}, optional</strong>
    Method to use for optimization. See <code>least_squares</code> for more details.
    Default is 'lm' for unconstrained problems and 'trf' if <code>bounds</code> are
    provided. The method 'lm' won't work when the number of observations
    is less than the number of variables, use 'trf' or 'dogbox' in this
    case.</p>
<p>.. versionadded:: 0.17</p>
</li>
<li>
<p><strong>jac : callable, string or None, optional</strong>
    Function with signature <code>jac(x, ...)</code> which computes the Jacobian
    matrix of the model function with respect to parameters as a dense
    array_like structure. It will be scaled according to provided <code>sigma</code>.
    If None (default), the Jacobian will be estimated numerically.
    String keywords for 'trf' and 'dogbox' methods can be used to select
    a finite difference scheme, see <code>least_squares</code>.</p>
<p>.. versionadded:: 0.18
kwargs
Keyword arguments passed to <code>leastsq</code> for <code>method='lm'</code> or
<code>least_squares</code> otherwise.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>popt : array</strong>
    Optimal values for the parameters so that the sum of the squared
    residuals of <code>f(xdata, *popt) - ydata</code> is minimized.</p>
</li>
<li>
<p><strong>pcov : 2-D array</strong>
    The estimated covariance of popt. The diagonals provide the variance
    of the parameter estimate. To compute one standard deviation errors
    on the parameters use <code>perr = np.sqrt(np.diag(pcov))</code>.</p>
<p>How the <code>sigma</code> parameter affects the estimated covariance
depends on <code>absolute_sigma</code> argument, as described above.</p>
<p>If the Jacobian matrix at the solution doesn't have a full rank, then
'lm' method returns a matrix filled with <code>np.inf</code>, on the other hand
'trf'  and 'dogbox' methods use Moore-Penrose pseudoinverse to compute
the covariance matrix.</p>
</li>
</ul>
<h4>Raises</h4>
<p>ValueError
    if either <code>ydata</code> or <code>xdata</code> contain NaNs, or if incompatible options
    are used.</p>
<p>RuntimeError
    if the least-squares minimization fails.</p>
<p>OptimizeWarning
    if covariance of the parameters can not be estimated.</p>
<h4>See Also</h4>
<ul>
<li>
<p><strong>least_squares : Minimize the sum of squares of nonlinear functions.</strong></p>
</li>
<li>
<p><strong>scipy.stats.linregress : Calculate a linear least squares regression for</strong>
                         two sets of measurements.</p>
</li>
</ul>
<h4>Notes</h4>
<p>With <code>method='lm'</code>, the algorithm uses the Levenberg-Marquardt algorithm
through <code>leastsq</code>. Note that this algorithm can only deal with
unconstrained problems.</p>
<p>Box constraints can be handled by methods 'trf' and 'dogbox'. Refer to
the docstring of <code>least_squares</code> for more information.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</code></pre></div>

<p>Define the data to be fit with some noise:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1729</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_noise</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y_noise</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Fit for the parameters a, b, c of the function <code>func</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.55423706</span><span class="p">,</span>  <span class="mf">1.35190947</span><span class="p">,</span>  <span class="mf">0.47450618</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
<span class="o">...</span>          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit: a=</span><span class="si">%5.3f</span><span class="s1">, b=</span><span class="si">%5.3f</span><span class="s1">, c=</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">popt</span><span class="p">))</span>
</code></pre></div>

<p>Constrain the optimization to the region of <code>0 &lt;= a &lt;= 3</code>,
<code>0 &lt;= b &lt;= 1</code> and <code>0 &lt;= c &lt;= 0.5</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.43708906</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.35015434</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span>
<span class="o">...</span>          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit: a=</span><span class="si">%5.3f</span><span class="s1">, b=</span><span class="si">%5.3f</span><span class="s1">, c=</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">popt</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="dot_5">dot<a class="headerlink" href="#dot_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>dot(a, b, out=None)</p>
<p>Dot product of two arrays. Specifically,</p>
<ul>
<li>
<p>If both <code>a</code> and <code>b</code> are 1-D arrays, it is inner product of vectors
  (without complex conjugation).</p>
</li>
<li>
<p>If both <code>a</code> and <code>b</code> are 2-D arrays, it is matrix multiplication,
  but using :func:<code>matmul</code> or <code>a @ b</code> is preferred.</p>
</li>
<li>
<p>If either <code>a</code> or <code>b</code> is 0-D (scalar), it is equivalent to :func:<code>multiply</code>
  and using <code>numpy.multiply(a, b)</code> or <code>a * b</code> is preferred.</p>
</li>
<li>
<p>If <code>a</code> is an N-D array and <code>b</code> is a 1-D array, it is a sum product over
  the last axis of <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p>If <code>a</code> is an N-D array and <code>b</code> is an M-D array (where <code>M&gt;=2</code>), it is a
  sum product over the last axis of <code>a</code> and the second-to-last axis of <code>b</code>::</p>
<p>dot(a, b)[i,j,k,m] = sum(a[i,j,:] * b[k,:,m])</p>
</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    First argument.</p>
</li>
<li>
<p><strong>b : array_like</strong>
    Second argument.</p>
</li>
<li>
<p><strong>out : ndarray, optional</strong>
    Output argument. This must have the exact kind that would be returned
    if it was not used. In particular, it must have the right type, must be
    C-contiguous, and its dtype must be the dtype that would be returned
    for <code>dot(a,b)</code>. This is a performance feature. Therefore, if these
    conditions are not met, an exception is raised, instead of attempting
    to be flexible.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>output : ndarray</strong>
    Returns the dot product of <code>a</code> and <code>b</code>.  If <code>a</code> and <code>b</code> are both
    scalars or both 1-D arrays then a scalar is returned; otherwise
    an array is returned.
    If <code>out</code> is given, then it is returned.</li>
</ul>
<h4>Raises</h4>
<p>ValueError
    If the last dimension of <code>a</code> is not the same size as
    the second-to-last dimension of <code>b</code>.</p>
<h4>See Also</h4>
<ul>
<li>
<p><strong>vdot : Complex-conjugating dot product.</strong></p>
</li>
<li>
<p><strong>tensordot : Sum products over arbitrary axes.</strong></p>
</li>
<li>
<p><strong>einsum : Einstein summation convention.</strong></p>
</li>
<li>
<p><strong>matmul : '@' operator as method with out parameter.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">12</span>
</code></pre></div>

<p>Neither argument is complex-conjugated:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="n">j</span><span class="p">])</span>
<span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

<p>For 2-D arrays it is the matrix product:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="mi">499128</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,</span><span class="mi">2</span><span class="p">])</span>
<span class="mi">499128</span>
</code></pre></div>

</details>
<h3 id="eye">eye<a class="headerlink" href="#eye" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function eye</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">eye</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">n</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a 2-D array with ones on the diagonal and zeros elsewhere.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>N : int</strong>
  Number of rows in the output.</p>
</li>
<li>
<p><strong>M : int, optional</strong>
  Number of columns in the output. If None, defaults to <code>N</code>.</p>
</li>
<li>
<p><strong>k : int, optional</strong>
  Index of the diagonal: 0 (the default) refers to the main diagonal,
  a positive value refers to an upper diagonal, and a negative value
  to a lower diagonal.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
  Data-type of the returned array.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional</strong>
    Whether the output should be stored in row-major (C-style) or
    column-major (Fortran-style) order in memory.</p>
<p>.. versionadded:: 1.14.0</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>I : ndarray of shape (N,M)</strong>
  An array where all elements are equal to zero, except for the <code>k</code>-th
  diagonal, whose values are equal to one.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>identity : (almost) equivalent function</strong></p>
</li>
<li>
<p><strong>diag : diagonal 2-D array from a 1-D array specified by the user.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="fixed_point">fixed_point<a class="headerlink" href="#fixed_point" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fixed_point</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fixed_point</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Del2</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Iteration</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a fixed point of the function.</p>
<p>Given a function of one or more variables and a starting point, find a
fixed point of the function: i.e., where <code>func(x0) == x0</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : function</strong>
    Function to evaluate.</p>
</li>
<li>
<p><strong>x0 : array_like</strong>
    Fixed point of function.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments to <code>func</code>.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Convergence tolerance, defaults to 1e-08.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations, defaults to 500.</p>
</li>
<li>
<p><strong>method : {'del2', 'iteration'}, optional</strong>
    Method of finding the fixed-point, defaults to 'del2',
    which uses Steffensen's Method with Aitken's <code>Del^2</code>
    convergence acceleration [1]_. The 'iteration' method simply iterates
    the function until convergence is detected, without attempting to
    accelerate the convergence.</p>
</li>
</ul>
<h4>References</h4>
<p>.. [1] Burden, Faires, 'Numerical Analysis', 5th edition, pg. 80</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
<span class="o">...</span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">c2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mf">12.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.4920333</span> <span class="p">,</span>  <span class="mf">1.37228132</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="fsolve">fsolve<a class="headerlink" href="#fsolve" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">col_deriv</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfev</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">band</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsfcn</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">factor</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">diag</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span><span class="o">)</span>
</code></pre></div>

<p>Find the roots of a function.</p>
<p>Return the roots of the (non-linear) equations defined by
<code>func(x) = 0</code> given a starting estimate.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>f(x, *args)</code></strong>
    A function that takes at least one (possibly vector) argument,
    and returns a value of the same length.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    The starting estimate for the roots of <code>func(x) = 0</code>.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any extra arguments to <code>func</code>.</p>
</li>
<li>
<p><strong>fprime : callable <code>f(x, *args)</code>, optional</strong>
    A function to compute the Jacobian of <code>func</code> with derivatives
    across the rows. By default, the Jacobian will be estimated.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return optional outputs.</p>
</li>
<li>
<p><strong>col_deriv : bool, optional</strong>
    Specify whether the Jacobian function computes derivatives down
    the columns (faster, because there is no transpose operation).</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    The calculation will terminate if the relative error between two
    consecutive iterates is at most <code>xtol</code>.</p>
</li>
<li>
<p><strong>maxfev : int, optional</strong>
    The maximum number of calls to the function. If zero, then
    <code>100*(N+1)</code> is the maximum where N is the number of elements
    in <code>x0</code>.</p>
</li>
<li>
<p><strong>band : tuple, optional</strong>
    If set to a two-sequence containing the number of sub- and
    super-diagonals within the band of the Jacobi matrix, the
    Jacobi matrix is considered banded (only for <code>fprime=None</code>).</p>
</li>
<li>
<p><strong>epsfcn : float, optional</strong>
    A suitable step length for the forward-difference
    approximation of the Jacobian (for <code>fprime=None</code>). If
    <code>epsfcn</code> is less than the machine precision, it is assumed
    that the relative errors in the functions are of the order of
    the machine precision.</p>
</li>
<li>
<p><strong>factor : float, optional</strong>
    A parameter determining the initial step bound
    (<code>factor * || diag * x||</code>). Should be in the interval
    <code>(0.1, 100)</code>.</p>
</li>
<li>
<p><strong>diag : sequence, optional</strong>
    N positive entries that serve as a scale factors for the
    variables.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    The solution (or the result of the last iteration for
    an unsuccessful call).</p>
</li>
<li>
<p><strong>infodict : dict</strong>
    A dictionary of optional outputs with the keys:</p>
<p><code>nfev</code>
    number of function calls
<code>njev</code>
    number of Jacobian calls
<code>fvec</code>
    function evaluated at the output
<code>fjac</code>
    the orthogonal matrix, q, produced by the QR
    factorization of the final approximate Jacobian
    matrix, stored column wise
<code>r</code>
    upper triangular matrix produced by QR factorization
    of the same matrix
<code>qtf</code>
    the vector <code>(transpose(q) * fvec)</code></p>
</li>
<li>
<p><strong>ier : int</strong>
    An integer flag.  Set to 1 if a solution was found, otherwise refer
    to <code>mesg</code> for more information.</p>
</li>
<li>
<p><strong>mesg : str</strong>
    If no solution is found, <code>mesg</code> details the cause of failure.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See the <code>method=='hybr'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p><code>fsolve</code> is a wrapper around MINPACK's hybrd and hybrj algorithms.</p>
<h4>Examples</h4>
<p>Find a solution to the system of equations:
<code>x0*cos(x1) = 4,  x1*x0 - x1 = 5</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>             <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="n">array</span><span class="p">([</span><span class="mf">6.50409711</span><span class="p">,</span> <span class="mf">0.90841421</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># func(root) should be almost 0.0.</span>
<span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="greater">greater<a class="headerlink" href="#greater" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function greater</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">greater</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_of_ndarray_and_None</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>greater(x1, x2, /, out=None, *, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])</p>
<p>Return the truth value of (x1 &gt; x2) element-wise.</p>
<h4>Parameters</h4>
<p>x1, x2 : array_like
    Input arrays.
    If <code>x1.shape != x2.shape</code>, they must be broadcastable to a common
    shape (which becomes the shape of the output).</p>
<ul>
<li>
<p><strong>out : ndarray, None, or tuple of ndarray and None, optional</strong>
    A location into which the result is stored. If provided, it must have
    a shape that the inputs broadcast to. If not provided or None,
    a freshly-allocated array is returned. A tuple (possible only as a
    keyword argument) must have length equal to the number of outputs.</p>
</li>
<li>
<p><strong>where : array_like, optional</strong>
    This condition is broadcast over the input. At locations where the
    condition is True, the <code>out</code> array will be set to the ufunc result.
    Elsewhere, the <code>out</code> array will retain its original value.
    Note that if an uninitialized <code>out</code> array is created via the default
    <code>out=None</code>, locations within it where the condition is False will
    remain uninitialized.
**kwargs
    For other keyword-only arguments, see the
    :ref:<code>ufunc docs &lt;ufuncs.kwargs&gt;</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray or scalar</strong>
    Output array, element-wise comparison of <code>x1</code> and <code>x2</code>.
    Typically of type bool, unless <code>dtype=object</code> is passed.
    This is a scalar if both <code>x1</code> and <code>x2</code> are scalars.</li>
</ul>
<h4>See Also</h4>
<p>greater_equal, less, less_equal, equal, not_equal</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</code></pre></div>

<p>If the inputs are ndarrays, then np.greater is equivalent to '&gt;'.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span>
<span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="inv">inv<a class="headerlink" href="#inv" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function inv</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">inv</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute the inverse of a matrix.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Square matrix to be inverted.</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Discard data in <code>a</code> (may improve performance). Default is False.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>ainv : ndarray</strong>
    Inverse of the matrix <code>a</code>.</li>
</ul>
<h4>Raises</h4>
<p>LinAlgError
    If <code>a</code> is singular.
ValueError
    If <code>a</code> is not square, or not 2D.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">2.</span> <span class="p">,</span>  <span class="mf">1.</span> <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="issubdtype">issubdtype<a class="headerlink" href="#issubdtype" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function issubdtype</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">issubdtype</span> <span class="o">:</span>
  <span class="n">arg1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">arg2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">bool</span>
</code></pre></div>

<p>Returns True if first argument is a typecode lower/equal in type hierarchy.</p>
<h4>Parameters</h4>
<p>arg1, arg2 : dtype_like
    dtype or string representing a typecode.</p>
<h4>Returns</h4>
<ul>
<li><strong>out : bool</strong></li>
</ul>
<h4>See Also</h4>
<p>issubsctype, issubclass_</p>
<ul>
<li><strong>numpy.core.numerictypes : Overview of numpy type hierarchy.</strong></li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">string_</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>

</details>
<h3 id="least_squares">least_squares<a class="headerlink" href="#least_squares" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function least_squares</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">least_squares</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:[`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Trf</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dogbox</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lm</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_scale</span><span class="o">:[`</span><span class="nc">Jac</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">loss</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_scale</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">diff_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tr_solver</span><span class="o">:[`</span><span class="nc">Lsmr</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Exact</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tr_options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">jac_sparsity</span><span class="o">:[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_nfev</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:[`</span><span class="nc">Two</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Zero</span> <span class="o">|</span> <span class="o">`</span><span class="nc">One</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">bool</span><span class="o">)</span>
</code></pre></div>

<p>Solve a nonlinear least-squares problem with bounds on the variables.</p>
<p>Given the residuals f(x) (an m-D real function of n real
variables) and the loss function rho(s) (a scalar function), <code>least_squares</code>
finds a local minimum of the cost function F(x)::</p>
<div class="codehilite"><pre><span></span><code>minimize F(x) = 0.5 * sum(rho(f_i(x)**2), i = 0, ..., m - 1)
subject to lb &lt;= x &lt;= ub
</code></pre></div>


<p>The purpose of the loss function rho(s) is to reduce the influence of
outliers on the solution.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    Function which computes the vector of residuals, with the signature
    <code>fun(x, *args, **kwargs)</code>, i.e., the minimization proceeds with
    respect to its first argument. The argument <code>x</code> passed to this
    function is an ndarray of shape (n,) (never a scalar, even for n=1).
    It must allocate and return a 1-D array_like of shape (m,) or a scalar.
    If the argument <code>x</code> is complex or the function <code>fun</code> returns
    complex residuals, it must be wrapped in a real function of real
    arguments, as shown at the end of the Examples section.</p>
</li>
<li>
<p><strong>x0 : array_like with shape (n,) or float</strong>
    Initial guess on independent variables. If float, it will be treated
    as a 1-D array with one element.</p>
</li>
<li>
<p><strong>jac : {'2-point', '3-point', 'cs', callable}, optional</strong>
    Method of computing the Jacobian matrix (an m-by-n matrix, where
    element (i, j) is the partial derivative of f[i] with respect to
    x[j]). The keywords select a finite difference scheme for numerical
    estimation. The scheme '3-point' is more accurate, but requires
    twice as many operations as '2-point' (default). The scheme 'cs'
    uses complex steps, and while potentially the most accurate, it is
    applicable only when <code>fun</code> correctly handles complex inputs and
    can be analytically continued to the complex plane. Method 'lm'
    always uses the '2-point' scheme. If callable, it is used as
    <code>jac(x, *args, **kwargs)</code> and should return a good approximation
    (or the exact value) for the Jacobian as an array_like (np.atleast_2d
    is applied), a sparse matrix or a <code>scipy.sparse.linalg.LinearOperator</code>.</p>
</li>
<li>
<p><strong>bounds : 2-tuple of array_like, optional</strong>
    Lower and upper bounds on independent variables. Defaults to no bounds.
    Each array must match the size of <code>x0</code> or be a scalar, in the latter
    case a bound will be the same for all variables. Use <code>np.inf</code> with
    an appropriate sign to disable bounds on all or some variables.</p>
</li>
<li>
<p><strong>method : {'trf', 'dogbox', 'lm'}, optional</strong>
    Algorithm to perform minimization.</p>
<div class="codehilite"><pre><span></span><code>* &#39;trf&#39; : Trust Region Reflective algorithm, particularly suitable
  for large sparse problems with bounds. Generally robust method.
* &#39;dogbox&#39; : dogleg algorithm with rectangular trust regions,
  typical use case is small problems with bounds. Not recommended
  for problems with rank-deficient Jacobian.
* &#39;lm&#39; : Levenberg-Marquardt algorithm as implemented in MINPACK.
  Doesn&#39;t handle bounds and sparse Jacobians. Usually the most
  efficient method for small unconstrained problems.
</code></pre></div>


<p>Default is 'trf'. See Notes for more information.</p>
</li>
<li>
<p><strong>ftol : float or None, optional</strong>
    Tolerance for termination by the change of the cost function. Default
    is 1e-8. The optimization process is stopped when <code>dF &lt; ftol * F</code>,
    and there was an adequate agreement between a local quadratic model and
    the true model in the last step. If None, the termination by this
    condition is disabled.</p>
</li>
<li>
<p><strong>xtol : float or None, optional</strong>
    Tolerance for termination by the change of the independent variables.
    Default is 1e-8. The exact condition depends on the <code>method</code> used:</p>
<div class="codehilite"><pre><span></span><code>* For &#39;trf&#39; and &#39;dogbox&#39; : ``norm(dx) &lt; xtol * (xtol + norm(x))``.
* For &#39;lm&#39; : ``Delta &lt; xtol * norm(xs)``, where ``Delta`` is
  a trust-region radius and ``xs`` is the value of ``x``
  scaled according to `x_scale` parameter (see below).
</code></pre></div>


<p>If None, the termination by this condition is disabled.</p>
</li>
<li>
<p><strong>gtol : float or None, optional</strong>
    Tolerance for termination by the norm of the gradient. Default is 1e-8.
    The exact condition depends on a <code>method</code> used:</p>
<div class="codehilite"><pre><span></span><code>* For &#39;trf&#39; : ``norm(g_scaled, ord=np.inf) &lt; gtol``, where
  ``g_scaled`` is the value of the gradient scaled to account for
  the presence of the bounds [STIR]_.
* For &#39;dogbox&#39; : ``norm(g_free, ord=np.inf) &lt; gtol``, where
  ``g_free`` is the gradient with respect to the variables which
  are not in the optimal state on the boundary.
* For &#39;lm&#39; : the maximum absolute value of the cosine of angles
  between columns of the Jacobian and the residual vector is less
  than `gtol`, or the residual vector is zero.
</code></pre></div>


<p>If None, the termination by this condition is disabled.</p>
</li>
<li>
<p><strong>x_scale : array_like or 'jac', optional</strong>
    Characteristic scale of each variable. Setting <code>x_scale</code> is equivalent
    to reformulating the problem in scaled variables <code>xs = x / x_scale</code>.
    An alternative view is that the size of a trust region along jth
    dimension is proportional to <code>x_scale[j]</code>. Improved convergence may
    be achieved by setting <code>x_scale</code> such that a step of a given size
    along any of the scaled variables has a similar effect on the cost
    function. If set to 'jac', the scale is iteratively updated using the
    inverse norms of the columns of the Jacobian matrix (as described in
    [JJMore]_).</p>
</li>
<li>
<p><strong>loss : str or callable, optional</strong>
    Determines the loss function. The following keyword values are allowed:</p>
<div class="codehilite"><pre><span></span><code>* &#39;linear&#39; (default) : ``rho(z) = z``. Gives a standard
  least-squares problem.
* &#39;soft_l1&#39; : ``rho(z) = 2 * ((1 + z)**0.5 - 1)``. The smooth
  approximation of l1 (absolute value) loss. Usually a good
  choice for robust least squares.
* &#39;huber&#39; : ``rho(z) = z if z &lt;= 1 else 2*z**0.5 - 1``. Works
  similarly to &#39;soft_l1&#39;.
* &#39;cauchy&#39; : ``rho(z) = ln(1 + z)``. Severely weakens outliers
  influence, but may cause difficulties in optimization process.
* &#39;arctan&#39; : ``rho(z) = arctan(z)``. Limits a maximum loss on
  a single residual, has properties similar to &#39;cauchy&#39;.
</code></pre></div>


<p>If callable, it must take a 1-D ndarray <code>z=f**2</code> and return an
array_like with shape (3, m) where row 0 contains function values,
row 1 contains first derivatives and row 2 contains second
derivatives. Method 'lm' supports only 'linear' loss.</p>
</li>
<li>
<p><strong>f_scale : float, optional</strong>
    Value of soft margin between inlier and outlier residuals, default
    is 1.0. The loss function is evaluated as follows
    <code>rho_(f**2) = C**2 * rho(f**2 / C**2)</code>, where <code>C</code> is <code>f_scale</code>,
    and <code>rho</code> is determined by <code>loss</code> parameter. This parameter has
    no effect with <code>loss='linear'</code>, but for other <code>loss</code> values it is
    of crucial importance.</p>
</li>
<li>
<p><strong>max_nfev : None or int, optional</strong>
    Maximum number of function evaluations before the termination.
    If None (default), the value is chosen automatically:</p>
<div class="codehilite"><pre><span></span><code>* For &#39;trf&#39; and &#39;dogbox&#39; : 100 * n.
* For &#39;lm&#39; :  100 * n if `jac` is callable and 100 * n * (n + 1)
  otherwise (because &#39;lm&#39; counts function calls in Jacobian
  estimation).
</code></pre></div>


</li>
<li>
<p><strong>diff_step : None or array_like, optional</strong>
    Determines the relative step size for the finite difference
    approximation of the Jacobian. The actual step is computed as
    <code>x * diff_step</code>. If None (default), then <code>diff_step</code> is taken to be
    a conventional 'optimal' power of machine epsilon for the finite
    difference scheme used [NR]_.</p>
</li>
<li>
<p><strong>tr_solver : {None, 'exact', 'lsmr'}, optional</strong>
    Method for solving trust-region subproblems, relevant only for 'trf'
    and 'dogbox' methods.</p>
<div class="codehilite"><pre><span></span><code>* &#39;exact&#39; is suitable for not very large problems with dense
  Jacobian matrices. The computational complexity per iteration is
  comparable to a singular value decomposition of the Jacobian
  matrix.
* &#39;lsmr&#39; is suitable for problems with sparse and large Jacobian
  matrices. It uses the iterative procedure
  `scipy.sparse.linalg.lsmr` for finding a solution of a linear
  least-squares problem and only requires matrix-vector product
  evaluations.
</code></pre></div>


<p>If None (default), the solver is chosen based on the type of Jacobian
returned on the first iteration.</p>
</li>
<li>
<p><strong>tr_options : dict, optional</strong>
    Keyword options passed to trust-region solver.</p>
<div class="codehilite"><pre><span></span><code>* ``tr_solver=&#39;exact&#39;``: `tr_options` are ignored.
* ``tr_solver=&#39;lsmr&#39;``: options for `scipy.sparse.linalg.lsmr`.
  Additionally,  ``method=&#39;trf&#39;`` supports  &#39;regularize&#39; option
  (bool, default is True), which adds a regularization term to the
  normal equation, which improves convergence if the Jacobian is
  rank-deficient [Byrd]_ (eq. 3.4).
</code></pre></div>


</li>
<li>
<p><strong>jac_sparsity : {None, array_like, sparse matrix}, optional</strong>
    Defines the sparsity structure of the Jacobian matrix for finite
    difference estimation, its shape must be (m, n). If the Jacobian has
    only few non-zero elements in <em>each</em> row, providing the sparsity
    structure will greatly speed up the computations [Curtis]_. A zero
    entry means that a corresponding element in the Jacobian is identically
    zero. If provided, forces the use of 'lsmr' trust-region solver.
    If None (default), then dense differencing will be used. Has no effect
    for 'lm' method.</p>
</li>
<li>
<p><strong>verbose : {0, 1, 2}, optional</strong>
    Level of algorithm's verbosity:</p>
<div class="codehilite"><pre><span></span><code>* 0 (default) : work silently.
* 1 : display a termination report.
* 2 : display progress during iterations (not supported by &#39;lm&#39;
  method).
</code></pre></div>


</li>
</ul>
<p>args, kwargs : tuple and dict, optional
    Additional arguments passed to <code>fun</code> and <code>jac</code>. Both empty by default.
    The calling signature is <code>fun(x, *args, **kwargs)</code> and the same for
    <code>jac</code>.</p>
<h4>Returns</h4>
<p><code>OptimizeResult</code> with the following fields defined:</p>
<ul>
<li>
<p><strong>x : ndarray, shape (n,)</strong>
    Solution found.</p>
</li>
<li>
<p><strong>cost : float</strong>
    Value of the cost function at the solution.</p>
</li>
<li>
<p><strong>fun : ndarray, shape (m,)</strong>
    Vector of residuals at the solution.</p>
</li>
<li>
<p><strong>jac : ndarray, sparse matrix or LinearOperator, shape (m, n)</strong>
    Modified Jacobian matrix at the solution, in the sense that J^T J
    is a Gauss-Newton approximation of the Hessian of the cost function.
    The type is the same as the one used by the algorithm.</p>
</li>
<li>
<p><strong>grad : ndarray, shape (m,)</strong>
    Gradient of the cost function at the solution.</p>
</li>
<li>
<p><strong>optimality : float</strong>
    First-order optimality measure. In unconstrained problems, it is always
    the uniform norm of the gradient. In constrained problems, it is the
    quantity which was compared with <code>gtol</code> during iterations.</p>
</li>
<li>
<p><strong>active_mask : ndarray of int, shape (n,)</strong>
    Each component shows whether a corresponding constraint is active
    (that is, whether a variable is at the bound):</p>
<div class="codehilite"><pre><span></span><code>*  0 : a constraint is not active.
* -1 : a lower bound is active.
*  1 : an upper bound is active.
</code></pre></div>


<p>Might be somewhat arbitrary for 'trf' method as it generates a sequence
of strictly feasible iterates and <code>active_mask</code> is determined within a
tolerance threshold.</p>
</li>
<li>
<p><strong>nfev : int</strong>
    Number of function evaluations done. Methods 'trf' and 'dogbox' do not
    count function calls for numerical Jacobian approximation, as opposed
    to 'lm' method.</p>
</li>
<li>
<p><strong>njev : int or None</strong>
    Number of Jacobian evaluations done. If numerical Jacobian
    approximation is used in 'lm' method, it is set to None.</p>
</li>
<li>
<p><strong>status : int</strong>
    The reason for algorithm termination:</p>
<div class="codehilite"><pre><span></span><code>* -1 : improper input parameters status returned from MINPACK.
*  0 : the maximum number of function evaluations is exceeded.
*  1 : `gtol` termination condition is satisfied.
*  2 : `ftol` termination condition is satisfied.
*  3 : `xtol` termination condition is satisfied.
*  4 : Both `ftol` and `xtol` termination conditions are satisfied.
</code></pre></div>


</li>
<li>
<p><strong>message : str</strong>
    Verbal description of the termination reason.</p>
</li>
<li>
<p><strong>success : bool</strong>
    True if one of the convergence criteria is satisfied (<code>status</code> &gt; 0).</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>leastsq : A legacy wrapper for the MINPACK implementation of the</strong>
          Levenberg-Marquadt algorithm.</p>
</li>
<li>
<p><strong>curve_fit : Least-squares minimization applied to a curve-fitting problem.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>Method 'lm' (Levenberg-Marquardt) calls a wrapper over least-squares
algorithms implemented in MINPACK (lmder, lmdif). It runs the
Levenberg-Marquardt algorithm formulated as a trust-region type algorithm.
The implementation is based on paper [JJMore]_, it is very robust and
efficient with a lot of smart tricks. It should be your first choice
for unconstrained problems. Note that it doesn't support bounds. Also,
it doesn't work when m &lt; n.</p>
<p>Method 'trf' (Trust Region Reflective) is motivated by the process of
solving a system of equations, which constitute the first-order optimality
condition for a bound-constrained minimization problem as formulated in
[STIR]<em>. The algorithm iteratively solves trust-region subproblems
augmented by a special diagonal quadratic term and with trust-region shape
determined by the distance from the bounds and the direction of the
gradient. This enhancements help to avoid making steps directly into bounds
and efficiently explore the whole space of variables. To further improve
convergence, the algorithm considers search directions reflected from the
bounds. To obey theoretical requirements, the algorithm keeps iterates
strictly feasible. With dense Jacobians trust-region subproblems are
solved by an exact method very similar to the one described in [JJMore]</em>
(and implemented in MINPACK). The difference from the MINPACK
implementation is that a singular value decomposition of a Jacobian
matrix is done once per iteration, instead of a QR decomposition and series
of Givens rotation eliminations. For large sparse Jacobians a 2-D subspace
approach of solving trust-region subproblems is used [STIR]<em>, [Byrd]</em>.
The subspace is spanned by a scaled gradient and an approximate
Gauss-Newton solution delivered by <code>scipy.sparse.linalg.lsmr</code>. When no
constraints are imposed the algorithm is very similar to MINPACK and has
generally comparable performance. The algorithm works quite robust in
unbounded and bounded problems, thus it is chosen as a default algorithm.</p>
<p>Method 'dogbox' operates in a trust-region framework, but considers
rectangular trust regions as opposed to conventional ellipsoids [Voglis]<em>.
The intersection of a current trust region and initial bounds is again
rectangular, so on each iteration a quadratic minimization problem subject
to bound constraints is solved approximately by Powell's dogleg method
[NumOpt]</em>. The required Gauss-Newton step can be computed exactly for
dense Jacobians or approximately by <code>scipy.sparse.linalg.lsmr</code> for large
sparse Jacobians. The algorithm is likely to exhibit slow convergence when
the rank of Jacobian is less than the number of variables. The algorithm
often outperforms 'trf' in bounded problems with a small number of
variables.</p>
<p>Robust loss functions are implemented as described in [BA]_. The idea
is to modify a residual vector and a Jacobian matrix on each iteration
such that computed gradient and Gauss-Newton Hessian approximation match
the true gradient and Hessian approximation of the cost function. Then
the algorithm proceeds in a normal way, i.e., robust loss functions are
implemented as a simple wrapper over standard least-squares algorithms.</p>
<p>.. versionadded:: 0.17.0</p>
<h4>References</h4>
<p>.. [STIR] M. A. Branch, T. F. Coleman, and Y. Li, 'A Subspace, Interior,
          and Conjugate Gradient Method for Large-Scale Bound-Constrained
          Minimization Problems,' SIAM Journal on Scientific Computing,
          Vol. 21, Number 1, pp 1-23, 1999.
.. [NR] William H. Press et. al., 'Numerical Recipes. The Art of Scientific
        Computing. 3rd edition', Sec. 5.7.
.. [Byrd] R. H. Byrd, R. B. Schnabel and G. A. Shultz, 'Approximate
          solution of the trust region problem by minimization over
          two-dimensional subspaces', Math. Programming, 40, pp. 247-263,
          1988.
.. [Curtis] A. Curtis, M. J. D. Powell, and J. Reid, 'On the estimation of
            sparse Jacobian matrices', Journal of the Institute of
            Mathematics and its Applications, 13, pp. 117-120, 1974.
.. [JJMore] J. J. More, 'The Levenberg-Marquardt Algorithm: Implementation
            and Theory,' Numerical Analysis, ed. G. A. Watson, Lecture
            Notes in Mathematics 630, Springer Verlag, pp. 105-116, 1977.
.. [Voglis] C. Voglis and I. E. Lagaris, 'A Rectangular Trust Region
            Dogleg Approach for Unconstrained and Bound Constrained
            Nonlinear Optimization', WSEAS International Conference on
            Applied Mathematics, Corfu, Greece, 2004.
.. [NumOpt] J. Nocedal and S. J. Wright, 'Numerical optimization,
            2nd edition', Chapter 4.
.. [BA] B. Triggs et. al., 'Bundle Adjustment - A Modern Synthesis',
        Proceedings of the International Workshop on Vision Algorithms:
        Theory and Practice, pp. 298-372, 1999.</p>
<h4>Examples</h4>
<p>In this example we find a minimum of the Rosenbrock function without bounds
on independent variables.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun_rosenbrock</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
</code></pre></div>

<p>Notice that we only provide the vector of the residuals. The algorithm
constructs the cost function as a sum of squares of the residuals, which
gives the Rosenbrock function. The exact minimum is at <code>x = [1.0, 1.0]</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">least_squares</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0_rosenbrock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun_rosenbrock</span><span class="p">,</span> <span class="n">x0_rosenbrock</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span><span class="o">.</span><span class="n">cost</span>
<span class="mf">9.8669242910846867e-30</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span><span class="o">.</span><span class="n">optimality</span>
<span class="mf">8.8928864934219529e-14</span>
</code></pre></div>

<p>We now constrain the variables, in such a way that the previous solution
becomes infeasible. Specifically, we require that <code>x[1] &gt;= 1.5</code>, and
<code>x[0]</code> left unconstrained. To this end, we specify the <code>bounds</code> parameter
to <code>least_squares</code> in the form <code>bounds=([-np.inf, 1.5], np.inf)</code>.</p>
<p>We also provide the analytic Jacobian:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">jac_rosenbrock</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="o">...</span>         <span class="p">[</span><span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</code></pre></div>

<p>Putting this all together, we see that the new solution lies on the bound:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun_rosenbrock</span><span class="p">,</span> <span class="n">x0_rosenbrock</span><span class="p">,</span> <span class="n">jac_rosenbrock</span><span class="p">,</span>
<span class="o">...</span>                       <span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.22437075</span><span class="p">,</span>  <span class="mf">1.5</span>       <span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span><span class="o">.</span><span class="n">cost</span>
<span class="mf">0.025213093946805685</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span><span class="o">.</span><span class="n">optimality</span>
<span class="mf">1.5885401433157753e-07</span>
</code></pre></div>

<p>Now we solve a system of equations (i.e., the cost function should be zero
at a minimum) for a Broyden tridiagonal vector-valued function of 100000
variables:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun_broyden</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>     <span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">f</span>
</code></pre></div>

<p>The corresponding Jacobian matrix is sparse. We tell the algorithm to
estimate it by finite differences and provide the sparsity structure of
Jacobian to significantly speed up this process.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">lil_matrix</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">sparsity_broyden</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">sparsity</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">sparsity</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">sparsity</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">sparsity</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">sparsity</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0_broyden</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_3</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun_broyden</span><span class="p">,</span> <span class="n">x0_broyden</span><span class="p">,</span>
<span class="o">...</span>                       <span class="n">jac_sparsity</span><span class="o">=</span><span class="n">sparsity_broyden</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_3</span><span class="o">.</span><span class="n">cost</span>
<span class="mf">4.5687069299604613e-23</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_3</span><span class="o">.</span><span class="n">optimality</span>
<span class="mf">1.1650454296851518e-11</span>
</code></pre></div>

<p>Let's also solve a curve fitting problem using robust loss function to
take care of outliers in the data. Define the model function as
<code>y = a + b * exp(c * t)</code>, where t is a predictor variable, y is an
observation and a, b, c are parameters to estimate.</p>
<p>First, define the function which generates the data with noise and
outliers, define the model parameters, and generate data:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">gen_data</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_outliers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">rnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">error</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">*</span> <span class="n">rnd</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">outliers</span> <span class="o">=</span> <span class="n">rnd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">n_outliers</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">error</span><span class="p">[</span><span class="n">outliers</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">error</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t_min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t_max</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n_points</span> <span class="o">=</span> <span class="mi">15</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_outliers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>

<p>Define function for computing residuals and initial estimate of
parameters.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</code></pre></div>

<p>Compute a standard least-squares solution:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res_lsq</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
</code></pre></div>

<p>Now compute two solutions with two different robust loss functions. The
parameter <code>f_scale</code> is set to 0.1, meaning that inlier residuals should
not significantly exceed 0.1 (the noise level used).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res_soft_l1</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;soft_l1&#39;</span><span class="p">,</span> <span class="n">f_scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="o">...</span>                             <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_log</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;cauchy&#39;</span><span class="p">,</span> <span class="n">f_scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="o">...</span>                         <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
</code></pre></div>

<p>And, finally, plot all the curves. We see that by selecting an appropriate
<code>loss</code>  we can get estimates close to optimal even in the presence of
strong outliers. But keep in mind that generally it is recommended to try
'soft_l1' or 'huber' losses first (if at all necessary) as the other two
options may cause difficulties in optimization process.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">t_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_lsq</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="o">*</span><span class="n">res_lsq</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_soft_l1</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="o">*</span><span class="n">res_soft_l1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_log</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="o">*</span><span class="n">res_log</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_lsq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear loss&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_soft_l1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;soft_l1 loss&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_log</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cauchy loss&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>In the next example, we show how complex-valued residual functions of
complex variables can be optimized with <code>least_squares()</code>. Consider the
following function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

<p>We wrap it into a function of real variables that returns real residuals
by simply handling the real and imaginary parts as independent variables:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f_wrap</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">fx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fx</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">fx</span><span class="o">.</span><span class="n">imag</span><span class="p">])</span>
</code></pre></div>

<p>Thus, instead of the original m-D complex function of n complex
variables we optimize a 2m-D real function of 2n real variables:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">least_squares</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_wrapped</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">f_wrap</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span> <span class="o">=</span> <span class="n">res_wrapped</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">res_wrapped</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span>
<span class="p">(</span><span class="mf">0.49999999999925893</span><span class="o">+</span><span class="mf">0.49999999999925893</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="leastsq">leastsq<a class="headerlink" href="#leastsq" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function leastsq</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">leastsq</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dfun</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">col_deriv</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfev</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsfcn</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">factor</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">diag</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Minimize the sum of squares of a set of equations.</p>
<p>::</p>
<div class="codehilite"><pre><span></span><code>x = arg min(sum(func(y)**2,axis=0))
         y
</code></pre></div>


<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    Should take at least one (possibly length N vector) argument and
    returns M floating point numbers. It must not return NaNs or
    fitting might fail.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    The starting estimate for the minimization.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any extra arguments to func are placed in this tuple.</p>
</li>
<li>
<p><strong>Dfun : callable, optional</strong>
    A function or method to compute the Jacobian of func with derivatives
    across the rows. If this is None, the Jacobian will be estimated.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    non-zero to return all optional outputs.</p>
</li>
<li>
<p><strong>col_deriv : bool, optional</strong>
    non-zero to specify that the Jacobian function computes derivatives
    down the columns (faster, because there is no transpose operation).</p>
</li>
<li>
<p><strong>ftol : float, optional</strong>
    Relative error desired in the sum of squares.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Relative error desired in the approximate solution.</p>
</li>
<li>
<p><strong>gtol : float, optional</strong>
    Orthogonality desired between the function vector and the columns of
    the Jacobian.</p>
</li>
<li>
<p><strong>maxfev : int, optional</strong>
    The maximum number of calls to the function. If <code>Dfun</code> is provided,
    then the default <code>maxfev</code> is 100<em>(N+1) where N is the number of elements
    in x0, otherwise the default <code>maxfev</code> is 200</em>(N+1).</p>
</li>
<li>
<p><strong>epsfcn : float, optional</strong>
    A variable used in determining a suitable step length for the forward-
    difference approximation of the Jacobian (for Dfun=None).
    Normally the actual step length will be sqrt(epsfcn)*x
    If epsfcn is less than the machine precision, it is assumed that the
    relative errors are of the order of the machine precision.</p>
</li>
<li>
<p><strong>factor : float, optional</strong>
    A parameter determining the initial step bound
    (<code>factor * || diag * x||</code>). Should be in interval <code>(0.1, 100)</code>.</p>
</li>
<li>
<p><strong>diag : sequence, optional</strong>
    N positive entries that serve as a scale factors for the variables.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    The solution (or the result of the last iteration for an unsuccessful
    call).</p>
</li>
<li>
<p><strong>cov_x : ndarray</strong>
    The inverse of the Hessian. <code>fjac</code> and <code>ipvt</code> are used to construct an
    estimate of the Hessian. A value of None indicates a singular matrix,
    which means the curvature in parameters <code>x</code> is numerically flat. To
    obtain the covariance matrix of the parameters <code>x</code>, <code>cov_x</code> must be
    multiplied by the variance of the residuals -- see curve_fit.</p>
</li>
<li>
<p><strong>infodict : dict</strong>
    a dictionary of optional outputs with the keys:</p>
<p><code>nfev</code>
    The number of function calls
<code>fvec</code>
    The function evaluated at the output
<code>fjac</code>
    A permutation of the R matrix of a QR
    factorization of the final approximate
    Jacobian matrix, stored column wise.
    Together with ipvt, the covariance of the
    estimate can be approximated.
<code>ipvt</code>
    An integer array of length N which defines
    a permutation matrix, p, such that
    fjac<em>p = q</em>r, where r is upper triangular
    with diagonal elements of nonincreasing
    magnitude. Column j of p is column ipvt(j)
    of the identity matrix.
<code>qtf</code>
    The vector (transpose(q) * fvec).</p>
</li>
<li>
<p><strong>mesg : str</strong>
    A string message giving information about the cause of failure.</p>
</li>
<li>
<p><strong>ier : int</strong>
    An integer flag. If it is equal to 1, 2, 3 or 4, the solution was
    found. Otherwise, the solution was not found. In either case, the
    optional output variable 'mesg' gives more information.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>least_squares : Newer interface to solve nonlinear least-squares problems</strong>
    with bounds on the variables. See <code>method=='lm'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>'leastsq' is a wrapper around MINPACK's lmdif and lmder algorithms.</p>
<p>cov_x is a Jacobian approximation to the Hessian of the least squares
objective function.
This approximation assumes that the objective function is based on the
difference between some observed target data (ydata) and a (non-linear)
function of the parameters <code>f(xdata, params)</code> ::</p>
<div class="codehilite"><pre><span></span><code>   func(params) = ydata - f(xdata, params)
</code></pre></div>


<p>so that the objective function is ::</p>
<div class="codehilite"><pre><span></span><code>   min   sum((ydata - f(xdata, params))**2, axis=0)
 params
</code></pre></div>


<p>The solution, <code>x</code>, is always a 1-D array, regardless of the shape of <code>x0</code>,
or whether <code>x0</code> is a scalar.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">leastsq</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">leastsq</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">2.99999999</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="prepare_bounds">prepare_bounds<a class="headerlink" href="#prepare_bounds" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function prepare_bounds</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">prepare_bounds</span> <span class="o">:</span>
  <span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">n</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="prod">prod<a class="headerlink" href="#prod" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function prod</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">prod</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">keepdims</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">initial</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the product of array elements over a given axis.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input data.</p>
</li>
<li>
<p><strong>axis : None or int or tuple of ints, optional</strong>
    Axis or axes along which a product is performed.  The default,
    axis=None, will calculate the product of all the elements in the
    input array. If axis is negative it counts from the last to the
    first axis.</p>
<p>.. versionadded:: 1.7.0</p>
<p>If axis is a tuple of ints, a product is performed on all of the
axes specified in the tuple instead of a single axis or all the
axes as before.</p>
</li>
<li>
<p><strong>dtype : dtype, optional</strong>
    The type of the returned array, as well as of the accumulator in
    which the elements are multiplied.  The dtype of <code>a</code> is used by
    default unless <code>a</code> has an integer dtype of less precision than the
    default platform integer.  In that case, if <code>a</code> is signed then the
    platform integer is used while if <code>a</code> is unsigned then an unsigned
    integer of the same precision as the platform integer is used.</p>
</li>
<li>
<p><strong>out : ndarray, optional</strong>
    Alternative output array in which to place the result. It must have
    the same shape as the expected output, but the type of the output
    values will be cast if necessary.</p>
</li>
<li>
<p><strong>keepdims : bool, optional</strong>
    If this is set to True, the axes which are reduced are left in the
    result as dimensions with size one. With this option, the result
    will broadcast correctly against the input array.</p>
<p>If the default value is passed, then <code>keepdims</code> will not be
passed through to the <code>prod</code> method of sub-classes of
<code>ndarray</code>, however any non-default value will be.  If the
sub-class' method does not implement <code>keepdims</code> any
exceptions will be raised.</p>
</li>
<li>
<p><strong>initial : scalar, optional</strong>
    The starting value for this product. See <code>~numpy.ufunc.reduce</code> for details.</p>
<p>.. versionadded:: 1.15.0</p>
</li>
<li>
<p><strong>where : array_like of bool, optional</strong>
    Elements to include in the product. See <code>~numpy.ufunc.reduce</code> for details.</p>
<p>.. versionadded:: 1.17.0</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>product_along_axis : ndarray, see <code>dtype</code> parameter above.</strong>
    An array shaped as <code>a</code> but with the specified axis removed.
    Returns a reference to <code>out</code> if specified.</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>ndarray.prod : equivalent method</strong>
ufuncs-output-type</li>
</ul>
<h4>Notes</h4>
<p>Arithmetic is modular when using integer types, and no error is
raised on overflow.  That means that, on a 32-bit platform:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">536870910</span><span class="p">,</span> <span class="mi">536870910</span><span class="p">,</span> <span class="mi">536870910</span><span class="p">,</span> <span class="mi">536870910</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="mi">16</span> <span class="c1"># may vary</span>
</code></pre></div>

<p>The product of an empty array is the neutral element 1:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([])</span>
<span class="mf">1.0</span>
</code></pre></div>

<h4>Examples</h4>
<p>By default, calculate the product of all elements:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">])</span>
<span class="mf">2.0</span>
</code></pre></div>

<p>Even when the input array is two-dimensional:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">]])</span>
<span class="mf">24.0</span>
</code></pre></div>

<p>But we can also specify the axis over which to multiply:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">12.</span><span class="p">])</span>
</code></pre></div>

<p>Or select specific elements to include:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="mf">3.0</span>
</code></pre></div>

<p>If the type of <code>x</code> is unsigned, then the output type is
the unsigned platform integer:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint</span>
<span class="kc">True</span>
</code></pre></div>

<p>If <code>x</code> is of a signed integer type, then the output type
is the default platform integer:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span>
<span class="kc">True</span>
</code></pre></div>

<p>You can also start the product with a value other than one:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">initial</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">10</span>
</code></pre></div>

</details>
<h3 id="shape">shape<a class="headerlink" href="#shape" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function shape</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">shape</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">int</span> <span class="kt">array</span>
</code></pre></div>

<p>Return the shape of an array.</p>
<h4>Parameters</h4>
<ul>
<li><strong>a : array_like</strong>
    Input array.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>shape : tuple of ints</strong>
    The elements of the shape tuple give the lengths of the
    corresponding array dimensions.</li>
</ul>
<h4>See Also</h4>
<p>alen</p>
<ul>
<li><strong>ndarray.shape : Equivalent array method.</strong></li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
</code></pre></div>

</details>
<h3 id="solve_triangular">solve_triangular<a class="headerlink" href="#solve_triangular" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function solve_triangular</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve_triangular</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">trans</span><span class="o">:[`</span><span class="nc">N</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Two</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Zero</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T</span> <span class="o">|</span> <span class="o">`</span><span class="nc">One</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lower</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">unit_diagonal</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">overwrite_b</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">debug</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Solve the equation <code>a x = b</code> for <code>x</code>, assuming a is a triangular matrix.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (M, M) array_like</strong>
    A triangular matrix</p>
</li>
<li>
<p><strong>b : (M,) or (M, N) array_like</strong>
    Right-hand side matrix in <code>a x = b</code></p>
</li>
<li>
<p><strong>lower : bool, optional</strong>
    Use only data contained in the lower triangle of <code>a</code>.
    Default is to use upper triangle.</p>
</li>
<li>
<p><strong>trans : {0, 1, 2, 'N', 'T', 'C'}, optional</strong>
    Type of system to solve:</p>
<p>========  =========
trans     system
========  =========
0 or 'N'  a x  = b
1 or 'T'  a^T x = b
2 or 'C'  a^H x = b
========  =========</p>
</li>
<li>
<p><strong>unit_diagonal : bool, optional</strong>
    If True, diagonal elements of <code>a</code> are assumed to be 1 and
    will not be referenced.</p>
</li>
<li>
<p><strong>overwrite_b : bool, optional</strong>
    Allow overwriting data in <code>b</code> (may enhance performance)</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>x : (M,) or (M, N) ndarray</strong>
    Solution to the system <code>a x = b</code>.  Shape of return matches <code>b</code>.</li>
</ul>
<h4>Raises</h4>
<p>LinAlgError
    If <code>a</code> is singular</p>
<h4>Notes</h4>
<p>.. versionadded:: 0.9.0</p>
<h4>Examples</h4>
<p>Solve the lower triangular system a x = b, where::</p>
<div class="codehilite"><pre><span></span><code>     [3  0  0  0]       [4]
a =  [2  1  0  0]   b = [2]
     [1  0  1  0]       [4]
     [1  1  1  1]       [2]
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">solve_triangular</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">solve_triangular</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.33333333</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.66666667</span><span class="p">,</span>  <span class="mf">2.66666667</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.33333333</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Check the result</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">4.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="svd">svd<a class="headerlink" href="#svd" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function svd</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">svd</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">full_matrices</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">compute_uv</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lapack_driver</span><span class="o">:[`</span><span class="nc">Gesdd</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Gesvd</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Singular Value Decomposition.</p>
<p>Factorizes the matrix <code>a</code> into two unitary matrices <code>U</code> and <code>Vh</code>, and
a 1-D array <code>s</code> of singular values (real, non-negative) such that
<code>a == U @ S @ Vh</code>, where <code>S</code> is a suitably shaped matrix of zeros with
main diagonal <code>s</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (M, N) array_like</strong>
    Matrix to decompose.</p>
</li>
<li>
<p><strong>full_matrices : bool, optional</strong>
    If True (default), <code>U</code> and <code>Vh</code> are of shape <code>(M, M)</code>, <code>(N, N)</code>.
    If False, the shapes are <code>(M, K)</code> and <code>(K, N)</code>, where
    <code>K = min(M, N)</code>.</p>
</li>
<li>
<p><strong>compute_uv : bool, optional</strong>
    Whether to compute also <code>U</code> and <code>Vh</code> in addition to <code>s</code>.
    Default is True.</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Whether to overwrite <code>a</code>; may improve performance.
    Default is False.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
<li>
<p><strong>lapack_driver : {'gesdd', 'gesvd'}, optional</strong>
    Whether to use the more efficient divide-and-conquer approach
    (<code>'gesdd'</code>) or general rectangular approach (<code>'gesvd'</code>)
    to compute the SVD. MATLAB and Octave use the <code>'gesvd'</code> approach.
    Default is <code>'gesdd'</code>.</p>
<p>.. versionadded:: 0.18</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>U : ndarray</strong>
    Unitary matrix having left singular vectors as columns.
    Of shape <code>(M, M)</code> or <code>(M, K)</code>, depending on <code>full_matrices</code>.</p>
</li>
<li>
<p><strong>s : ndarray</strong>
    The singular values, sorted in non-increasing order.
    Of shape (K,), with <code>K = min(M, N)</code>.</p>
</li>
<li>
<p><strong>Vh : ndarray</strong>
    Unitary matrix having right singular vectors as rows.
    Of shape <code>(N, N)</code> or <code>(K, N)</code> depending on <code>full_matrices</code>.</p>
</li>
</ul>
<p>For <code>compute_uv=False</code>, only <code>s</code> is returned.</p>
<h4>Raises</h4>
<p>LinAlgError
    If SVD computation does not converge.</p>
<h4>See also</h4>
<ul>
<li>
<p><strong>svdvals : Compute singular values of a matrix.</strong></p>
</li>
<li>
<p><strong>diagsvd : Construct the Sigma matrix, given the vector s.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>  <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Vh</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div>

<p>Reconstruct the original matrix from the decomposition:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)):</span>
<span class="o">...</span>     <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">Vh</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<p>Alternatively, use <code>full_matrices=False</code> (notice that the shape of
<code>U</code> is then <code>(m, n)</code> instead of <code>(m, m)</code>):</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Vh</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">Vh</span><span class="p">)))</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="take">take<a class="headerlink" href="#take" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function take</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">take</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T_Ni_Nj_Nk_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">mode</span><span class="o">:[`</span><span class="nc">Raise</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wrap</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Clip</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">indices</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Take elements from an array along an axis.</p>
<p>When axis is not None, this function does the same thing as 'fancy'
indexing (indexing arrays using arrays); however, it can be easier to use
if you need elements along a given axis. A call such as
<code>np.take(arr, indices, axis=3)</code> is equivalent to
<code>arr[:,:,:,indices,...]</code>.</p>
<p>Explained without fancy indexing, this is equivalent to the following use
of <code>ndindex</code>, which sets each of <code>ii</code>, <code>jj</code>, and <code>kk</code> to a tuple of</p>
<ul>
<li>
<p><strong>indices::</strong></p>
<p>Ni, Nk = a.shape[:axis], a.shape[axis+1:]
Nj = indices.shape
for ii in ndindex(Ni):
    for jj in ndindex(Nj):
        for kk in ndindex(Nk):
            out[ii + jj + kk] = a[ii + (indices[jj],) + kk]</p>
</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like (Ni..., M, Nk...)</strong>
    The source array.</p>
</li>
<li>
<p><strong>indices : array_like (Nj...)</strong>
    The indices of the values to extract.</p>
<p>.. versionadded:: 1.8.0</p>
<p>Also allow scalars for indices.</p>
</li>
<li>
<p><strong>axis : int, optional</strong>
    The axis over which to select values. By default, the flattened
    input array is used.</p>
</li>
<li>
<p><strong>out : ndarray, optional (Ni..., Nj..., Nk...)</strong>
    If provided, the result will be placed in this array. It should
    be of the appropriate shape and dtype. Note that <code>out</code> is always
    buffered if <code>mode='raise'</code>; use other modes for better performance.</p>
</li>
<li>
<p><strong>mode : {'raise', 'wrap', 'clip'}, optional</strong>
    Specifies how out-of-bounds indices will behave.</p>
<ul>
<li>'raise' -- raise an error (default)</li>
<li>'wrap' -- wrap around</li>
<li>'clip' -- clip to the range</li>
</ul>
<p>'clip' mode means that all indices that are too large are replaced
by the index that addresses the last element along that axis. Note
that this disables indexing with negative numbers.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray (Ni..., Nj..., Nk...)</strong>
    The returned array has the same type as <code>a</code>.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>compress : Take elements using a boolean mask</strong></p>
</li>
<li>
<p><strong>ndarray.take : equivalent method</strong></p>
</li>
<li>
<p><strong>take_along_axis : Take elements by matching the array and the index arrays</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>By eliminating the inner loop in the description above, and using <code>s_</code> to
build simple slice objects, <code>take</code> can be expressed  in terms of applying
fancy indexing to each 1-d slice::</p>
<div class="codehilite"><pre><span></span><code>Ni, Nk = a.shape[:axis], a.shape[axis+1:]
for ii in ndindex(Ni):
    for kk in ndindex(Nj):
        out[ii + s_[...,] + kk] = a[ii + s_[:,] + kk][indices]
</code></pre></div>


<p>For this reason, it is equivalent to (but faster than) the following use
of <code>apply_along_axis</code>::</p>
<div class="codehilite"><pre><span></span><code>out = np.apply_along_axis(lambda a_1d: a_1d[indices], axis, a)
</code></pre></div>


<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</code></pre></div>

<p>In this example if <code>a</code> is an ndarray, 'fancy' indexing can be used.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</code></pre></div>

<p>If <code>indices</code> is not one dimensional, the output also has these dimensions.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="transpose_2">transpose<a class="headerlink" href="#transpose_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function transpose</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">transpose</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axes</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Reverse or permute the axes of an array; returns the modified array.</p>
<p>For an array a with two axes, transpose(a) gives the matrix transpose.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input array.</p>
</li>
<li>
<p><strong>axes : tuple or list of ints, optional</strong>
    If specified, it must be a tuple or list which contains a permutation of
    [0,1,..,N-1] where N is the number of axes of a.  The i'th axis of the
    returned array will correspond to the axis numbered <code>axes[i]</code> of the
    input.  If not specified, defaults to <code>range(a.ndim)[::-1]</code>, which
    reverses the order of the axes.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>p : ndarray</strong>
    <code>a</code> with its axes permuted.  A view is returned whenever
    possible.</li>
</ul>
<h4>See Also</h4>
<p>moveaxis
argsort</p>
<h4>Notes</h4>
<p>Use <code>transpose(a, argsort(axes))</code> to invert the transposition of tensors
when using the <code>axes</code> keyword argument.</p>
<p>Transposing a 1-D array returns an unchanged view of the original array.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="triu">triu<a class="headerlink" href="#triu" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function triu</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">triu</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">k</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">m</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Upper triangle of an array.</p>
<p>Return a copy of a matrix with the elements below the <code>k</code>-th diagonal
zeroed.</p>
<p>Please refer to the documentation for <code>tril</code> for further details.</p>
<h4>See Also</h4>
<ul>
<li><strong>tril : lower triangle of an array</strong></li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="zeros_1">zeros<a class="headerlink" href="#zeros_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function zeros</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">zeros</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">shape</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>zeros(shape, dtype=float, order='C')</p>
<p>Return a new array of given shape and type, filled with zeros.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>shape : int or tuple of ints</strong>
    Shape of the new array, e.g., <code>(2, 3)</code> or <code>2</code>.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array, e.g., <code>numpy.int8</code>.  Default is
    <code>numpy.float64</code>.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional, default: 'C'</strong>
    Whether to store multi-dimensional data in row-major
    (C-style) or column-major (Fortran-style) order in
    memory.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array of zeros with the given shape, dtype, and order.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span> <span class="c1"># custom dtype</span>
<span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
</code></pre></div>

</details>
<h2 id="minpack2">Minpack2<a class="headerlink" href="#minpack2" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Minpack2</code> wraps Python module <code>scipy.optimize.minpack2</code>.</p>
<h2 id="moduletnc">ModuleTNC<a class="headerlink" href="#moduletnc" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​ModuleTNC</code> wraps Python module <code>scipy.optimize.moduleTNC</code>.</p>
<h2 id="nonlin">Nonlin<a class="headerlink" href="#nonlin" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin</code> wraps Python module <code>scipy.optimize.nonlin</code>.</p>
<h2 id="anderson">Anderson<a class="headerlink" href="#anderson" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​Anderson</code> wraps Python class <code>scipy.optimize.nonlin.Anderson</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_13">create<a class="headerlink" href="#create_13" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">w0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using (extended) Anderson mixing.</p>
<p>The Jacobian is formed by for a 'best' solution in the space
spanned by last <code>M</code> vectors. As a result, only a MxM matrix
inversions and MxN multiplications are required. [Ey]_</p>
<h4>Parameters</h4>
<p>%(params_basic)s</p>
<ul>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is (-1/alpha).</p>
</li>
<li>
<p><strong>M : float, optional</strong>
    Number of previous vectors to retain. Defaults to 5.</p>
</li>
<li>
<p><strong>w0 : float, optional</strong>
    Regularization parameter for numerical stability.
    Compared to unity, good values of the order of 0.01.
%(params_extra)s</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='anderson'</code> in particular.</li>
</ul>
<h4>References</h4>
<p>.. [Ey] V. Eyert, J. Comp. Phys., 124, 271 (1996).</p>
</details>
<h3 id="aspreconditioner">aspreconditioner<a class="headerlink" href="#aspreconditioner" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_2">matvec<a class="headerlink" href="#matvec_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup">setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve">solve<a class="headerlink" href="#solve" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_3">update<a class="headerlink" href="#update_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_17">to_string<a class="headerlink" href="#to_string_17" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_17">show<a class="headerlink" href="#show_17" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_17">pp<a class="headerlink" href="#pp_17" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="broydenfirst">BroydenFirst<a class="headerlink" href="#broydenfirst" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​BroydenFirst</code> wraps Python class <code>scipy.optimize.nonlin.BroydenFirst</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_14">create<a class="headerlink" href="#create_14" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">reduction_method</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_rank</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Broyden's first Jacobian approximation.</p>
<p>This method is also known as \'Broyden's good method\'.</p>
<h4>Parameters</h4>
<p>%(params_basic)s
%(broyden_params)s
%(params_extra)s</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='broyden1'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm implements the inverse Jacobian Quasi-Newton update</p>
<p>.. math:: H_+ = H + (dx - H df) dx^\dagger H / ( dx^\dagger H df)</p>
<p>which corresponds to Broyden's first Jacobian update</p>
<p>.. math:: J_+ = J + (df - J dx) dx^\dagger / dx^\dagger dx</p>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   \'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations\'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="aspreconditioner_1">aspreconditioner<a class="headerlink" href="#aspreconditioner_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_3">matvec<a class="headerlink" href="#matvec_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rmatvec_2">rmatvec<a class="headerlink" href="#rmatvec_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rsolve">rsolve<a class="headerlink" href="#rsolve" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_1">setup<a class="headerlink" href="#setup_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_1">solve<a class="headerlink" href="#solve_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="todense_1">todense<a class="headerlink" href="#todense_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method todense</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">todense</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_4">update<a class="headerlink" href="#update_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_18">to_string<a class="headerlink" href="#to_string_18" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_18">show<a class="headerlink" href="#show_18" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_18">pp<a class="headerlink" href="#pp_18" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="broydensecond">BroydenSecond<a class="headerlink" href="#broydensecond" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​BroydenSecond</code> wraps Python class <code>scipy.optimize.nonlin.BroydenSecond</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_15">create<a class="headerlink" href="#create_15" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">reduction_method</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_rank</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Broyden's second Jacobian approximation.</p>
<p>This method is also known as 'Broyden's bad method'.</p>
<h4>Parameters</h4>
<p>%(params_basic)s
%(broyden_params)s
%(params_extra)s</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='broyden2'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm implements the inverse Jacobian Quasi-Newton update</p>
<p>.. math:: H_+ = H + (dx - H df) df^\dagger / ( df^\dagger df)</p>
<p>corresponding to Broyden's second method.</p>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="aspreconditioner_2">aspreconditioner<a class="headerlink" href="#aspreconditioner_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_4">matvec<a class="headerlink" href="#matvec_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rmatvec_3">rmatvec<a class="headerlink" href="#rmatvec_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rsolve_1">rsolve<a class="headerlink" href="#rsolve_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_2">setup<a class="headerlink" href="#setup_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_2">solve<a class="headerlink" href="#solve_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="todense_2">todense<a class="headerlink" href="#todense_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method todense</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">todense</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_5">update<a class="headerlink" href="#update_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_19">to_string<a class="headerlink" href="#to_string_19" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_19">show<a class="headerlink" href="#show_19" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_19">pp<a class="headerlink" href="#pp_19" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="diagbroyden">DiagBroyden<a class="headerlink" href="#diagbroyden" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​DiagBroyden</code> wraps Python class <code>scipy.optimize.nonlin.DiagBroyden</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_16">create<a class="headerlink" href="#create_16" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using diagonal Broyden Jacobian approximation.</p>
<p>The Jacobian approximation is derived from previous iterations, by
retaining only the diagonal of Broyden matrices.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>Parameters</h4>
<p>%(params_basic)s</p>
<ul>
<li><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is (-1/alpha).
%(params_extra)s</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='diagbroyden'</code> in particular.</li>
</ul>
</details>
<h3 id="aspreconditioner_3">aspreconditioner<a class="headerlink" href="#aspreconditioner_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_5">matvec<a class="headerlink" href="#matvec_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rmatvec_4">rmatvec<a class="headerlink" href="#rmatvec_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rsolve_2">rsolve<a class="headerlink" href="#rsolve_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_3">setup<a class="headerlink" href="#setup_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_3">solve<a class="headerlink" href="#solve_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="todense_3">todense<a class="headerlink" href="#todense_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method todense</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">todense</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_6">update<a class="headerlink" href="#update_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_20">to_string<a class="headerlink" href="#to_string_20" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_20">show<a class="headerlink" href="#show_20" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_20">pp<a class="headerlink" href="#pp_20" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="excitingmixing">ExcitingMixing<a class="headerlink" href="#excitingmixing" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​ExcitingMixing</code> wraps Python class <code>scipy.optimize.nonlin.ExcitingMixing</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_17">create<a class="headerlink" href="#create_17" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alphamax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using a tuned diagonal Jacobian approximation.</p>
<p>The Jacobian matrix is diagonal and is tuned on each iteration.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='excitingmixing'</code> in particular.</li>
</ul>
<h4>Parameters</h4>
<p>%(params_basic)s</p>
<ul>
<li>
<p><strong>alpha : float, optional</strong>
    Initial Jacobian approximation is (-1/alpha).</p>
</li>
<li>
<p><strong>alphamax : float, optional</strong>
    The entries of the diagonal Jacobian are kept in the range
    <code>[alpha, alphamax]</code>.
%(params_extra)s</p>
</li>
</ul>
</details>
<h3 id="aspreconditioner_4">aspreconditioner<a class="headerlink" href="#aspreconditioner_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_6">matvec<a class="headerlink" href="#matvec_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rmatvec_5">rmatvec<a class="headerlink" href="#rmatvec_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rsolve_3">rsolve<a class="headerlink" href="#rsolve_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_4">setup<a class="headerlink" href="#setup_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_4">solve<a class="headerlink" href="#solve_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="todense_4">todense<a class="headerlink" href="#todense_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method todense</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">todense</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_7">update<a class="headerlink" href="#update_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_21">to_string<a class="headerlink" href="#to_string_21" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_21">show<a class="headerlink" href="#show_21" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_21">pp<a class="headerlink" href="#pp_21" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="genericbroyden">GenericBroyden<a class="headerlink" href="#genericbroyden" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​GenericBroyden</code> wraps Python class <code>scipy.optimize.nonlin.GenericBroyden</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_18">create<a class="headerlink" href="#create_18" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Common interface for Jacobians or Jacobian approximations.</p>
<p>The optional methods come useful when implementing trust region
etc., algorithms that often require evaluating transposes of the
Jacobian.</p>
<h4>Methods</h4>
<p>solve
    Returns J^-1 * v
update
    Updates Jacobian to point <code>x</code> (where the function has residual <code>Fx</code>)</p>
<ul>
<li>
<p><strong>matvec : optional</strong>
    Returns J * v</p>
</li>
<li>
<p><strong>rmatvec : optional</strong>
    Returns A^H * v</p>
</li>
<li>
<p><strong>rsolve : optional</strong>
    Returns A^-H * v</p>
</li>
<li>
<p><strong>matmat : optional</strong>
    Returns A * V, where V is a dense matrix with dimensions (N,K).</p>
</li>
<li>
<p><strong>todense : optional</strong>
    Form the dense Jacobian matrix. Necessary for dense trust region
    algorithms, and useful for testing.</p>
</li>
</ul>
<h4>Attributes</h4>
<p>shape
    Matrix dimensions (M, N)
dtype
    Data type of the matrix.</p>
<ul>
<li><strong>func : callable, optional</strong>
    Function the Jacobian corresponds to</li>
</ul>
</details>
<h3 id="aspreconditioner_5">aspreconditioner<a class="headerlink" href="#aspreconditioner_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_5">setup<a class="headerlink" href="#setup_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_5">solve<a class="headerlink" href="#solve_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_8">update<a class="headerlink" href="#update_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_22">to_string<a class="headerlink" href="#to_string_22" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_22">show<a class="headerlink" href="#show_22" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_22">pp<a class="headerlink" href="#pp_22" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="inversejacobian">InverseJacobian<a class="headerlink" href="#inversejacobian" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​InverseJacobian</code> wraps Python class <code>scipy.optimize.nonlin.InverseJacobian</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_19">create<a class="headerlink" href="#create_19" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_23">to_string<a class="headerlink" href="#to_string_23" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_23">show<a class="headerlink" href="#show_23" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_23">pp<a class="headerlink" href="#pp_23" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="jacobian">Jacobian<a class="headerlink" href="#jacobian" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​Jacobian</code> wraps Python class <code>scipy.optimize.nonlin.Jacobian</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_20">create<a class="headerlink" href="#create_20" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Common interface for Jacobians or Jacobian approximations.</p>
<p>The optional methods come useful when implementing trust region
etc., algorithms that often require evaluating transposes of the
Jacobian.</p>
<h4>Methods</h4>
<p>solve
    Returns J^-1 * v
update
    Updates Jacobian to point <code>x</code> (where the function has residual <code>Fx</code>)</p>
<ul>
<li>
<p><strong>matvec : optional</strong>
    Returns J * v</p>
</li>
<li>
<p><strong>rmatvec : optional</strong>
    Returns A^H * v</p>
</li>
<li>
<p><strong>rsolve : optional</strong>
    Returns A^-H * v</p>
</li>
<li>
<p><strong>matmat : optional</strong>
    Returns A * V, where V is a dense matrix with dimensions (N,K).</p>
</li>
<li>
<p><strong>todense : optional</strong>
    Form the dense Jacobian matrix. Necessary for dense trust region
    algorithms, and useful for testing.</p>
</li>
</ul>
<h4>Attributes</h4>
<p>shape
    Matrix dimensions (M, N)
dtype
    Data type of the matrix.</p>
<ul>
<li><strong>func : callable, optional</strong>
    Function the Jacobian corresponds to</li>
</ul>
</details>
<h3 id="aspreconditioner_6">aspreconditioner<a class="headerlink" href="#aspreconditioner_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_6">setup<a class="headerlink" href="#setup_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_6">solve<a class="headerlink" href="#solve_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_9">update<a class="headerlink" href="#update_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="shape_1">shape<a class="headerlink" href="#shape_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute shape</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">shape</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">shape_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="dtype">dtype<a class="headerlink" href="#dtype" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute dtype</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dtype</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">dtype_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="func">func<a class="headerlink" href="#func" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute func</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">func</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">func_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="to_string_24">to_string<a class="headerlink" href="#to_string_24" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_24">show<a class="headerlink" href="#show_24" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_24">pp<a class="headerlink" href="#pp_24" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="krylovjacobian">KrylovJacobian<a class="headerlink" href="#krylovjacobian" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​KrylovJacobian</code> wraps Python class <code>scipy.optimize.nonlin.KrylovJacobian</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_21">create<a class="headerlink" href="#create_21" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">rdiff</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cgs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Minres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Gmres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lgmres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bicgstab</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">inner_maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">inner_M</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">outer_k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Krylov approximation for inverse Jacobian.</p>
<p>This method is suitable for solving large-scale problems.</p>
<h4>Parameters</h4>
<p>%(params_basic)s</p>
<ul>
<li>
<p><strong>rdiff : float, optional</strong>
    Relative step size to use in numerical differentiation.</p>
</li>
<li>
<p><strong>method : {'lgmres', 'gmres', 'bicgstab', 'cgs', 'minres'} or function</strong>
    Krylov method to use to approximate the Jacobian.
    Can be a string, or a function implementing the same interface as
    the iterative solvers in <code>scipy.sparse.linalg</code>.</p>
<p>The default is <code>scipy.sparse.linalg.lgmres</code>.</p>
</li>
<li>
<p><strong>inner_maxiter : int, optional</strong>
    Parameter to pass to the 'inner' Krylov solver: maximum number of
    iterations. Iteration will stop after maxiter steps even if the
    specified tolerance has not been achieved.</p>
</li>
<li>
<p><strong>inner_M : LinearOperator or InverseJacobian</strong>
    Preconditioner for the inner Krylov iteration.
    Note that you can use also inverse Jacobians as (adaptive)
    preconditioners. For example,</p>
<blockquote>
<blockquote>
<blockquote>
<p>from scipy.optimize.nonlin import BroydenFirst, KrylovJacobian
from scipy.optimize.nonlin import InverseJacobian
jac = BroydenFirst()
kjac = KrylovJacobian(inner_M=InverseJacobian(jac))</p>
</blockquote>
</blockquote>
</blockquote>
<p>If the preconditioner has a method named 'update', it will be called
as <code>update(x, f)</code> after each nonlinear step, with <code>x</code> giving
the current point, and <code>f</code> the current function value.</p>
</li>
<li>
<p><strong>outer_k : int, optional</strong>
    Size of the subspace kept across LGMRES nonlinear iterations.
    See <code>scipy.sparse.linalg.lgmres</code> for details.</p>
</li>
<li>
<p><strong>inner_kwargs : kwargs</strong>
    Keyword parameters for the 'inner' Krylov solver
    (defined with <code>method</code>). Parameter names must start with
    the <code>inner_</code> prefix which will be stripped before passing on
    the inner method. See, e.g., <code>scipy.sparse.linalg.gmres</code> for details.
%(params_extra)s</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='krylov'</code> in particular.
scipy.sparse.linalg.gmres
scipy.sparse.linalg.lgmres</li>
</ul>
<h4>Notes</h4>
<p>This function implements a Newton-Krylov solver. The basic idea is
to compute the inverse of the Jacobian with an iterative Krylov
method. These methods require only evaluating the Jacobian-vector
products, which are conveniently approximated by a finite difference:</p>
<p>.. math:: J v \approx (f(x + \omega*v/|v|) - f(x)) / \omega</p>
<p>Due to the use of iterative matrix inverses, these methods can
deal with large nonlinear problems.</p>
<p>SciPy's <code>scipy.sparse.linalg</code> module offers a selection of Krylov
solvers to choose from. The default here is <code>lgmres</code>, which is a
variant of restarted GMRES iteration that reuses some of the
information obtained in the previous Newton steps to invert
Jacobians in subsequent steps.</p>
<p>For a review on Newton-Krylov methods, see for example [1]<em>,
and for the LGMRES sparse inverse method, see [2]</em>.</p>
<h4>References</h4>
<p>.. [1] D.A. Knoll and D.E. Keyes, J. Comp. Phys. 193, 357 (2004).
       :doi:<code>10.1016/j.jcp.2003.08.010</code>
.. [2] A.H. Baker and E.R. Jessup and T. Manteuffel,
       SIAM J. Matrix Anal. Appl. 26, 962 (2005).
       :doi:<code>10.1137/S0895479803422014</code></p>
</details>
<h3 id="aspreconditioner_7">aspreconditioner<a class="headerlink" href="#aspreconditioner_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_7">matvec<a class="headerlink" href="#matvec_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_7">setup<a class="headerlink" href="#setup_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_7">solve<a class="headerlink" href="#solve_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">rhs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_10">update<a class="headerlink" href="#update_10" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_25">to_string<a class="headerlink" href="#to_string_25" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_25">show<a class="headerlink" href="#show_25" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_25">pp<a class="headerlink" href="#pp_25" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="linearmixing">LinearMixing<a class="headerlink" href="#linearmixing" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​LinearMixing</code> wraps Python class <code>scipy.optimize.nonlin.LinearMixing</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_22">create<a class="headerlink" href="#create_22" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using a scalar Jacobian approximation.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>Parameters</h4>
<p>%(params_basic)s</p>
<ul>
<li><strong>alpha : float, optional</strong>
    The Jacobian approximation is (-1/alpha).
%(params_extra)s</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='linearmixing'</code> in particular.</li>
</ul>
</details>
<h3 id="aspreconditioner_8">aspreconditioner<a class="headerlink" href="#aspreconditioner_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method aspreconditioner</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">aspreconditioner</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="matvec_8">matvec<a class="headerlink" href="#matvec_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rmatvec_6">rmatvec<a class="headerlink" href="#rmatvec_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rsolve_4">rsolve<a class="headerlink" href="#rsolve_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="setup_8">setup<a class="headerlink" href="#setup_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method setup</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">setup</span> <span class="o">:</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="solve_8">solve<a class="headerlink" href="#solve_8" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="todense_5">todense<a class="headerlink" href="#todense_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method todense</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">todense</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="update_11">update<a class="headerlink" href="#update_11" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method update</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">update</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_26">to_string<a class="headerlink" href="#to_string_26" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_26">show<a class="headerlink" href="#show_26" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_26">pp<a class="headerlink" href="#pp_26" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="lowrankmatrix">LowRankMatrix<a class="headerlink" href="#lowrankmatrix" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​LowRankMatrix</code> wraps Python class <code>scipy.optimize.nonlin.LowRankMatrix</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_23">create<a class="headerlink" href="#create_23" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="n">alpha</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">n</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">dtype</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>A matrix represented as</p>
<p>.. math:: \alpha I + \sum_{n=0}^{n=M} c_n d_n^\dagger</p>
<p>However, if the rank of the matrix reaches the dimension of the vectors,
full matrix representation will be used thereon.</p>
</details>
<h3 id="append">append<a class="headerlink" href="#append" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method append</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">append</span> <span class="o">:</span>
  <span class="n">c</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">d</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="collapse">collapse<a class="headerlink" href="#collapse" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method collapse</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">collapse</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Collapse the low-rank matrix to a full-rank one.</p>
</details>
<h3 id="matvec_9">matvec<a class="headerlink" href="#matvec_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method matvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">matvec</span> <span class="o">:</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Evaluate w = M v</p>
</details>
<h3 id="restart_reduce">restart_reduce<a class="headerlink" href="#restart_reduce" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method restart_reduce</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">restart_reduce</span> <span class="o">:</span>
  <span class="n">rank</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Reduce the rank of the matrix by dropping all vectors.</p>
</details>
<h3 id="rmatvec_7">rmatvec<a class="headerlink" href="#rmatvec_7" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rmatvec</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rmatvec</span> <span class="o">:</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Evaluate w = M^H v</p>
</details>
<h3 id="rsolve_5">rsolve<a class="headerlink" href="#rsolve_5" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method rsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Evaluate w = M^-H v</p>
</details>
<h3 id="simple_reduce">simple_reduce<a class="headerlink" href="#simple_reduce" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method simple_reduce</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">simple_reduce</span> <span class="o">:</span>
  <span class="n">rank</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Reduce the rank of the matrix by dropping oldest vectors.</p>
</details>
<h3 id="solve_9">solve<a class="headerlink" href="#solve_9" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">v</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Evaluate w = M^-1 v</p>
</details>
<h3 id="svd_reduce">svd_reduce<a class="headerlink" href="#svd_reduce" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method svd_reduce</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">svd_reduce</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">to_retain</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">max_rank</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Reduce the rank of the matrix by retaining some SVD components.</p>
<p>This corresponds to the 'Broyden Rank Reduction Inverse'
algorithm described in [1]_.</p>
<p>Note that the SVD decomposition can be done by solving only a
problem whose size is the effective rank of this matrix, which
is viable even for large problems.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>max_rank : int</strong>
    Maximum rank of this matrix after reduction.</p>
</li>
<li>
<p><strong>to_retain : int, optional</strong>
    Number of SVD components to retain when reduction is done
    (ie. rank &gt; max_rank). Default is <code>max_rank - 2</code>.</p>
</li>
</ul>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="to_string_27">to_string<a class="headerlink" href="#to_string_27" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_27">show<a class="headerlink" href="#show_27" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_27">pp<a class="headerlink" href="#pp_27" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="noconvergence">NoConvergence<a class="headerlink" href="#noconvergence" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​NoConvergence</code> wraps Python class <code>scipy.optimize.nonlin.NoConvergence</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback_3">with_traceback<a class="headerlink" href="#with_traceback_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method with_traceback</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_28">to_string<a class="headerlink" href="#to_string_28" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_28">show<a class="headerlink" href="#show_28" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_28">pp<a class="headerlink" href="#pp_28" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="terminationcondition">TerminationCondition<a class="headerlink" href="#terminationcondition" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Nonlin.​TerminationCondition</code> wraps Python class <code>scipy.optimize.nonlin.TerminationCondition</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_24">create<a class="headerlink" href="#create_24" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Termination condition for an iteration. It is terminated if</p>
<ul>
<li>|F| &lt; f_rtol*|F_0|, AND</li>
<li>|F| &lt; f_tol</li>
</ul>
<p>AND</p>
<ul>
<li>|dx| &lt; x_rtol*|x|, AND</li>
<li>|dx| &lt; x_tol</li>
</ul>
</details>
<h3 id="check">check<a class="headerlink" href="#check" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method check</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">check</span> <span class="o">:</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">dx</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_29">to_string<a class="headerlink" href="#to_string_29" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_29">show<a class="headerlink" href="#show_29" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_29">pp<a class="headerlink" href="#pp_29" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="anderson_1">anderson<a class="headerlink" href="#anderson_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function anderson</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">anderson</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">w0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using (extended) Anderson mixing.</p>
<p>The Jacobian is formed by for a 'best' solution in the space
spanned by last <code>M</code> vectors. As a result, only a MxM matrix
inversions and MxN multiplications are required. [Ey]_</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is (-1/alpha).</p>
</li>
<li>
<p><strong>M : float, optional</strong>
    Number of previous vectors to retain. Defaults to 5.</p>
</li>
<li>
<p><strong>w0 : float, optional</strong>
    Regularization parameter for numerical stability.
    Compared to unity, good values of the order of 0.01.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='anderson'</code> in particular.</li>
</ul>
<h4>References</h4>
<p>.. [Ey] V. Eyert, J. Comp. Phys., 124, 271 (1996).</p>
</details>
<h3 id="asarray_2">asarray<a class="headerlink" href="#asarray_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">F</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the input to an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input data, in any form that can be converted to an array.  This
    includes lists, lists of tuples, tuples, tuples of tuples, tuples
    of lists and ndarrays.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    By default, the data-type is inferred from the input data.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional</strong>
    Whether to use row-major (C-style) or
    column-major (Fortran-style) memory representation.
    Defaults to 'C'.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array interpretation of <code>a</code>.  No copy is performed if the input
    is already an ndarray with matching dtype and order.  If <code>a</code> is a
    subclass of ndarray, a base class ndarray is returned.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>asanyarray : Similar function which passes through subclasses.</strong></p>
</li>
<li>
<p><strong>ascontiguousarray : Convert input to a contiguous array.</strong></p>
</li>
<li>
<p><strong>asfarray : Convert input to a floating point ndarray.</strong></p>
</li>
<li>
<p><strong>asfortranarray : Convert input to an ndarray with column-major</strong>
                 memory order.</p>
</li>
<li>
<p><strong>asarray_chkfinite : Similar function which checks input for NaNs and Infs.</strong></p>
</li>
<li>
<p><strong>fromiter : Create an array from an iterator.</strong></p>
</li>
<li>
<p><strong>fromfunction : Construct an array by executing a function on grid</strong>
               positions.</p>
</li>
</ul>
<h4>Examples</h4>
<p>Convert a list into an array:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div>

<p>Existing arrays are not copied:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

<p>If <code>dtype</code> is set, array is copied only if dtype does not match:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
</code></pre></div>

<p>Contrary to <code>asanyarray</code>, ndarray subclasses are not passed through:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4,i4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="asjacobian">asjacobian<a class="headerlink" href="#asjacobian" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asjacobian</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asjacobian</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert given object to one suitable for use as a Jacobian.</p>
</details>
<h3 id="broyden1">broyden1<a class="headerlink" href="#broyden1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function broyden1</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">broyden1</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">reduction_method</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_rank</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Broyden's first Jacobian approximation.</p>
<p>This method is also known as \'Broyden's good method\'.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is <code>(-1/alpha)</code>.</p>
</li>
<li>
<p><strong>reduction_method : str or tuple, optional</strong>
    Method used in ensuring that the rank of the Broyden matrix
    stays low. Can either be a string giving the name of the method,
    or a tuple of the form <code>(method, param1, param2, ...)</code>
    that gives the name of the method and values for additional parameters.</p>
<p>Methods available:</p>
<div class="codehilite"><pre><span></span><code>- ``restart``: drop all matrix columns. Has no extra parameters.
- ``simple``: drop oldest matrix column. Has no extra parameters.
- ``svd``: keep only the most significant SVD components.
  Takes an extra parameter, ``to_retain``, which determines the
  number of SVD components to retain when rank reduction is done.
  Default is ``max_rank - 2``.
</code></pre></div>


</li>
<li>
<p><strong>max_rank : int, optional</strong>
    Maximum rank for the Broyden matrix.
    Default is infinity (i.e., no rank reduction).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='broyden1'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm implements the inverse Jacobian Quasi-Newton update</p>
<p>.. math:: H_+ = H + (dx - H df) dx^\dagger H / ( dx^\dagger H df)</p>
<p>which corresponds to Broyden's first Jacobian update</p>
<p>.. math:: J_+ = J + (df - J dx) dx^\dagger / dx^\dagger dx</p>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   \'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations\'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="broyden2">broyden2<a class="headerlink" href="#broyden2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function broyden2</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">broyden2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">reduction_method</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_rank</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Broyden's second Jacobian approximation.</p>
<p>This method is also known as 'Broyden's bad method'.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is <code>(-1/alpha)</code>.</p>
</li>
<li>
<p><strong>reduction_method : str or tuple, optional</strong>
    Method used in ensuring that the rank of the Broyden matrix
    stays low. Can either be a string giving the name of the method,
    or a tuple of the form <code>(method, param1, param2, ...)</code>
    that gives the name of the method and values for additional parameters.</p>
<p>Methods available:</p>
<div class="codehilite"><pre><span></span><code>- ``restart``: drop all matrix columns. Has no extra parameters.
- ``simple``: drop oldest matrix column. Has no extra parameters.
- ``svd``: keep only the most significant SVD components.
  Takes an extra parameter, ``to_retain``, which determines the
  number of SVD components to retain when rank reduction is done.
  Default is ``max_rank - 2``.
</code></pre></div>


</li>
<li>
<p><strong>max_rank : int, optional</strong>
    Maximum rank for the Broyden matrix.
    Default is infinity (i.e., no rank reduction).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='broyden2'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm implements the inverse Jacobian Quasi-Newton update</p>
<p>.. math:: H_+ = H + (dx - H df) df^\dagger / ( df^\dagger df)</p>
<p>corresponding to Broyden's second method.</p>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="diagbroyden_1">diagbroyden<a class="headerlink" href="#diagbroyden_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function diagbroyden</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">diagbroyden</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using diagonal Broyden Jacobian approximation.</p>
<p>The Jacobian approximation is derived from previous iterations, by
retaining only the diagonal of Broyden matrices.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is (-1/alpha).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='diagbroyden'</code> in particular.</li>
</ul>
</details>
<h3 id="dot_6">dot<a class="headerlink" href="#dot_6" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function dot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dot</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>dot(a, b, out=None)</p>
<p>Dot product of two arrays. Specifically,</p>
<ul>
<li>
<p>If both <code>a</code> and <code>b</code> are 1-D arrays, it is inner product of vectors
  (without complex conjugation).</p>
</li>
<li>
<p>If both <code>a</code> and <code>b</code> are 2-D arrays, it is matrix multiplication,
  but using :func:<code>matmul</code> or <code>a @ b</code> is preferred.</p>
</li>
<li>
<p>If either <code>a</code> or <code>b</code> is 0-D (scalar), it is equivalent to :func:<code>multiply</code>
  and using <code>numpy.multiply(a, b)</code> or <code>a * b</code> is preferred.</p>
</li>
<li>
<p>If <code>a</code> is an N-D array and <code>b</code> is a 1-D array, it is a sum product over
  the last axis of <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p>If <code>a</code> is an N-D array and <code>b</code> is an M-D array (where <code>M&gt;=2</code>), it is a
  sum product over the last axis of <code>a</code> and the second-to-last axis of <code>b</code>::</p>
<p>dot(a, b)[i,j,k,m] = sum(a[i,j,:] * b[k,:,m])</p>
</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    First argument.</p>
</li>
<li>
<p><strong>b : array_like</strong>
    Second argument.</p>
</li>
<li>
<p><strong>out : ndarray, optional</strong>
    Output argument. This must have the exact kind that would be returned
    if it was not used. In particular, it must have the right type, must be
    C-contiguous, and its dtype must be the dtype that would be returned
    for <code>dot(a,b)</code>. This is a performance feature. Therefore, if these
    conditions are not met, an exception is raised, instead of attempting
    to be flexible.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>output : ndarray</strong>
    Returns the dot product of <code>a</code> and <code>b</code>.  If <code>a</code> and <code>b</code> are both
    scalars or both 1-D arrays then a scalar is returned; otherwise
    an array is returned.
    If <code>out</code> is given, then it is returned.</li>
</ul>
<h4>Raises</h4>
<p>ValueError
    If the last dimension of <code>a</code> is not the same size as
    the second-to-last dimension of <code>b</code>.</p>
<h4>See Also</h4>
<ul>
<li>
<p><strong>vdot : Complex-conjugating dot product.</strong></p>
</li>
<li>
<p><strong>tensordot : Sum products over arbitrary axes.</strong></p>
</li>
<li>
<p><strong>einsum : Einstein summation convention.</strong></p>
</li>
<li>
<p><strong>matmul : '@' operator as method with out parameter.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">12</span>
</code></pre></div>

<p>Neither argument is complex-conjugated:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="n">j</span><span class="p">])</span>
<span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

<p>For 2-D arrays it is the matrix product:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="mi">499128</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,</span><span class="mi">2</span><span class="p">])</span>
<span class="mi">499128</span>
</code></pre></div>

</details>
<h3 id="excitingmixing_1">excitingmixing<a class="headerlink" href="#excitingmixing_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function excitingmixing</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">excitingmixing</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alphamax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using a tuned diagonal Jacobian approximation.</p>
<p>The Jacobian matrix is diagonal and is tuned on each iteration.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='excitingmixing'</code> in particular.</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial Jacobian approximation is (-1/alpha).</p>
</li>
<li>
<p><strong>alphamax : float, optional</strong>
    The entries of the diagonal Jacobian are kept in the range
    <code>[alpha, alphamax]</code>.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
</details>
<h3 id="get_blas_funcs">get_blas_funcs<a class="headerlink" href="#get_blas_funcs" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function get_blas_funcs</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_blas_funcs</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">arrays</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dtype</span> <span class="k">of</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">names</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Sequence_of_str</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return available BLAS function objects from names.</p>
<p>Arrays are used to determine the optimal prefix of BLAS routines.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>names : str or sequence of str</strong>
    Name(s) of BLAS functions without type prefix.</p>
</li>
<li>
<p><strong>arrays : sequence of ndarrays, optional</strong>
    Arrays can be given to determine optimal prefix of BLAS
    routines. If not given, double-precision routines will be
    used, otherwise the most generic type in arrays will be used.</p>
</li>
<li>
<p><strong>dtype : str or dtype, optional</strong>
    Data-type specifier. Not used if <code>arrays</code> is non-empty.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>funcs : list</strong>
    List containing the found function(s).</li>
</ul>
<h4>Notes</h4>
<p>This routine automatically chooses between Fortran/C
interfaces. Fortran code is used whenever possible for arrays with
column major order. In all other cases, C code is preferred.</p>
<p>In BLAS, the naming convention is that all functions start with a
type prefix, which depends on the type of the principal
matrix. These can be one of {'s', 'd', 'c', 'z'} for the NumPy
types {float32, float64, complex64, complex128} respectively.
The code and the dtype are stored in attributes <code>typecode</code> and <code>dtype</code>
of the returned functions.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">LA</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_gemv</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">get_blas_funcs</span><span class="p">(</span><span class="s1">&#39;gemv&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_gemv</span><span class="o">.</span><span class="n">typecode</span>
<span class="s1">&#39;d&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_gemv</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">get_blas_funcs</span><span class="p">(</span><span class="s1">&#39;gemv&#39;</span><span class="p">,(</span><span class="n">a</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_gemv</span><span class="o">.</span><span class="n">typecode</span>
<span class="s1">&#39;z&#39;</span>
</code></pre></div>

</details>
<h3 id="inv_1">inv<a class="headerlink" href="#inv_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function inv</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">inv</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute the inverse of a matrix.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Square matrix to be inverted.</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Discard data in <code>a</code> (may improve performance). Default is False.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>ainv : ndarray</strong>
    Inverse of the matrix <code>a</code>.</li>
</ul>
<h4>Raises</h4>
<p>LinAlgError
    If <code>a</code> is singular.
ValueError
    If <code>a</code> is not square, or not 2D.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">2.</span> <span class="p">,</span>  <span class="mf">1.</span> <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="linearmixing_1">linearmixing<a class="headerlink" href="#linearmixing_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function linearmixing</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">linearmixing</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using a scalar Jacobian approximation.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    The Jacobian approximation is (-1/alpha).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='linearmixing'</code> in particular.</li>
</ul>
</details>
<h3 id="maxnorm">maxnorm<a class="headerlink" href="#maxnorm" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function maxnorm</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxnorm</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="newton_krylov">newton_krylov<a class="headerlink" href="#newton_krylov" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function newton_krylov</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">newton_krylov</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rdiff</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cgs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Minres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Gmres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lgmres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bicgstab</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">inner_maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">inner_M</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">outer_k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Krylov approximation for inverse Jacobian.</p>
<p>This method is suitable for solving large-scale problems.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>rdiff : float, optional</strong>
    Relative step size to use in numerical differentiation.</p>
</li>
<li>
<p><strong>method : {'lgmres', 'gmres', 'bicgstab', 'cgs', 'minres'} or function</strong>
    Krylov method to use to approximate the Jacobian.
    Can be a string, or a function implementing the same interface as
    the iterative solvers in <code>scipy.sparse.linalg</code>.</p>
<p>The default is <code>scipy.sparse.linalg.lgmres</code>.</p>
</li>
<li>
<p><strong>inner_maxiter : int, optional</strong>
    Parameter to pass to the 'inner' Krylov solver: maximum number of
    iterations. Iteration will stop after maxiter steps even if the
    specified tolerance has not been achieved.</p>
</li>
<li>
<p><strong>inner_M : LinearOperator or InverseJacobian</strong>
    Preconditioner for the inner Krylov iteration.
    Note that you can use also inverse Jacobians as (adaptive)
    preconditioners. For example,</p>
<blockquote>
<blockquote>
<blockquote>
<p>from scipy.optimize.nonlin import BroydenFirst, KrylovJacobian
from scipy.optimize.nonlin import InverseJacobian
jac = BroydenFirst()
kjac = KrylovJacobian(inner_M=InverseJacobian(jac))</p>
</blockquote>
</blockquote>
</blockquote>
<p>If the preconditioner has a method named 'update', it will be called
as <code>update(x, f)</code> after each nonlinear step, with <code>x</code> giving
the current point, and <code>f</code> the current function value.</p>
</li>
<li>
<p><strong>outer_k : int, optional</strong>
    Size of the subspace kept across LGMRES nonlinear iterations.
    See <code>scipy.sparse.linalg.lgmres</code> for details.</p>
</li>
<li>
<p><strong>inner_kwargs : kwargs</strong>
    Keyword parameters for the 'inner' Krylov solver
    (defined with <code>method</code>). Parameter names must start with
    the <code>inner_</code> prefix which will be stripped before passing on
    the inner method. See, e.g., <code>scipy.sparse.linalg.gmres</code> for details.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='krylov'</code> in particular.
scipy.sparse.linalg.gmres
scipy.sparse.linalg.lgmres</li>
</ul>
<h4>Notes</h4>
<p>This function implements a Newton-Krylov solver. The basic idea is
to compute the inverse of the Jacobian with an iterative Krylov
method. These methods require only evaluating the Jacobian-vector
products, which are conveniently approximated by a finite difference:</p>
<p>.. math:: J v \approx (f(x + \omega*v/|v|) - f(x)) / \omega</p>
<p>Due to the use of iterative matrix inverses, these methods can
deal with large nonlinear problems.</p>
<p>SciPy's <code>scipy.sparse.linalg</code> module offers a selection of Krylov
solvers to choose from. The default here is <code>lgmres</code>, which is a
variant of restarted GMRES iteration that reuses some of the
information obtained in the previous Newton steps to invert
Jacobians in subsequent steps.</p>
<p>For a review on Newton-Krylov methods, see for example [1]<em>,
and for the LGMRES sparse inverse method, see [2]</em>.</p>
<h4>References</h4>
<p>.. [1] D.A. Knoll and D.E. Keyes, J. Comp. Phys. 193, 357 (2004).
       :doi:<code>10.1016/j.jcp.2003.08.010</code>
.. [2] A.H. Baker and E.R. Jessup and T. Manteuffel,
       SIAM J. Matrix Anal. Appl. 26, 962 (2005).
       :doi:<code>10.1137/S0895479803422014</code></p>
</details>
<h3 id="nonlin_solve">nonlin_solve<a class="headerlink" href="#nonlin_solve" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function nonlin_solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nonlin_solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">jacobian</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">raise_exception</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, in a way suitable for large-scale problems.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>jacobian : Jacobian</strong>
    A Jacobian approximation: <code>Jacobian</code> object or something that
    <code>asjacobian</code> can transform to one. Alternatively, a string specifying
    which of the builtin Jacobian approximations to use:</p>
<div class="codehilite"><pre><span></span><code>krylov, broyden1, broyden2, anderson
diagbroyden, linearmixing, excitingmixing
</code></pre></div>


</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<ul>
<li>
<p><strong>full_output : bool</strong>
    If true, returns a dictionary <code>info</code> containing convergence
    information.</p>
</li>
<li>
<p><strong>raise_exception : bool</strong>
    If True, a <code>NoConvergence</code> exception is raise if no solution is found.</p>
</li>
</ul>
<h4>See Also</h4>
<p>asjacobian, Jacobian</p>
<h4>Notes</h4>
<p>This algorithm implements the inexact Newton method, with
backtracking or full line searches. Several Jacobian
approximations are available, including Krylov and Quasi-Newton
methods.</p>
<h4>References</h4>
<p>.. [KIM] C. T. Kelley, 'Iterative Methods for Linear and Nonlinear
   Equations'. Society for Industrial and Applied Mathematics. (1995)</p>
<ul>
<li><strong>https://archive.siam.org/books/kelley/fr16/</strong></li>
</ul>
</details>
<h3 id="norm">norm<a class="headerlink" href="#norm" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function norm</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">norm</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">ord</span><span class="o">:[`</span><span class="nc">PyObject</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Fro</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_tuple_of_ints</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">keepdims</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Matrix or vector norm.</p>
<p>This function is able to return one of seven different matrix norms,
or one of an infinite number of vector norms (described below), depending
on the value of the <code>ord</code> parameter.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (M,) or (M, N) array_like</strong>
    Input array. If <code>axis</code> is None, <code>a</code> must be 1D or 2D.</p>
</li>
<li>
<p><strong>ord : {non-zero int, inf, -inf, 'fro'}, optional</strong>
    Order of the norm (see table under <code>Notes</code>). inf means NumPy's
    <code>inf</code> object</p>
</li>
<li>
<p><strong>axis : {int, 2-tuple of ints, None}, optional</strong>
    If <code>axis</code> is an integer, it specifies the axis of <code>a</code> along which to
    compute the vector norms.  If <code>axis</code> is a 2-tuple, it specifies the
    axes that hold 2-D matrices, and the matrix norms of these matrices
    are computed.  If <code>axis</code> is None then either a vector norm (when <code>a</code>
    is 1-D) or a matrix norm (when <code>a</code> is 2-D) is returned.</p>
</li>
<li>
<p><strong>keepdims : bool, optional</strong>
    If this is set to True, the axes which are normed over are left in the
    result as dimensions with size one.  With this option the result will
    broadcast correctly against the original <code>a</code>.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>n : float or ndarray</strong>
    Norm of the matrix or vector(s).</li>
</ul>
<h4>Notes</h4>
<p>For values of <code>ord &lt;= 0</code>, the result is, strictly speaking, not a
mathematical 'norm', but it may still be useful for various numerical
purposes.</p>
<p>The following norms can be calculated:</p>
<p>=====  ============================  ==========================
ord    norm for matrices             norm for vectors
=====  ============================  ==========================
None   Frobenius norm                2-norm
'fro'  Frobenius norm                --
inf    max(sum(abs(x), axis=1))      max(abs(x))
-inf   min(sum(abs(x), axis=1))      min(abs(x))
0      --                            sum(x != 0)
1      max(sum(abs(x), axis=0))      as below
-1     min(sum(abs(x), axis=0))      as below
2      2-norm (largest sing. value)  as below
-2     smallest singular value       as below
other  --                            sum(abs(x)<strong>ord)</strong>(1./ord)
=====  ============================  ==========================</p>
<p>The Frobenius norm is given by [1]_:</p>
<div class="codehilite"><pre><span></span><code>:math:`||A||_F = [\sum_{i,j} abs(a_{i,j})^2]^{1/2}`
</code></pre></div>


<p>The <code>axis</code> and <code>keepdims</code> arguments are passed directly to
<code>numpy.linalg.norm</code> and are only usable if they are supported
by the version of numpy in use.</p>
<h4>References</h4>
<p>.. [1] G. H. Golub and C. F. Van Loan, <em>Matrix Computations</em>,
       Baltimore, MD, Johns Hopkins University Press, 1985, pg. 15</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">-</span> <span class="mf">4.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">4.</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="mf">7.745966692414834</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="mf">7.745966692414834</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s1">&#39;fro&#39;</span><span class="p">)</span>
<span class="mf">7.745966692414834</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="mi">9</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">7</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">-</span><span class="mf">4.6566128774142013e-010</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mf">7.745966692414834</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mf">7.3484692283495345</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="mf">1.8570331885190563e-016</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="mf">5.8480354764257312</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">0</span>
</code></pre></div>

</details>
<h3 id="qr">qr<a class="headerlink" href="#qr" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function qr</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">qr</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lwork</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">mode</span><span class="o">:[`</span><span class="nc">Full</span> <span class="o">|</span> <span class="o">`</span><span class="nc">R</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Economic</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Raw</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">pivoting</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Compute QR decomposition of a matrix.</p>
<p>Calculate the decomposition <code>A = Q R</code> where Q is unitary/orthogonal
and R upper triangular.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (M, N) array_like</strong>
    Matrix to be decomposed</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Whether data in <code>a</code> is overwritten (may improve performance if
    <code>overwrite_a</code> is set to True by reusing the existing input data
    structure rather than creating a new one.)</p>
</li>
<li>
<p><strong>lwork : int, optional</strong>
    Work array size, lwork &gt;= a.shape[1]. If None or -1, an optimal size
    is computed.</p>
</li>
<li>
<p><strong>mode : {'full', 'r', 'economic', 'raw'}, optional</strong>
    Determines what information is to be returned: either both Q and R
    ('full', default), only R ('r') or both Q and R but computed in
    economy-size ('economic', see Notes). The final option 'raw'
    (added in SciPy 0.11) makes the function return two matrices
    (Q, TAU) in the internal format used by LAPACK.</p>
</li>
<li>
<p><strong>pivoting : bool, optional</strong>
    Whether or not factorization should include pivoting for rank-revealing
    qr decomposition. If pivoting, compute the decomposition
    <code>A P = Q R</code> as above, but where P is chosen such that the diagonal
    of R is non-increasing.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>Q : float or complex ndarray</strong>
    Of shape (M, M), or (M, K) for <code>mode='economic'</code>. Not returned
    if <code>mode='r'</code>.</p>
</li>
<li>
<p><strong>R : float or complex ndarray</strong>
    Of shape (M, N), or (K, N) for <code>mode='economic'</code>. <code>K = min(M, N)</code>.</p>
</li>
<li>
<p><strong>P : int ndarray</strong>
    Of shape (N,) for <code>pivoting=True</code>. Not returned if
    <code>pivoting=False</code>.</p>
</li>
</ul>
<h4>Raises</h4>
<p>LinAlgError
    Raised if decomposition fails</p>
<h4>Notes</h4>
<p>This is an interface to the LAPACK routines dgeqrf, zgeqrf,
dorgqr, zungqr, dgeqp3, and zgeqp3.</p>
<p>If <code>mode=economic</code>, the shapes of Q and R are (M, K) and (K, N) instead
of (M,M) and (M,N), with <code>K=min(M,N)</code>.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">q3</span><span class="p">,</span> <span class="n">r3</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;economic&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q3</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">r3</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">q4</span><span class="p">,</span> <span class="n">r4</span><span class="p">,</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pivoting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">r4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">[:,</span> <span class="n">p4</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">q4</span><span class="p">,</span> <span class="n">r4</span><span class="p">))</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q4</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">r4</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p4</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">q5</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="n">p5</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;economic&#39;</span><span class="p">,</span> <span class="n">pivoting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">q5</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">r5</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p5</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,))</span>
</code></pre></div>

</details>
<h3 id="scalar_search_armijo_1">scalar_search_armijo<a class="headerlink" href="#scalar_search_armijo_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function scalar_search_armijo</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">scalar_search_armijo</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">phi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">phi0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">derphi0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimize over alpha, the function <code>phi(alpha)</code>.</p>
<p>Uses the interpolation algorithm (Armijo backtracking) as suggested by
Wright and Nocedal in 'Numerical Optimization', 1999, pp. 56-57</p>
<p>alpha &gt; 0 is assumed to be a descent direction.</p>
<h4>Returns</h4>
<p>alpha
phi1</p>
</details>
<h3 id="scalar_search_wolfe1_1">scalar_search_wolfe1<a class="headerlink" href="#scalar_search_wolfe1_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function scalar_search_wolfe1</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">scalar_search_wolfe1</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">phi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_phi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">derphi0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="n">phi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">derphi</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span><span class="o">)</span>
</code></pre></div>

<p>Scalar function search for alpha that satisfies strong Wolfe conditions</p>
<p>alpha &gt; 0 is assumed to be a descent direction.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>phi : callable phi(alpha)</strong>
    Function at point <code>alpha</code></p>
</li>
<li>
<p><strong>derphi : callable phi'(alpha)</strong>
    Objective function derivative. Returns a scalar.</p>
</li>
<li>
<p><strong>phi0 : float, optional</strong>
    Value of phi at 0</p>
</li>
<li>
<p><strong>old_phi0 : float, optional</strong>
    Value of phi at previous point</p>
</li>
<li>
<p><strong>derphi0 : float, optional</strong>
    Value derphi at 0</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.
amax, amin : float, optional
    Maximum and minimum step size</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Relative tolerance for an acceptable step.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha : float</strong>
    Step size, or None if no suitable step was found</p>
</li>
<li>
<p><strong>phi : float</strong>
    Value of <code>phi</code> at the new point <code>alpha</code></p>
</li>
<li>
<p><strong>phi0 : float</strong>
    Value of <code>phi</code> at <code>alpha=0</code></p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses routine DCSRCH from MINPACK.</p>
</details>
<h3 id="solve_10">solve<a class="headerlink" href="#solve_10" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">sym_pos</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lower</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">overwrite_b</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">debug</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">assume_a</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">transposed</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Solves the linear equation set <code>a * x = b</code> for the unknown <code>x</code>
for square <code>a</code> matrix.</p>
<p>If the data matrix is known to be a particular type then supplying the
corresponding string to <code>assume_a</code> key chooses the dedicated solver.
The available options are</p>
<p>===================  ========
 generic matrix       'gen'
 symmetric            'sym'
 hermitian            'her'
 positive definite    'pos'
===================  ========</p>
<p>If omitted, <code>'gen'</code> is the default structure.</p>
<p>The datatype of the arrays define which solver is called regardless
of the values. In other words, even when the complex array entries have
precisely zero imaginary parts, the complex solver will be called based
on the data type of the array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (N, N) array_like</strong>
    Square input data</p>
</li>
<li>
<p><strong>b : (N, NRHS) array_like</strong>
    Input data for the right hand side.</p>
</li>
<li>
<p><strong>sym_pos : bool, optional</strong>
    Assume <code>a</code> is symmetric and positive definite. This key is deprecated
    and assume_a = 'pos' keyword is recommended instead. The functionality
    is the same. It will be removed in the future.</p>
</li>
<li>
<p><strong>lower : bool, optional</strong>
    If True, only the data contained in the lower triangle of <code>a</code>. Default
    is to use upper triangle. (ignored for <code>'gen'</code>)</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Allow overwriting data in <code>a</code> (may enhance performance).
    Default is False.</p>
</li>
<li>
<p><strong>overwrite_b : bool, optional</strong>
    Allow overwriting data in <code>b</code> (may enhance performance).
    Default is False.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
<li>
<p><strong>assume_a : str, optional</strong>
    Valid entries are explained above.</p>
</li>
<li>
<p><strong>transposed: bool, optional</strong>
    If True, <code>a^T x = b</code> for real matrices, raises <code>NotImplementedError</code>
    for complex matrices (only for True).</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>x : (N, NRHS) ndarray</strong>
    The solution array.</li>
</ul>
<h4>Raises</h4>
<p>ValueError
    If size mismatches detected or input a is not square.
LinAlgError
    If the matrix is singular.
LinAlgWarning
    If an ill-conditioned input a is detected.
NotImplementedError
    If transposed is True and input a is a complex matrix.</p>
<h4>Examples</h4>
<p>Given <code>a</code> and <code>b</code>, solve for <code>x</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">b</span>
<span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div>

<h4>Notes</h4>
<p>If the input b matrix is a 1-D array with N elements, when supplied
together with an NxN input a, it is assumed as a valid column vector
despite the apparent size mismatch. This is compatible with the
numpy.dot() behavior and the returned result is still 1-D array.</p>
<p>The generic, symmetric, hermitian and positive definite solutions are
obtained via calling ?GESV, ?SYSV, ?HESV, and ?POSV routines of
LAPACK respectively.</p>
</details>
<h3 id="svd_1">svd<a class="headerlink" href="#svd_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function svd</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">svd</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">full_matrices</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">compute_uv</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">overwrite_a</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lapack_driver</span><span class="o">:[`</span><span class="nc">Gesdd</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Gesvd</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Singular Value Decomposition.</p>
<p>Factorizes the matrix <code>a</code> into two unitary matrices <code>U</code> and <code>Vh</code>, and
a 1-D array <code>s</code> of singular values (real, non-negative) such that
<code>a == U @ S @ Vh</code>, where <code>S</code> is a suitably shaped matrix of zeros with
main diagonal <code>s</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : (M, N) array_like</strong>
    Matrix to decompose.</p>
</li>
<li>
<p><strong>full_matrices : bool, optional</strong>
    If True (default), <code>U</code> and <code>Vh</code> are of shape <code>(M, M)</code>, <code>(N, N)</code>.
    If False, the shapes are <code>(M, K)</code> and <code>(K, N)</code>, where
    <code>K = min(M, N)</code>.</p>
</li>
<li>
<p><strong>compute_uv : bool, optional</strong>
    Whether to compute also <code>U</code> and <code>Vh</code> in addition to <code>s</code>.
    Default is True.</p>
</li>
<li>
<p><strong>overwrite_a : bool, optional</strong>
    Whether to overwrite <code>a</code>; may improve performance.
    Default is False.</p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.</p>
</li>
<li>
<p><strong>lapack_driver : {'gesdd', 'gesvd'}, optional</strong>
    Whether to use the more efficient divide-and-conquer approach
    (<code>'gesdd'</code>) or general rectangular approach (<code>'gesvd'</code>)
    to compute the SVD. MATLAB and Octave use the <code>'gesvd'</code> approach.
    Default is <code>'gesdd'</code>.</p>
<p>.. versionadded:: 0.18</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>U : ndarray</strong>
    Unitary matrix having left singular vectors as columns.
    Of shape <code>(M, M)</code> or <code>(M, K)</code>, depending on <code>full_matrices</code>.</p>
</li>
<li>
<p><strong>s : ndarray</strong>
    The singular values, sorted in non-increasing order.
    Of shape (K,), with <code>K = min(M, N)</code>.</p>
</li>
<li>
<p><strong>Vh : ndarray</strong>
    Unitary matrix having right singular vectors as rows.
    Of shape <code>(N, N)</code> or <code>(K, N)</code> depending on <code>full_matrices</code>.</p>
</li>
</ul>
<p>For <code>compute_uv=False</code>, only <code>s</code> is returned.</p>
<h4>Raises</h4>
<p>LinAlgError
    If SVD computation does not converge.</p>
<h4>See also</h4>
<ul>
<li>
<p><strong>svdvals : Compute singular values of a matrix.</strong></p>
</li>
<li>
<p><strong>diagsvd : Construct the Sigma matrix, given the vector s.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>  <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Vh</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div>

<p>Reconstruct the original matrix from the decomposition:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)):</span>
<span class="o">...</span>     <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">Vh</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<p>Alternatively, use <code>full_matrices=False</code> (notice that the shape of
<code>U</code> is then <code>(m, n)</code> instead of <code>(m, m)</code>):</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Vh</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">Vh</span><span class="p">)))</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="vdot">vdot<a class="headerlink" href="#vdot" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function vdot</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">vdot</span> <span class="o">:</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>vdot(a, b)</p>
<p>Return the dot product of two vectors.</p>
<p>The vdot(<code>a</code>, <code>b</code>) function handles complex numbers differently than
dot(<code>a</code>, <code>b</code>).  If the first argument is complex the complex conjugate
of the first argument is used for the calculation of the dot product.</p>
<p>Note that <code>vdot</code> handles multidimensional arrays differently than <code>dot</code>:
it does <em>not</em> perform a matrix product, but flattens input arguments
to 1-D vectors first. Consequently, it should only be used for vectors.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    If <code>a</code> is complex the complex conjugate is taken before calculation
    of the dot product.</p>
</li>
<li>
<p><strong>b : array_like</strong>
    Second argument to the dot product.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>output : ndarray</strong>
    Dot product of <code>a</code> and <code>b</code>.  Can be an int, float, or
    complex depending on the types of <code>a</code> and <code>b</code>.</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>dot : Return the dot product without using the complex conjugate of the</strong>
      first argument.</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="n">j</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="n">j</span><span class="p">,</span><span class="mi">7</span><span class="o">+</span><span class="mi">8</span><span class="n">j</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="p">(</span><span class="mi">70</span><span class="o">-</span><span class="mi">8</span><span class="n">j</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="p">(</span><span class="mi">70</span><span class="o">+</span><span class="mi">8</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

<p>Note that higher-dimensional arrays are flattened!</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="mi">30</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="mi">30</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="mi">2</span>
<span class="mi">30</span>
</code></pre></div>

</details>
<h2 id="optimize">Optimize<a class="headerlink" href="#optimize" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Optimize</code> wraps Python module <code>scipy.optimize.optimize</code>.</p>
<h2 id="brent">Brent<a class="headerlink" href="#brent" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Optimize.​Brent</code> wraps Python class <code>scipy.optimize.optimize.Brent</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_25">create<a class="headerlink" href="#create_25" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

</details>
<h3 id="get_bracket_info">get_bracket_info<a class="headerlink" href="#get_bracket_info" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_bracket_info</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_bracket_info</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="get_result">get_result<a class="headerlink" href="#get_result" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_result</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_result</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="optimize_1">optimize<a class="headerlink" href="#optimize_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method optimize</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">optimize</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="set_bracket">set_bracket<a class="headerlink" href="#set_bracket" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method set_bracket</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">set_bracket</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">brack</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_30">to_string<a class="headerlink" href="#to_string_30" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_30">show<a class="headerlink" href="#show_30" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_30">pp<a class="headerlink" href="#pp_30" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="linesearchwarning_1">LineSearchWarning<a class="headerlink" href="#linesearchwarning_1" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Optimize.​LineSearchWarning</code> wraps Python class <code>scipy.optimize.optimize.LineSearchWarning</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="with_traceback_4">with_traceback<a class="headerlink" href="#with_traceback_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method with_traceback</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">with_traceback</span> <span class="o">:</span>
  <span class="n">tb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Exception.with_traceback(tb) --
set self.<strong>traceback</strong> to tb and return self.</p>
</details>
<h3 id="to_string_31">to_string<a class="headerlink" href="#to_string_31" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_31">show<a class="headerlink" href="#show_31" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_31">pp<a class="headerlink" href="#pp_31" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="mapwrapper">MapWrapper<a class="headerlink" href="#mapwrapper" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Optimize.​MapWrapper</code> wraps Python class <code>scipy.optimize.optimize.MapWrapper</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_26">create<a class="headerlink" href="#create_26" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">pool</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Map_like_callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Parallelisation wrapper for working with map-like callables, such as
<code>multiprocessing.Pool.map</code>.</p>
<h4>Parameters</h4>
<ul>
<li><strong>pool : int or map-like callable</strong>
    If <code>pool</code> is an integer, then it specifies the number of threads to
    use for parallelization. If <code>int(pool) == 1</code>, then no parallel
    processing is used and the map builtin is used.
    If <code>pool == -1</code>, then the pool will utilize all available CPUs.
    If <code>pool</code> is a map-like callable that follows the same
    calling sequence as the built-in map function, then this callable is
    used for parallelization.</li>
</ul>
</details>
<h3 id="close">close<a class="headerlink" href="#close" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method close</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">close</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="join">join<a class="headerlink" href="#join" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method join</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">join</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="terminate">terminate<a class="headerlink" href="#terminate" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method terminate</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">terminate</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_32">to_string<a class="headerlink" href="#to_string_32" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_32">show<a class="headerlink" href="#show_32" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_32">pp<a class="headerlink" href="#pp_32" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h2 id="scalarfunction">ScalarFunction<a class="headerlink" href="#scalarfunction" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Optimize.​ScalarFunction</code> wraps Python class <code>scipy.optimize.optimize.ScalarFunction</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_27">create<a class="headerlink" href="#create_27" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">grad</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">hess</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">finite_diff_rel_step</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">finite_diff_bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Scalar function and its derivatives.</p>
<p>This class defines a scalar function F: R^n-&gt;R and methods for
computing or approximating its first and second derivatives.</p>
<h4>Notes</h4>
<p>This class implements a memoization logic. There are methods <code>fun</code>,
<code>grad</code>, hess<code>and corresponding attributes</code>f<code>,</code>g<code>and</code>H`. The following
things should be considered:</p>
<div class="codehilite"><pre><span></span><code>1. Use only public methods `fun`, `grad` and `hess`.
2. After one of the methods is called, the corresponding attribute
   will be set. However, a subsequent call with a different argument
   of *any* of the methods may overwrite the attribute.
</code></pre></div>


</details>
<h3 id="fun_">fun_<a class="headerlink" href="#fun_" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method fun_</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fun_</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="fun_and_grad">fun_and_grad<a class="headerlink" href="#fun_and_grad" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method fun_and_grad</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fun_and_grad</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="grad">grad<a class="headerlink" href="#grad" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method grad</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">grad</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="hess">hess<a class="headerlink" href="#hess" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method hess</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">hess</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_33">to_string<a class="headerlink" href="#to_string_33" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_33">show<a class="headerlink" href="#show_33" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_33">pp<a class="headerlink" href="#pp_33" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="approx_derivative">approx_derivative<a class="headerlink" href="#approx_derivative" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function approx_derivative</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">approx_derivative</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rel_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">abs_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">sparsity</span><span class="o">:[`</span><span class="nc">Arr</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_tuple</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">as_linear_operator</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute finite difference approximation of the derivatives of a
vector-valued function.</p>
<p>If a function maps from R^n to R^m, its derivatives form m-by-n matrix
called the Jacobian, where an element (i, j) is a partial derivative of
f[i] with respect to x[j].</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    Function of which to estimate the derivatives. The argument x
    passed to this function is ndarray of shape (n,) (never a scalar
    even if n=1). It must return 1-D array_like of shape (m,) or a scalar.</p>
</li>
<li>
<p><strong>x0 : array_like of shape (n,) or float</strong>
    Point at which to estimate the derivatives. Float will be converted
    to a 1-D array.</p>
</li>
<li>
<p><strong>method : {'3-point', '2-point', 'cs'}, optional</strong>
    Finite difference method to use:
        - '2-point' - use the first order accuracy forward or backward
                      difference.
        - '3-point' - use central difference in interior points and the
                      second order accuracy forward or backward difference
                      near the boundary.
        - 'cs' - use a complex-step finite difference scheme. This assumes
                 that the user function is real-valued and can be
                 analytically continued to the complex plane. Otherwise,
                 produces bogus results.</p>
</li>
<li>
<p><strong>rel_step : None or array_like, optional</strong>
    Relative step size to use. The absolute step size is computed as
    <code>h = rel_step * sign(x0) * max(1, abs(x0))</code>, possibly adjusted to
    fit into the bounds. For <code>method='3-point'</code> the sign of <code>h</code> is
    ignored. If None (default) then step is selected automatically,
    see Notes.</p>
</li>
<li>
<p><strong>abs_step : array_like, optional</strong>
    Absolute step size to use, possibly adjusted to fit into the bounds.
    For <code>method='3-point'</code> the sign of <code>abs_step</code> is ignored. By default
    relative steps are used, only if <code>abs_step is not None</code> are absolute
    steps used.</p>
</li>
<li>
<p><strong>f0 : None or array_like, optional</strong>
    If not None it is assumed to be equal to <code>fun(x0)</code>, in  this case
    the <code>fun(x0)</code> is not called. Default is None.</p>
</li>
<li>
<p><strong>bounds : tuple of array_like, optional</strong>
    Lower and upper bounds on independent variables. Defaults to no bounds.
    Each bound must match the size of <code>x0</code> or be a scalar, in the latter
    case the bound will be the same for all variables. Use it to limit the
    range of function evaluation. Bounds checking is not implemented
    when <code>as_linear_operator</code> is True.</p>
</li>
<li>
<p><strong>sparsity : {None, array_like, sparse matrix, 2-tuple}, optional</strong>
    Defines a sparsity structure of the Jacobian matrix. If the Jacobian
    matrix is known to have only few non-zero elements in each row, then
    it's possible to estimate its several columns by a single function
    evaluation [3]_. To perform such economic computations two ingredients
    are required:</p>
<ul>
<li>structure : array_like or sparse matrix of shape (m, n). A zero
  element means that a corresponding element of the Jacobian
  identically equals to zero.</li>
<li>groups : array_like of shape (n,). A column grouping for a given
  sparsity structure, use <code>group_columns</code> to obtain it.</li>
</ul>
<p>A single array or a sparse matrix is interpreted as a sparsity
structure, and groups are computed inside the function. A tuple is
interpreted as (structure, groups). If None (default), a standard
dense differencing will be used.</p>
<p>Note, that sparse differencing makes sense only for large Jacobian
matrices where each row contains few non-zero elements.</p>
</li>
<li>
<p><strong>as_linear_operator : bool, optional</strong>
    When True the function returns an <code>scipy.sparse.linalg.LinearOperator</code>.
    Otherwise it returns a dense array or a sparse matrix depending on
    <code>sparsity</code>. The linear operator provides an efficient way of computing
    <code>J.dot(p)</code> for any vector <code>p</code> of shape (n,), but does not allow
    direct access to individual elements of the matrix. By default
    <code>as_linear_operator</code> is False.
args, kwargs : tuple and dict, optional
    Additional arguments passed to <code>fun</code>. Both empty by default.
    The calling signature is <code>fun(x, *args, **kwargs)</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>J : {ndarray, sparse matrix, LinearOperator}</strong>
    Finite difference approximation of the Jacobian matrix.
    If <code>as_linear_operator</code> is True returns a LinearOperator
    with shape (m, n). Otherwise it returns a dense array or sparse
    matrix depending on how <code>sparsity</code> is defined. If <code>sparsity</code>
    is None then a ndarray with shape (m, n) is returned. If
    <code>sparsity</code> is not None returns a csr_matrix with shape (m, n).
    For sparse matrices and linear operators it is always returned as
    a 2-D structure, for ndarrays, if m=1 it is returned
    as a 1-D gradient array with shape (n,).</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>check_derivative : Check correctness of a function computing derivatives.</strong></li>
</ul>
<h4>Notes</h4>
<p>If <code>rel_step</code> is not provided, it assigned to <code>EPS**(1/s)</code>, where EPS is
machine epsilon for float64 numbers, s=2 for '2-point' method and s=3 for
'3-point' method. Such relative step approximately minimizes a sum of
truncation and round-off errors, see [1]_. Relative steps are used by
default. However, absolute steps are used when <code>abs_step is not None</code>.
If any of the absolute steps produces an indistinguishable difference from
the original <code>x0</code>, <code>(x0 + abs_step) - x0 == 0</code>, then a relative step is
substituted for that particular entry.</p>
<p>A finite difference scheme for '3-point' method is selected automatically.
The well-known central difference scheme is used for points sufficiently
far from the boundary, and 3-point forward or backward scheme is used for
points near the boundary. Both schemes have the second-order accuracy in
terms of Taylor expansion. Refer to [2]_ for the formulas of 3-point
forward and backward difference schemes.</p>
<p>For dense differencing when m=1 Jacobian is returned with a shape (n,),
on the other hand when n=1 Jacobian is returned with a shape (m, 1).
Our motivation is the following: a) It handles a case of gradient
computation (m=1) in a conventional way. b) It clearly separates these two
different cases. b) In all cases np.atleast_2d can be called to get 2-D
Jacobian with correct dimensions.</p>
<h4>References</h4>
<p>.. [1] W. H. Press et. al. 'Numerical Recipes. The Art of Scientific
       Computing. 3rd edition', sec. 5.7.</p>
<p>.. [2] A. Curtis, M. J. D. Powell, and J. Reid, 'On the estimation of
       sparse Jacobian matrices', Journal of the Institute of Mathematics
       and its Applications, 13 (1974), pp. 117-120.</p>
<p>.. [3] B. Fornberg, 'Generation of Finite Difference Formulas on
       Arbitrarily Spaced Grids', Mathematics of Computation 51, 1988.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">approx_derivative</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="o">...</span>                      <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<p>Bounds can be used to limit the region of function evaluation.
In the example below we compute left and right derivative at point 1.0.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="approx_fhess_p">approx_fhess_p<a class="headerlink" href="#approx_fhess_p" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function approx_fhess_p</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">approx_fhess_p</span> <span class="o">:</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">p</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">epsilon</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="approx_fprime">approx_fprime<a class="headerlink" href="#approx_fprime" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function approx_fprime</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">approx_fprime</span> <span class="o">:</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">epsilon</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Finite-difference approximation of the gradient of a scalar function.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>xk : array_like</strong>
    The coordinate vector at which to determine the gradient of <code>f</code>.</p>
</li>
<li>
<p><strong>f : callable</strong>
    The function of which to determine the gradient (partial derivatives).
    Should take <code>xk</code> as first argument, other arguments to <code>f</code> can be
    supplied in <code>*args</code>. Should return a scalar, the value of the
    function at <code>xk</code>.</p>
</li>
<li>
<p><strong>epsilon : array_like</strong>
    Increment to <code>xk</code> to use for determining the function gradient.
    If a scalar, uses the same finite difference delta for all partial
    derivatives. If an array, should contain one value per element of
    <code>xk</code>.
*args : args, optional
    Any other arguments that are to be passed to <code>f</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>grad : ndarray</strong>
    The partial derivatives of <code>f</code> to <code>xk</code>.</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>check_grad : Check correctness of gradient function against approx_fprime.</strong></li>
</ul>
<h4>Notes</h4>
<p>The function gradient is determined by the forward finite difference</p>
<ul>
<li><strong>formula::</strong><div class="codehilite"><pre><span></span><code>     f(xk[i] + epsilon[i]) - f(xk[i])
</code></pre></div>


<p>f'[i] = ---------------------------------
                    epsilon[i]</p>
</li>
</ul>
<p>The main use of <code>approx_fprime</code> is in scalar function optimizers like
<code>fmin_bfgs</code>, to determine numerically the Jacobian of a function.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">):</span>
<span class="o">...</span>     <span class="s1">&#39;Coordinate vector `x` should be an array of size two.&#39;</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">optimize</span><span class="o">.</span><span class="n">approx_fprime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="n">eps</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span>   <span class="mf">2.</span>        <span class="p">,</span>  <span class="mf">400.00004198</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="argmin">argmin<a class="headerlink" href="#argmin" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function argmin</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">argmin</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Returns the indices of the minimum values along an axis.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input array.</p>
</li>
<li>
<p><strong>axis : int, optional</strong>
    By default, the index is into the flattened array, otherwise
    along the specified axis.</p>
</li>
<li>
<p><strong>out : array, optional</strong>
    If provided, the result will be inserted into this array. It should
    be of the appropriate shape and dtype.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>index_array : ndarray of ints</strong>
    Array of indices into the array. It has the same shape as <code>a.shape</code>
    with the dimension along <code>axis</code> removed.</li>
</ul>
<h4>See Also</h4>
<p>ndarray.argmin, argmax</p>
<ul>
<li>
<p><strong>amin : The minimum value along a given axis.</strong></p>
</li>
<li>
<p><strong>unravel_index : Convert a flat index into an index tuple.</strong></p>
</li>
<li>
<p><strong>take_along_axis : Apply <code>np.expand_dims(index_array, axis)</code></strong>
                  from argmin to an array as if by calling min.</p>
</li>
</ul>
<h4>Notes</h4>
<p>In case of multiple occurrences of the minimum values, the indices
corresponding to the first occurrence are returned.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<p>Indices of the minimum elements of a N-dimensional array:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ind</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="mi">10</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span>
<span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># Only the first occurrence is returned.</span>
<span class="mi">0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">index_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Same as np.min(x, axis=-1, keepdims=True)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">index_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Same as np.max(x, axis=-1)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">index_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="asarray_3">asarray<a class="headerlink" href="#asarray_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">F</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the input to an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input data, in any form that can be converted to an array.  This
    includes lists, lists of tuples, tuples, tuples of tuples, tuples
    of lists and ndarrays.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    By default, the data-type is inferred from the input data.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional</strong>
    Whether to use row-major (C-style) or
    column-major (Fortran-style) memory representation.
    Defaults to 'C'.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array interpretation of <code>a</code>.  No copy is performed if the input
    is already an ndarray with matching dtype and order.  If <code>a</code> is a
    subclass of ndarray, a base class ndarray is returned.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>asanyarray : Similar function which passes through subclasses.</strong></p>
</li>
<li>
<p><strong>ascontiguousarray : Convert input to a contiguous array.</strong></p>
</li>
<li>
<p><strong>asfarray : Convert input to a floating point ndarray.</strong></p>
</li>
<li>
<p><strong>asfortranarray : Convert input to an ndarray with column-major</strong>
                 memory order.</p>
</li>
<li>
<p><strong>asarray_chkfinite : Similar function which checks input for NaNs and Infs.</strong></p>
</li>
<li>
<p><strong>fromiter : Create an array from an iterator.</strong></p>
</li>
<li>
<p><strong>fromfunction : Construct an array by executing a function on grid</strong>
               positions.</p>
</li>
</ul>
<h4>Examples</h4>
<p>Convert a list into an array:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div>

<p>Existing arrays are not copied:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

<p>If <code>dtype</code> is set, array is copied only if dtype does not match:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
</code></pre></div>

<p>Contrary to <code>asanyarray</code>, ndarray subclasses are not passed through:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4,i4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span>
<span class="kc">True</span>
</code></pre></div>

</details>
<h3 id="asfarray">asfarray<a class="headerlink" href="#asfarray" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asfarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asfarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dtype_object</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return an array converted to a float type.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    The input array.</p>
</li>
<li>
<p><strong>dtype : str or dtype object, optional</strong>
    Float type code to coerce input array <code>a</code>.  If <code>dtype</code> is one of the
    'int' dtypes, it is replaced with float64.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    The input <code>a</code> as a float ndarray.</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="atleast_1d_1">atleast_1d<a class="headerlink" href="#atleast_1d_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function atleast_1d</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">atleast_1d</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert inputs to arrays with at least one dimension.</p>
<p>Scalar inputs are converted to 1-dimensional arrays, whilst
higher-dimensional inputs are preserved.</p>
<h4>Parameters</h4>
<p>arys1, arys2, ... : array_like
    One or more input arrays.</p>
<h4>Returns</h4>
<ul>
<li><strong>ret : ndarray</strong>
    An array, or list of arrays, each with <code>a.ndim &gt;= 1</code>.
    Copies are made only if necessary.</li>
</ul>
<h4>See Also</h4>
<p>atleast_2d, atleast_3d</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="n">x</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">[</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])]</span>
</code></pre></div>

</details>
<h3 id="bracket">bracket<a class="headerlink" href="#bracket" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function bracket</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">bracket</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">xa</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">grow_limit</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">int</span>
</code></pre></div>

<p>Bracket the minimum of the function.</p>
<p>Given a function and distinct initial points, search in the
downhill direction (as defined by the initial points) and return
new points xa, xb, xc that bracket the minimum of the function
f(xa) &gt; f(xb) &lt; f(xc). It doesn't always mean that obtained
solution will satisfy xa&lt;=x&lt;=xb.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function to minimize.
xa, xb : float, optional
    Bracketing interval. Defaults <code>xa</code> to 0.0, and <code>xb</code> to 1.0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments (if present), passed to <code>func</code>.</p>
</li>
<li>
<p><strong>grow_limit : float, optional</strong>
    Maximum grow limit.  Defaults to 110.0</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform. Defaults to 1000.</p>
</li>
</ul>
<h4>Returns</h4>
<p>xa, xb, xc : float
    Bracket.
fa, fb, fc : float
    Objective function values in bracket.</p>
<ul>
<li><strong>funcalls : int</strong>
    Number of function evaluations made.</li>
</ul>
<h4>Examples</h4>
<p>This function can find a downward convex region of a function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">bracket</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">init_xa</span><span class="p">,</span> <span class="n">init_xb</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="n">funcalls</span> <span class="o">=</span> <span class="n">bracket</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">xa</span><span class="o">=</span><span class="n">init_xa</span><span class="p">,</span> <span class="n">xb</span><span class="o">=</span><span class="n">init_xb</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">init_xa</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">init_xb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="brent_1">brent<a class="headerlink" href="#brent_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brent</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brent</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">brack</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Given a function of one variable and a possible bracket, return
the local minimum of the function isolated to a fractional precision
of tol.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments (if present).</p>
</li>
<li>
<p><strong>brack : tuple, optional</strong>
    Either a triple (xa,xb,xc) where xa&lt;xb&lt;xc and func(xb) &lt;
    func(xa), func(xc) or a pair (xa,xb) which are used as a
    starting interval for a downhill bracket search (see
    <code>bracket</code>). Providing the pair (xa,xb) does not always mean
    the obtained solution will satisfy xa&lt;=x&lt;=xb.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    Stop if between iteration change is less than <code>tol</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return all output args (xmin, fval, iter,
    funcalls).</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations in solution.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xmin : ndarray</strong>
    Optimum point.</p>
</li>
<li>
<p><strong>fval : float</strong>
    Optimum value.</p>
</li>
<li>
<p><strong>iter : int</strong>
    Number of iterations.</p>
</li>
<li>
<p><strong>funcalls : int</strong>
    Number of objective function evaluations made.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize_scalar: Interface to minimization algorithms for scalar</strong>
    univariate functions. See the 'Brent' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses inverse parabolic interpolation when possible to speed up
convergence of golden section method.</p>
<p>Does not ensure that the minimum lies in the range specified by
<code>brack</code>. See <code>fminbound</code>.</p>
<h4>Examples</h4>
<p>We illustrate the behaviour of the function when <code>brack</code> is of
size 2 and 3 respectively. In the case where <code>brack</code> is of the
form (xa,xb), we can see for the given values, the output need
not necessarily lie in the range (xa,xb).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">0.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="o">-</span><span class="mf">2.7755575615628914e-17</span>
</code></pre></div>

</details>
<h3 id="brute">brute<a class="headerlink" href="#brute" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brute</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brute</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ns</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">finish</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">workers</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Map_like_callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">ranges</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function over a given range by brute force.</p>
<p>Uses the 'brute force' method, i.e., computes the function's value
at each point of a multidimensional grid of points, to find the global
minimum of the function.</p>
<p>The function is evaluated everywhere in the range with the datatype of the
first call to the function, as enforced by the <code>vectorize</code> NumPy
function. The value and type of the function evaluation returned when
<code>full_output=True</code> are affected in addition by the <code>finish</code> argument
(see Notes).</p>
<p>The brute force approach is inefficient because the number of grid points
increases exponentially - the number of grid points to evaluate is
<code>Ns ** len(x)</code>. Consequently, even with coarse grid spacing, even
moderately sized problems can take a long time to run, and/or run into
memory limitations.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The objective function to be minimized. Must be in the
    form <code>f(x, *args)</code>, where <code>x</code> is the argument in
    the form of a 1-D array and <code>args</code> is a tuple of any
    additional fixed parameters needed to completely specify
    the function.</p>
</li>
<li>
<p><strong>ranges : tuple</strong>
    Each component of the <code>ranges</code> tuple must be either a
    'slice object' or a range tuple of the form <code>(low, high)</code>.
    The program uses these to create the grid of points on which
    the objective function will be computed. See <code>Note 2</code> for
    more detail.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any additional fixed parameters needed to completely specify
    the function.</p>
</li>
<li>
<p><strong>Ns : int, optional</strong>
    Number of grid points along the axes, if not otherwise
    specified. See <code>Note2</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return the evaluation grid and the objective function's
    values on it.</p>
</li>
<li>
<p><strong>finish : callable, optional</strong>
    An optimization function that is called with the result of brute force
    minimization as initial guess. <code>finish</code> should take <code>func</code> and
    the initial guess as positional arguments, and take <code>args</code> as
    keyword arguments. It may additionally take <code>full_output</code>
    and/or <code>disp</code> as keyword arguments. Use None if no 'polishing'
    function is to be used. See Notes for more details.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Set to True to print convergence messages from the <code>finish</code> callable.</p>
</li>
<li>
<p><strong>workers : int or map-like callable, optional</strong>
    If <code>workers</code> is an int the grid is subdivided into <code>workers</code>
    sections and evaluated in parallel (uses
    <code>multiprocessing.Pool &lt;multiprocessing&gt;</code>).
    Supply <code>-1</code> to use all cores available to the Process.
    Alternatively supply a map-like callable, such as
    <code>multiprocessing.Pool.map</code> for evaluating the grid in parallel.
    This evaluation is carried out as <code>workers(func, iterable)</code>.
    Requires that <code>func</code> be pickleable.</p>
<p>.. versionadded:: 1.3.0</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : ndarray</strong>
    A 1-D array containing the coordinates of a point at which the
    objective function had its minimum value. (See <code>Note 1</code> for
    which point is returned.)</p>
</li>
<li>
<p><strong>fval : float</strong>
    Function value at the point <code>x0</code>. (Returned when <code>full_output</code> is
    True.)</p>
</li>
<li>
<p><strong>grid : tuple</strong>
    Representation of the evaluation grid. It has the same
    length as <code>x0</code>. (Returned when <code>full_output</code> is True.)</p>
</li>
<li>
<p><strong>Jout : ndarray</strong>
    Function values at each point of the evaluation
    grid, i.e., <code>Jout = func( *grid)</code>. (Returned
    when <code>full_output</code> is True.)</p>
</li>
</ul>
<h4>See Also</h4>
<p>basinhopping, differential_evolution</p>
<h4>Notes</h4>
<p><em>Note 1</em>: The program finds the gridpoint at which the lowest value
of the objective function occurs. If <code>finish</code> is None, that is the
point returned. When the global minimum occurs within (or not very far
outside) the grid's boundaries, and the grid is fine enough, that
point will be in the neighborhood of the global minimum.</p>
<p>However, users often employ some other optimization program to
'polish' the gridpoint values, i.e., to seek a more precise
(local) minimum near <code>brute's</code> best gridpoint.
The <code>brute</code> function's <code>finish</code> option provides a convenient way to do
that. Any polishing program used must take <code>brute's</code> output as its
initial guess as a positional argument, and take <code>brute's</code> input values
for <code>args</code> as keyword arguments, otherwise an error will be raised.
It may additionally take <code>full_output</code> and/or <code>disp</code> as keyword arguments.</p>
<p><code>brute</code> assumes that the <code>finish</code> function returns either an
<code>OptimizeResult</code> object or a tuple in the form:
<code>(xmin, Jmin, ... , statuscode)</code>, where <code>xmin</code> is the minimizing
value of the argument, <code>Jmin</code> is the minimum value of the objective
function, '...' may be some other returned values (which are not used
by <code>brute</code>), and <code>statuscode</code> is the status code of the <code>finish</code> program.</p>
<p>Note that when <code>finish</code> is not None, the values returned are those
of the <code>finish</code> program, <em>not</em> the gridpoint ones. Consequently,
while <code>brute</code> confines its search to the input grid points,
the <code>finish</code> program's results usually will not coincide with any
gridpoint, and may fall outside the grid's boundary. Thus, if a
minimum only needs to be found over the provided grid points, make
sure to pass in <code>finish=None</code>.</p>
<p><em>Note 2</em>: The grid of points is a <code>numpy.mgrid</code> object.
For <code>brute</code> the <code>ranges</code> and <code>Ns</code> inputs have the following effect.
Each component of the <code>ranges</code> tuple can be either a slice object or a
two-tuple giving a range of values, such as (0, 5). If the component is a
slice object, <code>brute</code> uses it directly. If the component is a two-tuple
range, <code>brute</code> internally converts it to a slice object that interpolates
<code>Ns</code> points from its low-value to its high-value, inclusive.</p>
<h4>Examples</h4>
<p>We illustrate the use of <code>brute</code> to seek the global minimum of a function
of two variables that is given as the sum of a positive-definite
quadratic and two deep 'Gaussian-shaped' craters. Specifically, define
the objective function <code>f</code> as the sum of three other functions,
<code>f = f1 + f2 + f3</code>. We suppose each of these has a signature
<code>(z, *params)</code>, where <code>z = (x, y)</code>,  and <code>params</code> and the functions
are as defined below.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">f1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">f3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>

<p>Thus, the objective function may have local minima near the minimum
of each of the three functions of which it is composed. To
use <code>fmin</code> to polish its gridpoint result, we may then continue as
follows:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">rranges</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">resbrute</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brute</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rranges</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>                           <span class="n">finish</span><span class="o">=</span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">resbrute</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># global minimum</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.05665192</span><span class="p">,</span>  <span class="mf">1.80834843</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">resbrute</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># function value at global minimum</span>
<span class="o">-</span><span class="mf">3.4085818767</span>
</code></pre></div>

<p>Note that if <code>finish</code> had been set to None, we would have gotten the
gridpoint [-1.0 1.75] where the rounded function value is -2.892.</p>
</details>
<h3 id="check_grad">check_grad<a class="headerlink" href="#check_grad" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function check_grad</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">check_grad</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">grad</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">float</span>
</code></pre></div>

<p>Check the correctness of a gradient function by comparing it against a
(forward) finite-difference approximation of the gradient.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>func(x0, *args)</code></strong>
    Function whose derivative is to be checked.</p>
</li>
<li>
<p><strong>grad : callable <code>grad(x0, *args)</code></strong>
    Gradient of <code>func</code>.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Points to check <code>grad</code> against forward difference approximation of grad
    using <code>func</code>.</p>
</li>
<li>
<p><strong>args : *args, optional</strong>
    Extra arguments passed to <code>func</code> and <code>grad</code>.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    Step size used for the finite difference approximation. It defaults to
    <code>sqrt(np.finfo(float).eps)</code>, which is approximately 1.49e-08.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>err : float</strong>
    The square root of the sum of squares (i.e., the 2-norm) of the
    difference between <code>grad(x0, *args)</code> and the finite difference
    approximation of <code>grad</code> using func at the points <code>x0</code>.</li>
</ul>
<h4>See Also</h4>
<p>approx_fprime</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">check_grad</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">check_grad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
<span class="mf">2.9802322387695312e-08</span>
</code></pre></div>

</details>
<h3 id="eye_1">eye<a class="headerlink" href="#eye_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function eye</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">eye</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">n</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return a 2-D array with ones on the diagonal and zeros elsewhere.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>N : int</strong>
  Number of rows in the output.</p>
</li>
<li>
<p><strong>M : int, optional</strong>
  Number of columns in the output. If None, defaults to <code>N</code>.</p>
</li>
<li>
<p><strong>k : int, optional</strong>
  Index of the diagonal: 0 (the default) refers to the main diagonal,
  a positive value refers to an upper diagonal, and a negative value
  to a lower diagonal.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
  Data-type of the returned array.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional</strong>
    Whether the output should be stored in row-major (C-style) or
    column-major (Fortran-style) order in memory.</p>
<p>.. versionadded:: 1.14.0</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>I : ndarray of shape (N,M)</strong>
  An array where all elements are equal to zero, except for the <code>k</code>-th
  diagonal, whose values are equal to one.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>identity : (almost) equivalent function</strong></p>
</li>
<li>
<p><strong>diag : diagonal 2-D array from a 1-D array specified by the user.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="fmin">fmin<a class="headerlink" href="#fmin" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">initial_simplex</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using the downhill simplex algorithm.</p>
<p>This algorithm only uses function values, not derivatives or second
derivatives.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable func(x,*args)</strong>
    The objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to func, i.e., <code>f(x,*args)</code>.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Absolute error in xopt between iterations that is acceptable for
    convergence.</p>
</li>
<li>
<p><strong>ftol : number, optional</strong>
    Absolute error in func(xopt) between iterations that is acceptable for
    convergence.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>maxfun : number, optional</strong>
    Maximum number of function evaluations to make.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    Set to True if fopt and warnflag outputs are desired.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Set to True to print convergence messages.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    Set to True to return list of solutions at each iteration.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as callback(xk), where xk is the
    current parameter vector.</p>
</li>
<li>
<p><strong>initial_simplex : array_like of shape (N + 1, N), optional</strong>
    Initial simplex. If given, overrides <code>x0</code>.
    <code>initial_simplex[j,:]</code> should contain the coordinates of
    the jth vertex of the <code>N+1</code> vertices in the simplex, where
    <code>N</code> is the dimension.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameter that minimizes function.</p>
</li>
<li>
<p><strong>fopt : float</strong>
    Value of function at minimum: <code>fopt = func(xopt)</code>.</p>
</li>
<li>
<p><strong>iter : int</strong>
    Number of iterations performed.</p>
</li>
<li>
<p><strong>funcalls : int</strong>
    Number of function calls made.</p>
</li>
<li>
<p><strong>warnflag : int</strong></p>
</li>
<li>
<p><strong>1 : Maximum number of function evaluations made.</strong></p>
</li>
<li>
<p><strong>2 : Maximum number of iterations reached.</strong></p>
</li>
<li>
<p><strong>allvecs : list</strong>
    Solution at each iteration.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'Nelder-Mead' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses a Nelder-Mead simplex algorithm to find the minimum of function of
one or more variables.</p>
<p>This algorithm has a long history of successful use in applications.
But it will usually be slower than an algorithm that uses first or
second derivative information. In practice, it can have poor
performance in high-dimensional problems and is not robust to
minimizing complicated functions. Additionally, there currently is no
complete theory describing when the algorithm will successfully
converge to the minimum, or how fast it will if it does. Both the ftol and
xtol criteria must be met for convergence.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.000000</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 17</strong>
         Function evaluations: 34
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">-</span><span class="mf">8.8817841970012523e-16</span>
</code></pre></div></li>
</ul>
<h4>References</h4>
<p>.. [1] Nelder, J.A. and Mead, R. (1965), 'A simplex method for function
       minimization', The Computer Journal, 7, pp. 308-313</p>
<p>.. [2] Wright, M.H. (1996), 'Direct Search Methods: Once Scorned, Now
       Respectable', in Numerical Analysis 1995, Proceedings of the
       1995 Dundee Biennial Conference in Numerical Analysis, D.F.
       Griffiths and G.A. Watson (Eds.), Addison Wesley Longman,
       Harlow, UK, pp. 191-208.</p>
</details>
<h3 id="fmin_bfgs">fmin_bfgs<a class="headerlink" href="#fmin_bfgs" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_bfgs</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_bfgs</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">norm</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using the BFGS algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable f(x,*args)</strong>
    Objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>fprime : callable f'(x,*args), optional</strong>
    Gradient of f.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to f and fprime.</p>
</li>
<li>
<p><strong>gtol : float, optional</strong>
    Gradient norm must be less than gtol before successful termination.</p>
</li>
<li>
<p><strong>norm : float, optional</strong>
    Order of norm (Inf is max, -Inf is min)</p>
</li>
<li>
<p><strong>epsilon : int or ndarray, optional</strong>
    If fprime is approximated, use this value for the step size.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function to call after each
    iteration. Called as callback(xk), where xk is the
    current parameter vector.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True,return fopt, func_calls, grad_calls, and warnflag
    in addition to xopt.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Print convergence message if True.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    Return a list of results at each iteration if True.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters which minimize f, i.e., f(xopt) == fopt.</p>
</li>
<li>
<p><strong>fopt : float</strong>
    Minimum value.</p>
</li>
<li>
<p><strong>gopt : ndarray</strong>
    Value of gradient at minimum, f'(xopt), which should be near 0.</p>
</li>
<li>
<p><strong>Bopt : ndarray</strong>
    Value of 1/f''(xopt), i.e., the inverse Hessian matrix.</p>
</li>
<li>
<p><strong>func_calls : int</strong>
    Number of function_calls made.</p>
</li>
<li>
<p><strong>grad_calls : int</strong>
    Number of gradient calls made.</p>
</li>
<li>
<p><strong>warnflag : integer</strong></p>
</li>
<li>
<p><strong>1 : Maximum number of iterations exceeded.</strong></p>
</li>
<li>
<p><strong>2 : Gradient and/or function calls not changing.</strong></p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>allvecs  :  list</strong>
    The value of xopt at each iteration. Only returned if retall is True.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'BFGS' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Optimize the function, f, whose gradient is given by fprime
using the quasi-Newton method of Broyden, Fletcher, Goldfarb,
and Shanno (BFGS)</p>
<h4>References</h4>
<p>Wright, and Nocedal 'Numerical Optimization', 1999, p. 198.</p>
</details>
<h3 id="fmin_cg">fmin_cg<a class="headerlink" href="#fmin_cg" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_cg</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_cg</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:[`</span><span class="nc">T_fprime_x_args_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">norm</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T_f_x_args_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using a nonlinear conjugate gradient algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable, <code>f(x, *args)</code></strong>
    Objective function to be minimized. Here <code>x</code> must be a 1-D array of
    the variables that are to be changed in the search for a minimum, and
    <code>args</code> are the other (fixed) parameters of <code>f</code>.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    A user-supplied initial estimate of <code>xopt</code>, the optimal value of <code>x</code>.
    It must be a 1-D array of values.</p>
</li>
<li>
<p><strong>fprime : callable, <code>fprime(x, *args)</code>, optional</strong>
    A function that returns the gradient of <code>f</code> at <code>x</code>. Here <code>x</code> and <code>args</code>
    are as described above for <code>f</code>. The returned value must be a 1-D array.
    Defaults to None, in which case the gradient is approximated
    numerically (see <code>epsilon</code>, below).</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Parameter values passed to <code>f</code> and <code>fprime</code>. Must be supplied whenever
    additional fixed parameters are needed to completely specify the
    functions <code>f</code> and <code>fprime</code>.</p>
</li>
<li>
<p><strong>gtol : float, optional</strong>
    Stop when the norm of the gradient is less than <code>gtol</code>.</p>
</li>
<li>
<p><strong>norm : float, optional</strong>
    Order to use for the norm of the gradient
    (<code>-np.Inf</code> is min, <code>np.Inf</code> is max).</p>
</li>
<li>
<p><strong>epsilon : float or ndarray, optional</strong>
    Step size(s) to use when <code>fprime</code> is approximated numerically. Can be a
    scalar or a 1-D array. Defaults to <code>sqrt(eps)</code>, with eps the
    floating point machine precision.  Usually <code>sqrt(eps)</code> is about
    1.5e-8.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform. Default is <code>200 * len(x0)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return <code>fopt</code>, <code>func_calls</code>, <code>grad_calls</code>, and <code>warnflag</code> in
    addition to <code>xopt</code>.  See the Returns section below for additional
    information on optional return values.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, return a convergence message, followed by <code>xopt</code>.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    If True, add to the returned values the results of each iteration.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function, called after each iteration.
    Called as <code>callback(xk)</code>, where <code>xk</code> is the current value of <code>x0</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters which minimize f, i.e., <code>f(xopt) == fopt</code>.</p>
</li>
<li>
<p><strong>fopt : float, optional</strong>
    Minimum value found, f(xopt). Only returned if <code>full_output</code> is True.</p>
</li>
<li>
<p><strong>func_calls : int, optional</strong>
    The number of function_calls made. Only returned if <code>full_output</code>
    is True.</p>
</li>
<li>
<p><strong>grad_calls : int, optional</strong>
    The number of gradient calls made. Only returned if <code>full_output</code> is
    True.</p>
</li>
<li>
<p><strong>warnflag : int, optional</strong>
    Integer value with warning status, only returned if <code>full_output</code> is
    True.</p>
</li>
<li>
<p><strong>0 : Success.</strong></p>
</li>
<li>
<p><strong>1 : The maximum number of iterations was exceeded.</strong></p>
</li>
<li>
<p><strong>2 : Gradient and/or function calls were not changing. May indicate</strong>
        that precision was lost, i.e., the routine did not converge.</p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>allvecs : list of ndarray, optional</strong>
    List of arrays, containing the results at each iteration.
    Only returned if <code>retall</code> is True.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>minimize : common interface to all <code>scipy.optimize</code> algorithms for</strong>
           unconstrained and constrained minimization of multivariate
           functions. It provides an alternative way to call
           <code>fmin_cg</code>, by specifying <code>method='CG'</code>.</li>
</ul>
<h4>Notes</h4>
<p>This conjugate gradient algorithm is based on that of Polak and Ribiere
[1]_.</p>
<p>Conjugate gradient methods tend to work better when:</p>
<ol>
<li><code>f</code> has a unique global minimizing point, and no local minima or
   other stationary points,</li>
<li><code>f</code> is, at least locally, reasonably well approximated by a
   quadratic function of the variables,</li>
<li><code>f</code> is continuous and has a continuous gradient,</li>
<li><code>fprime</code> is not too large, e.g., has a norm less than 1000,</li>
<li>The initial guess, <code>x0</code>, is reasonably close to <code>f</code> 's global
   minimizing point, <code>xopt</code>.</li>
</ol>
<h4>References</h4>
<p>.. [1] Wright &amp; Nocedal, 'Numerical Optimization', 1999, pp. 120-122.</p>
<h4>Examples</h4>
<p>Example 1: seek the minimum value of the expression
<code>a*u**2 + b*u*v + c*v**2 + d*u + e*v + f</code> for given values
of the parameters and an initial guess <code>(u, v) = (0, 0)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># parameter values</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">args</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">f</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">gradf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">args</span>
<span class="o">...</span>     <span class="n">gu</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">d</span>     <span class="c1"># u-component of the gradient</span>
<span class="o">...</span>     <span class="n">gv</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">e</span>     <span class="c1"># v-component of the gradient</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">gu</span><span class="p">,</span> <span class="n">gv</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Initial guess.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin_cg</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">gradf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">1.617021</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 4</strong>
         Function evaluations: 8
         Gradient evaluations: 8
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res1</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.80851064</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25531915</span><span class="p">])</span>
</code></pre></div></li>
</ul>
<p>Example 2: solve the same problem using the <code>minimize</code> function.
(This <code>myopts</code> dictionary shows all of the available options,
although in practice only non-default values would be needed.
The returned value will be a dictionary.)</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;maxiter&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1"># default value.</span>
<span class="o">...</span>         <span class="s1">&#39;disp&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1"># non-default value.</span>
<span class="o">...</span>         <span class="s1">&#39;gtol&#39;</span> <span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>    <span class="c1"># default value.</span>
<span class="o">...</span>         <span class="s1">&#39;norm&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>  <span class="c1"># default value.</span>
<span class="o">...</span>         <span class="s1">&#39;eps&#39;</span> <span class="p">:</span> <span class="mf">1.4901161193847656e-08</span><span class="p">}</span>  <span class="c1"># default value.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">gradf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
<span class="o">...</span>                          <span class="n">method</span><span class="o">=</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
        <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">1.617021</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 4</strong>
        Function evaluations: 8
        Gradient evaluations: 8
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res2</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># minimum found</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.80851064</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25531915</span><span class="p">])</span>
</code></pre></div></li>
</ul>
</details>
<h3 id="fmin_ncg">fmin_ncg<a class="headerlink" href="#fmin_ncg" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_ncg</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_ncg</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fhess_p</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fhess</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">avextol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Unconstrained minimization of a function using the Newton-CG method.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable <code>f(x, *args)</code></strong>
    Objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>fprime : callable <code>f'(x, *args)</code></strong>
    Gradient of f.</p>
</li>
<li>
<p><strong>fhess_p : callable <code>fhess_p(x, p, *args)</code>, optional</strong>
    Function which computes the Hessian of f times an
    arbitrary vector, p.</p>
</li>
<li>
<p><strong>fhess : callable <code>fhess(x, *args)</code>, optional</strong>
    Function to compute the Hessian matrix of f.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to f, fprime, fhess_p, and fhess
    (the same set of extra arguments is supplied to all of
    these functions).</p>
</li>
<li>
<p><strong>epsilon : float or ndarray, optional</strong>
    If fhess is approximated, use this value for the step size.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function which is called after
    each iteration. Called as callback(xk), where xk is the
    current parameter vector.</p>
</li>
<li>
<p><strong>avextol : float, optional</strong>
    Convergence is assumed when the average relative error in
    the minimizer falls below this amount.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return the optional outputs.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, print convergence message.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    If True, return a list of results at each iteration.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters which minimize f, i.e., <code>f(xopt) == fopt</code>.</p>
</li>
<li>
<p><strong>fopt : float</strong>
    Value of the function at xopt, i.e., <code>fopt = f(xopt)</code>.</p>
</li>
<li>
<p><strong>fcalls : int</strong>
    Number of function calls made.</p>
</li>
<li>
<p><strong>gcalls : int</strong>
    Number of gradient calls made.</p>
</li>
<li>
<p><strong>hcalls : int</strong>
    Number of Hessian calls made.</p>
</li>
<li>
<p><strong>warnflag : int</strong>
    Warnings generated by the algorithm.</p>
</li>
<li>
<p><strong>1 : Maximum number of iterations exceeded.</strong></p>
</li>
<li>
<p><strong>2 : Line search failure (precision loss).</strong></p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>allvecs : list</strong>
    The result at each iteration, if retall is True (see below).</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'Newton-CG' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Only one of <code>fhess_p</code> or <code>fhess</code> need to be given.  If <code>fhess</code>
is provided, then <code>fhess_p</code> will be ignored. If neither <code>fhess</code>
nor <code>fhess_p</code> is provided, then the hessian product will be
approximated using finite differences on <code>fprime</code>. <code>fhess_p</code>
must compute the hessian times an arbitrary vector. If it is not
given, finite-differences on <code>fprime</code> are used to compute
it.</p>
<p>Newton-CG methods are also called truncated Newton methods. This
function differs from scipy.optimize.fmin_tnc because</p>
<ol>
<li>scipy.optimize.fmin_ncg is written purely in Python using NumPy
    and scipy while scipy.optimize.fmin_tnc calls a C function.</li>
<li>scipy.optimize.fmin_ncg is only for unconstrained minimization
    while scipy.optimize.fmin_tnc is for unconstrained minimization
    or box constrained minimization. (Box constraints give
    lower and upper bounds for each variable separately.)</li>
</ol>
<h4>References</h4>
<p>Wright &amp; Nocedal, 'Numerical Optimization', 1999, p. 140.</p>
</details>
<h3 id="fmin_powell">fmin_powell<a class="headerlink" href="#fmin_powell" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_powell</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_powell</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">direc</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using modified Powell's method.</p>
<p>This method only uses function values, not derivatives.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to func.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Line-search error tolerance.</p>
</li>
<li>
<p><strong>ftol : float, optional</strong>
    Relative error in <code>func(xopt)</code> acceptable for convergence.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations to make.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, <code>fopt</code>, <code>xi</code>, <code>direc</code>, <code>iter</code>, <code>funcalls</code>, and
    <code>warnflag</code> are returned.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, print convergence messages.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    If True, return a list of the solution at each iteration.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function, called after each
    iteration.  Called as <code>callback(xk)</code>, where <code>xk</code> is the
    current parameter vector.</p>
</li>
<li>
<p><strong>direc : ndarray, optional</strong>
    Initial fitting step and parameter order set as an (N, N) array, where N
    is the number of fitting parameters in <code>x0</code>. Defaults to step size 1.0
    fitting all parameters simultaneously (<code>np.ones((N, N))</code>). To
    prevent initial consideration of values in a step or to change initial
    step size, set to 0 or desired step size in the Jth position in the Mth
    block, where J is the position in <code>x0</code> and M is the desired evaluation
    step, with steps being evaluated in index order. Step size and ordering
    will change freely as minimization proceeds.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameter which minimizes <code>func</code>.</p>
</li>
<li>
<p><strong>fopt : number</strong>
    Value of function at minimum: <code>fopt = func(xopt)</code>.</p>
</li>
<li>
<p><strong>direc : ndarray</strong>
    Current direction set.</p>
</li>
<li>
<p><strong>iter : int</strong>
    Number of iterations.</p>
</li>
<li>
<p><strong>funcalls : int</strong>
    Number of function calls made.</p>
</li>
<li>
<p><strong>warnflag : int</strong>
    Integer warning flag:</p>
</li>
<li>
<p><strong>1 : Maximum number of function evaluations.</strong></p>
</li>
<li>
<p><strong>2 : Maximum number of iterations.</strong></p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>4 : The result is out of the provided bounds.</strong></p>
</li>
<li>
<p><strong>allvecs : list</strong>
    List of solutions at each iteration.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to unconstrained minimization algorithms for</strong>
    multivariate functions. See the 'Powell' method in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses a modification of Powell's method to find the minimum of
a function of N variables. Powell's method is a conjugate
direction method.</p>
<p>The algorithm has two loops. The outer loop merely iterates over the inner
loop. The inner loop minimizes over each current direction in the direction
set. At the end of the inner loop, if certain conditions are met, the
direction that gave the largest decrease is dropped and replaced with the
difference between the current estimated x and the estimated x from the
beginning of the inner-loop.</p>
<p>The technical conditions for replacing the direction of greatest
increase amount to checking that</p>
<ol>
<li>No further gain can be made along the direction of greatest increase
   from that iteration.</li>
<li>The direction of greatest increase accounted for a large sufficient
   fraction of the decrease in the function value from that iteration of
   the inner loop.</li>
</ol>
<h4>References</h4>
<p>Powell M.J.D. (1964) An efficient method for finding the minimum of a
function of several variables without calculating derivatives,
Computer Journal, 7 (2):155-162.</p>
<p>Press W., Teukolsky S.A., Vetterling W.T., and Flannery B.P.:
Numerical Recipes (any edition), Cambridge University Press</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin_powell</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.000000</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 2</strong>
         Function evaluations: 18
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div></li>
</ul>
</details>
<h3 id="fminbound">fminbound<a class="headerlink" href="#fminbound" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fminbound</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fminbound</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Bounded minimization for scalar functions.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function to be minimized (must accept and return scalars).
x1, x2 : float or array scalar
    The optimization bounds.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to function.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    The convergence tolerance.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations allowed.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return optional outputs.</p>
</li>
<li>
<p><strong>disp : int, optional</strong>
    If non-zero, print messages.</p>
</li>
<li>
<p><strong>0 : no message printing.</strong></p>
</li>
<li>
<p><strong>1 : non-convergence notification messages only.</strong></p>
</li>
<li>
<p><strong>2 : print a message on convergence too.</strong></p>
</li>
<li>
<p><strong>3 : print iteration results.</strong></p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters (over given interval) which minimize the
    objective function.</p>
</li>
<li>
<p><strong>fval : number</strong>
    The function value at the minimum point.</p>
</li>
<li>
<p><strong>ierr : int</strong>
    An error flag (0 if converged, 1 if maximum number of
    function calls reached).</p>
</li>
<li>
<p><strong>numfunc : int</strong>
  The number of function calls made.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize_scalar: Interface to minimization algorithms for scalar</strong>
    univariate functions. See the 'Bounded' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Finds a local minimizer of the scalar function <code>func</code> in the
interval x1 &lt; xopt &lt; x2 using Brent's method. (See <code>brent</code>
for auto-bracketing.)</p>
<h4>Examples</h4>
<p><code>fminbound</code> finds the minimum of the function in the given range.
The following examples illustrate the same</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">0.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">1.0000059608609866</span>
</code></pre></div>

</details>
<h3 id="golden">golden<a class="headerlink" href="#golden" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function golden</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">golden</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">brack</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the minimum of a function of one variable using golden section
method.</p>
<p>Given a function of one variable and a possible bracketing interval,
return the minimum of the function isolated to a fractional precision of
tol.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable func(x,*args)</strong>
    Objective function to minimize.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments (if present), passed to func.</p>
</li>
<li>
<p><strong>brack : tuple, optional</strong>
    Triple (a,b,c), where (a&lt;b&lt;c) and func(b) &lt;
    func(a),func(c). If bracket consists of two numbers (a,
    c), then they are assumed to be a starting interval for a
    downhill bracket search (see <code>bracket</code>); it doesn't always
    mean that obtained solution will satisfy a&lt;=x&lt;=c.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    x tolerance stop criterion</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return optional outputs.</p>
</li>
<li>
<p><strong>maxiter : int</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize_scalar: Interface to minimization algorithms for scalar</strong>
    univariate functions. See the 'Golden' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses analog of bisection method to decrease the bracketed
interval.</p>
<h4>Examples</h4>
<p>We illustrate the behaviour of the function when <code>brack</code> is of
size 2 and 3, respectively. In the case where <code>brack</code> is of the
form (xa,xb), we can see for the given values, the output need
not necessarily lie in the range <code>(xa, xb)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">golden</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">1.5717277788484873e-162</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">golden</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="o">-</span><span class="mf">1.5717277788484873e-162</span>
</code></pre></div>

</details>
<h3 id="is_array_scalar">is_array_scalar<a class="headerlink" href="#is_array_scalar" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function is_array_scalar</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">is_array_scalar</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Test whether <code>x</code> is either a scalar or an array scalar.</p>
</details>
<h3 id="isinf">isinf<a class="headerlink" href="#isinf" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function isinf</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">isinf</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_of_ndarray_and_None</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>isinf(x, /, out=None, *, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])</p>
<p>Test element-wise for positive or negative infinity.</p>
<p>Returns a boolean array of the same shape as <code>x</code>, True where <code>x ==
+/-inf</code>, otherwise False.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    Input values</p>
</li>
<li>
<p><strong>out : ndarray, None, or tuple of ndarray and None, optional</strong>
    A location into which the result is stored. If provided, it must have
    a shape that the inputs broadcast to. If not provided or None,
    a freshly-allocated array is returned. A tuple (possible only as a
    keyword argument) must have length equal to the number of outputs.</p>
</li>
<li>
<p><strong>where : array_like, optional</strong>
    This condition is broadcast over the input. At locations where the
    condition is True, the <code>out</code> array will be set to the ufunc result.
    Elsewhere, the <code>out</code> array will retain its original value.
    Note that if an uninitialized <code>out</code> array is created via the default
    <code>out=None</code>, locations within it where the condition is False will
    remain uninitialized.
**kwargs
    For other keyword-only arguments, see the
    :ref:<code>ufunc docs &lt;ufuncs.kwargs&gt;</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : bool (scalar) or boolean ndarray</strong>
    True where <code>x</code> is positive or negative infinity, false otherwise.
    This is a scalar if <code>x</code> is a scalar.</li>
</ul>
<h4>See Also</h4>
<p>isneginf, isposinf, isnan, isfinite</p>
<h4>Notes</h4>
<p>NumPy uses the IEEE Standard for Binary Floating-Point for Arithmetic
(IEEE 754).</p>
<p>Errors result if the second argument is supplied when the first
argument is a scalar, or if the first and second arguments have
different shapes.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="line_search_1">line_search<a class="headerlink" href="#line_search_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">extra_condition</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">myfprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span><span class="o">)</span>
</code></pre></div>

<p>Find alpha that satisfies strong Wolfe conditions.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable f(x,*args)</strong>
    Objective function.</p>
</li>
<li>
<p><strong>myfprime : callable f'(x,*args)</strong>
    Objective function gradient.</p>
</li>
<li>
<p><strong>xk : ndarray</strong>
    Starting point.</p>
</li>
<li>
<p><strong>pk : ndarray</strong>
    Search direction.</p>
</li>
<li>
<p><strong>gfk : ndarray, optional</strong>
    Gradient value for x=xk (xk being the current parameter
    estimate). Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Function value for x=xk. Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Function value for the point preceding x=xk.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments passed to objective function.</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.</p>
</li>
<li>
<p><strong>amax : float, optional</strong>
    Maximum step size</p>
</li>
<li>
<p><strong>extra_condition : callable, optional</strong>
    A callable of the form <code>extra_condition(alpha, x, f, g)</code>
    returning a boolean. Arguments are the proposed step <code>alpha</code>
    and the corresponding <code>x</code>, <code>f</code> and <code>g</code> values. The line search
    accepts the value of <code>alpha</code> only if this
    callable returns <code>True</code>. If the callable returns <code>False</code>
    for the step length, the algorithm will continue with
    new iterates. The callable is only called for iterates
    satisfying the strong Wolfe conditions.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha : float or None</strong>
    Alpha for which <code>x_new = x0 + alpha * pk</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>fc : int</strong>
    Number of function evaluations made.</p>
</li>
<li>
<p><strong>gc : int</strong>
    Number of gradient evaluations made.</p>
</li>
<li>
<p><strong>new_fval : float or None</strong>
    New function value <code>f(x_new)=f(x0+alpha*pk)</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>old_fval : float</strong>
    Old function value <code>f(x0)</code>.</p>
</li>
<li>
<p><strong>new_slope : float or None</strong>
    The local slope along the search direction at the
    new value <code>&lt;myfprime(x_new), pk&gt;</code>,
    or None if the line search algorithm did not converge.</p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses the line search algorithm to enforce strong Wolfe
conditions. See Wright and Nocedal, 'Numerical Optimization',
1999, pp. 59-61.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">line_search</span>
</code></pre></div>

<p>A objective function and its gradient are defined.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

<p>We can find alpha that satisfies strong Wolfe conditions.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">start_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">search_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">line_search</span><span class="p">(</span><span class="n">obj_func</span><span class="p">,</span> <span class="n">obj_grad</span><span class="p">,</span> <span class="n">start_point</span><span class="p">,</span> <span class="n">search_gradient</span><span class="p">)</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1300000000000001</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="line_search_wolfe1_1">line_search_wolfe1<a class="headerlink" href="#line_search_wolfe1_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search_wolfe1</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search_wolfe1</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amin</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>As <code>scalar_search_wolfe1</code> but do a line search to direction <code>pk</code></p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    Function <code>f(x)</code></p>
</li>
<li>
<p><strong>fprime : callable</strong>
    Gradient of <code>f</code></p>
</li>
<li>
<p><strong>xk : array_like</strong>
    Current point</p>
</li>
<li>
<p><strong>pk : array_like</strong>
    Search direction</p>
</li>
<li>
<p><strong>gfk : array_like, optional</strong>
    Gradient of <code>f</code> at point <code>xk</code></p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Value of <code>f</code> at point <code>xk</code></p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Value of <code>f</code> at point preceding <code>xk</code></p>
</li>
</ul>
<p>The rest of the parameters are the same as for <code>scalar_search_wolfe1</code>.</p>
<h4>Returns</h4>
<p>stp, f_count, g_count, fval, old_fval
    As in <code>line_search_wolfe1</code></p>
<ul>
<li><strong>gval : array</strong>
    Gradient of <code>f</code> at the final point</li>
</ul>
</details>
<h3 id="line_search_wolfe2_1">line_search_wolfe2<a class="headerlink" href="#line_search_wolfe2_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search_wolfe2</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search_wolfe2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">extra_condition</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">myfprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span><span class="o">)</span>
</code></pre></div>

<p>Find alpha that satisfies strong Wolfe conditions.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable f(x,*args)</strong>
    Objective function.</p>
</li>
<li>
<p><strong>myfprime : callable f'(x,*args)</strong>
    Objective function gradient.</p>
</li>
<li>
<p><strong>xk : ndarray</strong>
    Starting point.</p>
</li>
<li>
<p><strong>pk : ndarray</strong>
    Search direction.</p>
</li>
<li>
<p><strong>gfk : ndarray, optional</strong>
    Gradient value for x=xk (xk being the current parameter
    estimate). Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Function value for x=xk. Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Function value for the point preceding x=xk.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments passed to objective function.</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.</p>
</li>
<li>
<p><strong>amax : float, optional</strong>
    Maximum step size</p>
</li>
<li>
<p><strong>extra_condition : callable, optional</strong>
    A callable of the form <code>extra_condition(alpha, x, f, g)</code>
    returning a boolean. Arguments are the proposed step <code>alpha</code>
    and the corresponding <code>x</code>, <code>f</code> and <code>g</code> values. The line search
    accepts the value of <code>alpha</code> only if this
    callable returns <code>True</code>. If the callable returns <code>False</code>
    for the step length, the algorithm will continue with
    new iterates. The callable is only called for iterates
    satisfying the strong Wolfe conditions.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha : float or None</strong>
    Alpha for which <code>x_new = x0 + alpha * pk</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>fc : int</strong>
    Number of function evaluations made.</p>
</li>
<li>
<p><strong>gc : int</strong>
    Number of gradient evaluations made.</p>
</li>
<li>
<p><strong>new_fval : float or None</strong>
    New function value <code>f(x_new)=f(x0+alpha*pk)</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>old_fval : float</strong>
    Old function value <code>f(x0)</code>.</p>
</li>
<li>
<p><strong>new_slope : float or None</strong>
    The local slope along the search direction at the
    new value <code>&lt;myfprime(x_new), pk&gt;</code>,
    or None if the line search algorithm did not converge.</p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses the line search algorithm to enforce strong Wolfe
conditions. See Wright and Nocedal, 'Numerical Optimization',
1999, pp. 59-61.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">line_search</span>
</code></pre></div>

<p>A objective function and its gradient are defined.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

<p>We can find alpha that satisfies strong Wolfe conditions.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">start_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">search_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">line_search</span><span class="p">(</span><span class="n">obj_func</span><span class="p">,</span> <span class="n">obj_grad</span><span class="p">,</span> <span class="n">start_point</span><span class="p">,</span> <span class="n">search_gradient</span><span class="p">)</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1300000000000001</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="main">main<a class="headerlink" href="#main" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function main</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">main</span> <span class="o">:</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="rosen">rosen<a class="headerlink" href="#rosen" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">float</span>
</code></pre></div>

<p>The Rosenbrock function.</p>
<p>The function computed is::</p>
<ul>
<li><strong>sum(100.0*(x[1:] - x[:-1]</strong>2.0)<strong>2.0 + (1 - x[:-1])</strong>2.0)**</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-D array of points at which the Rosenbrock function is to be computed.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>f : float</strong>
    The value of the Rosenbrock function.</li>
</ul>
<h4>See Also</h4>
<p>rosen_der, rosen_hess, rosen_hess_prod</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="mf">76.56</span>
</code></pre></div>

</details>
<h3 id="rosen_der">rosen_der<a class="headerlink" href="#rosen_der" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen_der</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen_der</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>The derivative (i.e. gradient) of the Rosenbrock function.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-D array of points at which the derivative is to be computed.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>rosen_der : (N,) ndarray</strong>
    The gradient of the Rosenbrock function at <code>x</code>.</li>
</ul>
<h4>See Also</h4>
<p>rosen, rosen_hess, rosen_hess_prod</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen_der</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen_der</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">2.</span> <span class="p">,</span>  <span class="mf">10.6</span><span class="p">,</span>  <span class="mf">15.6</span><span class="p">,</span>  <span class="mf">13.4</span><span class="p">,</span>   <span class="mf">6.4</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">12.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.4</span><span class="p">,</span>  <span class="mf">62.</span> <span class="p">])</span>
</code></pre></div>

</details>
<h3 id="rosen_hess">rosen_hess<a class="headerlink" href="#rosen_hess" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen_hess</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen_hess</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>The Hessian matrix of the Rosenbrock function.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-D array of points at which the Hessian matrix is to be computed.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>rosen_hess : ndarray</strong>
    The Hessian matrix of the Rosenbrock function at <code>x</code>.</li>
</ul>
<h4>See Also</h4>
<p>rosen, rosen_der, rosen_hess_prod</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen_hess</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen_hess</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">38.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">134.</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.</span><span class="p">,</span> <span class="mf">130.</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="rosen_hess_prod">rosen_hess_prod<a class="headerlink" href="#rosen_hess_prod" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen_hess_prod</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen_hess_prod</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">p</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Product of the Hessian matrix of the Rosenbrock function with a vector.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    1-D array of points at which the Hessian matrix is to be computed.</p>
</li>
<li>
<p><strong>p : array_like</strong>
    1-D array, the vector to be multiplied by the Hessian matrix.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>rosen_hess_prod : ndarray</strong>
    The Hessian matrix of the Rosenbrock function at <code>x</code> multiplied
    by the vector <code>p</code>.</li>
</ul>
<h4>See Also</h4>
<p>rosen, rosen_der, rosen_hess</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen_hess_prod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen_hess_prod</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span>  <span class="o">-</span><span class="mf">0.</span><span class="p">,</span>   <span class="mf">27.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">10.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">95.</span><span class="p">,</span> <span class="o">-</span><span class="mf">192.</span><span class="p">,</span> <span class="o">-</span><span class="mf">265.</span><span class="p">,</span> <span class="o">-</span><span class="mf">278.</span><span class="p">,</span> <span class="o">-</span><span class="mf">195.</span><span class="p">,</span> <span class="o">-</span><span class="mf">180.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="shape_2">shape<a class="headerlink" href="#shape_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function shape</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">shape</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">int</span> <span class="kt">array</span>
</code></pre></div>

<p>Return the shape of an array.</p>
<h4>Parameters</h4>
<ul>
<li><strong>a : array_like</strong>
    Input array.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>shape : tuple of ints</strong>
    The elements of the shape tuple give the lengths of the
    corresponding array dimensions.</li>
</ul>
<h4>See Also</h4>
<p>alen</p>
<ul>
<li><strong>ndarray.shape : Equivalent array method.</strong></li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
</code></pre></div>

</details>
<h3 id="show_options">show_options<a class="headerlink" href="#show_options" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function show_options</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show_options</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">solver</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Show documentation for additional options of optimization solvers.</p>
<p>These are method-specific options that can be supplied through the
<code>options</code> dict.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>solver : str</strong>
    Type of optimization solver. One of 'minimize', 'minimize_scalar',
    'root', or 'linprog'.</p>
</li>
<li>
<p><strong>method : str, optional</strong>
    If not given, shows all methods of the specified solver. Otherwise,
    show only the options for the specified method. Valid values
    corresponds to methods' names of respective solver (e.g., 'BFGS' for
    'minimize').</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Whether to print the result rather than returning it.</p>
</li>
</ul>
<h4>Returns</h4>
<p>text
    Either None (for disp=True) or the text string (disp=False)</p>
<h4>Notes</h4>
<p>The solver-specific methods are:</p>
<p><code>scipy.optimize.minimize</code></p>
<ul>
<li>:ref:<code>Nelder-Mead &lt;optimize.minimize-neldermead&gt;</code></li>
<li>:ref:<code>Powell      &lt;optimize.minimize-powell&gt;</code></li>
<li>:ref:<code>CG          &lt;optimize.minimize-cg&gt;</code></li>
<li>:ref:<code>BFGS        &lt;optimize.minimize-bfgs&gt;</code></li>
<li>:ref:<code>Newton-CG   &lt;optimize.minimize-newtoncg&gt;</code></li>
<li>:ref:<code>L-BFGS-B    &lt;optimize.minimize-lbfgsb&gt;</code></li>
<li>:ref:<code>TNC         &lt;optimize.minimize-tnc&gt;</code></li>
<li>:ref:<code>COBYLA      &lt;optimize.minimize-cobyla&gt;</code></li>
<li>:ref:<code>SLSQP       &lt;optimize.minimize-slsqp&gt;</code></li>
<li>:ref:<code>dogleg      &lt;optimize.minimize-dogleg&gt;</code></li>
<li>:ref:<code>trust-ncg   &lt;optimize.minimize-trustncg&gt;</code></li>
</ul>
<p><code>scipy.optimize.root</code></p>
<ul>
<li>:ref:<code>hybr              &lt;optimize.root-hybr&gt;</code></li>
<li>:ref:<code>lm                &lt;optimize.root-lm&gt;</code></li>
<li>:ref:<code>broyden1          &lt;optimize.root-broyden1&gt;</code></li>
<li>:ref:<code>broyden2          &lt;optimize.root-broyden2&gt;</code></li>
<li>:ref:<code>anderson          &lt;optimize.root-anderson&gt;</code></li>
<li>:ref:<code>linearmixing      &lt;optimize.root-linearmixing&gt;</code></li>
<li>:ref:<code>diagbroyden       &lt;optimize.root-diagbroyden&gt;</code></li>
<li>:ref:<code>excitingmixing    &lt;optimize.root-excitingmixing&gt;</code></li>
<li>:ref:<code>krylov            &lt;optimize.root-krylov&gt;</code></li>
<li>:ref:<code>df-sane           &lt;optimize.root-dfsane&gt;</code></li>
</ul>
<p><code>scipy.optimize.minimize_scalar</code></p>
<ul>
<li>:ref:<code>brent       &lt;optimize.minimize_scalar-brent&gt;</code></li>
<li>:ref:<code>golden      &lt;optimize.minimize_scalar-golden&gt;</code></li>
<li>:ref:<code>bounded     &lt;optimize.minimize_scalar-bounded&gt;</code></li>
</ul>
<p><code>scipy.optimize.linprog</code></p>
<ul>
<li>:ref:<code>simplex         &lt;optimize.linprog-simplex&gt;</code></li>
<li>:ref:<code>interior-point  &lt;optimize.linprog-interior-point&gt;</code></li>
</ul>
<h4>Examples</h4>
<p>We can print documentations of a solver in stdout:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">show_options</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">show_options</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>

<p>Specifying a method is possible:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">show_options</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>

<p>We can also get the documentations as a string:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">show_options</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Minimization</span> <span class="n">of</span> <span class="n">scalar</span> <span class="n">function</span> <span class="n">of</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">variables</span> <span class="n">using</span> <span class="n">the</span> <span class="o">...</span>
</code></pre></div>

</details>
<h3 id="sqrt">sqrt<a class="headerlink" href="#sqrt" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function sqrt</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">sqrt</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_of_ndarray_and_None</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>sqrt(x, /, out=None, *, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])</p>
<p>Return the non-negative square-root of an array, element-wise.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    The values whose square-roots are required.</p>
</li>
<li>
<p><strong>out : ndarray, None, or tuple of ndarray and None, optional</strong>
    A location into which the result is stored. If provided, it must have
    a shape that the inputs broadcast to. If not provided or None,
    a freshly-allocated array is returned. A tuple (possible only as a
    keyword argument) must have length equal to the number of outputs.</p>
</li>
<li>
<p><strong>where : array_like, optional</strong>
    This condition is broadcast over the input. At locations where the
    condition is True, the <code>out</code> array will be set to the ufunc result.
    Elsewhere, the <code>out</code> array will retain its original value.
    Note that if an uninitialized <code>out</code> array is created via the default
    <code>out=None</code>, locations within it where the condition is False will
    remain uninitialized.
**kwargs
    For other keyword-only arguments, see the
    :ref:<code>ufunc docs &lt;ufuncs.kwargs&gt;</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : ndarray</strong>
    An array of the same shape as <code>x</code>, containing the positive
    square-root of each element in <code>x</code>.  If any element in <code>x</code> is
    complex, a complex array is returned (and the square-roots of
    negative reals are calculated).  If all of the elements in <code>x</code>
    are real, so is <code>y</code>, with negative elements returning <code>nan</code>.
    If <code>out</code> was provided, <code>y</code> is a reference to it.
    This is a scalar if <code>x</code> is a scalar.</li>
</ul>
<h4>See Also</h4>
<p>lib.scimath.sqrt
    A version which returns complex numbers when given negative reals.</p>
<h4>Notes</h4>
<p><em>sqrt</em> has--consistent with common convention--as its branch cut the
real 'interval' [<code>-inf</code>, 0), and is continuous from above on it.
A branch cut is a curve in the complex plane across which a given
complex function fails to be continuous.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="n">J</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="n">j</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">inf</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="squeeze">squeeze<a class="headerlink" href="#squeeze" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function squeeze</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">squeeze</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Remove single-dimensional entries from the shape of an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    Input data.</p>
</li>
<li>
<p><strong>axis : None or int or tuple of ints, optional</strong>
    .. versionadded:: 1.7.0</p>
<p>Selects a subset of the single-dimensional entries in the
shape. If an axis is selected with shape entry greater than
one, an error is raised.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>squeezed : ndarray</strong>
    The input array, but with all or a subset of the
    dimensions of length 1 removed. This is always <code>a</code> itself
    or a view into <code>a</code>. Note that if all axes are squeezed,
    the result is a 0d array and not a scalar.</li>
</ul>
<h4>Raises</h4>
<p>ValueError
    If <code>axis</code> is not None, and an axis being squeezed is not of length 1</p>
<h4>See Also</h4>
<ul>
<li>
<p><strong>expand_dims : The inverse operation, adding singleton dimensions</strong></p>
</li>
<li>
<p><strong>reshape : Insert, remove, and combine dimensions, and resize existing ones</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<span class="o">...</span>
</code></pre></div>

<ul>
<li><strong>ValueError: cannot select an axis to squeeze out which has size not equal to one</strong>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1234</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">array</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># 0d array</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)[()]</span>
<span class="mi">1234</span>
</code></pre></div></li>
</ul>
</details>
<h3 id="vecnorm">vecnorm<a class="headerlink" href="#vecnorm" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function vecnorm</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">vecnorm</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">ord</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="wrap_function">wrap_function<a class="headerlink" href="#wrap_function" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function wrap_function</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">wrap_function</span> <span class="o">:</span>
  <span class="n">function_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="zeros_2">zeros<a class="headerlink" href="#zeros_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function zeros</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">zeros</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">shape</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>zeros(shape, dtype=float, order='C')</p>
<p>Return a new array of given shape and type, filled with zeros.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>shape : int or tuple of ints</strong>
    Shape of the new array, e.g., <code>(2, 3)</code> or <code>2</code>.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array, e.g., <code>numpy.int8</code>.  Default is
    <code>numpy.float64</code>.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional, default: 'C'</strong>
    Whether to store multi-dimensional data in row-major
    (C-style) or column-major (Fortran-style) order in
    memory.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array of zeros with the given shape, dtype, and order.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span> <span class="c1"># custom dtype</span>
<span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
</code></pre></div>

</details>
<h2 id="slsqp">Slsqp<a class="headerlink" href="#slsqp" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Slsqp</code> wraps Python module <code>scipy.optimize.slsqp</code>.</p>
<h2 id="finfo_1">Finfo<a class="headerlink" href="#finfo_1" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Slsqp.​Finfo</code> wraps Python class <code>scipy.optimize.slsqp.finfo</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_28">create<a class="headerlink" href="#create_28" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="o">[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dtype</span> <span class="k">of</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Instance</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>finfo(dtype)</p>
<p>Machine limits for floating point types.</p>
<h4>Attributes</h4>
<ul>
<li>
<p><strong>bits : int</strong>
    The number of bits occupied by the type.</p>
</li>
<li>
<p><strong>eps : float</strong>
    The difference between 1.0 and the next smallest representable float
    larger than 1.0. For example, for 64-bit binary floats in the IEEE-754
    standard, <code>eps = 2**-52</code>, approximately 2.22e-16.</p>
</li>
<li>
<p><strong>epsneg : float</strong>
    The difference between 1.0 and the next smallest representable float
    less than 1.0. For example, for 64-bit binary floats in the IEEE-754
    standard, <code>epsneg = 2**-53</code>, approximately 1.11e-16.</p>
</li>
<li>
<p><strong>iexp : int</strong>
    The number of bits in the exponent portion of the floating point
    representation.</p>
</li>
<li>
<p><strong>machar : MachAr</strong>
    The object which calculated these parameters and holds more
    detailed information.</p>
</li>
<li>
<p><strong>machep : int</strong>
    The exponent that yields <code>eps</code>.</p>
</li>
<li>
<p><strong>max : floating point number of the appropriate type</strong>
    The largest representable number.</p>
</li>
<li>
<p><strong>maxexp : int</strong>
    The smallest positive power of the base (2) that causes overflow.</p>
</li>
<li>
<p><strong>min : floating point number of the appropriate type</strong>
    The smallest representable number, typically <code>-max</code>.</p>
</li>
<li>
<p><strong>minexp : int</strong>
    The most negative power of the base (2) consistent with there
    being no leading 0's in the mantissa.</p>
</li>
<li>
<p><strong>negep : int</strong>
    The exponent that yields <code>epsneg</code>.</p>
</li>
<li>
<p><strong>nexp : int</strong>
    The number of bits in the exponent including its sign and bias.</p>
</li>
<li>
<p><strong>nmant : int</strong>
    The number of bits in the mantissa.</p>
</li>
<li>
<p><strong>precision : int</strong>
    The approximate number of decimal digits to which this kind of
    float is precise.</p>
</li>
<li>
<p><strong>resolution : floating point number of the appropriate type</strong>
    The approximate decimal resolution of this type, i.e.,
    <code>10**-precision</code>.</p>
</li>
<li>
<p><strong>tiny : float</strong>
    The smallest positive usable number.  Type of <code>tiny</code> is an
    appropriate floating point type.</p>
</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><strong>dtype : float, dtype, or instance</strong>
    Kind of floating point data-type about which to get information.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>MachAr : The implementation of the tests that produce this information.</strong></p>
</li>
<li>
<p><strong>iinfo : The equivalent for integer data types.</strong></p>
</li>
<li>
<p><strong>spacing : The distance between a value and the nearest adjacent number</strong></p>
</li>
<li>
<p><strong>nextafter : The next floating point value after x1 towards x2</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>For developers of NumPy: do not instantiate this at the module level.
The initial calculation of these parameters is expensive and negatively
impacts import times.  These objects are cached, so calling <code>finfo()</code>
repeatedly inside your functions is not a problem.</p>
</details>
<h3 id="bits_1">bits<a class="headerlink" href="#bits_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute bits</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">bits</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">bits_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="eps_1">eps<a class="headerlink" href="#eps_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute eps</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">eps</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">eps_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="epsneg_1">epsneg<a class="headerlink" href="#epsneg_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute epsneg</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">epsneg</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">epsneg_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="iexp_1">iexp<a class="headerlink" href="#iexp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute iexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">iexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">iexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="machar_1">machar<a class="headerlink" href="#machar_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute machar</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">machar</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">machar_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="machep_1">machep<a class="headerlink" href="#machep_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute machep</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">machep</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">machep_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="max_1">max<a class="headerlink" href="#max_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute max</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">max</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">max_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="maxexp_1">maxexp<a class="headerlink" href="#maxexp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute maxexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">maxexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">maxexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="min_1">min<a class="headerlink" href="#min_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute min</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">min</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">min_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="minexp_1">minexp<a class="headerlink" href="#minexp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute minexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">minexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">minexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="negep_1">negep<a class="headerlink" href="#negep_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute negep</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">negep</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">negep_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="nexp_1">nexp<a class="headerlink" href="#nexp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute nexp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nexp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">nexp_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="nmant_1">nmant<a class="headerlink" href="#nmant_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute nmant</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nmant</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">nmant_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="precision_1">precision<a class="headerlink" href="#precision_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute precision</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">precision</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">val</span> <span class="n">precision_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="resolution_1">resolution<a class="headerlink" href="#resolution_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute resolution</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">resolution</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
<span class="k">val</span> <span class="n">resolution_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="tiny_1">tiny<a class="headerlink" href="#tiny_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>attribute tiny</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">tiny</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">float</span>
<span class="k">val</span> <span class="n">tiny_opt</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">option</span>
</code></pre></div>

<p>This attribute is documented in <code>create</code> above. The first version raises Not_found
if the attribute is None. The _opt version returns an option.</p>
</details>
<h3 id="to_string_34">to_string<a class="headerlink" href="#to_string_34" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_34">show<a class="headerlink" href="#show_34" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_34">pp<a class="headerlink" href="#pp_34" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="append_1">append<a class="headerlink" href="#append_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function append</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">append</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">arr</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">values</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Append values to the end of an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>arr : array_like</strong>
    Values are appended to a copy of this array.</p>
</li>
<li>
<p><strong>values : array_like</strong>
    These values are appended to a copy of <code>arr</code>.  It must be of the
    correct shape (the same shape as <code>arr</code>, excluding <code>axis</code>).  If
    <code>axis</code> is not specified, <code>values</code> can be any shape and will be
    flattened before use.</p>
</li>
<li>
<p><strong>axis : int, optional</strong>
    The axis along which <code>values</code> are appended.  If <code>axis</code> is not
    given, both <code>arr</code> and <code>values</code> are flattened before use.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>append : ndarray</strong>
    A copy of <code>arr</code> with <code>values</code> appended to <code>axis</code>.  Note that
    <code>append</code> does not occur in-place: a new array is allocated and
    filled.  If <code>axis</code> is None, <code>out</code> is a flattened array.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>insert : Insert elements into an array.</strong></p>
</li>
<li>
<p><strong>delete : Delete elements from an array.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</code></pre></div>

<p>When <code>axis</code> is specified, <code>values</code> must have the correct shape.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>

<ul>
<li><strong>ValueError: all the input arrays must have same number of dimensions, but</strong>
the array at index 0 has 2 dimension(s) and the array at index 1 has 1
dimension(s)</li>
</ul>
</details>
<h3 id="approx_derivative_1">approx_derivative<a class="headerlink" href="#approx_derivative_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function approx_derivative</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">approx_derivative</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rel_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">abs_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">sparsity</span><span class="o">:[`</span><span class="nc">Arr</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_tuple</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">as_linear_operator</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Compute finite difference approximation of the derivatives of a
vector-valued function.</p>
<p>If a function maps from R^n to R^m, its derivatives form m-by-n matrix
called the Jacobian, where an element (i, j) is a partial derivative of
f[i] with respect to x[j].</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    Function of which to estimate the derivatives. The argument x
    passed to this function is ndarray of shape (n,) (never a scalar
    even if n=1). It must return 1-D array_like of shape (m,) or a scalar.</p>
</li>
<li>
<p><strong>x0 : array_like of shape (n,) or float</strong>
    Point at which to estimate the derivatives. Float will be converted
    to a 1-D array.</p>
</li>
<li>
<p><strong>method : {'3-point', '2-point', 'cs'}, optional</strong>
    Finite difference method to use:
        - '2-point' - use the first order accuracy forward or backward
                      difference.
        - '3-point' - use central difference in interior points and the
                      second order accuracy forward or backward difference
                      near the boundary.
        - 'cs' - use a complex-step finite difference scheme. This assumes
                 that the user function is real-valued and can be
                 analytically continued to the complex plane. Otherwise,
                 produces bogus results.</p>
</li>
<li>
<p><strong>rel_step : None or array_like, optional</strong>
    Relative step size to use. The absolute step size is computed as
    <code>h = rel_step * sign(x0) * max(1, abs(x0))</code>, possibly adjusted to
    fit into the bounds. For <code>method='3-point'</code> the sign of <code>h</code> is
    ignored. If None (default) then step is selected automatically,
    see Notes.</p>
</li>
<li>
<p><strong>abs_step : array_like, optional</strong>
    Absolute step size to use, possibly adjusted to fit into the bounds.
    For <code>method='3-point'</code> the sign of <code>abs_step</code> is ignored. By default
    relative steps are used, only if <code>abs_step is not None</code> are absolute
    steps used.</p>
</li>
<li>
<p><strong>f0 : None or array_like, optional</strong>
    If not None it is assumed to be equal to <code>fun(x0)</code>, in  this case
    the <code>fun(x0)</code> is not called. Default is None.</p>
</li>
<li>
<p><strong>bounds : tuple of array_like, optional</strong>
    Lower and upper bounds on independent variables. Defaults to no bounds.
    Each bound must match the size of <code>x0</code> or be a scalar, in the latter
    case the bound will be the same for all variables. Use it to limit the
    range of function evaluation. Bounds checking is not implemented
    when <code>as_linear_operator</code> is True.</p>
</li>
<li>
<p><strong>sparsity : {None, array_like, sparse matrix, 2-tuple}, optional</strong>
    Defines a sparsity structure of the Jacobian matrix. If the Jacobian
    matrix is known to have only few non-zero elements in each row, then
    it's possible to estimate its several columns by a single function
    evaluation [3]_. To perform such economic computations two ingredients
    are required:</p>
<ul>
<li>structure : array_like or sparse matrix of shape (m, n). A zero
  element means that a corresponding element of the Jacobian
  identically equals to zero.</li>
<li>groups : array_like of shape (n,). A column grouping for a given
  sparsity structure, use <code>group_columns</code> to obtain it.</li>
</ul>
<p>A single array or a sparse matrix is interpreted as a sparsity
structure, and groups are computed inside the function. A tuple is
interpreted as (structure, groups). If None (default), a standard
dense differencing will be used.</p>
<p>Note, that sparse differencing makes sense only for large Jacobian
matrices where each row contains few non-zero elements.</p>
</li>
<li>
<p><strong>as_linear_operator : bool, optional</strong>
    When True the function returns an <code>scipy.sparse.linalg.LinearOperator</code>.
    Otherwise it returns a dense array or a sparse matrix depending on
    <code>sparsity</code>. The linear operator provides an efficient way of computing
    <code>J.dot(p)</code> for any vector <code>p</code> of shape (n,), but does not allow
    direct access to individual elements of the matrix. By default
    <code>as_linear_operator</code> is False.
args, kwargs : tuple and dict, optional
    Additional arguments passed to <code>fun</code>. Both empty by default.
    The calling signature is <code>fun(x, *args, **kwargs)</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>J : {ndarray, sparse matrix, LinearOperator}</strong>
    Finite difference approximation of the Jacobian matrix.
    If <code>as_linear_operator</code> is True returns a LinearOperator
    with shape (m, n). Otherwise it returns a dense array or sparse
    matrix depending on how <code>sparsity</code> is defined. If <code>sparsity</code>
    is None then a ndarray with shape (m, n) is returned. If
    <code>sparsity</code> is not None returns a csr_matrix with shape (m, n).
    For sparse matrices and linear operators it is always returned as
    a 2-D structure, for ndarrays, if m=1 it is returned
    as a 1-D gradient array with shape (n,).</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>check_derivative : Check correctness of a function computing derivatives.</strong></li>
</ul>
<h4>Notes</h4>
<p>If <code>rel_step</code> is not provided, it assigned to <code>EPS**(1/s)</code>, where EPS is
machine epsilon for float64 numbers, s=2 for '2-point' method and s=3 for
'3-point' method. Such relative step approximately minimizes a sum of
truncation and round-off errors, see [1]_. Relative steps are used by
default. However, absolute steps are used when <code>abs_step is not None</code>.
If any of the absolute steps produces an indistinguishable difference from
the original <code>x0</code>, <code>(x0 + abs_step) - x0 == 0</code>, then a relative step is
substituted for that particular entry.</p>
<p>A finite difference scheme for '3-point' method is selected automatically.
The well-known central difference scheme is used for points sufficiently
far from the boundary, and 3-point forward or backward scheme is used for
points near the boundary. Both schemes have the second-order accuracy in
terms of Taylor expansion. Refer to [2]_ for the formulas of 3-point
forward and backward difference schemes.</p>
<p>For dense differencing when m=1 Jacobian is returned with a shape (n,),
on the other hand when n=1 Jacobian is returned with a shape (m, 1).
Our motivation is the following: a) It handles a case of gradient
computation (m=1) in a conventional way. b) It clearly separates these two
different cases. b) In all cases np.atleast_2d can be called to get 2-D
Jacobian with correct dimensions.</p>
<h4>References</h4>
<p>.. [1] W. H. Press et. al. 'Numerical Recipes. The Art of Scientific
       Computing. 3rd edition', sec. 5.7.</p>
<p>.. [2] A. Curtis, M. J. D. Powell, and J. Reid, 'On the estimation of
       sparse Jacobian matrices', Journal of the Institute of Mathematics
       and its Applications, 13 (1974), pp. 117-120.</p>
<p>.. [3] B. Fornberg, 'Generation of Finite Difference Formulas on
       Arbitrarily Spaced Grids', Mathematics of Computation 51, 1988.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">approx_derivative</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="o">...</span>                      <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<p>Bounds can be used to limit the region of function evaluation.
In the example below we compute left and right derivative at point 1.0.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="approx_jacobian">approx_jacobian<a class="headerlink" href="#approx_jacobian" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function approx_jacobian</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">approx_jacobian</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Approximate the Jacobian matrix of a callable function.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    The state vector at which to compute the Jacobian matrix.</p>
</li>
<li>
<p><strong>func : callable f(x,*args)</strong>
    The vector-valued function.</p>
</li>
<li>
<p><strong>epsilon : float</strong>
    The perturbation used to determine the partial derivatives.</p>
</li>
<li>
<p><strong>args : sequence</strong>
    Additional arguments passed to func.</p>
</li>
</ul>
<h4>Returns</h4>
<p>An array of dimensions <code>(lenf, lenx)</code> where <code>lenf</code> is the length
of the outputs of <code>func</code>, and <code>lenx</code> is the number of elements in
<code>x</code>.</p>
<h4>Notes</h4>
<p>The approximation is done using forward differences.</p>
</details>
<h3 id="array_1">array<a class="headerlink" href="#array_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function array</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="kt">array</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">copy</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">K</span> <span class="o">|</span> <span class="o">`</span><span class="nc">A</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">subok</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ndmin</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">object_</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>array(object, dtype=None, *, copy=True, order='K', subok=False, ndmin=0)</p>
<p>Create an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>object : array_like</strong>
    An array, any object exposing the array interface, an object whose
    <strong>array</strong> method returns an array, or any (nested) sequence.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array.  If not given, then the type will
    be determined as the minimum type required to hold the objects in the
    sequence.</p>
</li>
<li>
<p><strong>copy : bool, optional</strong>
    If true (default), then the object is copied.  Otherwise, a copy will
    only be made if <strong>array</strong> returns a copy, if obj is a nested sequence,
    or if a copy is needed to satisfy any of the other requirements
    (<code>dtype</code>, <code>order</code>, etc.).</p>
</li>
<li>
<p><strong>order : {'K', 'A', 'C', 'F'}, optional</strong>
    Specify the memory layout of the array. If object is not an array, the
    newly created array will be in C order (row major) unless 'F' is
    specified, in which case it will be in Fortran order (column major).
    If object is an array the following holds.</p>
<p>===== ========= ===================================================
order  no copy                     copy=True
===== ========= ===================================================
'K'   unchanged F &amp; C order preserved, otherwise most similar order
'A'   unchanged F order if input is F and not C, otherwise C order
'C'   C order   C order
'F'   F order   F order
===== ========= ===================================================</p>
<p>When <code>copy=False</code> and a copy is made for other reasons, the result is
the same as if <code>copy=True</code>, with some exceptions for <code>A</code>, see the
Notes section. The default order is 'K'.</p>
</li>
<li>
<p><strong>subok : bool, optional</strong>
    If True, then sub-classes will be passed-through, otherwise
    the returned array will be forced to be a base-class array (default).</p>
</li>
<li>
<p><strong>ndmin : int, optional</strong>
    Specifies the minimum number of dimensions that the resulting
    array should have.  Ones will be pre-pended to the shape as
    needed to meet this requirement.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    An array object satisfying the specified requirements.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>empty_like : Return an empty array with shape and type of input.</strong></p>
</li>
<li>
<p><strong>ones_like : Return an array of ones with shape and type of input.</strong></p>
</li>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>full_like : Return a new array with shape of input filled with value.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>zeros : Return a new array setting values to zero.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>When order is 'A' and <code>object</code> is an array in neither 'C' nor 'F' order,
and a copy is forced by a change in dtype, then the order of the result is
not necessarily 'C' as expected. This is likely a bug.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>

<p>Upcasting:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

<p>More than one dimension:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<p>Minimum dimensions 2:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</code></pre></div>

<p>Type provided:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">2.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">3.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">])</span>
</code></pre></div>

<p>Data-type consisting of more than one element:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">),(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>

<p>Creating an array from sub-classes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">),</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="asfarray_1">asfarray<a class="headerlink" href="#asfarray_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asfarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asfarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dtype_object</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return an array converted to a float type.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    The input array.</p>
</li>
<li>
<p><strong>dtype : str or dtype object, optional</strong>
    Float type code to coerce input array <code>a</code>.  If <code>dtype</code> is one of the
    'int' dtypes, it is replaced with float64.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    The input <code>a</code> as a float ndarray.</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="atleast_1d_2">atleast_1d<a class="headerlink" href="#atleast_1d_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function atleast_1d</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">atleast_1d</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert inputs to arrays with at least one dimension.</p>
<p>Scalar inputs are converted to 1-dimensional arrays, whilst
higher-dimensional inputs are preserved.</p>
<h4>Parameters</h4>
<p>arys1, arys2, ... : array_like
    One or more input arrays.</p>
<h4>Returns</h4>
<ul>
<li><strong>ret : ndarray</strong>
    An array, or list of arrays, each with <code>a.ndim &gt;= 1</code>.
    Copies are made only if necessary.</li>
</ul>
<h4>See Also</h4>
<p>atleast_2d, atleast_3d</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="n">x</span>
<span class="kc">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">[</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])]</span>
</code></pre></div>

</details>
<h3 id="concatenate">concatenate<a class="headerlink" href="#concatenate" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function concatenate</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">concatenate</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">axis</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>concatenate((a1, a2, ...), axis=0, out=None)</p>
<p>Join a sequence of arrays along an existing axis.</p>
<h4>Parameters</h4>
<p>a1, a2, ... : sequence of array_like
    The arrays must have the same shape, except in the dimension
    corresponding to <code>axis</code> (the first, by default).</p>
<ul>
<li>
<p><strong>axis : int, optional</strong>
    The axis along which the arrays will be joined.  If axis is None,
    arrays are flattened before use.  Default is 0.</p>
</li>
<li>
<p><strong>out : ndarray, optional</strong>
    If provided, the destination to place the result. The shape must be
    correct, matching that of what concatenate would have returned if no
    out argument were specified.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : ndarray</strong>
    The concatenated array.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>ma.concatenate : Concatenate function that preserves input masks.</strong></p>
</li>
<li>
<p><strong>array_split : Split an array into multiple sub-arrays of equal or</strong>
              near-equal size.</p>
</li>
<li>
<p><strong>split : Split array into a list of multiple sub-arrays of equal size.</strong></p>
</li>
<li>
<p><strong>hsplit : Split array into multiple sub-arrays horizontally (column wise).</strong></p>
</li>
<li>
<p><strong>vsplit : Split array into multiple sub-arrays vertically (row wise).</strong></p>
</li>
<li>
<p><strong>dsplit : Split array into multiple sub-arrays along the 3rd axis (depth).</strong></p>
</li>
<li>
<p><strong>stack : Stack a sequence of arrays along a new axis.</strong></p>
</li>
<li>
<p><strong>block : Assemble arrays from blocks.</strong></p>
</li>
<li>
<p><strong>hstack : Stack arrays in sequence horizontally (column wise).</strong></p>
</li>
<li>
<p><strong>vstack : Stack arrays in sequence vertically (row wise).</strong></p>
</li>
<li>
<p><strong>dstack : Stack arrays in sequence depth wise (along third dimension).</strong></p>
</li>
<li>
<p><strong>column_stack : Stack 1-D arrays as columns into a 2-D array.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>When one or more of the arrays to be concatenated is a MaskedArray,
this function will return a MaskedArray object instead of an ndarray,
but the input masks are <em>not</em> preserved. In cases where a MaskedArray
is expected as input, use the ma.concatenate function from the masked
array module instead.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</code></pre></div>

<p>This function will not preserve masking of MaskedArray inputs.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="n">masked_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">--</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
             <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
       <span class="n">fill_value</span><span class="o">=</span><span class="mi">999999</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span>
<span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="n">masked_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
             <span class="n">mask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
       <span class="n">fill_value</span><span class="o">=</span><span class="mi">999999</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="n">masked_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">--</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
             <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
       <span class="n">fill_value</span><span class="o">=</span><span class="mi">999999</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="exp">exp<a class="headerlink" href="#exp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function exp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">exp</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_of_ndarray_and_None</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>exp(x, /, out=None, *, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])</p>
<p>Calculate the exponential of all elements in the input array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    Input values.</p>
</li>
<li>
<p><strong>out : ndarray, None, or tuple of ndarray and None, optional</strong>
    A location into which the result is stored. If provided, it must have
    a shape that the inputs broadcast to. If not provided or None,
    a freshly-allocated array is returned. A tuple (possible only as a
    keyword argument) must have length equal to the number of outputs.</p>
</li>
<li>
<p><strong>where : array_like, optional</strong>
    This condition is broadcast over the input. At locations where the
    condition is True, the <code>out</code> array will be set to the ufunc result.
    Elsewhere, the <code>out</code> array will retain its original value.
    Note that if an uninitialized <code>out</code> array is created via the default
    <code>out=None</code>, locations within it where the condition is False will
    remain uninitialized.
**kwargs
    For other keyword-only arguments, see the
    :ref:<code>ufunc docs &lt;ufuncs.kwargs&gt;</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray or scalar</strong>
    Output array, element-wise exponential of <code>x</code>.
    This is a scalar if <code>x</code> is a scalar.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>expm1 : Calculate <code>exp(x) - 1</code> for all elements in the array.</strong></p>
</li>
<li>
<p><strong>exp2  : Calculate <code>2**x</code> for all elements in the array.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>The irrational number <code>e</code> is also known as Euler's number.  It is
approximately 2.718281, and is the base of the natural logarithm,
<code>ln</code> (this means that, if :math:<code>x = \ln y = \log_e y</code>,</p>
<ul>
<li><strong>then :math:<code>e^x = y</code>. For real input, <code>exp(x)</code> is always positive.</strong></li>
</ul>
<p>For complex arguments, <code>x = a + ib</code>, we can write
:math:<code>e^x = e^a e^{ib}</code>.  The first term, :math:<code>e^a</code>, is already
known (it is the real argument, described above).  The second term,
:math:<code>e^{ib}</code>, is :math:<code>\cos b + i \sin b</code>, a function with
magnitude 1 and a periodic phase.</p>
<h4>References</h4>
<p>.. [1] Wikipedia, 'Exponential function',</p>
<ul>
<li>
<p><strong>https://en.wikipedia.org/wiki/Exponential_function</strong>
.. [2] M. Abramovitz and I. A. Stegun, 'Handbook of Mathematical Functions
       with Formulas, Graphs, and Mathematical Tables,' Dover, 1964, p. 69,</p>
</li>
<li>
<p><strong>http://www.math.sfu.ca/~cbm/aands/page_69.htm</strong></p>
</li>
</ul>
<h4>Examples</h4>
<p>Plot the magnitude and phase of <code>exp(x)</code> in the complex plane:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="c1"># a + ib over complex plane</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>
<span class="o">...</span>            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnitude of exp(x)&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">out</span><span class="p">),</span>
<span class="o">...</span>            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phase (angle) of exp(x)&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="fmin_slsqp">fmin_slsqp<a class="headerlink" href="#fmin_slsqp" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_slsqp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_slsqp</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">eqcons</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_eqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ieqcons</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_ieqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime_eqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime_ieqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">acc</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iprint</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using Sequential Least Squares Programming</p>
<p>Python interface function for the SLSQP Optimization subroutine
originally implemented by Dieter Kraft.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function.  Must return a scalar.</p>
</li>
<li>
<p><strong>x0 : 1-D ndarray of float</strong>
    Initial guess for the independent variable(s).</p>
</li>
<li>
<p><strong>eqcons : list, optional</strong>
    A list of functions of length n such that
    eqcons<a href="x,*args">j</a> == 0.0 in a successfully optimized
    problem.</p>
</li>
<li>
<p><strong>f_eqcons : callable f(x,*args), optional</strong>
    Returns a 1-D array in which each element must equal 0.0 in a
    successfully optimized problem. If f_eqcons is specified,
    eqcons is ignored.</p>
</li>
<li>
<p><strong>ieqcons : list, optional</strong>
    A list of functions of length n such that
    ieqcons<a href="x,*args">j</a> &gt;= 0.0 in a successfully optimized
    problem.</p>
</li>
<li>
<p><strong>f_ieqcons : callable f(x,*args), optional</strong>
    Returns a 1-D ndarray in which each element must be greater or
    equal to 0.0 in a successfully optimized problem. If
    f_ieqcons is specified, ieqcons is ignored.</p>
</li>
<li>
<p><strong>bounds : list, optional</strong>
    A list of tuples specifying the lower and upper bound
    for each independent variable [(xl0, xu0),(xl1, xu1),...]
    Infinite values will be interpreted as large floating values.</p>
</li>
<li>
<p><strong>fprime : callable <code>f(x,*args)</code>, optional</strong>
    A function that evaluates the partial derivatives of func.</p>
</li>
<li>
<p><strong>fprime_eqcons : callable <code>f(x,*args)</code>, optional</strong>
    A function of the form <code>f(x, *args)</code> that returns the m by n
    array of equality constraint normals. If not provided,
    the normals will be approximated. The array returned by
    fprime_eqcons should be sized as ( len(eqcons), len(x0) ).</p>
</li>
<li>
<p><strong>fprime_ieqcons : callable <code>f(x,*args)</code>, optional</strong>
    A function of the form <code>f(x, *args)</code> that returns the m by n
    array of inequality constraint normals. If not provided,
    the normals will be approximated. The array returned by
    fprime_ieqcons should be sized as ( len(ieqcons), len(x0) ).</p>
</li>
<li>
<p><strong>args : sequence, optional</strong>
    Additional arguments passed to func and fprime.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    The maximum number of iterations.</p>
</li>
<li>
<p><strong>acc : float, optional</strong>
    Requested accuracy.</p>
</li>
<li>
<p><strong>iprint : int, optional</strong>
    The verbosity of fmin_slsqp :</p>
<ul>
<li>iprint &lt;= 0 : Silent operation</li>
<li>iprint == 1 : Print summary upon completion (default)</li>
<li>iprint &gt;= 2 : Print status of each iterate and summary</li>
</ul>
</li>
<li>
<p><strong>disp : int, optional</strong>
    Overrides the iprint interface (preferred).</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If False, return only the minimizer of func (default).
    Otherwise, output final objective function and summary
    information.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    The step size for finite-difference derivative estimates.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as <code>callback(x)</code>, where <code>x</code> is the
    current parameter vector.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>out : ndarray of float</strong>
    The final minimizer of func.</p>
</li>
<li>
<p><strong>fx : ndarray of float, if full_output is true</strong>
    The final value of the objective function.</p>
</li>
<li>
<p><strong>its : int, if full_output is true</strong>
    The number of iterations.</p>
</li>
<li>
<p><strong>imode : int, if full_output is true</strong>
    The exit mode from the optimizer (see below).</p>
</li>
<li>
<p><strong>smode : string, if full_output is true</strong>
    Message describing the exit mode from the optimizer.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'SLSQP' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Exit modes are defined as follows ::</p>
<div class="codehilite"><pre><span></span><code>-1 : Gradient evaluation required (g &amp; a)
</code></pre></div>


<ul>
<li>
<p><strong>0 : Optimization terminated successfully</strong></p>
</li>
<li>
<p><strong>1 : Function evaluation required (f &amp; c)</strong></p>
</li>
<li>
<p><strong>2 : More equality constraints than independent variables</strong></p>
</li>
<li>
<p><strong>3 : More than 3*n iterations in LSQ subproblem</strong></p>
</li>
<li>
<p><strong>4 : Inequality constraints incompatible</strong></p>
</li>
<li>
<p><strong>5 : Singular matrix E in LSQ subproblem</strong></p>
</li>
<li>
<p><strong>6 : Singular matrix C in LSQ subproblem</strong></p>
</li>
<li>
<p><strong>7 : Rank-deficient equality constraint subproblem HFTI</strong></p>
</li>
<li>
<p><strong>8 : Positive directional derivative for linesearch</strong></p>
</li>
<li>
<p><strong>9 : Iteration limit reached</strong></p>
</li>
</ul>
<h4>Examples</h4>
<p>Examples are given :ref:<code>in the tutorial &lt;tutorial-sqlsp&gt;</code>.</p>
</details>
<h3 id="isfinite">isfinite<a class="headerlink" href="#isfinite" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function isfinite</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">isfinite</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_of_ndarray_and_None</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>isfinite(x, /, out=None, *, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])</p>
<p>Test element-wise for finiteness (not infinity or not Not a Number).</p>
<p>The result is returned as a boolean array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    Input values.</p>
</li>
<li>
<p><strong>out : ndarray, None, or tuple of ndarray and None, optional</strong>
    A location into which the result is stored. If provided, it must have
    a shape that the inputs broadcast to. If not provided or None,
    a freshly-allocated array is returned. A tuple (possible only as a
    keyword argument) must have length equal to the number of outputs.</p>
</li>
<li>
<p><strong>where : array_like, optional</strong>
    This condition is broadcast over the input. At locations where the
    condition is True, the <code>out</code> array will be set to the ufunc result.
    Elsewhere, the <code>out</code> array will retain its original value.
    Note that if an uninitialized <code>out</code> array is created via the default
    <code>out=None</code>, locations within it where the condition is False will
    remain uninitialized.
**kwargs
    For other keyword-only arguments, see the
    :ref:<code>ufunc docs &lt;ufuncs.kwargs&gt;</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : ndarray, bool</strong>
    True where <code>x</code> is not positive infinity, negative infinity,
    or NaN; false otherwise.
    This is a scalar if <code>x</code> is a scalar.</li>
</ul>
<h4>See Also</h4>
<p>isinf, isneginf, isposinf, isnan</p>
<h4>Notes</h4>
<p>Not a Number, positive infinity and negative infinity are considered
to be non-finite.</p>
<p>NumPy uses the IEEE Standard for Binary Floating-Point for Arithmetic
(IEEE 754). This means that Not a Number is not equivalent to infinity.
Also that positive infinity is not equivalent to negative infinity. But
infinity is equivalent to positive infinity.  Errors result if the
second argument is also supplied when <code>x</code> is a scalar input, or if
first and second arguments have different shapes.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">)</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">),</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="old_bound_to_new_1">old_bound_to_new<a class="headerlink" href="#old_bound_to_new_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function old_bound_to_new</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">old_bound_to_new</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the old bounds representation to the new one.</p>
<p>The new representation is a tuple (lb, ub) and the old one is a list
containing n tuples, ith containing lower and upper bound on a ith
variable.
If any of the entries in lb/ub are None they are replaced by
-np.inf/np.inf.</p>
</details>
<h3 id="sqrt_1">sqrt<a class="headerlink" href="#sqrt_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function sqrt</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">sqrt</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">out</span><span class="o">:[`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_of_ndarray_and_None</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">where</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>sqrt(x, /, out=None, *, where=True, casting='same_kind', order='K', dtype=None, subok=True[, signature, extobj])</p>
<p>Return the non-negative square-root of an array, element-wise.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    The values whose square-roots are required.</p>
</li>
<li>
<p><strong>out : ndarray, None, or tuple of ndarray and None, optional</strong>
    A location into which the result is stored. If provided, it must have
    a shape that the inputs broadcast to. If not provided or None,
    a freshly-allocated array is returned. A tuple (possible only as a
    keyword argument) must have length equal to the number of outputs.</p>
</li>
<li>
<p><strong>where : array_like, optional</strong>
    This condition is broadcast over the input. At locations where the
    condition is True, the <code>out</code> array will be set to the ufunc result.
    Elsewhere, the <code>out</code> array will retain its original value.
    Note that if an uninitialized <code>out</code> array is created via the default
    <code>out=None</code>, locations within it where the condition is False will
    remain uninitialized.
**kwargs
    For other keyword-only arguments, see the
    :ref:<code>ufunc docs &lt;ufuncs.kwargs&gt;</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>y : ndarray</strong>
    An array of the same shape as <code>x</code>, containing the positive
    square-root of each element in <code>x</code>.  If any element in <code>x</code> is
    complex, a complex array is returned (and the square-roots of
    negative reals are calculated).  If all of the elements in <code>x</code>
    are real, so is <code>y</code>, with negative elements returning <code>nan</code>.
    If <code>out</code> was provided, <code>y</code> is a reference to it.
    This is a scalar if <code>x</code> is a scalar.</li>
</ul>
<h4>See Also</h4>
<p>lib.scimath.sqrt
    A version which returns complex numbers when given negative reals.</p>
<h4>Notes</h4>
<p><em>sqrt</em> has--consistent with common convention--as its branch cut the
real 'interval' [<code>-inf</code>, 0), and is continuous from above on it.
A branch cut is a curve in the complex plane across which a given
complex function fails to be continuous.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="n">J</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="n">j</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">inf</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="vstack">vstack<a class="headerlink" href="#vstack" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function vstack</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">vstack</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Stack arrays in sequence vertically (row wise).</p>
<p>This is equivalent to concatenation along the first axis after 1-D arrays
of shape <code>(N,)</code> have been reshaped to <code>(1,N)</code>. Rebuilds arrays divided by
<code>vsplit</code>.</p>
<p>This function makes most sense for arrays with up to 3 dimensions. For
instance, for pixel-data with a height (first axis), width (second axis),
and r/g/b channels (third axis). The functions <code>concatenate</code>, <code>stack</code> and
<code>block</code> provide more general stacking and concatenation operations.</p>
<h4>Parameters</h4>
<ul>
<li><strong>tup : sequence of ndarrays</strong>
    The arrays must have the same shape along all but the first axis.
    1-D arrays must have the same length.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>stacked : ndarray</strong>
    The array formed by stacking the given arrays, will be at least 2-D.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>concatenate : Join a sequence of arrays along an existing axis.</strong></p>
</li>
<li>
<p><strong>stack : Join a sequence of arrays along a new axis.</strong></p>
</li>
<li>
<p><strong>block : Assemble an nd-array from nested lists of blocks.</strong></p>
</li>
<li>
<p><strong>hstack : Stack arrays in sequence horizontally (column wise).</strong></p>
</li>
<li>
<p><strong>dstack : Stack arrays in sequence depth wise (along third axis).</strong></p>
</li>
<li>
<p><strong>column_stack : Stack 1-D arrays as columns into a 2-D array.</strong></p>
</li>
<li>
<p><strong>vsplit : Split an array into multiple sub-arrays vertically (row-wise).</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="zeros_3">zeros<a class="headerlink" href="#zeros_3" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function zeros</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">zeros</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">shape</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>zeros(shape, dtype=float, order='C')</p>
<p>Return a new array of given shape and type, filled with zeros.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>shape : int or tuple of ints</strong>
    Shape of the new array, e.g., <code>(2, 3)</code> or <code>2</code>.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array, e.g., <code>numpy.int8</code>.  Default is
    <code>numpy.float64</code>.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional, default: 'C'</strong>
    Whether to store multi-dimensional data in row-major
    (C-style) or column-major (Fortran-style) order in
    memory.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array of zeros with the given shape, dtype, and order.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span> <span class="c1"># custom dtype</span>
<span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
</code></pre></div>

</details>
<h2 id="tnc">Tnc<a class="headerlink" href="#tnc" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Tnc</code> wraps Python module <code>scipy.optimize.tnc</code>.</p>
<h2 id="memoizejac_1">MemoizeJac<a class="headerlink" href="#memoizejac_1" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Tnc.​MemoizeJac</code> wraps Python class <code>scipy.optimize.tnc.MemoizeJac</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_29">create<a class="headerlink" href="#create_29" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Decorator that caches the return values of a function returning <code>(fun, grad)</code>
each time it is called. </p>
</details>
<h3 id="derivative_1">derivative<a class="headerlink" href="#derivative_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method derivative</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">derivative</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="to_string_35">to_string<a class="headerlink" href="#to_string_35" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_35">show<a class="headerlink" href="#show_35" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_35">pp<a class="headerlink" href="#pp_35" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="array_2">array<a class="headerlink" href="#array_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function array</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="kt">array</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">copy</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">K</span> <span class="o">|</span> <span class="o">`</span><span class="nc">A</span> <span class="o">|</span> <span class="o">`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">subok</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ndmin</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">object_</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>array(object, dtype=None, *, copy=True, order='K', subok=False, ndmin=0)</p>
<p>Create an array.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>object : array_like</strong>
    An array, any object exposing the array interface, an object whose
    <strong>array</strong> method returns an array, or any (nested) sequence.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array.  If not given, then the type will
    be determined as the minimum type required to hold the objects in the
    sequence.</p>
</li>
<li>
<p><strong>copy : bool, optional</strong>
    If true (default), then the object is copied.  Otherwise, a copy will
    only be made if <strong>array</strong> returns a copy, if obj is a nested sequence,
    or if a copy is needed to satisfy any of the other requirements
    (<code>dtype</code>, <code>order</code>, etc.).</p>
</li>
<li>
<p><strong>order : {'K', 'A', 'C', 'F'}, optional</strong>
    Specify the memory layout of the array. If object is not an array, the
    newly created array will be in C order (row major) unless 'F' is
    specified, in which case it will be in Fortran order (column major).
    If object is an array the following holds.</p>
<p>===== ========= ===================================================
order  no copy                     copy=True
===== ========= ===================================================
'K'   unchanged F &amp; C order preserved, otherwise most similar order
'A'   unchanged F order if input is F and not C, otherwise C order
'C'   C order   C order
'F'   F order   F order
===== ========= ===================================================</p>
<p>When <code>copy=False</code> and a copy is made for other reasons, the result is
the same as if <code>copy=True</code>, with some exceptions for <code>A</code>, see the
Notes section. The default order is 'K'.</p>
</li>
<li>
<p><strong>subok : bool, optional</strong>
    If True, then sub-classes will be passed-through, otherwise
    the returned array will be forced to be a base-class array (default).</p>
</li>
<li>
<p><strong>ndmin : int, optional</strong>
    Specifies the minimum number of dimensions that the resulting
    array should have.  Ones will be pre-pended to the shape as
    needed to meet this requirement.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    An array object satisfying the specified requirements.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>empty_like : Return an empty array with shape and type of input.</strong></p>
</li>
<li>
<p><strong>ones_like : Return an array of ones with shape and type of input.</strong></p>
</li>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>full_like : Return a new array with shape of input filled with value.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>zeros : Return a new array setting values to zero.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>When order is 'A' and <code>object</code> is an array in neither 'C' nor 'F' order,
and a copy is forced by a change in dtype, then the order of the result is
not necessarily 'C' as expected. This is likely a bug.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>

<p>Upcasting:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

<p>More than one dimension:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<p>Minimum dimensions 2:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</code></pre></div>

<p>Type provided:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">2.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">3.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">])</span>
</code></pre></div>

<p>Data-type consisting of more than one element:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">),(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>

<p>Creating an array from sub-classes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">),</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="asfarray_2">asfarray<a class="headerlink" href="#asfarray_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function asfarray</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">asfarray</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dtype_object</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return an array converted to a float type.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>a : array_like</strong>
    The input array.</p>
</li>
<li>
<p><strong>dtype : str or dtype object, optional</strong>
    Float type code to coerce input array <code>a</code>.  If <code>dtype</code> is one of the
    'int' dtypes, it is replaced with float64.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    The input <code>a</code> as a float ndarray.</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="fmin_tnc">fmin_tnc<a class="headerlink" href="#fmin_tnc" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_tnc</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_tnc</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">approx_grad</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">scale</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">offset</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">messages</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxCGit</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">eta</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">stepmx</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">accuracy</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fmin</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">pgtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rescale</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function with variables subject to bounds, using
gradient information in a truncated Newton algorithm. This
method wraps a C implementation of the algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>func(x, *args)</code></strong>
    Function to minimize.  Must do one of:</p>
<ol>
<li>
<p>Return f and g, where f is the value of the function and g its
   gradient (a list of floats).</p>
</li>
<li>
<p>Return the function value but supply gradient function
   separately as <code>fprime</code>.</p>
</li>
<li>
<p>Return the function value and set <code>approx_grad=True</code>.</p>
</li>
</ol>
<p>If the function returns None, the minimization
is aborted.</p>
</li>
<li>
<p><strong>x0 : array_like</strong>
    Initial estimate of minimum.</p>
</li>
<li>
<p><strong>fprime : callable <code>fprime(x, *args)</code>, optional</strong>
    Gradient of <code>func</code>. If None, then either <code>func</code> must return the
    function value and the gradient (<code>f,g = func(x, *args)</code>)
    or <code>approx_grad</code> must be True.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Arguments to pass to function.</p>
</li>
<li>
<p><strong>approx_grad : bool, optional</strong>
    If true, approximate the gradient numerically.</p>
</li>
<li>
<p><strong>bounds : list, optional</strong>
    (min, max) pairs for each element in x0, defining the
    bounds on that parameter. Use None or +/-inf for one of
    min or max when there is no bound in that direction.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    Used if approx_grad is True. The stepsize in a finite
    difference approximation for fprime.</p>
</li>
<li>
<p><strong>scale : array_like, optional</strong>
    Scaling factors to apply to each variable. If None, the
    factors are up-low for interval bounded variables and
    1+|x| for the others. Defaults to None.</p>
</li>
<li>
<p><strong>offset : array_like, optional</strong>
    Value to subtract from each variable. If None, the
    offsets are (up+low)/2 for interval bounded variables
    and x for the others.</p>
</li>
<li>
<p><strong>messages : int, optional</strong>
    Bit mask used to select messages display during
    minimization values defined in the MSGS dict. Defaults to
    MGS_ALL.</p>
</li>
<li>
<p><strong>disp : int, optional</strong>
    Integer interface to messages. 0 = no message, 5 = all messages</p>
</li>
<li>
<p><strong>maxCGit : int, optional</strong>
    Maximum number of hessian*vector evaluations per main
    iteration. If maxCGit == 0, the direction chosen is
    -gradient if maxCGit &lt; 0, maxCGit is set to
    max(1,min(50,n/2)). Defaults to -1.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluation. If None, maxfun is
    set to max(100, 10*len(x0)). Defaults to None.</p>
</li>
<li>
<p><strong>eta : float, optional</strong>
    Severity of the line search. If &lt; 0 or &gt; 1, set to 0.25.
    Defaults to -1.</p>
</li>
<li>
<p><strong>stepmx : float, optional</strong>
    Maximum step for the line search. May be increased during
    call. If too small, it will be set to 10.0. Defaults to 0.</p>
</li>
<li>
<p><strong>accuracy : float, optional</strong>
    Relative precision for finite difference calculations. If
    &lt;= machine_precision, set to sqrt(machine_precision).
    Defaults to 0.</p>
</li>
<li>
<p><strong>fmin : float, optional</strong>
    Minimum function value estimate. Defaults to 0.</p>
</li>
<li>
<p><strong>ftol : float, optional</strong>
    Precision goal for the value of f in the stopping criterion.
    If ftol &lt; 0.0, ftol is set to 0.0 defaults to -1.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Precision goal for the value of x in the stopping
    criterion (after applying x scaling factors). If xtol &lt;
    0.0, xtol is set to sqrt(machine_precision). Defaults to
    -1.</p>
</li>
<li>
<p><strong>pgtol : float, optional</strong>
    Precision goal for the value of the projected gradient in
    the stopping criterion (after applying x scaling factors).
    If pgtol &lt; 0.0, pgtol is set to 1e-2 * sqrt(accuracy).
    Setting it to 0.0 is not recommended. Defaults to -1.</p>
</li>
<li>
<p><strong>rescale : float, optional</strong>
    Scaling factor (in log10) used to trigger f value
    rescaling. If 0, rescale at each iteration. If a large
    value, never rescale. If &lt; 0, rescale is set to 1.3.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as callback(xk), where xk is the
    current parameter vector.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    The solution.</p>
</li>
<li>
<p><strong>nfeval : int</strong>
    The number of function evaluations.</p>
</li>
<li>
<p><strong>rc : int</strong>
    Return code, see below</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'TNC' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>The underlying algorithm is truncated Newton, also called
Newton Conjugate-Gradient. This method differs from
scipy.optimize.fmin_ncg in that</p>
<ol>
<li>it wraps a C implementation of the algorithm</li>
<li>it allows each variable to be given an upper and lower bound.</li>
</ol>
<p>The algorithm incorporates the bound constraints by determining
the descent direction as in an unconstrained truncated Newton,
but never taking a step-size large enough to leave the space
of feasible x's. The algorithm keeps track of a set of
currently active constraints, and ignores them when computing
the minimum allowable step size. (The x's associated with the
active constraint are kept fixed.) If the maximum allowable
step size is zero then a new constraint is added. At the end
of each iteration one of the constraints may be deemed no
longer active and removed. A constraint is considered
no longer active is if it is currently active
but the gradient for that variable points inward from the
constraint. The specific constraint removed is the one
associated with the variable of largest index whose
constraint is no longer active.</p>
<p>Return codes are defined as follows::</p>
<div class="codehilite"><pre><span></span><code>-1 : Infeasible (lower bound &gt; upper bound)
</code></pre></div>


<ul>
<li>
<p><strong>0 : Local minimum reached (|pg| ~= 0)</strong></p>
</li>
<li>
<p><strong>1 : Converged (|f_n-f_(n-1)| ~= 0)</strong></p>
</li>
<li>
<p><strong>2 : Converged (|x_n-x_(n-1)| ~= 0)</strong></p>
</li>
<li>
<p><strong>3 : Max. number of function evaluations reached</strong></p>
</li>
<li>
<p><strong>4 : Linear search failed</strong></p>
</li>
<li>
<p><strong>5 : All lower bounds are equal to the upper bounds</strong></p>
</li>
<li>
<p><strong>6 : Unable to progress</strong></p>
</li>
<li>
<p><strong>7 : User requested end of minimization</strong></p>
</li>
</ul>
<h4>References</h4>
<p>Wright S., Nocedal J. (2006), 'Numerical Optimization'</p>
<p>Nash S.G. (1984), 'Newton-Type Minimization Via the Lanczos Method',
SIAM Journal of Numerical Analysis 21, pp. 770-778</p>
</details>
<h3 id="old_bound_to_new_2">old_bound_to_new<a class="headerlink" href="#old_bound_to_new_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function old_bound_to_new</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">old_bound_to_new</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Convert the old bounds representation to the new one.</p>
<p>The new representation is a tuple (lb, ub) and the old one is a list
containing n tuples, ith containing lower and upper bound on a ith
variable.
If any of the entries in lb/ub are None they are replaced by
-np.inf/np.inf.</p>
</details>
<h3 id="zeros_4">zeros<a class="headerlink" href="#zeros_4" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function zeros</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">zeros</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">dtype</span><span class="o">:</span><span class="nn">Np</span><span class="p">.</span><span class="nn">Dtype</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">order</span><span class="o">:[`</span><span class="nc">C</span> <span class="o">|</span> <span class="o">`</span><span class="nc">F</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">shape</span><span class="o">:</span><span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>zeros(shape, dtype=float, order='C')</p>
<p>Return a new array of given shape and type, filled with zeros.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>shape : int or tuple of ints</strong>
    Shape of the new array, e.g., <code>(2, 3)</code> or <code>2</code>.</p>
</li>
<li>
<p><strong>dtype : data-type, optional</strong>
    The desired data-type for the array, e.g., <code>numpy.int8</code>.  Default is
    <code>numpy.float64</code>.</p>
</li>
<li>
<p><strong>order : {'C', 'F'}, optional, default: 'C'</strong>
    Whether to store multi-dimensional data in row-major
    (C-style) or column-major (Fortran-style) order in
    memory.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>out : ndarray</strong>
    Array of zeros with the given shape, dtype, and order.</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>zeros_like : Return an array of zeros with shape and type of input.</strong></p>
</li>
<li>
<p><strong>empty : Return a new uninitialized array.</strong></p>
</li>
<li>
<p><strong>ones : Return a new array setting values to one.</strong></p>
</li>
<li>
<p><strong>full : Return a new array of given shape filled with value.</strong></p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)])</span> <span class="c1"># custom dtype</span>
<span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
</code></pre></div>

</details>
<h2 id="zeros_5">Zeros<a class="headerlink" href="#zeros_5" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Zeros</code> wraps Python module <code>scipy.optimize.zeros</code>.</p>
<h2 id="toms748solver">TOMS748Solver<a class="headerlink" href="#toms748solver" title="Permanent link">&para;</a></h2>
<p>Module <code>Scipy.​Optimize.​Zeros.​TOMS748Solver</code> wraps Python class <code>scipy.optimize.zeros.TOMS748Solver</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span> <span class="n">t</span>
</code></pre></div>

<h3 id="create_30">create<a class="headerlink" href="#create_30" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>constructor and attributes create</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">create</span> <span class="o">:</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="n">t</span>
</code></pre></div>

<p>Solve f(x, *args) == 0 using Algorithm748 of Alefeld, Potro &amp; Shi.</p>
</details>
<h3 id="configure">configure<a class="headerlink" href="#configure" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method configure</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">configure</span> <span class="o">:</span>
  <span class="n">xtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">rtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">maxiter</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">disp</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">k</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="get_result_1">get_result<a class="headerlink" href="#get_result_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_result</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_result</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">flag</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Package the result and statistics into a tuple.</p>
</details>
<h3 id="get_status">get_status<a class="headerlink" href="#get_status" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method get_status</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">get_status</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Determine the current status.</p>
</details>
<h3 id="iterate">iterate<a class="headerlink" href="#iterate" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method iterate</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">iterate</span> <span class="o">:</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Perform one step in the algorithm.</p>
<p>Implements Algorithm 4.1(k=1) or 4.2(k=2) in [APS1995]</p>
</details>
<h3 id="solve_11">solve<a class="headerlink" href="#solve_11" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method solve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">solve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">k</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Solve f(x) = 0 given an interval containing a zero.</p>
</details>
<h3 id="start">start<a class="headerlink" href="#start" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method start</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">start</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[&gt;</span> <span class="n">tag</span><span class="o">]</span> <span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Prepare for the iterations.</p>
</details>
<h3 id="to_string_36">to_string<a class="headerlink" href="#to_string_36" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method to_string</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">to_string</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="show_36">show<a class="headerlink" href="#show_36" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method show</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show</span><span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
</code></pre></div>

<p>Print the object to a human-readable representation.</p>
</details>
<h3 id="pp_36">pp<a class="headerlink" href="#pp_36" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>method pp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">pp</span><span class="o">:</span> <span class="nn">Format</span><span class="p">.</span><span class="n">formatter</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">unit</span>
</code></pre></div>

<p>Pretty-print the object to a formatter.</p>
</details>
<h3 id="bisect">bisect<a class="headerlink" href="#bisect" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function bisect</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">bisect</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find root of a function within an interval using bisection.</p>
<p>Basic bisection routine to find a zero of the function <code>f</code> between the
arguments <code>a</code> and <code>b</code>. <code>f(a)</code> and <code>f(b)</code> cannot have the same signs.
Slow but sure.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number.  <code>f</code> must be continuous, and
    f(a) and f(b) must have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative.</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where x is the root, and r is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in a <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

<h4>See Also</h4>
<p>brentq, brenth, bisect, newton</p>
<ul>
<li>
<p><strong>fixed_point : scalar fixed-point finder</strong></p>
</li>
<li>
<p><strong>fsolve : n-dimensional root-finding</strong></p>
</li>
</ul>
</details>
<h3 id="brenth">brenth<a class="headerlink" href="#brenth" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brenth</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brenth</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a root of a function in a bracketing interval using Brent's
method with hyperbolic extrapolation.</p>
<p>A variation on the classic Brent routine to find a zero of the function f
between the arguments a and b that uses hyperbolic extrapolation instead of
inverse quadratic extrapolation. There was a paper back in the 1980's ...
f(a) and f(b) cannot have the same signs. Generally, on a par with the
brent routine, but not as heavily tested. It is a safe version of the
secant method that uses hyperbolic extrapolation. The version here is by
Chuck Harris.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number. f must be continuous, and f(a) and
    f(b) must have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative. As with <code>brentq</code>, for nice
    functions the method will often satisfy the above condition
    with <code>xtol/2</code> and <code>rtol/2</code>.</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>. As with <code>brentq</code>, for nice functions
    the method will often satisfy the above condition with
    <code>xtol/2</code> and <code>rtol/2</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in any <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brenth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brenth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<h4>See Also</h4>
<p>fmin, fmin_powell, fmin_cg,
       fmin_bfgs, fmin_ncg : multivariate local optimizers</p>
<ul>
<li><strong>leastsq : nonlinear least squares minimizer</strong></li>
</ul>
<p>fmin_l_bfgs_b, fmin_tnc, fmin_cobyla : constrained multivariate optimizers</p>
<p>basinhopping, differential_evolution, brute : global optimizers</p>
<p>fminbound, brent, golden, bracket : local scalar minimizers</p>
<ul>
<li><strong>fsolve : N-D root-finding</strong></li>
</ul>
<p>brentq, brenth, ridder, bisect, newton : 1-D root-finding</p>
<ul>
<li><strong>fixed_point : scalar fixed-point finder</strong></li>
</ul>
</details>
<h3 id="brentq">brentq<a class="headerlink" href="#brentq" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brentq</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brentq</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a root of a function in a bracketing interval using Brent's method.</p>
<p>Uses the classic Brent's method to find a zero of the function <code>f</code> on
the sign changing interval [a , b]. Generally considered the best of the
rootfinding routines here. It is a safe version of the secant method that
uses inverse quadratic extrapolation. Brent's method combines root
bracketing, interval bisection, and inverse quadratic interpolation. It is
sometimes known as the van Wijngaarden-Dekker-Brent method. Brent (1973)
claims convergence is guaranteed for functions computable within [a,b].</p>
<p>[Brent1973]<em> provides the classic description of the algorithm. Another
description can be found in a recent edition of Numerical Recipes, including
[PressEtal1992]</em>. A third description is at</p>
<ul>
<li><strong>http://mathworld.wolfram.com/BrentsMethod.html. It should be easy to</strong>
understand the algorithm just by reading our code. Our code diverges a bit
from standard presentations: we choose a different formula for the
extrapolation step.</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number. The function :math:<code>f</code>
    must be continuous, and :math:<code>f(a)</code> and :math:<code>f(b)</code> must
    have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval :math:<code>[a, b]</code>.</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval :math:<code>[a, b]</code>.</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative. For nice functions, Brent's
    method will often satisfy the above condition with <code>xtol/2</code>
    and <code>rtol/2</code>. [Brent1973]_</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>. For nice functions, Brent's
    method will often satisfy the above condition with <code>xtol/2</code>
    and <code>rtol/2</code>. [Brent1973]_</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in any <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>Notes</h4>
<p><code>f</code> must be continuous.  f(a) and f(b) must have opposite signs.</p>
<p>Related functions fall into several classes:</p>
<p>multivariate local optimizers
  <code>fmin</code>, <code>fmin_powell</code>, <code>fmin_cg</code>, <code>fmin_bfgs</code>, <code>fmin_ncg</code>
nonlinear least squares minimizer
  <code>leastsq</code>
constrained multivariate optimizers
  <code>fmin_l_bfgs_b</code>, <code>fmin_tnc</code>, <code>fmin_cobyla</code>
global optimizers
  <code>basinhopping</code>, <code>brute</code>, <code>differential_evolution</code>
local scalar minimizers
  <code>fminbound</code>, <code>brent</code>, <code>golden</code>, <code>bracket</code>
N-D root-finding
  <code>fsolve</code>
1-D root-finding
  <code>brenth</code>, <code>ridder</code>, <code>bisect</code>, <code>newton</code>
scalar fixed-point finder
  <code>fixed_point</code></p>
<h4>References</h4>
<p>.. [Brent1973]
   Brent, R. P.,
   <em>Algorithms for Minimization Without Derivatives</em>.
   Englewood Cliffs, NJ: Prentice-Hall, 1973. Ch. 3-4.</p>
<p>.. [PressEtal1992]
   Press, W. H.; Flannery, B. P.; Teukolsky, S. A.; and Vetterling, W. T.
   <em>Numerical Recipes in FORTRAN: The Art of Scientific Computing</em>, 2nd ed.
   Cambridge, England: Cambridge University Press, pp. 352-355, 1992.
   Section 9.3:  'Van Wijngaarden-Dekker-Brent Method.'</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

</details>
<h3 id="namedtuple">namedtuple<a class="headerlink" href="#namedtuple" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function namedtuple</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">namedtuple</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">rename</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">defaults</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">module_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">typename</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">field_names</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Returns a new subclass of tuple with named fields.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Point&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point</span><span class="o">.</span><span class="vm">__doc__</span>                   <span class="c1"># docstring for the new class</span>
<span class="s1">&#39;Point(x, y)&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>             <span class="c1"># instantiate with positional args or keywords</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                     <span class="c1"># indexable like a plain tuple</span>
<span class="mi">33</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p</span>                        <span class="c1"># unpack like a regular tuple</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span>                       <span class="c1"># fields also accessible by name</span>
<span class="mi">33</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>                 <span class="c1"># convert to a dictionary</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="mi">11</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point</span><span class="p">(</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>                      <span class="c1"># convert from a dictionary</span>
<span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>               <span class="c1"># _replace() is like str.replace() but targets named fields</span>
<span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="newton">newton<a class="headerlink" href="#newton" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function newton</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">newton</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Sequence</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a zero of a real or complex function using the Newton-Raphson
(or secant or Halley's) method.</p>
<p>Find a zero of the function <code>func</code> given a nearby starting point <code>x0</code>.
The Newton-Raphson method is used if the derivative <code>fprime</code> of <code>func</code>
is provided, otherwise the secant method is used. If the second order
derivative <code>fprime2</code> of <code>func</code> is also provided, then Halley's method is
used.</p>
<p>If <code>x0</code> is a sequence with more than one item, then <code>newton</code> returns an
array, and <code>func</code> must be vectorized and return a sequence or array of the
same shape as its first argument. If <code>fprime</code> or <code>fprime2</code> is given, then
its return must also have the same shape.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The function whose zero is wanted. It must be a function of a
    single variable of the form <code>f(x,a,b,c...)</code>, where <code>a,b,c...</code>
    are extra arguments that can be passed in the <code>args</code> parameter.</p>
</li>
<li>
<p><strong>x0 : float, sequence, or ndarray</strong>
    An initial estimate of the zero that should be somewhere near the
    actual zero. If not scalar, then <code>func</code> must be vectorized and return
    a sequence or array of the same shape as its first argument.</p>
</li>
<li>
<p><strong>fprime : callable, optional</strong>
    The derivative of the function when available and convenient. If it
    is None (default), then the secant method is used.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments to be used in the function call.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    The allowable error of the zero value. If <code>func</code> is complex-valued,
    a larger <code>tol</code> is recommended as both the real and imaginary parts
    of <code>x</code> contribute to <code>|x - x0|</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations.</p>
</li>
<li>
<p><strong>fprime2 : callable, optional</strong>
    The second order derivative of the function when available and
    convenient. If it is None (default), then the normal Newton-Raphson
    or the secant method is used. If it is not None, then Halley's method
    is used.</p>
</li>
<li>
<p><strong>x1 : float, optional</strong>
    Another estimate of the zero that should be somewhere near the
    actual zero. Used if <code>fprime</code> is not provided.</p>
</li>
<li>
<p><strong>rtol : float, optional</strong>
    Tolerance (relative) for termination.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False (default), the root is returned.
    If True and <code>x0</code> is scalar, the return value is <code>(x, r)</code>, where <code>x</code>
    is the root and <code>r</code> is a <code>RootResults</code> object.
    If True and <code>x0</code> is non-scalar, the return value is <code>(x, converged,
    zero_der)</code> (see Returns section for details).</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise a RuntimeError if the algorithm didn't converge, with
    the error message containing the number of iterations and current
    function value. Otherwise, the convergence status is recorded in a
    <code>RootResults</code> return object.
    Ignored if <code>x0</code> is not scalar.</p>
</li>
<li>
<p><em><strong>Note: this has little to do with displaying, however,</strong>
    the <code>disp</code> keyword cannot be renamed for backwards compatibility.</em></p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>root : float, sequence, or ndarray</strong>
    Estimated location where function is zero.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code>, optional</strong>
    Present if <code>full_output=True</code> and <code>x0</code> is scalar.
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
<li>
<p><strong>converged : ndarray of bool, optional</strong>
    Present if <code>full_output=True</code> and <code>x0</code> is non-scalar.
    For vector functions, indicates which elements converged successfully.</p>
</li>
<li>
<p><strong>zero_der : ndarray of bool, optional</strong>
    Present if <code>full_output=True</code> and <code>x0</code> is non-scalar.
    For vector functions, indicates which elements had a zero derivative.</p>
</li>
</ul>
<h4>See Also</h4>
<p>brentq, brenth, ridder, bisect</p>
<ul>
<li><strong>fsolve : find zeros in N dimensions.</strong></li>
</ul>
<h4>Notes</h4>
<p>The convergence rate of the Newton-Raphson method is quadratic,
the Halley method is cubic, and the secant method is
sub-quadratic. This means that if the function is well-behaved
the actual error in the estimated zero after the nth iteration
is approximately the square (cube for Halley) of the error
after the (n-1)th step. However, the stopping criterion used
here is the step size and there is no guarantee that a zero
has been found. Consequently, the result should be verified.
Safer algorithms are brentq, brenth, ridder, and bisect,
but they all require that the root first be bracketed in an
interval where the function changes sign. The brentq algorithm
is recommended for general use in one dimensional problems
when such an interval has been found.</p>
<p>When <code>newton</code> is used with arrays, it is best suited for the following
types of problems:</p>
<ul>
<li>The initial guesses, <code>x0</code>, are all relatively the same distance from
  the roots.</li>
<li>Some or all of the extra arguments, <code>args</code>, are also arrays so that a
  class of similar problems can be solved together.</li>
<li>The size of the initial guesses, <code>x0</code>, is larger than O(100) elements.
  Otherwise, a naive loop may perform as well or better than a vector.</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># only one real root at x = 1</span>
</code></pre></div>

<p><code>fprime</code> is not provided, use the secant method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0000000000000016</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0000000000000016</span>
</code></pre></div>

<p>Only <code>fprime</code> is provided, use the Newton-Raphson method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<p>Both <code>fprime2</code> and <code>fprime</code> are provided, use Halley's method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>                        <span class="n">fprime2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<p>When we want to find zeros for a set of related starting values and/or
function parameters, we can provide both of those as an array of inputs:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fder</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">4321</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vec_res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">fder</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">))</span>
</code></pre></div>

<p>The above is the equivalent of solving for each value in <code>(x, a)</code>
separately in a for-loop, just faster:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">loop_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">fder</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a0</span><span class="p">,))</span>
<span class="o">...</span>             <span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">vec_res</span><span class="p">,</span> <span class="n">loop_res</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<p>Plot the results found for all values of <code>a</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">analytical_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">analytical_result</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">vec_res</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$a$&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x$ where $f(x, a)=0$&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="results_c">results_c<a class="headerlink" href="#results_c" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function results_c</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">results_c</span> <span class="o">:</span>
  <span class="n">full_output</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">r</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

</details>
<h3 id="ridder">ridder<a class="headerlink" href="#ridder" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function ridder</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">ridder</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a root of a function in an interval using Ridder's method.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number. f must be continuous, and f(a) and
    f(b) must have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative.</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in any <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence.
    In particular, <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>See Also</h4>
<p>brentq, brenth, bisect, newton : 1-D root-finding</p>
<ul>
<li><strong>fixed_point : scalar fixed-point finder</strong></li>
</ul>
<h4>Notes</h4>
<p>Uses [Ridders1979]<em> method to find a zero of the function <code>f</code> between the
arguments <code>a</code> and <code>b</code>. Ridders' method is faster than bisection, but not
generally as fast as the Brent routines. [Ridders1979]</em> provides the
classic description and source of the algorithm. A description can also be
found in any recent edition of Numerical Recipes.</p>
<p>The routine used here diverges slightly from standard presentations in
order to be a bit more careful of tolerance.</p>
<h4>References</h4>
<p>.. [Ridders1979]
   Ridders, C. F. J. 'A New Algorithm for Computing a
   Single Root of a Real Continuous Function.'
   IEEE Trans. Circuits Systems 26, 979-980, 1979.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">ridder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">ridder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

</details>
<h3 id="toms748">toms748<a class="headerlink" href="#toms748" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function toms748</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">toms748</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a zero using TOMS Algorithm 748 method.</p>
<p>Implements the Algorithm 748 method of Alefeld, Potro and Shi to find a
zero of the function <code>f</code> on the interval <code>[a , b]</code>, where <code>f(a)</code> and
<code>f(b)</code> must have opposite signs.</p>
<p>It uses a mixture of inverse cubic interpolation and
'Newton-quadratic' steps. [APS1995].</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a scalar. The function :math:<code>f</code>
    must be continuous, and :math:<code>f(a)</code> and :math:<code>f(b)</code>
    have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar,</strong>
    lower boundary of the search interval</p>
</li>
<li>
<p><strong>b : scalar,</strong>
    upper boundary of the search interval</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>f(x, *args)</code>.</p>
</li>
<li>
<p><strong>k : int, optional</strong>
    The number of Newton quadratic steps to perform each
    iteration. <code>k&gt;=1</code>.</p>
</li>
<li>
<p><strong>xtol : scalar, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative.</p>
</li>
<li>
<p><strong>rtol : scalar, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in the <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Approximate Zero of <code>f</code></p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>See Also</h4>
<p>brentq, brenth, ridder, bisect, newton</p>
<ul>
<li><strong>fsolve : find zeroes in N dimensions.</strong></li>
</ul>
<h4>Notes</h4>
<p><code>f</code> must be continuous.
Algorithm 748 with <code>k=2</code> is asymptotically the most efficient
algorithm known for finding roots of a four times continuously
differentiable function.
In contrast with Brent's algorithm, which may only decrease the length of
the enclosing bracket on the last step, Algorithm 748 decreases it each
iteration with the same asymptotic efficiency as it finds the root.</p>
<p>For easy statement of efficiency indices, assume that <code>f</code> has 4
continuouous deriviatives.
For <code>k=1</code>, the convergence order is at least 2.7, and with about
asymptotically 2 function evaluations per iteration, the efficiency
index is approximately 1.65.
For <code>k=2</code>, the order is about 4.6 with asymptotically 3 function
evaluations per iteration, and the efficiency index 1.66.
For higher values of <code>k</code>, the efficiency index approaches
the kth root of <code>(3k-2)</code>, hence <code>k=1</code> or <code>k=2</code> are
usually appropriate.</p>
<h4>References</h4>
<p>.. [APS1995]
   Alefeld, G. E. and Potra, F. A. and Shi, Yixun,
   <em>Algorithm 748: Enclosing Zeros of Continuous Functions</em>,
   ACM Trans. Math. Softw. Volume 221(1995)
   doi = {10.1145/210089.210111}</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># only one real root at x = 1</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">toms748</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">results</span>
</code></pre></div>

<ul>
<li>
<p><strong>converged: True</strong></p>
</li>
<li>
<p><strong>flag: 'converged'</strong></p>
</li>
<li>
<p><strong>function_calls: 11</strong></p>
</li>
<li>
<p><strong>iterations: 5</strong></p>
</li>
<li>
<p><strong>root: 1.0</strong></p>
</li>
</ul>
</details>
<h3 id="anderson_2">anderson<a class="headerlink" href="#anderson_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function anderson</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">anderson</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">w0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using (extended) Anderson mixing.</p>
<p>The Jacobian is formed by for a 'best' solution in the space
spanned by last <code>M</code> vectors. As a result, only a MxM matrix
inversions and MxN multiplications are required. [Ey]_</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is (-1/alpha).</p>
</li>
<li>
<p><strong>M : float, optional</strong>
    Number of previous vectors to retain. Defaults to 5.</p>
</li>
<li>
<p><strong>w0 : float, optional</strong>
    Regularization parameter for numerical stability.
    Compared to unity, good values of the order of 0.01.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='anderson'</code> in particular.</li>
</ul>
<h4>References</h4>
<p>.. [Ey] V. Eyert, J. Comp. Phys., 124, 271 (1996).</p>
</details>
<h3 id="approx_fprime_1">approx_fprime<a class="headerlink" href="#approx_fprime_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function approx_fprime</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">approx_fprime</span> <span class="o">:</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">epsilon</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Finite-difference approximation of the gradient of a scalar function.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>xk : array_like</strong>
    The coordinate vector at which to determine the gradient of <code>f</code>.</p>
</li>
<li>
<p><strong>f : callable</strong>
    The function of which to determine the gradient (partial derivatives).
    Should take <code>xk</code> as first argument, other arguments to <code>f</code> can be
    supplied in <code>*args</code>. Should return a scalar, the value of the
    function at <code>xk</code>.</p>
</li>
<li>
<p><strong>epsilon : array_like</strong>
    Increment to <code>xk</code> to use for determining the function gradient.
    If a scalar, uses the same finite difference delta for all partial
    derivatives. If an array, should contain one value per element of
    <code>xk</code>.
*args : args, optional
    Any other arguments that are to be passed to <code>f</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>grad : ndarray</strong>
    The partial derivatives of <code>f</code> to <code>xk</code>.</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>check_grad : Check correctness of gradient function against approx_fprime.</strong></li>
</ul>
<h4>Notes</h4>
<p>The function gradient is determined by the forward finite difference</p>
<ul>
<li><strong>formula::</strong><div class="codehilite"><pre><span></span><code>     f(xk[i] + epsilon[i]) - f(xk[i])
</code></pre></div>


<p>f'[i] = ---------------------------------
                    epsilon[i]</p>
</li>
</ul>
<p>The main use of <code>approx_fprime</code> is in scalar function optimizers like
<code>fmin_bfgs</code>, to determine numerically the Jacobian of a function.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">):</span>
<span class="o">...</span>     <span class="s1">&#39;Coordinate vector `x` should be an array of size two.&#39;</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">optimize</span><span class="o">.</span><span class="n">approx_fprime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="n">eps</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span>   <span class="mf">2.</span>        <span class="p">,</span>  <span class="mf">400.00004198</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="basinhopping">basinhopping<a class="headerlink" href="#basinhopping" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function basinhopping</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">basinhopping</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">niter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">t</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">stepsize</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">minimizer_kwargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">take_step</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">accept_test</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T_accept_test_f_new_f_new_x_new_x_new_f_old_fold_x_old_x_old_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T_callback_x_f_accept_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">interval</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">niter_success</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">seed</span><span class="o">:[`</span><span class="nc">PyObject</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find the global minimum of a function using the basin-hopping algorithm</p>
<p>Basin-hopping is a two-phase method that combines a global stepping
algorithm with local minimization at each step. Designed to mimic
the natural process of energy minimization of clusters of atoms, it works
well for similar problems with 'funnel-like, but rugged' energy landscapes
[5]_.</p>
<p>As the step-taking, step acceptance, and minimization methods are all
customizable, this function can also be used to implement other two-phase
methods.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>f(x, *args)</code></strong>
    Function to be optimized.  <code>args</code> can be passed as an optional item
    in the dict <code>minimizer_kwargs</code></p>
</li>
<li>
<p><strong>x0 : array_like</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>niter : integer, optional</strong>
    The number of basin-hopping iterations</p>
</li>
<li>
<p><strong>T : float, optional</strong>
    The 'temperature' parameter for the accept or reject criterion. Higher
    'temperatures' mean that larger jumps in function value will be
    accepted.  For best results <code>T</code> should be comparable to the
    separation (in function value) between local minima.</p>
</li>
<li>
<p><strong>stepsize : float, optional</strong>
    Maximum step size for use in the random displacement.</p>
</li>
<li>
<p><strong>minimizer_kwargs : dict, optional</strong>
    Extra keyword arguments to be passed to the local minimizer
    <code>scipy.optimize.minimize()</code> Some important options could be:</p>
</li>
<li>
<p><strong>method : str</strong>
            The minimization method (e.g. <code>'L-BFGS-B'</code>)</p>
</li>
<li>
<p><strong>args : tuple</strong>
            Extra arguments passed to the objective function (<code>func</code>) and
            its derivatives (Jacobian, Hessian).</p>
</li>
<li>
<p><strong>take_step : callable <code>take_step(x)</code>, optional</strong>
    Replace the default step-taking routine with this routine. The default
    step-taking routine is a random displacement of the coordinates, but
    other step-taking algorithms may be better for some systems.
    <code>take_step</code> can optionally have the attribute <code>take_step.stepsize</code>.
    If this attribute exists, then <code>basinhopping</code> will adjust
    <code>take_step.stepsize</code> in order to try to optimize the global minimum
    search.</p>
</li>
<li>
<p><strong>accept_test : callable, <code>accept_test(f_new=f_new, x_new=x_new, f_old=fold, x_old=x_old)</code>, optional</strong>
    Define a test which will be used to judge whether or not to accept the
    step.  This will be used in addition to the Metropolis test based on
    'temperature' <code>T</code>.  The acceptable return values are True,
    False, or <code>'force accept'</code>. If any of the tests return False
    then the step is rejected. If the latter, then this will override any
    other tests in order to accept the step. This can be used, for example,
    to forcefully escape from a local minimum that <code>basinhopping</code> is
    trapped in.</p>
</li>
<li>
<p><strong>callback : callable, <code>callback(x, f, accept)</code>, optional</strong>
    A callback function which will be called for all minima found. <code>x</code>
    and <code>f</code> are the coordinates and function value of the trial minimum,
    and <code>accept</code> is whether or not that minimum was accepted. This can
    be used, for example, to save the lowest N minima found. Also,
    <code>callback</code> can be used to specify a user defined stop criterion by
    optionally returning True to stop the <code>basinhopping</code> routine.</p>
</li>
<li>
<p><strong>interval : integer, optional</strong>
    interval for how often to update the <code>stepsize</code></p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Set to True to print status messages</p>
</li>
<li>
<p><strong>niter_success : integer, optional</strong>
    Stop the run if the global minimum candidate remains the same for this
    number of iterations.</p>
</li>
<li>
<p><strong>seed : {int, <code>~np.random.RandomState</code>, <code>~np.random.Generator</code>}, optional</strong>
    If <code>seed</code> is not specified the <code>~np.random.RandomState</code> singleton is
    used.
    If <code>seed</code> is an int, a new <code>RandomState</code> instance is used, seeded
    with seed.
    If <code>seed</code> is already a <code>RandomState</code> or <code>Generator</code> instance, then
    that object is used.
    Specify <code>seed</code> for repeatable minimizations. The random numbers
    generated with this seed only affect the default Metropolis
    <code>accept_test</code> and the default <code>take_step</code>. If you supply your own
    <code>take_step</code> and <code>accept_test</code>, and these functions use random
    number generation, then those functions are responsible for the state
    of their random number generator.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : OptimizeResult</strong>
    The optimization result represented as a <code>OptimizeResult</code> object.
    Important attributes are: <code>x</code> the solution array, <code>fun</code> the value
    of the function at the solution, and <code>message</code> which describes the
    cause of the termination. The <code>OptimizeResult</code> object returned by the
    selected minimizer at the lowest minimum is also contained within this
    object and can be accessed through the <code>lowest_optimization_result</code>
    attribute.  See <code>OptimizeResult</code> for a description of other attributes.</li>
</ul>
<h4>See Also</h4>
<p>minimize :
    The local minimization function called once for each basinhopping step.
    <code>minimizer_kwargs</code> is passed to this routine.</p>
<h4>Notes</h4>
<p>Basin-hopping is a stochastic algorithm which attempts to find the global
minimum of a smooth scalar function of one or more variables [1]<em> [2]</em> [3]<em>
[4]</em>. The algorithm in its current form was described by David Wales and
Jonathan Doye [2]_ http://www-wales.ch.cam.ac.uk/.</p>
<p>The algorithm is iterative with each cycle composed of the following
features</p>
<p>1) random perturbation of the coordinates</p>
<p>2) local minimization</p>
<p>3) accept or reject the new coordinates based on the minimized function
   value</p>
<p>The acceptance test used here is the Metropolis criterion of standard Monte
Carlo algorithms, although there are many other possibilities [3]_.</p>
<p>This global minimization method has been shown to be extremely efficient
for a wide variety of problems in physics and chemistry. It is
particularly useful when the function has many minima separated by large
barriers. See the Cambridge Cluster Database</p>
<ul>
<li><strong>http://www-wales.ch.cam.ac.uk/CCD.html for databases of molecular systems</strong>
that have been optimized primarily using basin-hopping. This database
includes minimization problems exceeding 300 degrees of freedom.</li>
</ul>
<p>See the free software program GMIN (http://www-wales.ch.cam.ac.uk/GMIN) for
a Fortran implementation of basin-hopping. This implementation has many
different variations of the procedure described above, including more
advanced step taking algorithms and alternate acceptance criterion.</p>
<p>For stochastic global optimization there is no way to determine if the true
global minimum has actually been found. Instead, as a consistency check,
the algorithm can be run from a number of different random starting points
to ensure the lowest minimum found in each example has converged to the
global minimum. For this reason, <code>basinhopping</code> will by default simply
run for the number of iterations <code>niter</code> and return the lowest minimum
found. It is left to the user to ensure that this is in fact the global
minimum.</p>
<p>Choosing <code>stepsize</code>:  This is a crucial parameter in <code>basinhopping</code> and
depends on the problem being solved. The step is chosen uniformly in the
region from x0-stepsize to x0+stepsize, in each dimension. Ideally, it
should be comparable to the typical separation (in argument values) between
local minima of the function being optimized. <code>basinhopping</code> will, by
default, adjust <code>stepsize</code> to find an optimal value, but this may take
many iterations. You will get quicker results if you set a sensible
initial value for <code>stepsize</code>.</p>
<p>Choosing <code>T</code>: The parameter <code>T</code> is the 'temperature' used in the
Metropolis criterion. Basinhopping steps are always accepted if
<code>func(xnew) &lt; func(xold)</code>. Otherwise, they are accepted with</p>
<ul>
<li>
<p><strong>probability::</strong></p>
<p>exp( -(func(xnew) - func(xold)) / T )</p>
</li>
</ul>
<p>So, for best results, <code>T</code> should to be comparable to the typical
difference (in function values) between local minima. (The height of
'walls' between local minima is irrelevant.)</p>
<p>If <code>T</code> is 0, the algorithm becomes Monotonic Basin-Hopping, in which all
steps that increase energy are rejected.</p>
<p>.. versionadded:: 0.12.0</p>
<h4>References</h4>
<p>.. [1] Wales, David J. 2003, Energy Landscapes, Cambridge University Press,
    Cambridge, UK.
.. [2] Wales, D J, and Doye J P K, Global Optimization by Basin-Hopping and
    the Lowest Energy Structures of Lennard-Jones Clusters Containing up to
    110 Atoms.  Journal of Physical Chemistry A, 1997, 101, 5111.
.. [3] Li, Z. and Scheraga, H. A., Monte Carlo-minimization approach to the
    multiple-minima problem in protein folding, Proc. Natl. Acad. Sci. USA,
    1987, 84, 6611.
.. [4] Wales, D. J. and Scheraga, H. A., Global optimization of clusters,
    crystals, and biomolecules, Science, 1999, 285, 1368.
.. [5] Olson, B., Hashmi, I., Molloy, K., and Shehu1, A., Basin Hopping as
    a General and Versatile Optimization Framework for the Characterization
    of Biological Macromolecules, Advances in Artificial Intelligence,
    Volume 2012 (2012), Article ID 674832, :doi:<code>10.1155/2012/674832</code></p>
<h4>Examples</h4>
<p>The following example is a 1-D minimization problem, with many
local minima superimposed on a parabola.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">basinhopping</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">14.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
</code></pre></div>

<p>Basinhopping, internally, uses a local minimization algorithm. We will use
the parameter <code>minimizer_kwargs</code> to tell basinhopping which algorithm to
use and how to set up that minimizer. This parameter will be passed to
<code>scipy.optimize.minimize()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimizer_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;BFGS&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="n">minimizer_kwargs</span><span class="p">,</span>
<span class="o">...</span>                    <span class="n">niter</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global minimum: x = </span><span class="si">%.4f</span><span class="s1">, f(x0) = </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ret</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ret</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span>
<span class="k">global</span> <span class="n">minimum</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1951</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0009</span>
</code></pre></div>

<p>Next consider a 2-D minimization problem. Also, this time, we
will use gradient information to significantly speed up the search.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func2d</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">14.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
<span class="o">...</span>                                                            <span class="mf">0.2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">...</span>     <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">14.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">14.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span>
<span class="o">...</span>     <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">df</span>
</code></pre></div>

<p>We'll also use a different local minimization algorithm. Also, we must tell
the minimizer that our function returns both energy and gradient (Jacobian).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimizer_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">,</span> <span class="s1">&#39;jac&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="n">minimizer_kwargs</span><span class="p">,</span>
<span class="o">...</span>                    <span class="n">niter</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global minimum: x = [</span><span class="si">%.4f</span><span class="s1">, </span><span class="si">%.4f</span><span class="s1">], f(x0) = </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ret</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>                                                           <span class="n">ret</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>                                                           <span class="n">ret</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span>
<span class="k">global</span> <span class="n">minimum</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1951</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1000</span><span class="p">],</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0109</span>
</code></pre></div>

<p>Here is an example using a custom step-taking routine. Imagine you want
the first coordinate to take larger steps than the rest of the coordinates.
This can be implemented like so:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">MyTakeStep</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="o">...</span>        <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">=</span> <span class="n">stepsize</span>
<span class="o">...</span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="o">...</span>        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span>
<span class="o">...</span>        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
<span class="o">...</span>        <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="o">...</span>        <span class="k">return</span> <span class="n">x</span>
</code></pre></div>

<p>Since <code>MyTakeStep.stepsize</code> exists basinhopping will adjust the magnitude
of <code>stepsize</code> to optimize the search. We'll use the same 2-D function as
before</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">mytakestep</span> <span class="o">=</span> <span class="n">MyTakeStep</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="n">minimizer_kwargs</span><span class="p">,</span>
<span class="o">...</span>                    <span class="n">niter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">take_step</span><span class="o">=</span><span class="n">mytakestep</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global minimum: x = [</span><span class="si">%.4f</span><span class="s1">, </span><span class="si">%.4f</span><span class="s1">], f(x0) = </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ret</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>                                                           <span class="n">ret</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>                                                           <span class="n">ret</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span>
<span class="k">global</span> <span class="n">minimum</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1951</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1000</span><span class="p">],</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0109</span>
</code></pre></div>

<p>Now, let's do an example using a custom callback function which prints the
value of every minimum found</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">print_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">accepted</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;at minimum </span><span class="si">%.4f</span><span class="s1"> accepted </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">accepted</span><span class="p">)))</span>
</code></pre></div>

<p>We'll run it for only 10 basinhopping steps this time.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="n">minimizer_kwargs</span><span class="p">,</span>
<span class="o">...</span>                    <span class="n">niter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_fun</span><span class="p">)</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="mf">0.4159</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="o">-</span><span class="mf">0.9073</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="o">-</span><span class="mf">0.1021</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="o">-</span><span class="mf">0.1021</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="mf">0.9102</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="mf">0.9102</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="mf">2.2945</span> <span class="n">accepted</span> <span class="mi">0</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="o">-</span><span class="mf">0.1021</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="o">-</span><span class="mf">1.0109</span> <span class="n">accepted</span> <span class="mi">1</span>
<span class="n">at</span> <span class="n">minimum</span> <span class="o">-</span><span class="mf">1.0109</span> <span class="n">accepted</span> <span class="mi">1</span>
</code></pre></div>

<p>The minimum at -1.0109 is actually the global minimum, found already on the
8th iteration.</p>
<p>Now let's implement bounds on the problem using a custom <code>accept_test</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">MyBounds</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">],</span> <span class="n">xmin</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1</span><span class="p">]</span> <span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;x_new&#39;</span><span class="p">]</span>
<span class="o">...</span>         <span class="n">tmax</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">))</span>
<span class="o">...</span>         <span class="n">tmin</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">))</span>
<span class="o">...</span>         <span class="k">return</span> <span class="n">tmax</span> <span class="ow">and</span> <span class="n">tmin</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">mybounds</span> <span class="o">=</span> <span class="n">MyBounds</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="n">minimizer_kwargs</span><span class="p">,</span>
<span class="o">...</span>                    <span class="n">niter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accept_test</span><span class="o">=</span><span class="n">mybounds</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="bisect_1">bisect<a class="headerlink" href="#bisect_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function bisect</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">bisect</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find root of a function within an interval using bisection.</p>
<p>Basic bisection routine to find a zero of the function <code>f</code> between the
arguments <code>a</code> and <code>b</code>. <code>f(a)</code> and <code>f(b)</code> cannot have the same signs.
Slow but sure.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number.  <code>f</code> must be continuous, and
    f(a) and f(b) must have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative.</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where x is the root, and r is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in a <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

<h4>See Also</h4>
<p>brentq, brenth, bisect, newton</p>
<ul>
<li>
<p><strong>fixed_point : scalar fixed-point finder</strong></p>
</li>
<li>
<p><strong>fsolve : n-dimensional root-finding</strong></p>
</li>
</ul>
</details>
<h3 id="bracket_1">bracket<a class="headerlink" href="#bracket_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function bracket</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">bracket</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">xa</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xb</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">grow_limit</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="kt">int</span>
</code></pre></div>

<p>Bracket the minimum of the function.</p>
<p>Given a function and distinct initial points, search in the
downhill direction (as defined by the initial points) and return
new points xa, xb, xc that bracket the minimum of the function
f(xa) &gt; f(xb) &lt; f(xc). It doesn't always mean that obtained
solution will satisfy xa&lt;=x&lt;=xb.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function to minimize.
xa, xb : float, optional
    Bracketing interval. Defaults <code>xa</code> to 0.0, and <code>xb</code> to 1.0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments (if present), passed to <code>func</code>.</p>
</li>
<li>
<p><strong>grow_limit : float, optional</strong>
    Maximum grow limit.  Defaults to 110.0</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform. Defaults to 1000.</p>
</li>
</ul>
<h4>Returns</h4>
<p>xa, xb, xc : float
    Bracket.
fa, fb, fc : float
    Objective function values in bracket.</p>
<ul>
<li><strong>funcalls : int</strong>
    Number of function evaluations made.</li>
</ul>
<h4>Examples</h4>
<p>This function can find a downward convex region of a function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">bracket</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">init_xa</span><span class="p">,</span> <span class="n">init_xb</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="n">funcalls</span> <span class="o">=</span> <span class="n">bracket</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">xa</span><span class="o">=</span><span class="n">init_xa</span><span class="p">,</span> <span class="n">xb</span><span class="o">=</span><span class="n">init_xb</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">init_xa</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">init_xb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="brent_2">brent<a class="headerlink" href="#brent_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brent</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brent</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">brack</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Given a function of one variable and a possible bracket, return
the local minimum of the function isolated to a fractional precision
of tol.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments (if present).</p>
</li>
<li>
<p><strong>brack : tuple, optional</strong>
    Either a triple (xa,xb,xc) where xa&lt;xb&lt;xc and func(xb) &lt;
    func(xa), func(xc) or a pair (xa,xb) which are used as a
    starting interval for a downhill bracket search (see
    <code>bracket</code>). Providing the pair (xa,xb) does not always mean
    the obtained solution will satisfy xa&lt;=x&lt;=xb.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    Stop if between iteration change is less than <code>tol</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return all output args (xmin, fval, iter,
    funcalls).</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations in solution.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xmin : ndarray</strong>
    Optimum point.</p>
</li>
<li>
<p><strong>fval : float</strong>
    Optimum value.</p>
</li>
<li>
<p><strong>iter : int</strong>
    Number of iterations.</p>
</li>
<li>
<p><strong>funcalls : int</strong>
    Number of objective function evaluations made.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize_scalar: Interface to minimization algorithms for scalar</strong>
    univariate functions. See the 'Brent' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses inverse parabolic interpolation when possible to speed up
convergence of golden section method.</p>
<p>Does not ensure that the minimum lies in the range specified by
<code>brack</code>. See <code>fminbound</code>.</p>
<h4>Examples</h4>
<p>We illustrate the behaviour of the function when <code>brack</code> is of
size 2 and 3 respectively. In the case where <code>brack</code> is of the
form (xa,xb), we can see for the given values, the output need
not necessarily lie in the range (xa,xb).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">0.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="o">-</span><span class="mf">2.7755575615628914e-17</span>
</code></pre></div>

</details>
<h3 id="brenth_1">brenth<a class="headerlink" href="#brenth_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brenth</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brenth</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a root of a function in a bracketing interval using Brent's
method with hyperbolic extrapolation.</p>
<p>A variation on the classic Brent routine to find a zero of the function f
between the arguments a and b that uses hyperbolic extrapolation instead of
inverse quadratic extrapolation. There was a paper back in the 1980's ...
f(a) and f(b) cannot have the same signs. Generally, on a par with the
brent routine, but not as heavily tested. It is a safe version of the
secant method that uses hyperbolic extrapolation. The version here is by
Chuck Harris.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number. f must be continuous, and f(a) and
    f(b) must have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative. As with <code>brentq</code>, for nice
    functions the method will often satisfy the above condition
    with <code>xtol/2</code> and <code>rtol/2</code>.</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>. As with <code>brentq</code>, for nice functions
    the method will often satisfy the above condition with
    <code>xtol/2</code> and <code>rtol/2</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in any <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brenth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brenth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<h4>See Also</h4>
<p>fmin, fmin_powell, fmin_cg,
       fmin_bfgs, fmin_ncg : multivariate local optimizers</p>
<ul>
<li><strong>leastsq : nonlinear least squares minimizer</strong></li>
</ul>
<p>fmin_l_bfgs_b, fmin_tnc, fmin_cobyla : constrained multivariate optimizers</p>
<p>basinhopping, differential_evolution, brute : global optimizers</p>
<p>fminbound, brent, golden, bracket : local scalar minimizers</p>
<ul>
<li><strong>fsolve : N-D root-finding</strong></li>
</ul>
<p>brentq, brenth, ridder, bisect, newton : 1-D root-finding</p>
<ul>
<li><strong>fixed_point : scalar fixed-point finder</strong></li>
</ul>
</details>
<h3 id="brentq_1">brentq<a class="headerlink" href="#brentq_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brentq</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brentq</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a root of a function in a bracketing interval using Brent's method.</p>
<p>Uses the classic Brent's method to find a zero of the function <code>f</code> on
the sign changing interval [a , b]. Generally considered the best of the
rootfinding routines here. It is a safe version of the secant method that
uses inverse quadratic extrapolation. Brent's method combines root
bracketing, interval bisection, and inverse quadratic interpolation. It is
sometimes known as the van Wijngaarden-Dekker-Brent method. Brent (1973)
claims convergence is guaranteed for functions computable within [a,b].</p>
<p>[Brent1973]<em> provides the classic description of the algorithm. Another
description can be found in a recent edition of Numerical Recipes, including
[PressEtal1992]</em>. A third description is at</p>
<ul>
<li><strong>http://mathworld.wolfram.com/BrentsMethod.html. It should be easy to</strong>
understand the algorithm just by reading our code. Our code diverges a bit
from standard presentations: we choose a different formula for the
extrapolation step.</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number. The function :math:<code>f</code>
    must be continuous, and :math:<code>f(a)</code> and :math:<code>f(b)</code> must
    have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval :math:<code>[a, b]</code>.</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval :math:<code>[a, b]</code>.</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative. For nice functions, Brent's
    method will often satisfy the above condition with <code>xtol/2</code>
    and <code>rtol/2</code>. [Brent1973]_</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>. For nice functions, Brent's
    method will often satisfy the above condition with <code>xtol/2</code>
    and <code>rtol/2</code>. [Brent1973]_</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in any <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>Notes</h4>
<p><code>f</code> must be continuous.  f(a) and f(b) must have opposite signs.</p>
<p>Related functions fall into several classes:</p>
<p>multivariate local optimizers
  <code>fmin</code>, <code>fmin_powell</code>, <code>fmin_cg</code>, <code>fmin_bfgs</code>, <code>fmin_ncg</code>
nonlinear least squares minimizer
  <code>leastsq</code>
constrained multivariate optimizers
  <code>fmin_l_bfgs_b</code>, <code>fmin_tnc</code>, <code>fmin_cobyla</code>
global optimizers
  <code>basinhopping</code>, <code>brute</code>, <code>differential_evolution</code>
local scalar minimizers
  <code>fminbound</code>, <code>brent</code>, <code>golden</code>, <code>bracket</code>
N-D root-finding
  <code>fsolve</code>
1-D root-finding
  <code>brenth</code>, <code>ridder</code>, <code>bisect</code>, <code>newton</code>
scalar fixed-point finder
  <code>fixed_point</code></p>
<h4>References</h4>
<p>.. [Brent1973]
   Brent, R. P.,
   <em>Algorithms for Minimization Without Derivatives</em>.
   Englewood Cliffs, NJ: Prentice-Hall, 1973. Ch. 3-4.</p>
<p>.. [PressEtal1992]
   Press, W. H.; Flannery, B. P.; Teukolsky, S. A.; and Vetterling, W. T.
   <em>Numerical Recipes in FORTRAN: The Art of Scientific Computing</em>, 2nd ed.
   Cambridge, England: Cambridge University Press, pp. 352-355, 1992.
   Section 9.3:  'Van Wijngaarden-Dekker-Brent Method.'</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

</details>
<h3 id="broyden1_1">broyden1<a class="headerlink" href="#broyden1_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function broyden1</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">broyden1</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">reduction_method</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_rank</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Broyden's first Jacobian approximation.</p>
<p>This method is also known as \'Broyden's good method\'.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is <code>(-1/alpha)</code>.</p>
</li>
<li>
<p><strong>reduction_method : str or tuple, optional</strong>
    Method used in ensuring that the rank of the Broyden matrix
    stays low. Can either be a string giving the name of the method,
    or a tuple of the form <code>(method, param1, param2, ...)</code>
    that gives the name of the method and values for additional parameters.</p>
<p>Methods available:</p>
<div class="codehilite"><pre><span></span><code>- ``restart``: drop all matrix columns. Has no extra parameters.
- ``simple``: drop oldest matrix column. Has no extra parameters.
- ``svd``: keep only the most significant SVD components.
  Takes an extra parameter, ``to_retain``, which determines the
  number of SVD components to retain when rank reduction is done.
  Default is ``max_rank - 2``.
</code></pre></div>


</li>
<li>
<p><strong>max_rank : int, optional</strong>
    Maximum rank for the Broyden matrix.
    Default is infinity (i.e., no rank reduction).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='broyden1'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm implements the inverse Jacobian Quasi-Newton update</p>
<p>.. math:: H_+ = H + (dx - H df) dx^\dagger H / ( dx^\dagger H df)</p>
<p>which corresponds to Broyden's first Jacobian update</p>
<p>.. math:: J_+ = J + (df - J dx) dx^\dagger / dx^\dagger dx</p>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   \'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations\'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="broyden2_1">broyden2<a class="headerlink" href="#broyden2_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function broyden2</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">broyden2</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">reduction_method</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_rank</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Broyden's second Jacobian approximation.</p>
<p>This method is also known as 'Broyden's bad method'.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is <code>(-1/alpha)</code>.</p>
</li>
<li>
<p><strong>reduction_method : str or tuple, optional</strong>
    Method used in ensuring that the rank of the Broyden matrix
    stays low. Can either be a string giving the name of the method,
    or a tuple of the form <code>(method, param1, param2, ...)</code>
    that gives the name of the method and values for additional parameters.</p>
<p>Methods available:</p>
<div class="codehilite"><pre><span></span><code>- ``restart``: drop all matrix columns. Has no extra parameters.
- ``simple``: drop oldest matrix column. Has no extra parameters.
- ``svd``: keep only the most significant SVD components.
  Takes an extra parameter, ``to_retain``, which determines the
  number of SVD components to retain when rank reduction is done.
  Default is ``max_rank - 2``.
</code></pre></div>


</li>
<li>
<p><strong>max_rank : int, optional</strong>
    Maximum rank for the Broyden matrix.
    Default is infinity (i.e., no rank reduction).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='broyden2'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm implements the inverse Jacobian Quasi-Newton update</p>
<p>.. math:: H_+ = H + (dx - H df) df^\dagger / ( df^\dagger df)</p>
<p>corresponding to Broyden's second method.</p>
<h4>References</h4>
<p>.. [1] B.A. van der Rotten, PhD thesis,
   'A limited memory Broyden method to solve high-dimensional
   systems of nonlinear equations'. Mathematisch Instituut,
   Universiteit Leiden, The Netherlands (2003).</p>
<ul>
<li><strong>https://web.archive.org/web/20161022015821/http://www.math.leidenuniv.nl/scripties/Rotten.pdf</strong></li>
</ul>
</details>
<h3 id="brute_1">brute<a class="headerlink" href="#brute_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function brute</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">brute</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ns</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">finish</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">workers</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Map_like_callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">ranges</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function over a given range by brute force.</p>
<p>Uses the 'brute force' method, i.e., computes the function's value
at each point of a multidimensional grid of points, to find the global
minimum of the function.</p>
<p>The function is evaluated everywhere in the range with the datatype of the
first call to the function, as enforced by the <code>vectorize</code> NumPy
function. The value and type of the function evaluation returned when
<code>full_output=True</code> are affected in addition by the <code>finish</code> argument
(see Notes).</p>
<p>The brute force approach is inefficient because the number of grid points
increases exponentially - the number of grid points to evaluate is
<code>Ns ** len(x)</code>. Consequently, even with coarse grid spacing, even
moderately sized problems can take a long time to run, and/or run into
memory limitations.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The objective function to be minimized. Must be in the
    form <code>f(x, *args)</code>, where <code>x</code> is the argument in
    the form of a 1-D array and <code>args</code> is a tuple of any
    additional fixed parameters needed to completely specify
    the function.</p>
</li>
<li>
<p><strong>ranges : tuple</strong>
    Each component of the <code>ranges</code> tuple must be either a
    'slice object' or a range tuple of the form <code>(low, high)</code>.
    The program uses these to create the grid of points on which
    the objective function will be computed. See <code>Note 2</code> for
    more detail.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any additional fixed parameters needed to completely specify
    the function.</p>
</li>
<li>
<p><strong>Ns : int, optional</strong>
    Number of grid points along the axes, if not otherwise
    specified. See <code>Note2</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return the evaluation grid and the objective function's
    values on it.</p>
</li>
<li>
<p><strong>finish : callable, optional</strong>
    An optimization function that is called with the result of brute force
    minimization as initial guess. <code>finish</code> should take <code>func</code> and
    the initial guess as positional arguments, and take <code>args</code> as
    keyword arguments. It may additionally take <code>full_output</code>
    and/or <code>disp</code> as keyword arguments. Use None if no 'polishing'
    function is to be used. See Notes for more details.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Set to True to print convergence messages from the <code>finish</code> callable.</p>
</li>
<li>
<p><strong>workers : int or map-like callable, optional</strong>
    If <code>workers</code> is an int the grid is subdivided into <code>workers</code>
    sections and evaluated in parallel (uses
    <code>multiprocessing.Pool &lt;multiprocessing&gt;</code>).
    Supply <code>-1</code> to use all cores available to the Process.
    Alternatively supply a map-like callable, such as
    <code>multiprocessing.Pool.map</code> for evaluating the grid in parallel.
    This evaluation is carried out as <code>workers(func, iterable)</code>.
    Requires that <code>func</code> be pickleable.</p>
<p>.. versionadded:: 1.3.0</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : ndarray</strong>
    A 1-D array containing the coordinates of a point at which the
    objective function had its minimum value. (See <code>Note 1</code> for
    which point is returned.)</p>
</li>
<li>
<p><strong>fval : float</strong>
    Function value at the point <code>x0</code>. (Returned when <code>full_output</code> is
    True.)</p>
</li>
<li>
<p><strong>grid : tuple</strong>
    Representation of the evaluation grid. It has the same
    length as <code>x0</code>. (Returned when <code>full_output</code> is True.)</p>
</li>
<li>
<p><strong>Jout : ndarray</strong>
    Function values at each point of the evaluation
    grid, i.e., <code>Jout = func( *grid)</code>. (Returned
    when <code>full_output</code> is True.)</p>
</li>
</ul>
<h4>See Also</h4>
<p>basinhopping, differential_evolution</p>
<h4>Notes</h4>
<p><em>Note 1</em>: The program finds the gridpoint at which the lowest value
of the objective function occurs. If <code>finish</code> is None, that is the
point returned. When the global minimum occurs within (or not very far
outside) the grid's boundaries, and the grid is fine enough, that
point will be in the neighborhood of the global minimum.</p>
<p>However, users often employ some other optimization program to
'polish' the gridpoint values, i.e., to seek a more precise
(local) minimum near <code>brute's</code> best gridpoint.
The <code>brute</code> function's <code>finish</code> option provides a convenient way to do
that. Any polishing program used must take <code>brute's</code> output as its
initial guess as a positional argument, and take <code>brute's</code> input values
for <code>args</code> as keyword arguments, otherwise an error will be raised.
It may additionally take <code>full_output</code> and/or <code>disp</code> as keyword arguments.</p>
<p><code>brute</code> assumes that the <code>finish</code> function returns either an
<code>OptimizeResult</code> object or a tuple in the form:
<code>(xmin, Jmin, ... , statuscode)</code>, where <code>xmin</code> is the minimizing
value of the argument, <code>Jmin</code> is the minimum value of the objective
function, '...' may be some other returned values (which are not used
by <code>brute</code>), and <code>statuscode</code> is the status code of the <code>finish</code> program.</p>
<p>Note that when <code>finish</code> is not None, the values returned are those
of the <code>finish</code> program, <em>not</em> the gridpoint ones. Consequently,
while <code>brute</code> confines its search to the input grid points,
the <code>finish</code> program's results usually will not coincide with any
gridpoint, and may fall outside the grid's boundary. Thus, if a
minimum only needs to be found over the provided grid points, make
sure to pass in <code>finish=None</code>.</p>
<p><em>Note 2</em>: The grid of points is a <code>numpy.mgrid</code> object.
For <code>brute</code> the <code>ranges</code> and <code>Ns</code> inputs have the following effect.
Each component of the <code>ranges</code> tuple can be either a slice object or a
two-tuple giving a range of values, such as (0, 5). If the component is a
slice object, <code>brute</code> uses it directly. If the component is a two-tuple
range, <code>brute</code> internally converts it to a slice object that interpolates
<code>Ns</code> points from its low-value to its high-value, inclusive.</p>
<h4>Examples</h4>
<p>We illustrate the use of <code>brute</code> to seek the global minimum of a function
of two variables that is given as the sum of a positive-definite
quadratic and two deep 'Gaussian-shaped' craters. Specifically, define
the objective function <code>f</code> as the sum of three other functions,
<code>f = f1 + f2 + f3</code>. We suppose each of these has a signature
<code>(z, *params)</code>, where <code>z = (x, y)</code>,  and <code>params</code> and the functions
are as defined below.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">f1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">f3</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>

<p>Thus, the objective function may have local minima near the minimum
of each of the three functions of which it is composed. To
use <code>fmin</code> to polish its gridpoint result, we may then continue as
follows:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">rranges</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">resbrute</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brute</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rranges</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>                           <span class="n">finish</span><span class="o">=</span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">resbrute</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># global minimum</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.05665192</span><span class="p">,</span>  <span class="mf">1.80834843</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">resbrute</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># function value at global minimum</span>
<span class="o">-</span><span class="mf">3.4085818767</span>
</code></pre></div>

<p>Note that if <code>finish</code> had been set to None, we would have gotten the
gridpoint [-1.0 1.75] where the rounded function value is -2.892.</p>
</details>
<h3 id="check_grad_1">check_grad<a class="headerlink" href="#check_grad_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function check_grad</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">check_grad</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">grad</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="kt">float</span>
</code></pre></div>

<p>Check the correctness of a gradient function by comparing it against a
(forward) finite-difference approximation of the gradient.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>func(x0, *args)</code></strong>
    Function whose derivative is to be checked.</p>
</li>
<li>
<p><strong>grad : callable <code>grad(x0, *args)</code></strong>
    Gradient of <code>func</code>.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Points to check <code>grad</code> against forward difference approximation of grad
    using <code>func</code>.</p>
</li>
<li>
<p><strong>args : *args, optional</strong>
    Extra arguments passed to <code>func</code> and <code>grad</code>.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    Step size used for the finite difference approximation. It defaults to
    <code>sqrt(np.finfo(float).eps)</code>, which is approximately 1.49e-08.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>err : float</strong>
    The square root of the sum of squares (i.e., the 2-norm) of the
    difference between <code>grad(x0, *args)</code> and the finite difference
    approximation of <code>grad</code> using func at the points <code>x0</code>.</li>
</ul>
<h4>See Also</h4>
<p>approx_fprime</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">check_grad</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">check_grad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
<span class="mf">2.9802322387695312e-08</span>
</code></pre></div>

</details>
<h3 id="curve_fit_1">curve_fit<a class="headerlink" href="#curve_fit_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function curve_fit</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">curve_fit</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">p0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">sigma</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">absolute_sigma</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">check_finite</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Trf</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lm</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dogbox</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xdata</span><span class="o">:[`</span><span class="nc">PyObject</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">ydata</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Use non-linear least squares to fit a function, f, to data.</p>
<p>Assumes <code>ydata = f(xdata, *params) + eps</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    The model function, f(x, ...). It must take the independent
    variable as the first argument and the parameters to fit as
    separate remaining arguments.</p>
</li>
<li>
<p><strong>xdata : array_like or object</strong>
    The independent variable where the data is measured.
    Should usually be an M-length sequence or an (k,M)-shaped array for
    functions with k predictors, but can actually be any object.</p>
</li>
<li>
<p><strong>ydata : array_like</strong>
    The dependent data, a length M array - nominally <code>f(xdata, ...)</code>.</p>
</li>
<li>
<p><strong>p0 : array_like, optional</strong>
    Initial guess for the parameters (length N). If None, then the
    initial values will all be 1 (if the number of parameters for the
    function can be determined using introspection, otherwise a
    ValueError is raised).</p>
</li>
<li>
<p><strong>sigma : None or M-length sequence or MxM array, optional</strong>
    Determines the uncertainty in <code>ydata</code>. If we define residuals as
    <code>r = ydata - f(xdata, *popt)</code>, then the interpretation of <code>sigma</code>
    depends on its number of dimensions:</p>
<div class="codehilite"><pre><span></span><code>- A 1-D `sigma` should contain values of standard deviations of
  errors in `ydata`. In this case, the optimized function is
  ``chisq = sum((r / sigma) ** 2)``.

- A 2-D `sigma` should contain the covariance matrix of
  errors in `ydata`. In this case, the optimized function is
  ``chisq = r.T @ inv(sigma) @ r``.

  .. versionadded:: 0.19
</code></pre></div>


<p>None (default) is equivalent of 1-D <code>sigma</code> filled with ones.</p>
</li>
<li>
<p><strong>absolute_sigma : bool, optional</strong>
    If True, <code>sigma</code> is used in an absolute sense and the estimated parameter
    covariance <code>pcov</code> reflects these absolute values.</p>
<p>If False (default), only the relative magnitudes of the <code>sigma</code> values matter.
The returned parameter covariance matrix <code>pcov</code> is based on scaling
<code>sigma</code> by a constant factor. This constant is set by demanding that the
reduced <code>chisq</code> for the optimal parameters <code>popt</code> when using the
<em>scaled</em> <code>sigma</code> equals unity. In other words, <code>sigma</code> is scaled to
match the sample variance of the residuals after the fit. Default is False.
Mathematically,
<code>pcov(absolute_sigma=False) = pcov(absolute_sigma=True) * chisq(popt)/(M-N)</code></p>
</li>
<li>
<p><strong>check_finite : bool, optional</strong>
    If True, check that the input arrays do not contain nans of infs,
    and raise a ValueError if they do. Setting this parameter to
    False may silently produce nonsensical results if the input arrays
    do contain nans. Default is True.</p>
</li>
<li>
<p><strong>bounds : 2-tuple of array_like, optional</strong>
    Lower and upper bounds on parameters. Defaults to no bounds.
    Each element of the tuple must be either an array with the length equal
    to the number of parameters, or a scalar (in which case the bound is
    taken to be the same for all parameters). Use <code>np.inf</code> with an
    appropriate sign to disable bounds on all or some parameters.</p>
<p>.. versionadded:: 0.17</p>
</li>
<li>
<p><strong>method : {'lm', 'trf', 'dogbox'}, optional</strong>
    Method to use for optimization. See <code>least_squares</code> for more details.
    Default is 'lm' for unconstrained problems and 'trf' if <code>bounds</code> are
    provided. The method 'lm' won't work when the number of observations
    is less than the number of variables, use 'trf' or 'dogbox' in this
    case.</p>
<p>.. versionadded:: 0.17</p>
</li>
<li>
<p><strong>jac : callable, string or None, optional</strong>
    Function with signature <code>jac(x, ...)</code> which computes the Jacobian
    matrix of the model function with respect to parameters as a dense
    array_like structure. It will be scaled according to provided <code>sigma</code>.
    If None (default), the Jacobian will be estimated numerically.
    String keywords for 'trf' and 'dogbox' methods can be used to select
    a finite difference scheme, see <code>least_squares</code>.</p>
<p>.. versionadded:: 0.18
kwargs
Keyword arguments passed to <code>leastsq</code> for <code>method='lm'</code> or
<code>least_squares</code> otherwise.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>popt : array</strong>
    Optimal values for the parameters so that the sum of the squared
    residuals of <code>f(xdata, *popt) - ydata</code> is minimized.</p>
</li>
<li>
<p><strong>pcov : 2-D array</strong>
    The estimated covariance of popt. The diagonals provide the variance
    of the parameter estimate. To compute one standard deviation errors
    on the parameters use <code>perr = np.sqrt(np.diag(pcov))</code>.</p>
<p>How the <code>sigma</code> parameter affects the estimated covariance
depends on <code>absolute_sigma</code> argument, as described above.</p>
<p>If the Jacobian matrix at the solution doesn't have a full rank, then
'lm' method returns a matrix filled with <code>np.inf</code>, on the other hand
'trf'  and 'dogbox' methods use Moore-Penrose pseudoinverse to compute
the covariance matrix.</p>
</li>
</ul>
<h4>Raises</h4>
<p>ValueError
    if either <code>ydata</code> or <code>xdata</code> contain NaNs, or if incompatible options
    are used.</p>
<p>RuntimeError
    if the least-squares minimization fails.</p>
<p>OptimizeWarning
    if covariance of the parameters can not be estimated.</p>
<h4>See Also</h4>
<ul>
<li>
<p><strong>least_squares : Minimize the sum of squares of nonlinear functions.</strong></p>
</li>
<li>
<p><strong>scipy.stats.linregress : Calculate a linear least squares regression for</strong>
                         two sets of measurements.</p>
</li>
</ul>
<h4>Notes</h4>
<p>With <code>method='lm'</code>, the algorithm uses the Levenberg-Marquardt algorithm
through <code>leastsq</code>. Note that this algorithm can only deal with
unconstrained problems.</p>
<p>Box constraints can be handled by methods 'trf' and 'dogbox'. Refer to
the docstring of <code>least_squares</code> for more information.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</code></pre></div>

<p>Define the data to be fit with some noise:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1729</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_noise</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y_noise</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Fit for the parameters a, b, c of the function <code>func</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.55423706</span><span class="p">,</span>  <span class="mf">1.35190947</span><span class="p">,</span>  <span class="mf">0.47450618</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
<span class="o">...</span>          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit: a=</span><span class="si">%5.3f</span><span class="s1">, b=</span><span class="si">%5.3f</span><span class="s1">, c=</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">popt</span><span class="p">))</span>
</code></pre></div>

<p>Constrain the optimization to the region of <code>0 &lt;= a &lt;= 3</code>,
<code>0 &lt;= b &lt;= 1</code> and <code>0 &lt;= c &lt;= 0.5</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">popt</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">2.43708906</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.35015434</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span>
<span class="o">...</span>          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit: a=</span><span class="si">%5.3f</span><span class="s1">, b=</span><span class="si">%5.3f</span><span class="s1">, c=</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">popt</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="diagbroyden_2">diagbroyden<a class="headerlink" href="#diagbroyden_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function diagbroyden</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">diagbroyden</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using diagonal Broyden Jacobian approximation.</p>
<p>The Jacobian approximation is derived from previous iterations, by
retaining only the diagonal of Broyden matrices.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial guess for the Jacobian is (-1/alpha).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='diagbroyden'</code> in particular.</li>
</ul>
</details>
<h3 id="differential_evolution">differential_evolution<a class="headerlink" href="#differential_evolution" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function differential_evolution</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">differential_evolution</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">strategy</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">popsize</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">mutation</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Tuple_float_float_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">recombination</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">seed</span><span class="o">:[`</span><span class="nc">PyObject</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T_callback_xk_convergence_val_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">polish</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">init</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">atol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">updating</span><span class="o">:[`</span><span class="nc">Immediate</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Deferred</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">workers</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Map_like_callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">constraints</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Finds the global minimum of a multivariate function.</p>
<p>Differential Evolution is stochastic in nature (does not use gradient
methods) to find the minimum, and can search large areas of candidate
space, but often requires larger numbers of function evaluations than
conventional gradient-based techniques.</p>
<p>The algorithm is due to Storn and Price [1]_.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The objective function to be minimized. Must be in the form
    <code>f(x, *args)</code>, where <code>x</code> is the argument in the form of a 1-D array
    and <code>args</code> is a  tuple of any additional fixed parameters needed to
    completely specify the function.</p>
</li>
<li>
<p><strong>bounds : sequence or <code>Bounds</code>, optional</strong>
    Bounds for variables. There are two ways to specify the bounds:</p>
<ol>
<li>Instance of <code>Bounds</code> class.</li>
<li><code>(min, max)</code> pairs for each element in <code>x</code>, defining the finite
lower and upper bounds for the optimizing argument of <code>func</code>. It is
required to have <code>len(bounds) == len(x)</code>. <code>len(bounds)</code> is used
to determine the number of parameters in <code>x</code>.</li>
</ol>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any additional fixed parameters needed to
    completely specify the objective function.</p>
</li>
<li>
<p><strong>strategy : str, optional</strong>
    The differential evolution strategy to use. Should be one of:</p>
<div class="codehilite"><pre><span></span><code>- &#39;best1bin&#39;
- &#39;best1exp&#39;
- &#39;rand1exp&#39;
- &#39;randtobest1exp&#39;
- &#39;currenttobest1exp&#39;
- &#39;best2exp&#39;
- &#39;rand2exp&#39;
- &#39;randtobest1bin&#39;
- &#39;currenttobest1bin&#39;
- &#39;best2bin&#39;
- &#39;rand2bin&#39;
- &#39;rand1bin&#39;
</code></pre></div>


<p>The default is 'best1bin'.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    The maximum number of generations over which the entire population is
    evolved. The maximum number of function evaluations (with no polishing)</p>
</li>
<li>
<p><strong>is: <code>(maxiter + 1) * popsize * len(x)</code></strong></p>
</li>
<li>
<p><strong>popsize : int, optional</strong>
    A multiplier for setting the total population size. The population has
    <code>popsize * len(x)</code> individuals (unless the initial population is
    supplied via the <code>init</code> keyword).</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    Relative tolerance for convergence, the solving stops when
    <code>np.std(pop) &lt;= atol + tol * np.abs(np.mean(population_energies))</code>,
    where and <code>atol</code> and <code>tol</code> are the absolute and relative tolerance
    respectively.</p>
</li>
<li>
<p><strong>mutation : float or tuple(float, float), optional</strong>
    The mutation constant. In the literature this is also known as
    differential weight, being denoted by F.
    If specified as a float it should be in the range [0, 2].
    If specified as a tuple <code>(min, max)</code> dithering is employed. Dithering
    randomly changes the mutation constant on a generation by generation
    basis. The mutation constant for that generation is taken from
    <code>U[min, max)</code>. Dithering can help speed convergence significantly.
    Increasing the mutation constant increases the search radius, but will
    slow down convergence.</p>
</li>
<li>
<p><strong>recombination : float, optional</strong>
    The recombination constant, should be in the range [0, 1]. In the
    literature this is also known as the crossover probability, being
    denoted by CR. Increasing this value allows a larger number of mutants
    to progress into the next generation, but at the risk of population
    stability.</p>
</li>
<li>
<p><strong>seed : {int, <code>~np.random.RandomState</code>, <code>~np.random.Generator</code>}, optional</strong>
    If <code>seed</code> is not specified the <code>~np.random.RandomState</code> singleton is
    used.
    If <code>seed</code> is an int, a new <code>RandomState</code> instance is used,
    seeded with seed.
    If <code>seed</code> is already a <code>RandomState</code> or a <code>Generator</code> instance,
    then that object is used.
    Specify <code>seed</code> for repeatable minimizations.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Prints the evaluated <code>func</code> at every iteration.</p>
</li>
<li>
<p><strong>callback : callable, <code>callback(xk, convergence=val)</code>, optional</strong>
    A function to follow the progress of the minimization. <code>xk</code> is
    the current value of <code>x0</code>. <code>val</code> represents the fractional
    value of the population convergence.  When <code>val</code> is greater than one
    the function halts. If callback returns <code>True</code>, then the minimization
    is halted (any polishing is still carried out).</p>
</li>
<li>
<p><strong>polish : bool, optional</strong>
    If True (default), then <code>scipy.optimize.minimize</code> with the <code>L-BFGS-B</code>
    method is used to polish the best population member at the end, which
    can improve the minimization slightly. If a constrained problem is
    being studied then the <code>trust-constr</code> method is used instead.</p>
</li>
<li>
<p><strong>init : str or array-like, optional</strong>
    Specify which type of population initialization is performed. Should be
    one of:</p>
<div class="codehilite"><pre><span></span><code>- &#39;latinhypercube&#39;
- &#39;random&#39;
- array specifying the initial population. The array should have
  shape ``(M, len(x))``, where M is the total population size and
  len(x) is the number of parameters.
  `init` is clipped to `bounds` before use.
</code></pre></div>


<p>The default is 'latinhypercube'. Latin Hypercube sampling tries to
maximize coverage of the available parameter space. 'random'
initializes the population randomly - this has the drawback that
clustering can occur, preventing the whole of parameter space being
covered. Use of an array to specify a population subset could be used,
for example, to create a tight bunch of initial guesses in an location
where the solution is known to exist, thereby reducing time for
convergence.</p>
</li>
<li>
<p><strong>atol : float, optional</strong>
    Absolute tolerance for convergence, the solving stops when
    <code>np.std(pop) &lt;= atol + tol * np.abs(np.mean(population_energies))</code>,
    where and <code>atol</code> and <code>tol</code> are the absolute and relative tolerance
    respectively.</p>
</li>
<li>
<p><strong>updating : {'immediate', 'deferred'}, optional</strong>
    If <code>'immediate'</code>, the best solution vector is continuously updated
    within a single generation [4]_. This can lead to faster convergence as
    trial vectors can take advantage of continuous improvements in the best
    solution.
    With <code>'deferred'</code>, the best solution vector is updated once per
    generation. Only <code>'deferred'</code> is compatible with parallelization, and
    the <code>workers</code> keyword can over-ride this option.</p>
<p>.. versionadded:: 1.2.0</p>
</li>
<li>
<p><strong>workers : int or map-like callable, optional</strong>
    If <code>workers</code> is an int the population is subdivided into <code>workers</code>
    sections and evaluated in parallel
    (uses <code>multiprocessing.Pool &lt;multiprocessing&gt;</code>).
    Supply -1 to use all available CPU cores.
    Alternatively supply a map-like callable, such as
    <code>multiprocessing.Pool.map</code> for evaluating the population in parallel.
    This evaluation is carried out as <code>workers(func, iterable)</code>.
    This option will override the <code>updating</code> keyword to
    <code>updating='deferred'</code> if <code>workers != 1</code>.
    Requires that <code>func</code> be pickleable.</p>
<p>.. versionadded:: 1.2.0</p>
</li>
<li>
<p><strong>constraints : {NonLinearConstraint, LinearConstraint, Bounds}</strong>
    Constraints on the solver, over and above those applied by the <code>bounds</code>
    kwd. Uses the approach by Lampinen [5]_.</p>
<p>.. versionadded:: 1.4.0</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : OptimizeResult</strong>
    The optimization result represented as a <code>OptimizeResult</code> object.
    Important attributes are: <code>x</code> the solution array, <code>success</code> a
    Boolean flag indicating if the optimizer exited successfully and
    <code>message</code> which describes the cause of the termination. See
    <code>OptimizeResult</code> for a description of other attributes. If <code>polish</code>
    was employed, and a lower minimum was obtained by the polishing, then
    OptimizeResult also contains the <code>jac</code> attribute.
    If the eventual solution does not satisfy the applied constraints
    <code>success</code> will be <code>False</code>.</li>
</ul>
<h4>Notes</h4>
<p>Differential evolution is a stochastic population based method that is
useful for global optimization problems. At each pass through the population
the algorithm mutates each candidate solution by mixing with other candidate
solutions to create a trial candidate. There are several strategies [2]_ for
creating trial candidates, which suit some problems more than others. The
'best1bin' strategy is a good starting point for many systems. In this
strategy two members of the population are randomly chosen. Their difference
is used to mutate the best member (the 'best' in 'best1bin'), :math:<code>b_0</code>,
so far:</p>
<div>
<div class="MathJax_Preview">
    b' = b_0 + mutation * (population[rand0] - population[rand1])
</div>
<script type="math/tex; mode=display">
    b' = b_0 + mutation * (population[rand0] - population[rand1])
</script>
</div>
<p>A trial vector is then constructed. Starting with a randomly chosen ith
parameter the trial is sequentially filled (in modulo) with parameters from
<code>b'</code> or the original candidate. The choice of whether to use <code>b'</code> or the
original candidate is made with a binomial distribution (the 'bin' in
'best1bin') - a random number in [0, 1) is generated. If this number is
less than the <code>recombination</code> constant then the parameter is loaded from
<code>b'</code>, otherwise it is loaded from the original candidate. The final
parameter is always loaded from <code>b'</code>. Once the trial candidate is built
its fitness is assessed. If the trial is better than the original candidate
then it takes its place. If it is also better than the best overall
candidate it also replaces that.
To improve your chances of finding a global minimum use higher <code>popsize</code>
values, with higher <code>mutation</code> and (dithering), but lower <code>recombination</code>
values. This has the effect of widening the search radius, but slowing
convergence.
By default the best solution vector is updated continuously within a single
iteration (<code>updating='immediate'</code>). This is a modification [4]_ of the
original differential evolution algorithm which can lead to faster
convergence as trial vectors can immediately benefit from improved
solutions. To use the original Storn and Price behaviour, updating the best
solution once per iteration, set <code>updating='deferred'</code>.</p>
<p>.. versionadded:: 0.15.0</p>
<h4>Examples</h4>
<p>Let us consider the problem of minimizing the Rosenbrock function. This
function is implemented in <code>rosen</code> in <code>scipy.optimize</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen</span><span class="p">,</span> <span class="n">differential_evolution</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span> <span class="mf">1.9216496320061384e-19</span><span class="p">)</span>
</code></pre></div>

<p>Now repeat, but with parallelization.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">updating</span><span class="o">=</span><span class="s1">&#39;deferred&#39;</span><span class="p">,</span>
<span class="o">...</span>                                 <span class="n">workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span> <span class="mf">1.9216496320061384e-19</span><span class="p">)</span>
</code></pre></div>

<p>Let's try and do a constrained minimization</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">NonlinearConstraint</span><span class="p">,</span> <span class="n">Bounds</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">constr_f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># the sum of x[0] and x[1] must be less than 1.9</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nlc</span> <span class="o">=</span> <span class="n">NonlinearConstraint</span><span class="p">(</span><span class="n">constr_f</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># specify limits using a `Bounds` object.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">Bounds</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">nlc</span><span class="p">),</span>
<span class="o">...</span>                                 <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">0.96633867</span><span class="p">,</span> <span class="mf">0.93363577</span><span class="p">]),</span> <span class="mf">0.0011361355854792312</span><span class="p">)</span>
</code></pre></div>

<p>Next find the minimum of the Ackley function
(https://en.wikipedia.org/wiki/Test_functions_for_optimization).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">differential_evolution</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">ackley</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">arg1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="o">...</span>     <span class="n">arg2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="o">...</span>     <span class="k">return</span> <span class="o">-</span><span class="mf">20.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arg1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arg2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">20.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span><span class="n">ackley</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]),</span> <span class="mf">4.4408920985006262e-16</span><span class="p">)</span>
</code></pre></div>

<h4>References</h4>
<p>.. [1] Storn, R and Price, K, Differential Evolution - a Simple and
       Efficient Heuristic for Global Optimization over Continuous Spaces,
       Journal of Global Optimization, 1997, 11, 341 - 359.
.. [2] http://www1.icsi.berkeley.edu/~storn/code.html
.. [3] http://en.wikipedia.org/wiki/Differential_evolution
.. [4] Wormington, M., Panaccione, C., Matney, K. M., Bowen, D. K., -
       Characterization of structures from X-ray scattering data using
       genetic algorithms, Phil. Trans. R. Soc. Lond. A, 1999, 357,
       2827-2848
.. [5] Lampinen, J., A constraint handling approach for the differential
       evolution algorithm. Proceedings of the 2002 Congress on
       Evolutionary Computation. CEC'02 (Cat. No. 02TH8600). Vol. 2. IEEE,
       2002.</p>
</details>
<h3 id="dual_annealing">dual_annealing<a class="headerlink" href="#dual_annealing" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function dual_annealing</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">dual_annealing</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">local_search_options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">initial_temp</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">restart_temp_ratio</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">visit</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">accept</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">seed</span><span class="o">:[`</span><span class="nc">PyObject</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">no_local_search</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find the global minimum of a function using Dual Annealing.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The objective function to be minimized. Must be in the form
    <code>f(x, *args)</code>, where <code>x</code> is the argument in the form of a 1-D array
    and <code>args</code> is a  tuple of any additional fixed parameters needed to
    completely specify the function.</p>
</li>
<li>
<p><strong>bounds : sequence, shape (n, 2)</strong>
    Bounds for variables.  <code>(min, max)</code> pairs for each element in <code>x</code>,
    defining bounds for the objective function parameter.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any additional fixed parameters needed to completely specify the
    objective function.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    The maximum number of global search iterations. Default value is 1000.</p>
</li>
<li>
<p><strong>local_search_options : dict, optional</strong>
    Extra keyword arguments to be passed to the local minimizer
    (<code>minimize</code>). Some important options could be:
    <code>method</code> for the minimizer method to use and <code>args</code> for
    objective function additional arguments.</p>
</li>
<li>
<p><strong>initial_temp : float, optional</strong>
    The initial temperature, use higher values to facilitates a wider
    search of the energy landscape, allowing dual_annealing to escape
    local minima that it is trapped in. Default value is 5230. Range is
    (0.01, 5.e4].</p>
</li>
<li>
<p><strong>restart_temp_ratio : float, optional</strong>
    During the annealing process, temperature is decreasing, when it
    reaches <code>initial_temp * restart_temp_ratio</code>, the reannealing process
    is triggered. Default value of the ratio is 2e-5. Range is (0, 1).</p>
</li>
<li>
<p><strong>visit : float, optional</strong>
    Parameter for visiting distribution. Default value is 2.62. Higher
    values give the visiting distribution a heavier tail, this makes
    the algorithm jump to a more distant region. The value range is (0, 3].</p>
</li>
<li>
<p><strong>accept : float, optional</strong>
    Parameter for acceptance distribution. It is used to control the
    probability of acceptance. The lower the acceptance parameter, the
    smaller the probability of acceptance. Default value is -5.0 with
    a range (-1e4, -5].</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Soft limit for the number of objective function calls. If the
    algorithm is in the middle of a local search, this number will be
    exceeded, the algorithm will stop just after the local search is
    done. Default value is 1e7.</p>
</li>
<li>
<p><strong>seed : {int, <code>~numpy.random.RandomState</code>, <code>~numpy.random.Generator</code>}, optional</strong>
    If <code>seed</code> is not specified the <code>~numpy.random.RandomState</code> singleton is
    used.
    If <code>seed</code> is an int, a new <code>RandomState</code> instance is used, seeded
    with <code>seed</code>.
    If <code>seed</code> is already a <code>RandomState</code> or <code>Generator</code> instance, then
    that instance is used.
    Specify <code>seed</code> for repeatable minimizations. The random numbers
    generated with this seed only affect the visiting distribution function
    and new coordinates generation.</p>
</li>
<li>
<p><strong>no_local_search : bool, optional</strong>
    If <code>no_local_search</code> is set to True, a traditional Generalized
    Simulated Annealing will be performed with no local search
    strategy applied.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    A callback function with signature <code>callback(x, f, context)</code>,
    which will be called for all minima found.
    <code>x</code> and <code>f</code> are the coordinates and function value of the
    latest minimum found, and <code>context</code> has value in [0, 1, 2], with the
    following meaning:</p>
<div class="codehilite"><pre><span></span><code>- 0: minimum detected in the annealing process.
- 1: detection occurred in the local search process.
- 2: detection done in the dual annealing process.
</code></pre></div>


<p>If the callback implementation returns True, the algorithm will stop.</p>
</li>
<li>
<p><strong>x0 : ndarray, shape(n,), optional</strong>
    Coordinates of a single N-D starting point.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : OptimizeResult</strong>
    The optimization result represented as a <code>OptimizeResult</code> object.
    Important attributes are: <code>x</code> the solution array, <code>fun</code> the value
    of the function at the solution, and <code>message</code> which describes the
    cause of the termination.
    See <code>OptimizeResult</code> for a description of other attributes.</li>
</ul>
<h4>Notes</h4>
<p>This function implements the Dual Annealing optimization. This stochastic
approach derived from [3]<em> combines the generalization of CSA (Classical
Simulated Annealing) and FSA (Fast Simulated Annealing) [1]</em> [2]<em> coupled
to a strategy for applying a local search on accepted locations [4]</em>.
An alternative implementation of this same algorithm is described in [5]<em>
and benchmarks are presented in [6]</em>. This approach introduces an advanced
method to refine the solution found by the generalized annealing
process. This algorithm uses a distorted Cauchy-Lorentz visiting
distribution, with its shape controlled by the parameter :math:<code>q_{v}</code></p>
<div>
<div class="MathJax_Preview">
    g_{q_{v}}(\Delta x(t)) \propto \frac{ \
    \left[T_{q_{v}}(t) \right]^{-\frac{D}{3-q_{v}}}}{ \
    \left[{1+(q_{v}-1)\frac{(\Delta x(t))^{2}} { \
    \left[T_{q_{v}}(t)\right]^{\frac{2}{3-q_{v}}}}}\right]^{ \
    \frac{1}{q_{v}-1}+\frac{D-1}{2}}}
</div>
<script type="math/tex; mode=display">
    g_{q_{v}}(\Delta x(t)) \propto \frac{ \
    \left[T_{q_{v}}(t) \right]^{-\frac{D}{3-q_{v}}}}{ \
    \left[{1+(q_{v}-1)\frac{(\Delta x(t))^{2}} { \
    \left[T_{q_{v}}(t)\right]^{\frac{2}{3-q_{v}}}}}\right]^{ \
    \frac{1}{q_{v}-1}+\frac{D-1}{2}}}
</script>
</div>
<ul>
<li><strong>Where :math:<code>t</code> is the artificial time. This visiting distribution is used</strong>
to generate a trial jump distance :math:<code>\Delta x(t)</code> of variable
:math:<code>x(t)</code> under artificial temperature :math:<code>T_{q_{v}}(t)</code>.</li>
</ul>
<p>From the starting point, after calling the visiting distribution
function, the acceptance probability is computed as follows:</p>
<div>
<div class="MathJax_Preview">
    p_{q_{a}} = \min{\{1,\left[1-(1-q_{a}) \beta \Delta E \right]^{ \
    \frac{1}{1-q_{a}}}\}}
</div>
<script type="math/tex; mode=display">
    p_{q_{a}} = \min{\{1,\left[1-(1-q_{a}) \beta \Delta E \right]^{ \
    \frac{1}{1-q_{a}}}\}}
</script>
</div>
<ul>
<li><strong>Where :math:<code>q_{a}</code> is a acceptance parameter. For :math:<code>q_{a}&lt;1</code>, zero</strong>
acceptance probability is assigned to the cases where</li>
</ul>
<div>
<div class="MathJax_Preview">
    [1-(1-q_{a}) \beta \Delta E] &lt; 0
</div>
<script type="math/tex; mode=display">
    [1-(1-q_{a}) \beta \Delta E] < 0
</script>
</div>
<p>The artificial temperature :math:<code>T_{q_{v}}(t)</code> is decreased according to</p>
<div>
<div class="MathJax_Preview">
    T_{q_{v}}(t) = T_{q_{v}}(1) \frac{2^{q_{v}-1}-1}{\left( \
    1 + t\right)^{q_{v}-1}-1}
</div>
<script type="math/tex; mode=display">
    T_{q_{v}}(t) = T_{q_{v}}(1) \frac{2^{q_{v}-1}-1}{\left( \
    1 + t\right)^{q_{v}-1}-1}
</script>
</div>
<ul>
<li><strong>Where :math:<code>q_{v}</code> is the visiting parameter.</strong></li>
</ul>
<p>.. versionadded:: 1.2.0</p>
<h4>References</h4>
<p>.. [1] Tsallis C. Possible generalization of Boltzmann-Gibbs
    statistics. Journal of Statistical Physics, 52, 479-487 (1998).
.. [2] Tsallis C, Stariolo DA. Generalized Simulated Annealing.
    Physica A, 233, 395-406 (1996).
.. [3] Xiang Y, Sun DY, Fan W, Gong XG. Generalized Simulated
    Annealing Algorithm and Its Application to the Thomson Model.
    Physics Letters A, 233, 216-220 (1997).
.. [4] Xiang Y, Gong XG. Efficiency of Generalized Simulated
    Annealing. Physical Review E, 62, 4473 (2000).
.. [5] Xiang Y, Gubian S, Suomela B, Hoeng J. Generalized
    Simulated Annealing for Efficient Global Optimization: the GenSA
    Package for R. The R Journal, Volume 5/1 (2013).
.. [6] Mullen, K. Continuous Global Optimization in R. Journal of
    Statistical Software, 60(6), 1 - 45, (2014). DOI:10.18637/jss.v060.i06</p>
<h4>Examples</h4>
<p>The following example is a 10-D problem, with many local minima.
The function involved is called Rastrigin
(https://en.wikipedia.org/wiki/Rastrigin_function)</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">dual_annealing</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lw</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">5.12</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">up</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.12</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">dual_annealing</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lw</span><span class="p">,</span> <span class="n">up</span><span class="p">)),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.26437714e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.91699361e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.86149218e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.97165720e-09</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">6.29151648e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.53145322e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.93616815e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.55623025e-09</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">6.05775280e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.00668935e-09</span><span class="p">])</span> <span class="c1"># may vary</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ret</span><span class="o">.</span><span class="n">fun</span>
<span class="mf">0.000000</span>
</code></pre></div>

</details>
<h3 id="excitingmixing_2">excitingmixing<a class="headerlink" href="#excitingmixing_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function excitingmixing</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">excitingmixing</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alphamax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using a tuned diagonal Jacobian approximation.</p>
<p>The Jacobian matrix is diagonal and is tuned on each iteration.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='excitingmixing'</code> in particular.</li>
</ul>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    Initial Jacobian approximation is (-1/alpha).</p>
</li>
<li>
<p><strong>alphamax : float, optional</strong>
    The entries of the diagonal Jacobian are kept in the range
    <code>[alpha, alphamax]</code>.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
</details>
<h3 id="fixed_point_1">fixed_point<a class="headerlink" href="#fixed_point_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fixed_point</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fixed_point</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Del2</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Iteration</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a fixed point of the function.</p>
<p>Given a function of one or more variables and a starting point, find a
fixed point of the function: i.e., where <code>func(x0) == x0</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : function</strong>
    Function to evaluate.</p>
</li>
<li>
<p><strong>x0 : array_like</strong>
    Fixed point of function.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments to <code>func</code>.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Convergence tolerance, defaults to 1e-08.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations, defaults to 500.</p>
</li>
<li>
<p><strong>method : {'del2', 'iteration'}, optional</strong>
    Method of finding the fixed-point, defaults to 'del2',
    which uses Steffensen's Method with Aitken's <code>Del^2</code>
    convergence acceleration [1]_. The 'iteration' method simply iterates
    the function until convergence is detected, without attempting to
    accelerate the convergence.</p>
</li>
</ul>
<h4>References</h4>
<p>.. [1] Burden, Faires, 'Numerical Analysis', 5th edition, pg. 80</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
<span class="o">...</span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">c2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mf">12.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.4920333</span> <span class="p">,</span>  <span class="mf">1.37228132</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="fmin_1">fmin<a class="headerlink" href="#fmin_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">initial_simplex</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using the downhill simplex algorithm.</p>
<p>This algorithm only uses function values, not derivatives or second
derivatives.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable func(x,*args)</strong>
    The objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to func, i.e., <code>f(x,*args)</code>.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Absolute error in xopt between iterations that is acceptable for
    convergence.</p>
</li>
<li>
<p><strong>ftol : number, optional</strong>
    Absolute error in func(xopt) between iterations that is acceptable for
    convergence.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>maxfun : number, optional</strong>
    Maximum number of function evaluations to make.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    Set to True if fopt and warnflag outputs are desired.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Set to True to print convergence messages.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    Set to True to return list of solutions at each iteration.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as callback(xk), where xk is the
    current parameter vector.</p>
</li>
<li>
<p><strong>initial_simplex : array_like of shape (N + 1, N), optional</strong>
    Initial simplex. If given, overrides <code>x0</code>.
    <code>initial_simplex[j,:]</code> should contain the coordinates of
    the jth vertex of the <code>N+1</code> vertices in the simplex, where
    <code>N</code> is the dimension.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameter that minimizes function.</p>
</li>
<li>
<p><strong>fopt : float</strong>
    Value of function at minimum: <code>fopt = func(xopt)</code>.</p>
</li>
<li>
<p><strong>iter : int</strong>
    Number of iterations performed.</p>
</li>
<li>
<p><strong>funcalls : int</strong>
    Number of function calls made.</p>
</li>
<li>
<p><strong>warnflag : int</strong></p>
</li>
<li>
<p><strong>1 : Maximum number of function evaluations made.</strong></p>
</li>
<li>
<p><strong>2 : Maximum number of iterations reached.</strong></p>
</li>
<li>
<p><strong>allvecs : list</strong>
    Solution at each iteration.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'Nelder-Mead' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses a Nelder-Mead simplex algorithm to find the minimum of function of
one or more variables.</p>
<p>This algorithm has a long history of successful use in applications.
But it will usually be slower than an algorithm that uses first or
second derivative information. In practice, it can have poor
performance in high-dimensional problems and is not robust to
minimizing complicated functions. Additionally, there currently is no
complete theory describing when the algorithm will successfully
converge to the minimum, or how fast it will if it does. Both the ftol and
xtol criteria must be met for convergence.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.000000</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 17</strong>
         Function evaluations: 34
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">-</span><span class="mf">8.8817841970012523e-16</span>
</code></pre></div></li>
</ul>
<h4>References</h4>
<p>.. [1] Nelder, J.A. and Mead, R. (1965), 'A simplex method for function
       minimization', The Computer Journal, 7, pp. 308-313</p>
<p>.. [2] Wright, M.H. (1996), 'Direct Search Methods: Once Scorned, Now
       Respectable', in Numerical Analysis 1995, Proceedings of the
       1995 Dundee Biennial Conference in Numerical Analysis, D.F.
       Griffiths and G.A. Watson (Eds.), Addison Wesley Longman,
       Harlow, UK, pp. 191-208.</p>
</details>
<h3 id="fmin_bfgs_1">fmin_bfgs<a class="headerlink" href="#fmin_bfgs_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_bfgs</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_bfgs</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">norm</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:[`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using the BFGS algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable f(x,*args)</strong>
    Objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>fprime : callable f'(x,*args), optional</strong>
    Gradient of f.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to f and fprime.</p>
</li>
<li>
<p><strong>gtol : float, optional</strong>
    Gradient norm must be less than gtol before successful termination.</p>
</li>
<li>
<p><strong>norm : float, optional</strong>
    Order of norm (Inf is max, -Inf is min)</p>
</li>
<li>
<p><strong>epsilon : int or ndarray, optional</strong>
    If fprime is approximated, use this value for the step size.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function to call after each
    iteration. Called as callback(xk), where xk is the
    current parameter vector.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True,return fopt, func_calls, grad_calls, and warnflag
    in addition to xopt.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Print convergence message if True.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    Return a list of results at each iteration if True.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters which minimize f, i.e., f(xopt) == fopt.</p>
</li>
<li>
<p><strong>fopt : float</strong>
    Minimum value.</p>
</li>
<li>
<p><strong>gopt : ndarray</strong>
    Value of gradient at minimum, f'(xopt), which should be near 0.</p>
</li>
<li>
<p><strong>Bopt : ndarray</strong>
    Value of 1/f''(xopt), i.e., the inverse Hessian matrix.</p>
</li>
<li>
<p><strong>func_calls : int</strong>
    Number of function_calls made.</p>
</li>
<li>
<p><strong>grad_calls : int</strong>
    Number of gradient calls made.</p>
</li>
<li>
<p><strong>warnflag : integer</strong></p>
</li>
<li>
<p><strong>1 : Maximum number of iterations exceeded.</strong></p>
</li>
<li>
<p><strong>2 : Gradient and/or function calls not changing.</strong></p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>allvecs  :  list</strong>
    The value of xopt at each iteration. Only returned if retall is True.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'BFGS' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Optimize the function, f, whose gradient is given by fprime
using the quasi-Newton method of Broyden, Fletcher, Goldfarb,
and Shanno (BFGS)</p>
<h4>References</h4>
<p>Wright, and Nocedal 'Numerical Optimization', 1999, p. 198.</p>
</details>
<h3 id="fmin_cg_1">fmin_cg<a class="headerlink" href="#fmin_cg_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_cg</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_cg</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:[`</span><span class="nc">T_fprime_x_args_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">norm</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T_f_x_args_</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using a nonlinear conjugate gradient algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable, <code>f(x, *args)</code></strong>
    Objective function to be minimized. Here <code>x</code> must be a 1-D array of
    the variables that are to be changed in the search for a minimum, and
    <code>args</code> are the other (fixed) parameters of <code>f</code>.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    A user-supplied initial estimate of <code>xopt</code>, the optimal value of <code>x</code>.
    It must be a 1-D array of values.</p>
</li>
<li>
<p><strong>fprime : callable, <code>fprime(x, *args)</code>, optional</strong>
    A function that returns the gradient of <code>f</code> at <code>x</code>. Here <code>x</code> and <code>args</code>
    are as described above for <code>f</code>. The returned value must be a 1-D array.
    Defaults to None, in which case the gradient is approximated
    numerically (see <code>epsilon</code>, below).</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Parameter values passed to <code>f</code> and <code>fprime</code>. Must be supplied whenever
    additional fixed parameters are needed to completely specify the
    functions <code>f</code> and <code>fprime</code>.</p>
</li>
<li>
<p><strong>gtol : float, optional</strong>
    Stop when the norm of the gradient is less than <code>gtol</code>.</p>
</li>
<li>
<p><strong>norm : float, optional</strong>
    Order to use for the norm of the gradient
    (<code>-np.Inf</code> is min, <code>np.Inf</code> is max).</p>
</li>
<li>
<p><strong>epsilon : float or ndarray, optional</strong>
    Step size(s) to use when <code>fprime</code> is approximated numerically. Can be a
    scalar or a 1-D array. Defaults to <code>sqrt(eps)</code>, with eps the
    floating point machine precision.  Usually <code>sqrt(eps)</code> is about
    1.5e-8.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform. Default is <code>200 * len(x0)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return <code>fopt</code>, <code>func_calls</code>, <code>grad_calls</code>, and <code>warnflag</code> in
    addition to <code>xopt</code>.  See the Returns section below for additional
    information on optional return values.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, return a convergence message, followed by <code>xopt</code>.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    If True, add to the returned values the results of each iteration.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function, called after each iteration.
    Called as <code>callback(xk)</code>, where <code>xk</code> is the current value of <code>x0</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters which minimize f, i.e., <code>f(xopt) == fopt</code>.</p>
</li>
<li>
<p><strong>fopt : float, optional</strong>
    Minimum value found, f(xopt). Only returned if <code>full_output</code> is True.</p>
</li>
<li>
<p><strong>func_calls : int, optional</strong>
    The number of function_calls made. Only returned if <code>full_output</code>
    is True.</p>
</li>
<li>
<p><strong>grad_calls : int, optional</strong>
    The number of gradient calls made. Only returned if <code>full_output</code> is
    True.</p>
</li>
<li>
<p><strong>warnflag : int, optional</strong>
    Integer value with warning status, only returned if <code>full_output</code> is
    True.</p>
</li>
<li>
<p><strong>0 : Success.</strong></p>
</li>
<li>
<p><strong>1 : The maximum number of iterations was exceeded.</strong></p>
</li>
<li>
<p><strong>2 : Gradient and/or function calls were not changing. May indicate</strong>
        that precision was lost, i.e., the routine did not converge.</p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>allvecs : list of ndarray, optional</strong>
    List of arrays, containing the results at each iteration.
    Only returned if <code>retall</code> is True.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>minimize : common interface to all <code>scipy.optimize</code> algorithms for</strong>
           unconstrained and constrained minimization of multivariate
           functions. It provides an alternative way to call
           <code>fmin_cg</code>, by specifying <code>method='CG'</code>.</li>
</ul>
<h4>Notes</h4>
<p>This conjugate gradient algorithm is based on that of Polak and Ribiere
[1]_.</p>
<p>Conjugate gradient methods tend to work better when:</p>
<ol>
<li><code>f</code> has a unique global minimizing point, and no local minima or
   other stationary points,</li>
<li><code>f</code> is, at least locally, reasonably well approximated by a
   quadratic function of the variables,</li>
<li><code>f</code> is continuous and has a continuous gradient,</li>
<li><code>fprime</code> is not too large, e.g., has a norm less than 1000,</li>
<li>The initial guess, <code>x0</code>, is reasonably close to <code>f</code> 's global
   minimizing point, <code>xopt</code>.</li>
</ol>
<h4>References</h4>
<p>.. [1] Wright &amp; Nocedal, 'Numerical Optimization', 1999, pp. 120-122.</p>
<h4>Examples</h4>
<p>Example 1: seek the minimum value of the expression
<code>a*u**2 + b*u*v + c*v**2 + d*u + e*v + f</code> for given values
of the parameters and an initial guess <code>(u, v) = (0, 0)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># parameter values</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">args</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">f</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">gradf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
<span class="o">...</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">args</span>
<span class="o">...</span>     <span class="n">gu</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">d</span>     <span class="c1"># u-component of the gradient</span>
<span class="o">...</span>     <span class="n">gv</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">e</span>     <span class="c1"># v-component of the gradient</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">gu</span><span class="p">,</span> <span class="n">gv</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Initial guess.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin_cg</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">gradf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">1.617021</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 4</strong>
         Function evaluations: 8
         Gradient evaluations: 8
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res1</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.80851064</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25531915</span><span class="p">])</span>
</code></pre></div></li>
</ul>
<p>Example 2: solve the same problem using the <code>minimize</code> function.
(This <code>myopts</code> dictionary shows all of the available options,
although in practice only non-default values would be needed.
The returned value will be a dictionary.)</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;maxiter&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1"># default value.</span>
<span class="o">...</span>         <span class="s1">&#39;disp&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1"># non-default value.</span>
<span class="o">...</span>         <span class="s1">&#39;gtol&#39;</span> <span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>    <span class="c1"># default value.</span>
<span class="o">...</span>         <span class="s1">&#39;norm&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>  <span class="c1"># default value.</span>
<span class="o">...</span>         <span class="s1">&#39;eps&#39;</span> <span class="p">:</span> <span class="mf">1.4901161193847656e-08</span><span class="p">}</span>  <span class="c1"># default value.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">gradf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
<span class="o">...</span>                          <span class="n">method</span><span class="o">=</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
        <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">1.617021</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 4</strong>
        Function evaluations: 8
        Gradient evaluations: 8
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res2</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># minimum found</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.80851064</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25531915</span><span class="p">])</span>
</code></pre></div></li>
</ul>
</details>
<h3 id="fmin_cobyla_1">fmin_cobyla<a class="headerlink" href="#fmin_cobyla_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_cobyla</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_cobyla</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">consargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rhobeg</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rhoend</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:[`</span><span class="nc">One</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Zero</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Three</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Two</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">catol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">cons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimize a function using the Constrained Optimization By Linear
Approximation (COBYLA) method. This method wraps a FORTRAN
implementation of the algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    Function to minimize. In the form func(x, *args).</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>cons : sequence</strong>
    Constraint functions; must all be <code>&gt;=0</code> (a single function
    if only 1 constraint). Each function takes the parameters <code>x</code>
    as its first argument, and it can return either a single number or
    an array or list of numbers.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments to pass to function.</p>
</li>
<li>
<p><strong>consargs : tuple, optional</strong>
    Extra arguments to pass to constraint functions (default of None means
    use same extra arguments as those passed to func).
    Use <code>()</code> for no extra arguments.</p>
</li>
<li>
<p><strong>rhobeg : float, optional</strong>
    Reasonable initial changes to the variables.</p>
</li>
<li>
<p><strong>rhoend : float, optional</strong>
    Final accuracy in the optimization (not precisely guaranteed). This
    is a lower bound on the size of the trust region.</p>
</li>
<li>
<p><strong>disp : {0, 1, 2, 3}, optional</strong>
    Controls the frequency of output; 0 implies no output.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations.</p>
</li>
<li>
<p><strong>catol : float, optional</strong>
    Absolute tolerance for constraint violations.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>x : ndarray</strong>
    The argument that minimises <code>f</code>.</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'COBYLA' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>This algorithm is based on linear approximations to the objective
function and each constraint. We briefly describe the algorithm.</p>
<p>Suppose the function is being minimized over k variables. At the
jth iteration the algorithm has k+1 points v_1, ..., v_(k+1),
an approximate solution x_j, and a radius RHO_j.
(i.e., linear plus a constant) approximations to the objective
function and constraint functions such that their function values
agree with the linear approximation on the k+1 points v_1,.., v_(k+1).
This gives a linear program to solve (where the linear approximations
of the constraint functions are constrained to be non-negative).</p>
<p>However, the linear approximations are likely only good
approximations near the current simplex, so the linear program is
given the further requirement that the solution, which
will become x_(j+1), must be within RHO_j from x_j. RHO_j only
decreases, never increases. The initial RHO_j is rhobeg and the
final RHO_j is rhoend. In this way COBYLA's iterations behave
like a trust region algorithm.</p>
<p>Additionally, the linear program may be inconsistent, or the
approximation may give poor improvement. For details about
how these issues are resolved, as well as how the points v_i are
updated, refer to the source code or the references below.</p>
<h4>References</h4>
<p>Powell M.J.D. (1994), 'A direct search optimization method that models
the objective and constraint functions by linear interpolation.', in
Advances in Optimization and Numerical Analysis, eds. S. Gomez and
J-P Hennart, Kluwer Academic (Dordrecht), pp. 51-67</p>
<p>Powell M.J.D. (1998), 'Direct search algorithms for optimization
calculations', Acta Numerica 7, 287-336</p>
<p>Powell M.J.D. (2007), 'A view of algorithms for optimization without
derivatives', Cambridge University Technical Report DAMTP 2007/NA03</p>
<h4>Examples</h4>
<p>Minimize the objective function f(x,y) = x<em>y subject
to the constraints x</em><em>2 + y</em>*2 &lt; 1 and y &gt; 0::</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; def objective(x):
...     return x[0]*x[1]
...
&gt;&gt;&gt; def constr1(x):
...     return 1 - (x[0]**2 + x[1]**2)
...
&gt;&gt;&gt; def constr2(x):
...     return x[1]
...
&gt;&gt;&gt; from scipy.optimize import fmin_cobyla
&gt;&gt;&gt; fmin_cobyla(objective, [0.0, 0.1], [constr1, constr2], rhoend=1e-7)
array([-0.70710685,  0.70710671])
</code></pre></div>


<p>The exact solution is (-sqrt(2)/2, sqrt(2)/2).</p>
</details>
<h3 id="fmin_l_bfgs_b_1">fmin_l_bfgs_b<a class="headerlink" href="#fmin_l_bfgs_b_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_l_bfgs_b</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_l_bfgs_b</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">approx_grad</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">m</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">factr</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">pgtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iprint</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxls</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function func using the L-BFGS-B algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Function to minimize.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>fprime : callable fprime(x,*args), optional</strong>
    The gradient of <code>func</code>. If None, then <code>func</code> returns the function
    value and the gradient (<code>f, g = func(x, *args)</code>), unless
    <code>approx_grad</code> is True in which case <code>func</code> returns only <code>f</code>.</p>
</li>
<li>
<p><strong>args : sequence, optional</strong>
    Arguments to pass to <code>func</code> and <code>fprime</code>.</p>
</li>
<li>
<p><strong>approx_grad : bool, optional</strong>
    Whether to approximate the gradient numerically (in which case
    <code>func</code> returns only the function value).</p>
</li>
<li>
<p><strong>bounds : list, optional</strong>
    <code>(min, max)</code> pairs for each element in <code>x</code>, defining
    the bounds on that parameter. Use None or +-inf for one of <code>min</code> or
    <code>max</code> when there is no bound in that direction.</p>
</li>
<li>
<p><strong>m : int, optional</strong>
    The maximum number of variable metric corrections
    used to define the limited memory matrix. (The limited memory BFGS
    method does not store the full hessian but uses this many terms in an
    approximation to it.)</p>
</li>
<li>
<p><strong>factr : float, optional</strong>
    The iteration stops when
    <code>(f^k - f^{k+1})/max{ |f^k|,|f^{k+1}|,1} &lt;= factr * eps</code>,
    where <code>eps</code> is the machine precision, which is automatically
    generated by the code. Typical values for <code>factr</code> are: 1e12 for
    low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
    high accuracy. See Notes for relationship to <code>ftol</code>, which is exposed
    (instead of <code>factr</code>) by the <code>scipy.optimize.minimize</code> interface to
    L-BFGS-B.</p>
</li>
<li>
<p><strong>pgtol : float, optional</strong>
    The iteration will stop when
    <code>max{ |proj g_i | i = 1, ..., n} &lt;= pgtol</code>
    where <code>pg_i</code> is the i-th component of the projected gradient.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    Step size used when <code>approx_grad</code> is True, for numerically
    calculating the gradient</p>
</li>
<li>
<p><strong>iprint : int, optional</strong>
    Controls the frequency of output. <code>iprint &lt; 0</code> means no output;
    <code>iprint = 0</code>    print only one line at the last iteration;
    <code>0 &lt; iprint &lt; 99</code> print also f and <code>|proj g|</code> every iprint iterations;
    <code>iprint = 99</code>   print details of every iteration except n-vectors;
    <code>iprint = 100</code>  print also the changes of active set and final x;
    <code>iprint &gt; 100</code>  print details of every iteration including x and g.</p>
</li>
<li>
<p><strong>disp : int, optional</strong>
    If zero, then no output. If a positive number, then this over-rides
    <code>iprint</code> (i.e., <code>iprint</code> gets the value of <code>disp</code>).</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as <code>callback(xk)</code>, where <code>xk</code> is the
    current parameter vector.</p>
</li>
<li>
<p><strong>maxls : int, optional</strong>
    Maximum number of line search steps (per iteration). Default is 20.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    Estimated position of the minimum.</p>
</li>
<li>
<p><strong>f : float</strong>
    Value of <code>func</code> at the minimum.</p>
</li>
<li>
<p><strong>d : dict</strong>
    Information dictionary.</p>
<ul>
<li>
<p>d['warnflag'] is</p>
</li>
<li>
<p>0 if converged,</p>
</li>
<li>1 if too many function evaluations or too many iterations,</li>
<li>
<p>2 if stopped for another reason, given in d['task']</p>
</li>
<li>
<p>d['grad'] is the gradient at the minimum (should be 0 ish)</p>
</li>
<li>d['funcalls'] is the number of function calls made.</li>
<li>d['nit'] is the number of iterations.</li>
</ul>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'L-BFGS-B' <code>method</code> in particular. Note that the
    <code>ftol</code> option is made available via that interface, while <code>factr</code> is
    provided via this interface, where <code>factr</code> is the factor multiplying
    the default machine floating-point precision to arrive at <code>ftol</code>:
    <code>ftol = factr * numpy.finfo(float).eps</code>.</li>
</ul>
<h4>Notes</h4>
<p>License of L-BFGS-B (FORTRAN code):</p>
<p>The version included here (in fortran code) is 3.0
(released April 25, 2011). It was written by Ciyou Zhu, Richard Byrd,
and Jorge Nocedal <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#99;&#101;&#100;&#97;&#108;&#64;&#101;&#99;&#101;&#46;&#110;&#119;&#117;&#46;&#101;&#100;&#117;">&#110;&#111;&#99;&#101;&#100;&#97;&#108;&#64;&#101;&#99;&#101;&#46;&#110;&#119;&#117;&#46;&#101;&#100;&#117;</a>. It carries the following
condition for use:</p>
<p>This software is freely available, but we expect that all publications
describing work using this software, or all commercial products using it,
quote at least one of the references given below. This software is released
under the BSD License.</p>
<h4>References</h4>
<ul>
<li>R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
  Constrained Optimization, (1995), SIAM Journal on Scientific and
  Statistical Computing, 16, 5, pp. 1190-1208.</li>
<li>C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
  FORTRAN routines for large scale bound constrained optimization (1997),
  ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.</li>
<li>J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,
  FORTRAN routines for large scale bound constrained optimization (2011),
  ACM Transactions on Mathematical Software, 38, 1.</li>
</ul>
</details>
<h3 id="fmin_ncg_1">fmin_ncg<a class="headerlink" href="#fmin_ncg_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_ncg</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_ncg</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fhess_p</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fhess</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">avextol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Unconstrained minimization of a function using the Newton-CG method.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable <code>f(x, *args)</code></strong>
    Objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>fprime : callable <code>f'(x, *args)</code></strong>
    Gradient of f.</p>
</li>
<li>
<p><strong>fhess_p : callable <code>fhess_p(x, p, *args)</code>, optional</strong>
    Function which computes the Hessian of f times an
    arbitrary vector, p.</p>
</li>
<li>
<p><strong>fhess : callable <code>fhess(x, *args)</code>, optional</strong>
    Function to compute the Hessian matrix of f.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to f, fprime, fhess_p, and fhess
    (the same set of extra arguments is supplied to all of
    these functions).</p>
</li>
<li>
<p><strong>epsilon : float or ndarray, optional</strong>
    If fhess is approximated, use this value for the step size.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function which is called after
    each iteration. Called as callback(xk), where xk is the
    current parameter vector.</p>
</li>
<li>
<p><strong>avextol : float, optional</strong>
    Convergence is assumed when the average relative error in
    the minimizer falls below this amount.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return the optional outputs.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, print convergence message.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    If True, return a list of results at each iteration.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters which minimize f, i.e., <code>f(xopt) == fopt</code>.</p>
</li>
<li>
<p><strong>fopt : float</strong>
    Value of the function at xopt, i.e., <code>fopt = f(xopt)</code>.</p>
</li>
<li>
<p><strong>fcalls : int</strong>
    Number of function calls made.</p>
</li>
<li>
<p><strong>gcalls : int</strong>
    Number of gradient calls made.</p>
</li>
<li>
<p><strong>hcalls : int</strong>
    Number of Hessian calls made.</p>
</li>
<li>
<p><strong>warnflag : int</strong>
    Warnings generated by the algorithm.</p>
</li>
<li>
<p><strong>1 : Maximum number of iterations exceeded.</strong></p>
</li>
<li>
<p><strong>2 : Line search failure (precision loss).</strong></p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>allvecs : list</strong>
    The result at each iteration, if retall is True (see below).</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'Newton-CG' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Only one of <code>fhess_p</code> or <code>fhess</code> need to be given.  If <code>fhess</code>
is provided, then <code>fhess_p</code> will be ignored. If neither <code>fhess</code>
nor <code>fhess_p</code> is provided, then the hessian product will be
approximated using finite differences on <code>fprime</code>. <code>fhess_p</code>
must compute the hessian times an arbitrary vector. If it is not
given, finite-differences on <code>fprime</code> are used to compute
it.</p>
<p>Newton-CG methods are also called truncated Newton methods. This
function differs from scipy.optimize.fmin_tnc because</p>
<ol>
<li>scipy.optimize.fmin_ncg is written purely in Python using NumPy
    and scipy while scipy.optimize.fmin_tnc calls a C function.</li>
<li>scipy.optimize.fmin_ncg is only for unconstrained minimization
    while scipy.optimize.fmin_tnc is for unconstrained minimization
    or box constrained minimization. (Box constraints give
    lower and upper bounds for each variable separately.)</li>
</ol>
<h4>References</h4>
<p>Wright &amp; Nocedal, 'Numerical Optimization', 1999, p. 140.</p>
</details>
<h3 id="fmin_powell_1">fmin_powell<a class="headerlink" href="#fmin_powell_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_powell</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_powell</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">retall</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">direc</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using modified Powell's method.</p>
<p>This method only uses function values, not derivatives.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function to be minimized.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to func.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Line-search error tolerance.</p>
</li>
<li>
<p><strong>ftol : float, optional</strong>
    Relative error in <code>func(xopt)</code> acceptable for convergence.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations to make.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, <code>fopt</code>, <code>xi</code>, <code>direc</code>, <code>iter</code>, <code>funcalls</code>, and
    <code>warnflag</code> are returned.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, print convergence messages.</p>
</li>
<li>
<p><strong>retall : bool, optional</strong>
    If True, return a list of the solution at each iteration.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    An optional user-supplied function, called after each
    iteration.  Called as <code>callback(xk)</code>, where <code>xk</code> is the
    current parameter vector.</p>
</li>
<li>
<p><strong>direc : ndarray, optional</strong>
    Initial fitting step and parameter order set as an (N, N) array, where N
    is the number of fitting parameters in <code>x0</code>. Defaults to step size 1.0
    fitting all parameters simultaneously (<code>np.ones((N, N))</code>). To
    prevent initial consideration of values in a step or to change initial
    step size, set to 0 or desired step size in the Jth position in the Mth
    block, where J is the position in <code>x0</code> and M is the desired evaluation
    step, with steps being evaluated in index order. Step size and ordering
    will change freely as minimization proceeds.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameter which minimizes <code>func</code>.</p>
</li>
<li>
<p><strong>fopt : number</strong>
    Value of function at minimum: <code>fopt = func(xopt)</code>.</p>
</li>
<li>
<p><strong>direc : ndarray</strong>
    Current direction set.</p>
</li>
<li>
<p><strong>iter : int</strong>
    Number of iterations.</p>
</li>
<li>
<p><strong>funcalls : int</strong>
    Number of function calls made.</p>
</li>
<li>
<p><strong>warnflag : int</strong>
    Integer warning flag:</p>
</li>
<li>
<p><strong>1 : Maximum number of function evaluations.</strong></p>
</li>
<li>
<p><strong>2 : Maximum number of iterations.</strong></p>
</li>
<li>
<p><strong>3 : NaN result encountered.</strong></p>
</li>
<li>
<p><strong>4 : The result is out of the provided bounds.</strong></p>
</li>
<li>
<p><strong>allvecs : list</strong>
    List of solutions at each iteration.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to unconstrained minimization algorithms for</strong>
    multivariate functions. See the 'Powell' method in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses a modification of Powell's method to find the minimum of
a function of N variables. Powell's method is a conjugate
direction method.</p>
<p>The algorithm has two loops. The outer loop merely iterates over the inner
loop. The inner loop minimizes over each current direction in the direction
set. At the end of the inner loop, if certain conditions are met, the
direction that gave the largest decrease is dropped and replaced with the
difference between the current estimated x and the estimated x from the
beginning of the inner-loop.</p>
<p>The technical conditions for replacing the direction of greatest
increase amount to checking that</p>
<ol>
<li>No further gain can be made along the direction of greatest increase
   from that iteration.</li>
<li>The direction of greatest increase accounted for a large sufficient
   fraction of the decrease in the function value from that iteration of
   the inner loop.</li>
</ol>
<h4>References</h4>
<p>Powell M.J.D. (1964) An efficient method for finding the minimum of a
function of several variables without calculating derivatives,
Computer Journal, 7 (2):155-162.</p>
<p>Press W., Teukolsky S.A., Vetterling W.T., and Flannery B.P.:
Numerical Recipes (any edition), Cambridge University Press</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fmin_powell</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.000000</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 2</strong>
         Function evaluations: 18
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div></li>
</ul>
</details>
<h3 id="fmin_slsqp_1">fmin_slsqp<a class="headerlink" href="#fmin_slsqp_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_slsqp</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_slsqp</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">eqcons</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_eqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ieqcons</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_ieqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime_eqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime_ieqcons</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">acc</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iprint</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function using Sequential Least Squares Programming</p>
<p>Python interface function for the SLSQP Optimization subroutine
originally implemented by Dieter Kraft.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function.  Must return a scalar.</p>
</li>
<li>
<p><strong>x0 : 1-D ndarray of float</strong>
    Initial guess for the independent variable(s).</p>
</li>
<li>
<p><strong>eqcons : list, optional</strong>
    A list of functions of length n such that
    eqcons<a href="x,*args">j</a> == 0.0 in a successfully optimized
    problem.</p>
</li>
<li>
<p><strong>f_eqcons : callable f(x,*args), optional</strong>
    Returns a 1-D array in which each element must equal 0.0 in a
    successfully optimized problem. If f_eqcons is specified,
    eqcons is ignored.</p>
</li>
<li>
<p><strong>ieqcons : list, optional</strong>
    A list of functions of length n such that
    ieqcons<a href="x,*args">j</a> &gt;= 0.0 in a successfully optimized
    problem.</p>
</li>
<li>
<p><strong>f_ieqcons : callable f(x,*args), optional</strong>
    Returns a 1-D ndarray in which each element must be greater or
    equal to 0.0 in a successfully optimized problem. If
    f_ieqcons is specified, ieqcons is ignored.</p>
</li>
<li>
<p><strong>bounds : list, optional</strong>
    A list of tuples specifying the lower and upper bound
    for each independent variable [(xl0, xu0),(xl1, xu1),...]
    Infinite values will be interpreted as large floating values.</p>
</li>
<li>
<p><strong>fprime : callable <code>f(x,*args)</code>, optional</strong>
    A function that evaluates the partial derivatives of func.</p>
</li>
<li>
<p><strong>fprime_eqcons : callable <code>f(x,*args)</code>, optional</strong>
    A function of the form <code>f(x, *args)</code> that returns the m by n
    array of equality constraint normals. If not provided,
    the normals will be approximated. The array returned by
    fprime_eqcons should be sized as ( len(eqcons), len(x0) ).</p>
</li>
<li>
<p><strong>fprime_ieqcons : callable <code>f(x,*args)</code>, optional</strong>
    A function of the form <code>f(x, *args)</code> that returns the m by n
    array of inequality constraint normals. If not provided,
    the normals will be approximated. The array returned by
    fprime_ieqcons should be sized as ( len(ieqcons), len(x0) ).</p>
</li>
<li>
<p><strong>args : sequence, optional</strong>
    Additional arguments passed to func and fprime.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    The maximum number of iterations.</p>
</li>
<li>
<p><strong>acc : float, optional</strong>
    Requested accuracy.</p>
</li>
<li>
<p><strong>iprint : int, optional</strong>
    The verbosity of fmin_slsqp :</p>
<ul>
<li>iprint &lt;= 0 : Silent operation</li>
<li>iprint == 1 : Print summary upon completion (default)</li>
<li>iprint &gt;= 2 : Print status of each iterate and summary</li>
</ul>
</li>
<li>
<p><strong>disp : int, optional</strong>
    Overrides the iprint interface (preferred).</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If False, return only the minimizer of func (default).
    Otherwise, output final objective function and summary
    information.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    The step size for finite-difference derivative estimates.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as <code>callback(x)</code>, where <code>x</code> is the
    current parameter vector.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>out : ndarray of float</strong>
    The final minimizer of func.</p>
</li>
<li>
<p><strong>fx : ndarray of float, if full_output is true</strong>
    The final value of the objective function.</p>
</li>
<li>
<p><strong>its : int, if full_output is true</strong>
    The number of iterations.</p>
</li>
<li>
<p><strong>imode : int, if full_output is true</strong>
    The exit mode from the optimizer (see below).</p>
</li>
<li>
<p><strong>smode : string, if full_output is true</strong>
    Message describing the exit mode from the optimizer.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'SLSQP' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Exit modes are defined as follows ::</p>
<div class="codehilite"><pre><span></span><code>-1 : Gradient evaluation required (g &amp; a)
</code></pre></div>


<ul>
<li>
<p><strong>0 : Optimization terminated successfully</strong></p>
</li>
<li>
<p><strong>1 : Function evaluation required (f &amp; c)</strong></p>
</li>
<li>
<p><strong>2 : More equality constraints than independent variables</strong></p>
</li>
<li>
<p><strong>3 : More than 3*n iterations in LSQ subproblem</strong></p>
</li>
<li>
<p><strong>4 : Inequality constraints incompatible</strong></p>
</li>
<li>
<p><strong>5 : Singular matrix E in LSQ subproblem</strong></p>
</li>
<li>
<p><strong>6 : Singular matrix C in LSQ subproblem</strong></p>
</li>
<li>
<p><strong>7 : Rank-deficient equality constraint subproblem HFTI</strong></p>
</li>
<li>
<p><strong>8 : Positive directional derivative for linesearch</strong></p>
</li>
<li>
<p><strong>9 : Iteration limit reached</strong></p>
</li>
</ul>
<h4>Examples</h4>
<p>Examples are given :ref:<code>in the tutorial &lt;tutorial-sqlsp&gt;</code>.</p>
</details>
<h3 id="fmin_tnc_1">fmin_tnc<a class="headerlink" href="#fmin_tnc_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fmin_tnc</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fmin_tnc</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">approx_grad</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsilon</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">scale</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">offset</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">messages</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxCGit</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">eta</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">stepmx</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">accuracy</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fmin</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">pgtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rescale</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Minimize a function with variables subject to bounds, using
gradient information in a truncated Newton algorithm. This
method wraps a C implementation of the algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>func(x, *args)</code></strong>
    Function to minimize.  Must do one of:</p>
<ol>
<li>
<p>Return f and g, where f is the value of the function and g its
   gradient (a list of floats).</p>
</li>
<li>
<p>Return the function value but supply gradient function
   separately as <code>fprime</code>.</p>
</li>
<li>
<p>Return the function value and set <code>approx_grad=True</code>.</p>
</li>
</ol>
<p>If the function returns None, the minimization
is aborted.</p>
</li>
<li>
<p><strong>x0 : array_like</strong>
    Initial estimate of minimum.</p>
</li>
<li>
<p><strong>fprime : callable <code>fprime(x, *args)</code>, optional</strong>
    Gradient of <code>func</code>. If None, then either <code>func</code> must return the
    function value and the gradient (<code>f,g = func(x, *args)</code>)
    or <code>approx_grad</code> must be True.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Arguments to pass to function.</p>
</li>
<li>
<p><strong>approx_grad : bool, optional</strong>
    If true, approximate the gradient numerically.</p>
</li>
<li>
<p><strong>bounds : list, optional</strong>
    (min, max) pairs for each element in x0, defining the
    bounds on that parameter. Use None or +/-inf for one of
    min or max when there is no bound in that direction.</p>
</li>
<li>
<p><strong>epsilon : float, optional</strong>
    Used if approx_grad is True. The stepsize in a finite
    difference approximation for fprime.</p>
</li>
<li>
<p><strong>scale : array_like, optional</strong>
    Scaling factors to apply to each variable. If None, the
    factors are up-low for interval bounded variables and
    1+|x| for the others. Defaults to None.</p>
</li>
<li>
<p><strong>offset : array_like, optional</strong>
    Value to subtract from each variable. If None, the
    offsets are (up+low)/2 for interval bounded variables
    and x for the others.</p>
</li>
<li>
<p><strong>messages : int, optional</strong>
    Bit mask used to select messages display during
    minimization values defined in the MSGS dict. Defaults to
    MGS_ALL.</p>
</li>
<li>
<p><strong>disp : int, optional</strong>
    Integer interface to messages. 0 = no message, 5 = all messages</p>
</li>
<li>
<p><strong>maxCGit : int, optional</strong>
    Maximum number of hessian*vector evaluations per main
    iteration. If maxCGit == 0, the direction chosen is
    -gradient if maxCGit &lt; 0, maxCGit is set to
    max(1,min(50,n/2)). Defaults to -1.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluation. If None, maxfun is
    set to max(100, 10*len(x0)). Defaults to None.</p>
</li>
<li>
<p><strong>eta : float, optional</strong>
    Severity of the line search. If &lt; 0 or &gt; 1, set to 0.25.
    Defaults to -1.</p>
</li>
<li>
<p><strong>stepmx : float, optional</strong>
    Maximum step for the line search. May be increased during
    call. If too small, it will be set to 10.0. Defaults to 0.</p>
</li>
<li>
<p><strong>accuracy : float, optional</strong>
    Relative precision for finite difference calculations. If
    &lt;= machine_precision, set to sqrt(machine_precision).
    Defaults to 0.</p>
</li>
<li>
<p><strong>fmin : float, optional</strong>
    Minimum function value estimate. Defaults to 0.</p>
</li>
<li>
<p><strong>ftol : float, optional</strong>
    Precision goal for the value of f in the stopping criterion.
    If ftol &lt; 0.0, ftol is set to 0.0 defaults to -1.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Precision goal for the value of x in the stopping
    criterion (after applying x scaling factors). If xtol &lt;
    0.0, xtol is set to sqrt(machine_precision). Defaults to
    -1.</p>
</li>
<li>
<p><strong>pgtol : float, optional</strong>
    Precision goal for the value of the projected gradient in
    the stopping criterion (after applying x scaling factors).
    If pgtol &lt; 0.0, pgtol is set to 1e-2 * sqrt(accuracy).
    Setting it to 0.0 is not recommended. Defaults to -1.</p>
</li>
<li>
<p><strong>rescale : float, optional</strong>
    Scaling factor (in log10) used to trigger f value
    rescaling. If 0, rescale at each iteration. If a large
    value, never rescale. If &lt; 0, rescale is set to 1.3.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as callback(xk), where xk is the
    current parameter vector.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    The solution.</p>
</li>
<li>
<p><strong>nfeval : int</strong>
    The number of function evaluations.</p>
</li>
<li>
<p><strong>rc : int</strong>
    Return code, see below</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize: Interface to minimization algorithms for multivariate</strong>
    functions. See the 'TNC' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>The underlying algorithm is truncated Newton, also called
Newton Conjugate-Gradient. This method differs from
scipy.optimize.fmin_ncg in that</p>
<ol>
<li>it wraps a C implementation of the algorithm</li>
<li>it allows each variable to be given an upper and lower bound.</li>
</ol>
<p>The algorithm incorporates the bound constraints by determining
the descent direction as in an unconstrained truncated Newton,
but never taking a step-size large enough to leave the space
of feasible x's. The algorithm keeps track of a set of
currently active constraints, and ignores them when computing
the minimum allowable step size. (The x's associated with the
active constraint are kept fixed.) If the maximum allowable
step size is zero then a new constraint is added. At the end
of each iteration one of the constraints may be deemed no
longer active and removed. A constraint is considered
no longer active is if it is currently active
but the gradient for that variable points inward from the
constraint. The specific constraint removed is the one
associated with the variable of largest index whose
constraint is no longer active.</p>
<p>Return codes are defined as follows::</p>
<div class="codehilite"><pre><span></span><code>-1 : Infeasible (lower bound &gt; upper bound)
</code></pre></div>


<ul>
<li>
<p><strong>0 : Local minimum reached (|pg| ~= 0)</strong></p>
</li>
<li>
<p><strong>1 : Converged (|f_n-f_(n-1)| ~= 0)</strong></p>
</li>
<li>
<p><strong>2 : Converged (|x_n-x_(n-1)| ~= 0)</strong></p>
</li>
<li>
<p><strong>3 : Max. number of function evaluations reached</strong></p>
</li>
<li>
<p><strong>4 : Linear search failed</strong></p>
</li>
<li>
<p><strong>5 : All lower bounds are equal to the upper bounds</strong></p>
</li>
<li>
<p><strong>6 : Unable to progress</strong></p>
</li>
<li>
<p><strong>7 : User requested end of minimization</strong></p>
</li>
</ul>
<h4>References</h4>
<p>Wright S., Nocedal J. (2006), 'Numerical Optimization'</p>
<p>Nash S.G. (1984), 'Newton-Type Minimization Via the Lanczos Method',
SIAM Journal of Numerical Analysis 21, pp. 770-778</p>
</details>
<h3 id="fminbound_1">fminbound<a class="headerlink" href="#fminbound_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fminbound</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fminbound</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfun</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x1</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Bounded minimization for scalar functions.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable f(x,*args)</strong>
    Objective function to be minimized (must accept and return scalars).
x1, x2 : float or array scalar
    The optimization bounds.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to function.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    The convergence tolerance.</p>
</li>
<li>
<p><strong>maxfun : int, optional</strong>
    Maximum number of function evaluations allowed.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return optional outputs.</p>
</li>
<li>
<p><strong>disp : int, optional</strong>
    If non-zero, print messages.</p>
</li>
<li>
<p><strong>0 : no message printing.</strong></p>
</li>
<li>
<p><strong>1 : non-convergence notification messages only.</strong></p>
</li>
<li>
<p><strong>2 : print a message on convergence too.</strong></p>
</li>
<li>
<p><strong>3 : print iteration results.</strong></p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>xopt : ndarray</strong>
    Parameters (over given interval) which minimize the
    objective function.</p>
</li>
<li>
<p><strong>fval : number</strong>
    The function value at the minimum point.</p>
</li>
<li>
<p><strong>ierr : int</strong>
    An error flag (0 if converged, 1 if maximum number of
    function calls reached).</p>
</li>
<li>
<p><strong>numfunc : int</strong>
  The number of function calls made.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize_scalar: Interface to minimization algorithms for scalar</strong>
    univariate functions. See the 'Bounded' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Finds a local minimizer of the scalar function <code>func</code> in the
interval x1 &lt; xopt &lt; x2 using Brent's method. (See <code>brent</code>
for auto-bracketing.)</p>
<h4>Examples</h4>
<p><code>fminbound</code> finds the minimum of the function in the given range.
The following examples illustrate the same</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">0.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">1.0000059608609866</span>
</code></pre></div>

</details>
<h3 id="fsolve_1">fsolve<a class="headerlink" href="#fsolve_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function fsolve</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">fsolve</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">col_deriv</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfev</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">band</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsfcn</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">factor</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">diag</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span><span class="o">)</span>
</code></pre></div>

<p>Find the roots of a function.</p>
<p>Return the roots of the (non-linear) equations defined by
<code>func(x) = 0</code> given a starting estimate.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable <code>f(x, *args)</code></strong>
    A function that takes at least one (possibly vector) argument,
    and returns a value of the same length.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    The starting estimate for the roots of <code>func(x) = 0</code>.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any extra arguments to <code>func</code>.</p>
</li>
<li>
<p><strong>fprime : callable <code>f(x, *args)</code>, optional</strong>
    A function to compute the Jacobian of <code>func</code> with derivatives
    across the rows. By default, the Jacobian will be estimated.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return optional outputs.</p>
</li>
<li>
<p><strong>col_deriv : bool, optional</strong>
    Specify whether the Jacobian function computes derivatives down
    the columns (faster, because there is no transpose operation).</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    The calculation will terminate if the relative error between two
    consecutive iterates is at most <code>xtol</code>.</p>
</li>
<li>
<p><strong>maxfev : int, optional</strong>
    The maximum number of calls to the function. If zero, then
    <code>100*(N+1)</code> is the maximum where N is the number of elements
    in <code>x0</code>.</p>
</li>
<li>
<p><strong>band : tuple, optional</strong>
    If set to a two-sequence containing the number of sub- and
    super-diagonals within the band of the Jacobi matrix, the
    Jacobi matrix is considered banded (only for <code>fprime=None</code>).</p>
</li>
<li>
<p><strong>epsfcn : float, optional</strong>
    A suitable step length for the forward-difference
    approximation of the Jacobian (for <code>fprime=None</code>). If
    <code>epsfcn</code> is less than the machine precision, it is assumed
    that the relative errors in the functions are of the order of
    the machine precision.</p>
</li>
<li>
<p><strong>factor : float, optional</strong>
    A parameter determining the initial step bound
    (<code>factor * || diag * x||</code>). Should be in the interval
    <code>(0.1, 100)</code>.</p>
</li>
<li>
<p><strong>diag : sequence, optional</strong>
    N positive entries that serve as a scale factors for the
    variables.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    The solution (or the result of the last iteration for
    an unsuccessful call).</p>
</li>
<li>
<p><strong>infodict : dict</strong>
    A dictionary of optional outputs with the keys:</p>
<p><code>nfev</code>
    number of function calls
<code>njev</code>
    number of Jacobian calls
<code>fvec</code>
    function evaluated at the output
<code>fjac</code>
    the orthogonal matrix, q, produced by the QR
    factorization of the final approximate Jacobian
    matrix, stored column wise
<code>r</code>
    upper triangular matrix produced by QR factorization
    of the same matrix
<code>qtf</code>
    the vector <code>(transpose(q) * fvec)</code></p>
</li>
<li>
<p><strong>ier : int</strong>
    An integer flag.  Set to 1 if a solution was found, otherwise refer
    to <code>mesg</code> for more information.</p>
</li>
<li>
<p><strong>mesg : str</strong>
    If no solution is found, <code>mesg</code> details the cause of failure.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See the <code>method=='hybr'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p><code>fsolve</code> is a wrapper around MINPACK's hybrd and hybrj algorithms.</p>
<h4>Examples</h4>
<p>Find a solution to the system of equations:
<code>x0*cos(x1) = 4,  x1*x0 - x1 = 5</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>             <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="n">array</span><span class="p">([</span><span class="mf">6.50409711</span><span class="p">,</span> <span class="mf">0.90841421</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># func(root) should be almost 0.0.</span>
<span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="golden_1">golden<a class="headerlink" href="#golden_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function golden</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">golden</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">brack</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Return the minimum of a function of one variable using golden section
method.</p>
<p>Given a function of one variable and a possible bracketing interval,
return the minimum of the function isolated to a fractional precision of
tol.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable func(x,*args)</strong>
    Objective function to minimize.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments (if present), passed to func.</p>
</li>
<li>
<p><strong>brack : tuple, optional</strong>
    Triple (a,b,c), where (a&lt;b&lt;c) and func(b) &lt;
    func(a),func(c). If bracket consists of two numbers (a,
    c), then they are assumed to be a starting interval for a
    downhill bracket search (see <code>bracket</code>); it doesn't always
    mean that obtained solution will satisfy a&lt;=x&lt;=c.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    x tolerance stop criterion</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If True, return optional outputs.</p>
</li>
<li>
<p><strong>maxiter : int</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>minimize_scalar: Interface to minimization algorithms for scalar</strong>
    univariate functions. See the 'Golden' <code>method</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>Uses analog of bisection method to decrease the bracketed
interval.</p>
<h4>Examples</h4>
<p>We illustrate the behaviour of the function when <code>brack</code> is of
size 2 and 3, respectively. In the case where <code>brack</code> is of the
form (xa,xb), we can see for the given values, the output need
not necessarily lie in the range <code>(xa, xb)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">golden</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="mf">1.5717277788484873e-162</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">golden</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">brack</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum</span>
<span class="o">-</span><span class="mf">1.5717277788484873e-162</span>
</code></pre></div>

</details>
<h3 id="least_squares_1">least_squares<a class="headerlink" href="#least_squares_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function least_squares</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">least_squares</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:[`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Trf</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Dogbox</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lm</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_scale</span><span class="o">:[`</span><span class="nc">Jac</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">loss</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_scale</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">diff_step</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tr_solver</span><span class="o">:[`</span><span class="nc">Lsmr</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Exact</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tr_options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">jac_sparsity</span><span class="o">:[&gt;`</span><span class="nc">ArrayLike</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_nfev</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:[`</span><span class="nc">Two</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Zero</span> <span class="o">|</span> <span class="o">`</span><span class="nc">One</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kwargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">bool</span><span class="o">)</span>
</code></pre></div>

<p>Solve a nonlinear least-squares problem with bounds on the variables.</p>
<p>Given the residuals f(x) (an m-D real function of n real
variables) and the loss function rho(s) (a scalar function), <code>least_squares</code>
finds a local minimum of the cost function F(x)::</p>
<div class="codehilite"><pre><span></span><code>minimize F(x) = 0.5 * sum(rho(f_i(x)**2), i = 0, ..., m - 1)
subject to lb &lt;= x &lt;= ub
</code></pre></div>


<p>The purpose of the loss function rho(s) is to reduce the influence of
outliers on the solution.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    Function which computes the vector of residuals, with the signature
    <code>fun(x, *args, **kwargs)</code>, i.e., the minimization proceeds with
    respect to its first argument. The argument <code>x</code> passed to this
    function is an ndarray of shape (n,) (never a scalar, even for n=1).
    It must allocate and return a 1-D array_like of shape (m,) or a scalar.
    If the argument <code>x</code> is complex or the function <code>fun</code> returns
    complex residuals, it must be wrapped in a real function of real
    arguments, as shown at the end of the Examples section.</p>
</li>
<li>
<p><strong>x0 : array_like with shape (n,) or float</strong>
    Initial guess on independent variables. If float, it will be treated
    as a 1-D array with one element.</p>
</li>
<li>
<p><strong>jac : {'2-point', '3-point', 'cs', callable}, optional</strong>
    Method of computing the Jacobian matrix (an m-by-n matrix, where
    element (i, j) is the partial derivative of f[i] with respect to
    x[j]). The keywords select a finite difference scheme for numerical
    estimation. The scheme '3-point' is more accurate, but requires
    twice as many operations as '2-point' (default). The scheme 'cs'
    uses complex steps, and while potentially the most accurate, it is
    applicable only when <code>fun</code> correctly handles complex inputs and
    can be analytically continued to the complex plane. Method 'lm'
    always uses the '2-point' scheme. If callable, it is used as
    <code>jac(x, *args, **kwargs)</code> and should return a good approximation
    (or the exact value) for the Jacobian as an array_like (np.atleast_2d
    is applied), a sparse matrix or a <code>scipy.sparse.linalg.LinearOperator</code>.</p>
</li>
<li>
<p><strong>bounds : 2-tuple of array_like, optional</strong>
    Lower and upper bounds on independent variables. Defaults to no bounds.
    Each array must match the size of <code>x0</code> or be a scalar, in the latter
    case a bound will be the same for all variables. Use <code>np.inf</code> with
    an appropriate sign to disable bounds on all or some variables.</p>
</li>
<li>
<p><strong>method : {'trf', 'dogbox', 'lm'}, optional</strong>
    Algorithm to perform minimization.</p>
<div class="codehilite"><pre><span></span><code>* &#39;trf&#39; : Trust Region Reflective algorithm, particularly suitable
  for large sparse problems with bounds. Generally robust method.
* &#39;dogbox&#39; : dogleg algorithm with rectangular trust regions,
  typical use case is small problems with bounds. Not recommended
  for problems with rank-deficient Jacobian.
* &#39;lm&#39; : Levenberg-Marquardt algorithm as implemented in MINPACK.
  Doesn&#39;t handle bounds and sparse Jacobians. Usually the most
  efficient method for small unconstrained problems.
</code></pre></div>


<p>Default is 'trf'. See Notes for more information.</p>
</li>
<li>
<p><strong>ftol : float or None, optional</strong>
    Tolerance for termination by the change of the cost function. Default
    is 1e-8. The optimization process is stopped when <code>dF &lt; ftol * F</code>,
    and there was an adequate agreement between a local quadratic model and
    the true model in the last step. If None, the termination by this
    condition is disabled.</p>
</li>
<li>
<p><strong>xtol : float or None, optional</strong>
    Tolerance for termination by the change of the independent variables.
    Default is 1e-8. The exact condition depends on the <code>method</code> used:</p>
<div class="codehilite"><pre><span></span><code>* For &#39;trf&#39; and &#39;dogbox&#39; : ``norm(dx) &lt; xtol * (xtol + norm(x))``.
* For &#39;lm&#39; : ``Delta &lt; xtol * norm(xs)``, where ``Delta`` is
  a trust-region radius and ``xs`` is the value of ``x``
  scaled according to `x_scale` parameter (see below).
</code></pre></div>


<p>If None, the termination by this condition is disabled.</p>
</li>
<li>
<p><strong>gtol : float or None, optional</strong>
    Tolerance for termination by the norm of the gradient. Default is 1e-8.
    The exact condition depends on a <code>method</code> used:</p>
<div class="codehilite"><pre><span></span><code>* For &#39;trf&#39; : ``norm(g_scaled, ord=np.inf) &lt; gtol``, where
  ``g_scaled`` is the value of the gradient scaled to account for
  the presence of the bounds [STIR]_.
* For &#39;dogbox&#39; : ``norm(g_free, ord=np.inf) &lt; gtol``, where
  ``g_free`` is the gradient with respect to the variables which
  are not in the optimal state on the boundary.
* For &#39;lm&#39; : the maximum absolute value of the cosine of angles
  between columns of the Jacobian and the residual vector is less
  than `gtol`, or the residual vector is zero.
</code></pre></div>


<p>If None, the termination by this condition is disabled.</p>
</li>
<li>
<p><strong>x_scale : array_like or 'jac', optional</strong>
    Characteristic scale of each variable. Setting <code>x_scale</code> is equivalent
    to reformulating the problem in scaled variables <code>xs = x / x_scale</code>.
    An alternative view is that the size of a trust region along jth
    dimension is proportional to <code>x_scale[j]</code>. Improved convergence may
    be achieved by setting <code>x_scale</code> such that a step of a given size
    along any of the scaled variables has a similar effect on the cost
    function. If set to 'jac', the scale is iteratively updated using the
    inverse norms of the columns of the Jacobian matrix (as described in
    [JJMore]_).</p>
</li>
<li>
<p><strong>loss : str or callable, optional</strong>
    Determines the loss function. The following keyword values are allowed:</p>
<div class="codehilite"><pre><span></span><code>* &#39;linear&#39; (default) : ``rho(z) = z``. Gives a standard
  least-squares problem.
* &#39;soft_l1&#39; : ``rho(z) = 2 * ((1 + z)**0.5 - 1)``. The smooth
  approximation of l1 (absolute value) loss. Usually a good
  choice for robust least squares.
* &#39;huber&#39; : ``rho(z) = z if z &lt;= 1 else 2*z**0.5 - 1``. Works
  similarly to &#39;soft_l1&#39;.
* &#39;cauchy&#39; : ``rho(z) = ln(1 + z)``. Severely weakens outliers
  influence, but may cause difficulties in optimization process.
* &#39;arctan&#39; : ``rho(z) = arctan(z)``. Limits a maximum loss on
  a single residual, has properties similar to &#39;cauchy&#39;.
</code></pre></div>


<p>If callable, it must take a 1-D ndarray <code>z=f**2</code> and return an
array_like with shape (3, m) where row 0 contains function values,
row 1 contains first derivatives and row 2 contains second
derivatives. Method 'lm' supports only 'linear' loss.</p>
</li>
<li>
<p><strong>f_scale : float, optional</strong>
    Value of soft margin between inlier and outlier residuals, default
    is 1.0. The loss function is evaluated as follows
    <code>rho_(f**2) = C**2 * rho(f**2 / C**2)</code>, where <code>C</code> is <code>f_scale</code>,
    and <code>rho</code> is determined by <code>loss</code> parameter. This parameter has
    no effect with <code>loss='linear'</code>, but for other <code>loss</code> values it is
    of crucial importance.</p>
</li>
<li>
<p><strong>max_nfev : None or int, optional</strong>
    Maximum number of function evaluations before the termination.
    If None (default), the value is chosen automatically:</p>
<div class="codehilite"><pre><span></span><code>* For &#39;trf&#39; and &#39;dogbox&#39; : 100 * n.
* For &#39;lm&#39; :  100 * n if `jac` is callable and 100 * n * (n + 1)
  otherwise (because &#39;lm&#39; counts function calls in Jacobian
  estimation).
</code></pre></div>


</li>
<li>
<p><strong>diff_step : None or array_like, optional</strong>
    Determines the relative step size for the finite difference
    approximation of the Jacobian. The actual step is computed as
    <code>x * diff_step</code>. If None (default), then <code>diff_step</code> is taken to be
    a conventional 'optimal' power of machine epsilon for the finite
    difference scheme used [NR]_.</p>
</li>
<li>
<p><strong>tr_solver : {None, 'exact', 'lsmr'}, optional</strong>
    Method for solving trust-region subproblems, relevant only for 'trf'
    and 'dogbox' methods.</p>
<div class="codehilite"><pre><span></span><code>* &#39;exact&#39; is suitable for not very large problems with dense
  Jacobian matrices. The computational complexity per iteration is
  comparable to a singular value decomposition of the Jacobian
  matrix.
* &#39;lsmr&#39; is suitable for problems with sparse and large Jacobian
  matrices. It uses the iterative procedure
  `scipy.sparse.linalg.lsmr` for finding a solution of a linear
  least-squares problem and only requires matrix-vector product
  evaluations.
</code></pre></div>


<p>If None (default), the solver is chosen based on the type of Jacobian
returned on the first iteration.</p>
</li>
<li>
<p><strong>tr_options : dict, optional</strong>
    Keyword options passed to trust-region solver.</p>
<div class="codehilite"><pre><span></span><code>* ``tr_solver=&#39;exact&#39;``: `tr_options` are ignored.
* ``tr_solver=&#39;lsmr&#39;``: options for `scipy.sparse.linalg.lsmr`.
  Additionally,  ``method=&#39;trf&#39;`` supports  &#39;regularize&#39; option
  (bool, default is True), which adds a regularization term to the
  normal equation, which improves convergence if the Jacobian is
  rank-deficient [Byrd]_ (eq. 3.4).
</code></pre></div>


</li>
<li>
<p><strong>jac_sparsity : {None, array_like, sparse matrix}, optional</strong>
    Defines the sparsity structure of the Jacobian matrix for finite
    difference estimation, its shape must be (m, n). If the Jacobian has
    only few non-zero elements in <em>each</em> row, providing the sparsity
    structure will greatly speed up the computations [Curtis]_. A zero
    entry means that a corresponding element in the Jacobian is identically
    zero. If provided, forces the use of 'lsmr' trust-region solver.
    If None (default), then dense differencing will be used. Has no effect
    for 'lm' method.</p>
</li>
<li>
<p><strong>verbose : {0, 1, 2}, optional</strong>
    Level of algorithm's verbosity:</p>
<div class="codehilite"><pre><span></span><code>* 0 (default) : work silently.
* 1 : display a termination report.
* 2 : display progress during iterations (not supported by &#39;lm&#39;
  method).
</code></pre></div>


</li>
</ul>
<p>args, kwargs : tuple and dict, optional
    Additional arguments passed to <code>fun</code> and <code>jac</code>. Both empty by default.
    The calling signature is <code>fun(x, *args, **kwargs)</code> and the same for
    <code>jac</code>.</p>
<h4>Returns</h4>
<p><code>OptimizeResult</code> with the following fields defined:</p>
<ul>
<li>
<p><strong>x : ndarray, shape (n,)</strong>
    Solution found.</p>
</li>
<li>
<p><strong>cost : float</strong>
    Value of the cost function at the solution.</p>
</li>
<li>
<p><strong>fun : ndarray, shape (m,)</strong>
    Vector of residuals at the solution.</p>
</li>
<li>
<p><strong>jac : ndarray, sparse matrix or LinearOperator, shape (m, n)</strong>
    Modified Jacobian matrix at the solution, in the sense that J^T J
    is a Gauss-Newton approximation of the Hessian of the cost function.
    The type is the same as the one used by the algorithm.</p>
</li>
<li>
<p><strong>grad : ndarray, shape (m,)</strong>
    Gradient of the cost function at the solution.</p>
</li>
<li>
<p><strong>optimality : float</strong>
    First-order optimality measure. In unconstrained problems, it is always
    the uniform norm of the gradient. In constrained problems, it is the
    quantity which was compared with <code>gtol</code> during iterations.</p>
</li>
<li>
<p><strong>active_mask : ndarray of int, shape (n,)</strong>
    Each component shows whether a corresponding constraint is active
    (that is, whether a variable is at the bound):</p>
<div class="codehilite"><pre><span></span><code>*  0 : a constraint is not active.
* -1 : a lower bound is active.
*  1 : an upper bound is active.
</code></pre></div>


<p>Might be somewhat arbitrary for 'trf' method as it generates a sequence
of strictly feasible iterates and <code>active_mask</code> is determined within a
tolerance threshold.</p>
</li>
<li>
<p><strong>nfev : int</strong>
    Number of function evaluations done. Methods 'trf' and 'dogbox' do not
    count function calls for numerical Jacobian approximation, as opposed
    to 'lm' method.</p>
</li>
<li>
<p><strong>njev : int or None</strong>
    Number of Jacobian evaluations done. If numerical Jacobian
    approximation is used in 'lm' method, it is set to None.</p>
</li>
<li>
<p><strong>status : int</strong>
    The reason for algorithm termination:</p>
<div class="codehilite"><pre><span></span><code>* -1 : improper input parameters status returned from MINPACK.
*  0 : the maximum number of function evaluations is exceeded.
*  1 : `gtol` termination condition is satisfied.
*  2 : `ftol` termination condition is satisfied.
*  3 : `xtol` termination condition is satisfied.
*  4 : Both `ftol` and `xtol` termination conditions are satisfied.
</code></pre></div>


</li>
<li>
<p><strong>message : str</strong>
    Verbal description of the termination reason.</p>
</li>
<li>
<p><strong>success : bool</strong>
    True if one of the convergence criteria is satisfied (<code>status</code> &gt; 0).</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>leastsq : A legacy wrapper for the MINPACK implementation of the</strong>
          Levenberg-Marquadt algorithm.</p>
</li>
<li>
<p><strong>curve_fit : Least-squares minimization applied to a curve-fitting problem.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>Method 'lm' (Levenberg-Marquardt) calls a wrapper over least-squares
algorithms implemented in MINPACK (lmder, lmdif). It runs the
Levenberg-Marquardt algorithm formulated as a trust-region type algorithm.
The implementation is based on paper [JJMore]_, it is very robust and
efficient with a lot of smart tricks. It should be your first choice
for unconstrained problems. Note that it doesn't support bounds. Also,
it doesn't work when m &lt; n.</p>
<p>Method 'trf' (Trust Region Reflective) is motivated by the process of
solving a system of equations, which constitute the first-order optimality
condition for a bound-constrained minimization problem as formulated in
[STIR]<em>. The algorithm iteratively solves trust-region subproblems
augmented by a special diagonal quadratic term and with trust-region shape
determined by the distance from the bounds and the direction of the
gradient. This enhancements help to avoid making steps directly into bounds
and efficiently explore the whole space of variables. To further improve
convergence, the algorithm considers search directions reflected from the
bounds. To obey theoretical requirements, the algorithm keeps iterates
strictly feasible. With dense Jacobians trust-region subproblems are
solved by an exact method very similar to the one described in [JJMore]</em>
(and implemented in MINPACK). The difference from the MINPACK
implementation is that a singular value decomposition of a Jacobian
matrix is done once per iteration, instead of a QR decomposition and series
of Givens rotation eliminations. For large sparse Jacobians a 2-D subspace
approach of solving trust-region subproblems is used [STIR]<em>, [Byrd]</em>.
The subspace is spanned by a scaled gradient and an approximate
Gauss-Newton solution delivered by <code>scipy.sparse.linalg.lsmr</code>. When no
constraints are imposed the algorithm is very similar to MINPACK and has
generally comparable performance. The algorithm works quite robust in
unbounded and bounded problems, thus it is chosen as a default algorithm.</p>
<p>Method 'dogbox' operates in a trust-region framework, but considers
rectangular trust regions as opposed to conventional ellipsoids [Voglis]<em>.
The intersection of a current trust region and initial bounds is again
rectangular, so on each iteration a quadratic minimization problem subject
to bound constraints is solved approximately by Powell's dogleg method
[NumOpt]</em>. The required Gauss-Newton step can be computed exactly for
dense Jacobians or approximately by <code>scipy.sparse.linalg.lsmr</code> for large
sparse Jacobians. The algorithm is likely to exhibit slow convergence when
the rank of Jacobian is less than the number of variables. The algorithm
often outperforms 'trf' in bounded problems with a small number of
variables.</p>
<p>Robust loss functions are implemented as described in [BA]_. The idea
is to modify a residual vector and a Jacobian matrix on each iteration
such that computed gradient and Gauss-Newton Hessian approximation match
the true gradient and Hessian approximation of the cost function. Then
the algorithm proceeds in a normal way, i.e., robust loss functions are
implemented as a simple wrapper over standard least-squares algorithms.</p>
<p>.. versionadded:: 0.17.0</p>
<h4>References</h4>
<p>.. [STIR] M. A. Branch, T. F. Coleman, and Y. Li, 'A Subspace, Interior,
          and Conjugate Gradient Method for Large-Scale Bound-Constrained
          Minimization Problems,' SIAM Journal on Scientific Computing,
          Vol. 21, Number 1, pp 1-23, 1999.
.. [NR] William H. Press et. al., 'Numerical Recipes. The Art of Scientific
        Computing. 3rd edition', Sec. 5.7.
.. [Byrd] R. H. Byrd, R. B. Schnabel and G. A. Shultz, 'Approximate
          solution of the trust region problem by minimization over
          two-dimensional subspaces', Math. Programming, 40, pp. 247-263,
          1988.
.. [Curtis] A. Curtis, M. J. D. Powell, and J. Reid, 'On the estimation of
            sparse Jacobian matrices', Journal of the Institute of
            Mathematics and its Applications, 13, pp. 117-120, 1974.
.. [JJMore] J. J. More, 'The Levenberg-Marquardt Algorithm: Implementation
            and Theory,' Numerical Analysis, ed. G. A. Watson, Lecture
            Notes in Mathematics 630, Springer Verlag, pp. 105-116, 1977.
.. [Voglis] C. Voglis and I. E. Lagaris, 'A Rectangular Trust Region
            Dogleg Approach for Unconstrained and Bound Constrained
            Nonlinear Optimization', WSEAS International Conference on
            Applied Mathematics, Corfu, Greece, 2004.
.. [NumOpt] J. Nocedal and S. J. Wright, 'Numerical optimization,
            2nd edition', Chapter 4.
.. [BA] B. Triggs et. al., 'Bundle Adjustment - A Modern Synthesis',
        Proceedings of the International Workshop on Vision Algorithms:
        Theory and Practice, pp. 298-372, 1999.</p>
<h4>Examples</h4>
<p>In this example we find a minimum of the Rosenbrock function without bounds
on independent variables.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun_rosenbrock</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
</code></pre></div>

<p>Notice that we only provide the vector of the residuals. The algorithm
constructs the cost function as a sum of squares of the residuals, which
gives the Rosenbrock function. The exact minimum is at <code>x = [1.0, 1.0]</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">least_squares</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0_rosenbrock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun_rosenbrock</span><span class="p">,</span> <span class="n">x0_rosenbrock</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span><span class="o">.</span><span class="n">cost</span>
<span class="mf">9.8669242910846867e-30</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_1</span><span class="o">.</span><span class="n">optimality</span>
<span class="mf">8.8928864934219529e-14</span>
</code></pre></div>

<p>We now constrain the variables, in such a way that the previous solution
becomes infeasible. Specifically, we require that <code>x[1] &gt;= 1.5</code>, and
<code>x[0]</code> left unconstrained. To this end, we specify the <code>bounds</code> parameter
to <code>least_squares</code> in the form <code>bounds=([-np.inf, 1.5], np.inf)</code>.</p>
<p>We also provide the analytic Jacobian:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">jac_rosenbrock</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="o">...</span>         <span class="p">[</span><span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</code></pre></div>

<p>Putting this all together, we see that the new solution lies on the bound:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun_rosenbrock</span><span class="p">,</span> <span class="n">x0_rosenbrock</span><span class="p">,</span> <span class="n">jac_rosenbrock</span><span class="p">,</span>
<span class="o">...</span>                       <span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.22437075</span><span class="p">,</span>  <span class="mf">1.5</span>       <span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span><span class="o">.</span><span class="n">cost</span>
<span class="mf">0.025213093946805685</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_2</span><span class="o">.</span><span class="n">optimality</span>
<span class="mf">1.5885401433157753e-07</span>
</code></pre></div>

<p>Now we solve a system of equations (i.e., the cost function should be zero
at a minimum) for a Broyden tridiagonal vector-valued function of 100000
variables:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun_broyden</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>     <span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">f</span>
</code></pre></div>

<p>The corresponding Jacobian matrix is sparse. We tell the algorithm to
estimate it by finite differences and provide the sparsity structure of
Jacobian to significantly speed up this process.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">lil_matrix</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">sparsity_broyden</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">sparsity</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">sparsity</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">sparsity</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">sparsity</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">sparsity</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0_broyden</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_3</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun_broyden</span><span class="p">,</span> <span class="n">x0_broyden</span><span class="p">,</span>
<span class="o">...</span>                       <span class="n">jac_sparsity</span><span class="o">=</span><span class="n">sparsity_broyden</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_3</span><span class="o">.</span><span class="n">cost</span>
<span class="mf">4.5687069299604613e-23</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_3</span><span class="o">.</span><span class="n">optimality</span>
<span class="mf">1.1650454296851518e-11</span>
</code></pre></div>

<p>Let's also solve a curve fitting problem using robust loss function to
take care of outliers in the data. Define the model function as
<code>y = a + b * exp(c * t)</code>, where t is a predictor variable, y is an
observation and a, b, c are parameters to estimate.</p>
<p>First, define the function which generates the data with noise and
outliers, define the model parameters, and generate data:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">gen_data</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_outliers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="n">rnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">error</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">*</span> <span class="n">rnd</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">outliers</span> <span class="o">=</span> <span class="n">rnd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">n_outliers</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">error</span><span class="p">[</span><span class="n">outliers</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">error</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t_min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t_max</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n_points</span> <span class="o">=</span> <span class="mi">15</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_outliers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>

<p>Define function for computing residuals and initial estimate of
parameters.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</code></pre></div>

<p>Compute a standard least-squares solution:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res_lsq</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
</code></pre></div>

<p>Now compute two solutions with two different robust loss functions. The
parameter <code>f_scale</code> is set to 0.1, meaning that inlier residuals should
not significantly exceed 0.1 (the noise level used).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res_soft_l1</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;soft_l1&#39;</span><span class="p">,</span> <span class="n">f_scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="o">...</span>                             <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_log</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;cauchy&#39;</span><span class="p">,</span> <span class="n">f_scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="o">...</span>                         <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
</code></pre></div>

<p>And, finally, plot all the curves. We see that by selecting an appropriate
<code>loss</code>  we can get estimates close to optimal even in the presence of
strong outliers. But keep in mind that generally it is recommended to try
'soft_l1' or 'huber' losses first (if at all necessary) as the other two
options may cause difficulties in optimization process.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">t_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_lsq</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="o">*</span><span class="n">res_lsq</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_soft_l1</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="o">*</span><span class="n">res_soft_l1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_log</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="o">*</span><span class="n">res_log</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_lsq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear loss&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_soft_l1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;soft_l1 loss&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_test</span><span class="p">,</span> <span class="n">y_log</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cauchy loss&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>In the next example, we show how complex-valued residual functions of
complex variables can be optimized with <code>least_squares()</code>. Consider the
following function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

<p>We wrap it into a function of real variables that returns real residuals
by simply handling the real and imaginary parts as independent variables:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f_wrap</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">fx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fx</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">fx</span><span class="o">.</span><span class="n">imag</span><span class="p">])</span>
</code></pre></div>

<p>Thus, instead of the original m-D complex function of n complex
variables we optimize a 2m-D real function of 2n real variables:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">least_squares</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res_wrapped</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">f_wrap</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span> <span class="o">=</span> <span class="n">res_wrapped</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">res_wrapped</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span>
<span class="p">(</span><span class="mf">0.49999999999925893</span><span class="o">+</span><span class="mf">0.49999999999925893</span><span class="n">j</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="leastsq_1">leastsq<a class="headerlink" href="#leastsq_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function leastsq</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">leastsq</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">dfun</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">col_deriv</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">ftol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">gtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxfev</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">epsfcn</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">factor</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">diag</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span>
</code></pre></div>

<p>Minimize the sum of squares of a set of equations.</p>
<p>::</p>
<div class="codehilite"><pre><span></span><code>x = arg min(sum(func(y)**2,axis=0))
         y
</code></pre></div>


<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    Should take at least one (possibly length N vector) argument and
    returns M floating point numbers. It must not return NaNs or
    fitting might fail.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    The starting estimate for the minimization.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any extra arguments to func are placed in this tuple.</p>
</li>
<li>
<p><strong>Dfun : callable, optional</strong>
    A function or method to compute the Jacobian of func with derivatives
    across the rows. If this is None, the Jacobian will be estimated.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    non-zero to return all optional outputs.</p>
</li>
<li>
<p><strong>col_deriv : bool, optional</strong>
    non-zero to specify that the Jacobian function computes derivatives
    down the columns (faster, because there is no transpose operation).</p>
</li>
<li>
<p><strong>ftol : float, optional</strong>
    Relative error desired in the sum of squares.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Relative error desired in the approximate solution.</p>
</li>
<li>
<p><strong>gtol : float, optional</strong>
    Orthogonality desired between the function vector and the columns of
    the Jacobian.</p>
</li>
<li>
<p><strong>maxfev : int, optional</strong>
    The maximum number of calls to the function. If <code>Dfun</code> is provided,
    then the default <code>maxfev</code> is 100<em>(N+1) where N is the number of elements
    in x0, otherwise the default <code>maxfev</code> is 200</em>(N+1).</p>
</li>
<li>
<p><strong>epsfcn : float, optional</strong>
    A variable used in determining a suitable step length for the forward-
    difference approximation of the Jacobian (for Dfun=None).
    Normally the actual step length will be sqrt(epsfcn)*x
    If epsfcn is less than the machine precision, it is assumed that the
    relative errors are of the order of the machine precision.</p>
</li>
<li>
<p><strong>factor : float, optional</strong>
    A parameter determining the initial step bound
    (<code>factor * || diag * x||</code>). Should be in interval <code>(0.1, 100)</code>.</p>
</li>
<li>
<p><strong>diag : sequence, optional</strong>
    N positive entries that serve as a scale factors for the variables.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    The solution (or the result of the last iteration for an unsuccessful
    call).</p>
</li>
<li>
<p><strong>cov_x : ndarray</strong>
    The inverse of the Hessian. <code>fjac</code> and <code>ipvt</code> are used to construct an
    estimate of the Hessian. A value of None indicates a singular matrix,
    which means the curvature in parameters <code>x</code> is numerically flat. To
    obtain the covariance matrix of the parameters <code>x</code>, <code>cov_x</code> must be
    multiplied by the variance of the residuals -- see curve_fit.</p>
</li>
<li>
<p><strong>infodict : dict</strong>
    a dictionary of optional outputs with the keys:</p>
<p><code>nfev</code>
    The number of function calls
<code>fvec</code>
    The function evaluated at the output
<code>fjac</code>
    A permutation of the R matrix of a QR
    factorization of the final approximate
    Jacobian matrix, stored column wise.
    Together with ipvt, the covariance of the
    estimate can be approximated.
<code>ipvt</code>
    An integer array of length N which defines
    a permutation matrix, p, such that
    fjac<em>p = q</em>r, where r is upper triangular
    with diagonal elements of nonincreasing
    magnitude. Column j of p is column ipvt(j)
    of the identity matrix.
<code>qtf</code>
    The vector (transpose(q) * fvec).</p>
</li>
<li>
<p><strong>mesg : str</strong>
    A string message giving information about the cause of failure.</p>
</li>
<li>
<p><strong>ier : int</strong>
    An integer flag. If it is equal to 1, 2, 3 or 4, the solution was
    found. Otherwise, the solution was not found. In either case, the
    optional output variable 'mesg' gives more information.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>least_squares : Newer interface to solve nonlinear least-squares problems</strong>
    with bounds on the variables. See <code>method=='lm'</code> in particular.</li>
</ul>
<h4>Notes</h4>
<p>'leastsq' is a wrapper around MINPACK's lmdif and lmder algorithms.</p>
<p>cov_x is a Jacobian approximation to the Hessian of the least squares
objective function.
This approximation assumes that the objective function is based on the
difference between some observed target data (ydata) and a (non-linear)
function of the parameters <code>f(xdata, params)</code> ::</p>
<div class="codehilite"><pre><span></span><code>   func(params) = ydata - f(xdata, params)
</code></pre></div>


<p>so that the objective function is ::</p>
<div class="codehilite"><pre><span></span><code>   min   sum((ydata - f(xdata, params))**2, axis=0)
 params
</code></pre></div>


<p>The solution, <code>x</code>, is always a 1-D array, regardless of the shape of <code>x0</code>,
or whether <code>x0</code> is a scalar.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">leastsq</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">leastsq</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">2.99999999</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="line_search_2">line_search<a class="headerlink" href="#line_search_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function line_search</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">line_search</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">gfk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">old_old_fval</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">c2</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">amax</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">extra_condition</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">myfprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">pk</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="kt">float</span> <span class="n">option</span><span class="o">)</span>
</code></pre></div>

<p>Find alpha that satisfies strong Wolfe conditions.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable f(x,*args)</strong>
    Objective function.</p>
</li>
<li>
<p><strong>myfprime : callable f'(x,*args)</strong>
    Objective function gradient.</p>
</li>
<li>
<p><strong>xk : ndarray</strong>
    Starting point.</p>
</li>
<li>
<p><strong>pk : ndarray</strong>
    Search direction.</p>
</li>
<li>
<p><strong>gfk : ndarray, optional</strong>
    Gradient value for x=xk (xk being the current parameter
    estimate). Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_fval : float, optional</strong>
    Function value for x=xk. Will be recomputed if omitted.</p>
</li>
<li>
<p><strong>old_old_fval : float, optional</strong>
    Function value for the point preceding x=xk.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Additional arguments passed to objective function.</p>
</li>
<li>
<p><strong>c1 : float, optional</strong>
    Parameter for Armijo condition rule.</p>
</li>
<li>
<p><strong>c2 : float, optional</strong>
    Parameter for curvature condition rule.</p>
</li>
<li>
<p><strong>amax : float, optional</strong>
    Maximum step size</p>
</li>
<li>
<p><strong>extra_condition : callable, optional</strong>
    A callable of the form <code>extra_condition(alpha, x, f, g)</code>
    returning a boolean. Arguments are the proposed step <code>alpha</code>
    and the corresponding <code>x</code>, <code>f</code> and <code>g</code> values. The line search
    accepts the value of <code>alpha</code> only if this
    callable returns <code>True</code>. If the callable returns <code>False</code>
    for the step length, the algorithm will continue with
    new iterates. The callable is only called for iterates
    satisfying the strong Wolfe conditions.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to perform.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>alpha : float or None</strong>
    Alpha for which <code>x_new = x0 + alpha * pk</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>fc : int</strong>
    Number of function evaluations made.</p>
</li>
<li>
<p><strong>gc : int</strong>
    Number of gradient evaluations made.</p>
</li>
<li>
<p><strong>new_fval : float or None</strong>
    New function value <code>f(x_new)=f(x0+alpha*pk)</code>,
    or None if the line search algorithm did not converge.</p>
</li>
<li>
<p><strong>old_fval : float</strong>
    Old function value <code>f(x0)</code>.</p>
</li>
<li>
<p><strong>new_slope : float or None</strong>
    The local slope along the search direction at the
    new value <code>&lt;myfprime(x_new), pk&gt;</code>,
    or None if the line search algorithm did not converge.</p>
</li>
</ul>
<h4>Notes</h4>
<p>Uses the line search algorithm to enforce strong Wolfe
conditions. See Wright and Nocedal, 'Numerical Optimization',
1999, pp. 59-61.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">line_search</span>
</code></pre></div>

<p>A objective function and its gradient are defined.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">obj_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

<p>We can find alpha that satisfies strong Wolfe conditions.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">start_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">search_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">line_search</span><span class="p">(</span><span class="n">obj_func</span><span class="p">,</span> <span class="n">obj_grad</span><span class="p">,</span> <span class="n">start_point</span><span class="p">,</span> <span class="n">search_gradient</span><span class="p">)</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1300000000000001</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="linear_sum_assignment">linear_sum_assignment<a class="headerlink" href="#linear_sum_assignment" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function linear_sum_assignment</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">linear_sum_assignment</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">maximize</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">cost_matrix</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Solve the linear sum assignment problem.</p>
<p>The linear sum assignment problem is also known as minimum weight matching
in bipartite graphs. A problem instance is described by a matrix C, where
each C[i,j] is the cost of matching vertex i of the first partite set
(a 'worker') and vertex j of the second set (a 'job'). The goal is to find
a complete assignment of workers to jobs of minimal cost.</p>
<p>Formally, let X be a boolean matrix where :math:<code>X[i,j] = 1</code> iff row i is
assigned to column j. Then the optimal assignment has cost</p>
<div>
<div class="MathJax_Preview">    \min \sum_i \sum_j C_{i,j} X_{i,j}
</div>
<script type="math/tex; mode=display">    \min \sum_i \sum_j C_{i,j} X_{i,j}
</script>
</div>
<p>where, in the case where the matrix X is square, each row is assigned to
exactly one column, and each column to exactly one row.</p>
<p>This function can also solve a generalization of the classic assignment
problem where the cost matrix is rectangular. If it has more rows than
columns, then not every row needs to be assigned to a column, and vice
versa.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>cost_matrix : array</strong>
    The cost matrix of the bipartite graph.</p>
</li>
<li>
<p><strong>maximize : bool (default: False)</strong>
    Calculates a maximum weight matching if true.</p>
</li>
</ul>
<h4>Returns</h4>
<p>row_ind, col_ind : array
    An array of row indices and one of corresponding column indices giving
    the optimal assignment. The cost of the assignment can be computed
    as <code>cost_matrix[row_ind, col_ind].sum()</code>. The row indices will be
    sorted; in the case of a square cost matrix they will be equal to
    <code>numpy.arange(cost_matrix.shape[0])</code>.</p>
<h4>Notes</h4>
<p>.. versionadded:: 0.17.0</p>
<h4>References</h4>
<ol>
<li>
<p>https://en.wikipedia.org/wiki/Assignment_problem</p>
</li>
<li>
<p>DF Crouse. On implementing 2D rectangular assignment algorithms.
   <em>IEEE Transactions on Aerospace and Electronic Systems</em>,</p>
</li>
<li>
<p><strong>52(4):1679-1696, August 2016, https://doi.org/10.1109/TAES.2016.140952</strong></p>
</li>
</ol>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">linear_sum_assignment</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">row_ind</span><span class="p">,</span> <span class="n">col_ind</span> <span class="o">=</span> <span class="n">linear_sum_assignment</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">col_ind</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cost</span><span class="p">[</span><span class="n">row_ind</span><span class="p">,</span> <span class="n">col_ind</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="mi">5</span>
</code></pre></div>

</details>
<h3 id="linearmixing_2">linearmixing<a class="headerlink" href="#linearmixing_2" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function linearmixing</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">linearmixing</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">alpha</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using a scalar Jacobian approximation.</p>
<p>.. warning::</p>
<p>This algorithm may be useful for specific problems, but whether
   it will work may depend strongly on the problem.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>alpha : float, optional</strong>
    The Jacobian approximation is (-1/alpha).</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='linearmixing'</code> in particular.</li>
</ul>
</details>
<h3 id="linprog">linprog<a class="headerlink" href="#linprog" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function linprog</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">linprog</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">a_ub</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">b_ub</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">a_eq</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">b_eq</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Interior_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Revised_simplex</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Simplex</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x0</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">c</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">bool</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span><span class="o">)</span>
</code></pre></div>

<p>Linear programming: minimize a linear objective function subject to linear
equality and inequality constraints.</p>
<p>Linear programming solves problems of the following form:</p>
<div>
<div class="MathJax_Preview">
    \min_x \ &amp; c^T x \\
    \mbox{such that} \ &amp; A_{ub} x \leq b_{ub},\\
    &amp; A_{eq} x = b_{eq},\\
    &amp; l \leq x \leq u ,
</div>
<script type="math/tex; mode=display">
    \min_x \ & c^T x \\
    \mbox{such that} \ & A_{ub} x \leq b_{ub},\\
    & A_{eq} x = b_{eq},\\
    & l \leq x \leq u ,
</script>
</div>
<ul>
<li><strong>where :math:<code>x</code> is a vector of decision variables; :math:<code>c</code>,</strong>
:math:<code>b_{ub}</code>, :math:<code>b_{eq}</code>, :math:<code>l</code>, and :math:<code>u</code> are vectors; and
:math:<code>A_{ub}</code> and :math:<code>A_{eq}</code> are matrices.</li>
</ul>
<p>Informally, that's:</p>
<ul>
<li>
<p><strong>minimize::</strong></p>
<p>c @ x</p>
</li>
</ul>
<p>such that::</p>
<div class="codehilite"><pre><span></span><code>A_ub @ x &lt;= b_ub
A_eq @ x == b_eq
lb &lt;= x &lt;= ub
</code></pre></div>


<p>Note that by default <code>lb = 0</code> and <code>ub = None</code> unless specified with
<code>bounds</code>.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>c : 1-D array</strong>
    The coefficients of the linear objective function to be minimized.</p>
</li>
<li>
<p><strong>A_ub : 2-D array, optional</strong>
    The inequality constraint matrix. Each row of <code>A_ub</code> specifies the
    coefficients of a linear inequality constraint on <code>x</code>.</p>
</li>
<li>
<p><strong>b_ub : 1-D array, optional</strong>
    The inequality constraint vector. Each element represents an
    upper bound on the corresponding value of <code>A_ub @ x</code>.</p>
</li>
<li>
<p><strong>A_eq : 2-D array, optional</strong>
    The equality constraint matrix. Each row of <code>A_eq</code> specifies the
    coefficients of a linear equality constraint on <code>x</code>.</p>
</li>
<li>
<p><strong>b_eq : 1-D array, optional</strong>
    The equality constraint vector. Each element of <code>A_eq @ x</code> must equal
    the corresponding element of <code>b_eq</code>.</p>
</li>
<li>
<p><strong>bounds : sequence, optional</strong>
    A sequence of <code>(min, max)</code> pairs for each element in <code>x</code>, defining
    the minimum and maximum values of that decision variable. Use <code>None</code> to
    indicate that there is no bound. By default, bounds are <code>(0, None)</code>
    (all decision variables are non-negative).
    If a single tuple <code>(min, max)</code> is provided, then <code>min</code> and
    <code>max</code> will serve as bounds for all decision variables.</p>
</li>
<li>
<p><strong>method : {'interior-point', 'revised simplex', 'simplex'}, optional</strong>
    The algorithm used to solve the standard form problem.
    :ref:<code>'interior-point' &lt;optimize.linprog-interior-point&gt;</code> (default),
    :ref:<code>'revised simplex' &lt;optimize.linprog-revised_simplex&gt;</code>, and
    :ref:<code>'simplex' &lt;optimize.linprog-simplex&gt;</code> (legacy)
    are supported.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    If a callback function is provided, it will be called at least once per
    iteration of the algorithm. The callback function must accept a single
    <code>scipy.optimize.OptimizeResult</code> consisting of the following fields:</p>
</li>
<li>
<p><strong>x : 1-D array</strong>
            The current solution vector.</p>
</li>
<li>
<p><strong>fun : float</strong>
            The current value of the objective function <code>c @ x</code>.</p>
</li>
<li>
<p><strong>success : bool</strong>
            <code>True</code> when the algorithm has completed successfully.</p>
</li>
<li>
<p><strong>slack : 1-D array</strong>
            The (nominally positive) values of the slack,
            <code>b_ub - A_ub @ x</code>.</p>
</li>
<li>
<p><strong>con : 1-D array</strong>
            The (nominally zero) residuals of the equality constraints,
            <code>b_eq - A_eq @ x</code>.</p>
</li>
<li>
<p><strong>phase : int</strong>
            The phase of the algorithm being executed.</p>
</li>
<li>
<p><strong>status : int</strong>
            An integer representing the status of the algorithm.</p>
<div class="codehilite"><pre><span></span><code>    ``0`` : Optimization proceeding nominally.

    ``1`` : Iteration limit reached.

    ``2`` : Problem appears to be infeasible.

    ``3`` : Problem appears to be unbounded.

    ``4`` : Numerical difficulties encountered.
</code></pre></div>


</li>
<li>
<p><strong>nit : int</strong>
            The current iteration number.</p>
</li>
<li>
<p><strong>message : str</strong>
            A string descriptor of the algorithm status.</p>
</li>
<li>
<p><strong>options : dict, optional</strong>
    A dictionary of solver options. All methods accept the following
    options:</p>
</li>
<li>
<p><strong>maxiter : int</strong>
            Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>Default: see method-specific documentation.</strong></p>
</li>
<li>
<p><strong>disp : bool</strong>
            Set to <code>True</code> to print convergence messages.</p>
</li>
<li>
<p><strong>Default: <code>False</code>.</strong></p>
</li>
<li>
<p><strong>autoscale : bool</strong>
            Set to <code>True</code> to automatically perform equilibration.
            Consider using this option if the numerical values in the
            constraints are separated by several orders of magnitude.</p>
</li>
<li>
<p><strong>Default: <code>False</code>.</strong></p>
</li>
<li>
<p><strong>presolve : bool</strong>
            Set to <code>False</code> to disable automatic presolve.</p>
</li>
<li>
<p><strong>Default: <code>True</code>.</strong></p>
</li>
<li>
<p><strong>rr : bool</strong>
            Set to <code>False</code> to disable automatic redundancy removal.</p>
</li>
<li>
<p><strong>Default: <code>True</code>.</strong></p>
<p>For method-specific options, see
:func:<code>show_options('linprog') &lt;show_options&gt;</code>.</p>
</li>
<li>
<p><strong>x0 : 1-D array, optional</strong>
    Guess values of the decision variables, which will be refined by
    the optimization algorithm. This argument is currently used only by the
    'revised simplex' method, and can only be used if <code>x0</code> represents a
    basic feasible solution.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>res : OptimizeResult</strong></p>
</li>
<li>
<p><strong>A :class:<code>scipy.optimize.OptimizeResult</code> consisting of the fields:</strong></p>
</li>
<li>
<p><strong>x : 1-D array</strong>
            The values of the decision variables that minimizes the
            objective function while satisfying the constraints.</p>
</li>
<li>
<p><strong>fun : float</strong>
            The optimal value of the objective function <code>c @ x</code>.</p>
</li>
<li>
<p><strong>slack : 1-D array</strong>
            The (nominally positive) values of the slack variables,
            <code>b_ub - A_ub @ x</code>.</p>
</li>
<li>
<p><strong>con : 1-D array</strong>
            The (nominally zero) residuals of the equality constraints,
            <code>b_eq - A_eq @ x</code>.</p>
</li>
<li>
<p><strong>success : bool</strong>
            <code>True</code> when the algorithm succeeds in finding an optimal
            solution.</p>
</li>
<li>
<p><strong>status : int</strong>
            An integer representing the exit status of the algorithm.</p>
<div class="codehilite"><pre><span></span><code>    ``0`` : Optimization terminated successfully.

    ``1`` : Iteration limit reached.

    ``2`` : Problem appears to be infeasible.

    ``3`` : Problem appears to be unbounded.

    ``4`` : Numerical difficulties encountered.
</code></pre></div>


</li>
<li>
<p><strong>nit : int</strong>
            The total number of iterations performed in all phases.</p>
</li>
<li>
<p><strong>message : str</strong>
            A string descriptor of the exit status of the algorithm.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>show_options : Additional options accepted by the solvers.</strong></li>
</ul>
<h4>Notes</h4>
<p>This section describes the available solvers that can be selected by the
'method' parameter.</p>
<p>:ref:<code>'interior-point' &lt;optimize.linprog-interior-point&gt;</code> is the default
as it is typically the fastest and most robust method.
:ref:<code>'revised simplex' &lt;optimize.linprog-revised_simplex&gt;</code> is more
accurate for the problems it solves.
:ref:<code>'simplex' &lt;optimize.linprog-simplex&gt;</code> is the legacy method and is
included for backwards compatibility and educational purposes.</p>
<p>Method <em>interior-point</em> uses the primal-dual path following algorithm
as outlined in [4]_. This algorithm supports sparse constraint matrices and
is typically faster than the simplex methods, especially for large, sparse
problems. Note, however, that the solution returned may be slightly less
accurate than those of the simplex methods and will not, in general,
correspond with a vertex of the polytope defined by the constraints.</p>
<p>.. versionadded:: 1.0.0</p>
<p>Method <em>revised simplex</em> uses the revised simplex method as described in
[9]<em>, except that a factorization [11]</em> of the basis matrix, rather than
its inverse, is efficiently maintained and used to solve the linear systems
at each iteration of the algorithm.</p>
<p>.. versionadded:: 1.3.0</p>
<p>Method <em>simplex</em> uses a traditional, full-tableau implementation of
Dantzig's simplex algorithm [1]<em>, [2]</em> ( <em>not</em> the
Nelder-Mead simplex). This algorithm is included for backwards
compatibility and educational purposes.</p>
<p>.. versionadded:: 0.15.0</p>
<p>Before applying any method, a presolve procedure based on [8]_ attempts
to identify trivial infeasibilities, trivial unboundedness, and potential
problem simplifications. Specifically, it checks for:</p>
<ul>
<li>rows of zeros in <code>A_eq</code> or <code>A_ub</code>, representing trivial constraints;</li>
<li>columns of zeros in <code>A_eq</code> <code>and</code> <code>A_ub</code>, representing unconstrained
  variables;</li>
<li>column singletons in <code>A_eq</code>, representing fixed variables; and</li>
<li>column singletons in <code>A_ub</code>, representing simple bounds.</li>
</ul>
<p>If presolve reveals that the problem is unbounded (e.g. an unconstrained
and unbounded variable has negative cost) or infeasible (e.g., a row of
zeros in <code>A_eq</code> corresponds with a nonzero in <code>b_eq</code>), the solver
terminates with the appropriate status code. Note that presolve terminates
as soon as any sign of unboundedness is detected; consequently, a problem
may be reported as unbounded when in reality the problem is infeasible
(but infeasibility has not been detected yet). Therefore, if it is
important to know whether the problem is actually infeasible, solve the
problem again with option <code>presolve=False</code>.</p>
<p>If neither infeasibility nor unboundedness are detected in a single pass
of the presolve, bounds are tightened where possible and fixed
variables are removed from the problem. Then, linearly dependent rows
of the <code>A_eq</code> matrix are removed, (unless they represent an
infeasibility) to avoid numerical difficulties in the primary solve
routine. Note that rows that are nearly linearly dependent (within a
prescribed tolerance) may also be removed, which can change the optimal
solution in rare cases. If this is a concern, eliminate redundancy from
your problem formulation and run with option <code>rr=False</code> or
<code>presolve=False</code>.</p>
<p>Several potential improvements can be made here: additional presolve
checks outlined in [8]<em> should be implemented, the presolve routine should
be run multiple times (until no further simplifications can be made), and
more of the efficiency improvements from [5]</em> should be implemented in the
redundancy removal routines.</p>
<p>After presolve, the problem is transformed to standard form by converting
the (tightened) simple bounds to upper bound constraints, introducing
non-negative slack variables for inequality constraints, and expressing
unbounded variables as the difference between two non-negative variables.
Optionally, the problem is automatically scaled via equilibration [12]_.
The selected algorithm solves the standard form problem, and a
postprocessing routine converts the result to a solution to the original
problem.</p>
<h4>References</h4>
<p>.. [1] Dantzig, George B., Linear programming and extensions. Rand
       Corporation Research Study Princeton Univ. Press, Princeton, NJ,
       1963
.. [2] Hillier, S.H. and Lieberman, G.J. (1995), 'Introduction to
       Mathematical Programming', McGraw-Hill, Chapter 4.
.. [3] Bland, Robert G. New finite pivoting rules for the simplex method.
       Mathematics of Operations Research (2), 1977: pp. 103-107.
.. [4] Andersen, Erling D., and Knud D. Andersen. 'The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm.' High performance optimization. Springer US,
       2000. 197-232.
.. [5] Andersen, Erling D. 'Finding all linearly dependent rows in
       large-scale linear programming.' Optimization Methods and Software
       6.3 (1995): 219-227.
.. [6] Freund, Robert M. 'Primal-Dual Interior-Point Methods for Linear
       Programming based on Newton's Method.' Unpublished Course Notes,
       March 2004. Available 2/25/2017 at</p>
<ul>
<li>
<p><strong>https://ocw.mit.edu/courses/sloan-school-of-management/15-084j-nonlinear-programming-spring-2004/lecture-notes/lec14_int_pt_mthd.pdf</strong>
.. [7] Fourer, Robert. 'Solving Linear Programs by Interior-Point Methods.'
       Unpublished Course Notes, August 26, 2005. Available 2/25/2017 at</p>
</li>
<li>
<p><strong>http://www.4er.org/CourseNotes/Book%20B/B-III.pdf</strong>
.. [8] Andersen, Erling D., and Knud D. Andersen. 'Presolving in linear
       programming.' Mathematical Programming 71.2 (1995): 221-245.
.. [9] Bertsimas, Dimitris, and J. Tsitsiklis. 'Introduction to linear
       programming.' Athena Scientific 1 (1997): 997.
.. [10] Andersen, Erling D., et al. Implementation of interior point
        methods for large scale linear programming. HEC/Universite de
        Geneve, 1996.
.. [11] Bartels, Richard H. 'A stabilization of the simplex method.'
        Journal in  Numerische Mathematik 16.5 (1971): 414-434.
.. [12] Tomlin, J. A. 'On scaling linear programming problems.'
        Mathematical Programming Study 4 (1975): 146-166.</p>
</li>
</ul>
<h4>Examples</h4>
<p>Consider the following problem:</p>
<div>
<div class="MathJax_Preview">
    \min_{x_0, x_1} \ -x_0 + 4x_1 &amp; \\
    \mbox{such that} \ -3x_0 + x_1 &amp; \leq 6,\\
    -x_0 - 2x_1 &amp; \geq -4,\\
    x_1 &amp; \geq -3.
</div>
<script type="math/tex; mode=display">
    \min_{x_0, x_1} \ -x_0 + 4x_1 & \\
    \mbox{such that} \ -3x_0 + x_1 & \leq 6,\\
    -x_0 - 2x_1 & \geq -4,\\
    x_1 & \geq -3.
</script>
</div>
<p>The problem is not presented in the form accepted by <code>linprog</code>. This is
easily remedied by converting the 'greater than' inequality
constraint to a 'less than' inequality constraint by
multiplying both sides by a factor of :math:<code>-1</code>. Note also that the last
constraint is really the simple bound :math:<code>-3 \leq x_1 \leq \infty</code>.
Finally, since there are no bounds on :math:<code>x_0</code>, we must explicitly
specify the bounds :math:<code>-\infty \leq x_0 \leq \infty</code>, as the
default is for variables to be non-negative. After collecting coeffecients
into arrays and tuples, the input for this problem is:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">linprog</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">])</span>
</code></pre></div>

<p>Note that the default method for <code>linprog</code> is 'interior-point', which is
approximate by nature.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>
<p><strong>con: array([], dtype=float64)</strong></p>
</li>
<li>
<p><strong>fun: -21.99999984082494 # may vary</strong></p>
</li>
<li>
<p><strong>message: 'Optimization terminated successfully.'</strong></p>
</li>
<li>
<p><strong>nit: 6 # may vary</strong></p>
</li>
<li>
<p><strong>slack: array([3.89999997e+01, 8.46872439e-08] # may vary</strong></p>
</li>
<li>
<p><strong>status: 0</strong></p>
</li>
<li>
<p><strong>success: True</strong></p>
</li>
<li>
<p><strong>x: array([ 9.99999989, -2.99999999]) # may vary</strong></p>
</li>
</ul>
<p>If you need greater accuracy, try 'revised simplex'.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">x0_bounds</span><span class="p">,</span> <span class="n">x1_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;revised simplex&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>
<p><strong>con: array([], dtype=float64)</strong></p>
</li>
<li>
<p><strong>fun: -22.0 # may vary</strong></p>
</li>
<li>
<p><strong>message: 'Optimization terminated successfully.'</strong></p>
</li>
<li>
<p><strong>nit: 1 # may vary</strong></p>
</li>
<li>
<p><strong>slack: array([39.,  0.]) # may vary</strong></p>
</li>
<li>
<p><strong>status: 0</strong></p>
</li>
<li>
<p><strong>success: True</strong></p>
</li>
<li>
<p><strong>x: array([10., -3.]) # may vary</strong></p>
</li>
</ul>
</details>
<h3 id="linprog_verbose_callback">linprog_verbose_callback<a class="headerlink" href="#linprog_verbose_callback" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function linprog_verbose_callback</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">linprog_verbose_callback</span> <span class="o">:</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>A sample callback function demonstrating the linprog callback interface.
This callback produces detailed output to sys.stdout before each iteration
and after the final iteration of the simplex algorithm.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>res : A <code>scipy.optimize.OptimizeResult</code> consisting of the following fields:</strong></p>
</li>
<li>
<p><strong>x : 1-D array</strong>
        The independent variable vector which optimizes the linear
        programming problem.</p>
</li>
<li>
<p><strong>fun : float</strong>
        Value of the objective function.</p>
</li>
<li>
<p><strong>success : bool</strong>
        True if the algorithm succeeded in finding an optimal solution.</p>
</li>
<li>
<p><strong>slack : 1-D array</strong>
        The values of the slack variables. Each slack variable corresponds
        to an inequality constraint. If the slack is zero, then the
        corresponding constraint is active.</p>
</li>
<li>
<p><strong>con : 1-D array</strong>
        The (nominally zero) residuals of the equality constraints, that is,
        <code>b - A_eq @ x</code></p>
</li>
<li>
<p><strong>phase : int</strong>
        The phase of the optimization being executed. In phase 1 a basic
        feasible solution is sought and the T has an additional row
        representing an alternate objective function.</p>
</li>
<li>
<p><strong>status : int</strong>
        An integer representing the exit status of the optimization::</p>
</li>
<li>
<p><strong>0 : Optimization terminated successfully</strong></p>
</li>
<li>
<p><strong>1 : Iteration limit reached</strong></p>
</li>
<li>
<p><strong>2 : Problem appears to be infeasible</strong></p>
</li>
<li>
<p><strong>3 : Problem appears to be unbounded</strong></p>
</li>
<li>
<p><strong>4 : Serious numerical difficulties encountered</strong></p>
</li>
<li>
<p><strong>nit : int</strong>
        The number of iterations performed.</p>
</li>
<li>
<p><strong>message : str</strong>
        A string descriptor of the exit status of the optimization.</p>
</li>
</ul>
</details>
<h3 id="lsq_linear">lsq_linear<a class="headerlink" href="#lsq_linear" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function lsq_linear</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">lsq_linear</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Trf</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bvls</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lsq_solver</span><span class="o">:[`</span><span class="nc">Lsmr</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Exact</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">lsmr_tol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Auto</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">max_iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:[`</span><span class="nc">Two</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Zero</span> <span class="o">|</span> <span class="o">`</span><span class="nc">One</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">Sparse_matrix_of_LinearOperator</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">bool</span><span class="o">)</span>
</code></pre></div>

<p>Solve a linear least-squares problem with bounds on the variables.</p>
<p>Given a m-by-n design matrix A and a target vector b with m elements,
<code>lsq_linear</code> solves the following optimization problem::</p>
<div class="codehilite"><pre><span></span><code>minimize 0.5 * ||A x - b||**2
subject to lb &lt;= x &lt;= ub
</code></pre></div>


<p>This optimization problem is convex, hence a found minimum (if iterations
have converged) is guaranteed to be global.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>A : array_like, sparse matrix of LinearOperator, shape (m, n)</strong>
    Design matrix. Can be <code>scipy.sparse.linalg.LinearOperator</code>.</p>
</li>
<li>
<p><strong>b : array_like, shape (m,)</strong>
    Target vector.</p>
</li>
<li>
<p><strong>bounds : 2-tuple of array_like, optional</strong>
    Lower and upper bounds on independent variables. Defaults to no bounds.
    Each array must have shape (n,) or be a scalar, in the latter
    case a bound will be the same for all variables. Use <code>np.inf</code> with
    an appropriate sign to disable bounds on all or some variables.</p>
</li>
<li>
<p><strong>method : 'trf' or 'bvls', optional</strong>
    Method to perform minimization.</p>
<div class="codehilite"><pre><span></span><code>* &#39;trf&#39; : Trust Region Reflective algorithm adapted for a linear
  least-squares problem. This is an interior-point-like method
  and the required number of iterations is weakly correlated with
  the number of variables.
* &#39;bvls&#39; : Bounded-variable least-squares algorithm. This is
  an active set method, which requires the number of iterations
  comparable to the number of variables. Can&#39;t be used when `A` is
  sparse or LinearOperator.
</code></pre></div>


<p>Default is 'trf'.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    Tolerance parameter. The algorithm terminates if a relative change
    of the cost function is less than <code>tol</code> on the last iteration.
    Additionally, the first-order optimality measure is considered:</p>
<div class="codehilite"><pre><span></span><code>* ``method=&#39;trf&#39;`` terminates if the uniform norm of the gradient,
  scaled to account for the presence of the bounds, is less than
  `tol`.
* ``method=&#39;bvls&#39;`` terminates if Karush-Kuhn-Tucker conditions
  are satisfied within `tol` tolerance.
</code></pre></div>


</li>
<li>
<p><strong>lsq_solver : {None, 'exact', 'lsmr'}, optional</strong>
    Method of solving unbounded least-squares problems throughout
    iterations:</p>
<div class="codehilite"><pre><span></span><code>* &#39;exact&#39; : Use dense QR or SVD decomposition approach. Can&#39;t be
  used when `A` is sparse or LinearOperator.
* &#39;lsmr&#39; : Use `scipy.sparse.linalg.lsmr` iterative procedure
  which requires only matrix-vector product evaluations. Can&#39;t
  be used with ``method=&#39;bvls&#39;``.
</code></pre></div>


<p>If None (default), the solver is chosen based on type of <code>A</code>.</p>
</li>
<li>
<p><strong>lsmr_tol : None, float or 'auto', optional</strong>
    Tolerance parameters 'atol' and 'btol' for <code>scipy.sparse.linalg.lsmr</code>
    If None (default), it is set to <code>1e-2 * tol</code>. If 'auto', the
    tolerance will be adjusted based on the optimality of the current
    iterate, which can speed up the optimization process, but is not always
    reliable.</p>
</li>
<li>
<p><strong>max_iter : None or int, optional</strong>
    Maximum number of iterations before termination. If None (default), it
    is set to 100 for <code>method='trf'</code> or to the number of variables for
    <code>method='bvls'</code> (not counting iterations for 'bvls' initialization).</p>
</li>
<li>
<p><strong>verbose : {0, 1, 2}, optional</strong>
    Level of algorithm's verbosity:</p>
<div class="codehilite"><pre><span></span><code>* 0 : work silently (default).
* 1 : display a termination report.
* 2 : display progress during iterations.
</code></pre></div>


</li>
</ul>
<h4>Returns</h4>
<p>OptimizeResult with the following fields defined:</p>
<ul>
<li>
<p><strong>x : ndarray, shape (n,)</strong>
    Solution found.</p>
</li>
<li>
<p><strong>cost : float</strong>
    Value of the cost function at the solution.</p>
</li>
<li>
<p><strong>fun : ndarray, shape (m,)</strong>
    Vector of residuals at the solution.</p>
</li>
<li>
<p><strong>optimality : float</strong>
    First-order optimality measure. The exact meaning depends on <code>method</code>,
    refer to the description of <code>tol</code> parameter.</p>
</li>
<li>
<p><strong>active_mask : ndarray of int, shape (n,)</strong>
    Each component shows whether a corresponding constraint is active
    (that is, whether a variable is at the bound):</p>
<div class="codehilite"><pre><span></span><code>*  0 : a constraint is not active.
* -1 : a lower bound is active.
*  1 : an upper bound is active.
</code></pre></div>


<p>Might be somewhat arbitrary for the <code>trf</code> method as it generates a
sequence of strictly feasible iterates and active_mask is determined
within a tolerance threshold.</p>
</li>
<li>
<p><strong>nit : int</strong>
    Number of iterations. Zero if the unconstrained solution is optimal.</p>
</li>
<li>
<p><strong>status : int</strong>
    Reason for algorithm termination:</p>
<div class="codehilite"><pre><span></span><code>* -1 : the algorithm was not able to make progress on the last
  iteration.
*  0 : the maximum number of iterations is exceeded.
*  1 : the first-order optimality measure is less than `tol`.
*  2 : the relative change of the cost function is less than `tol`.
*  3 : the unconstrained solution is optimal.
</code></pre></div>


</li>
<li>
<p><strong>message : str</strong>
    Verbal description of the termination reason.</p>
</li>
<li>
<p><strong>success : bool</strong>
    True if one of the convergence criteria is satisfied (<code>status</code> &gt; 0).</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li>
<p><strong>nnls : Linear least squares with non-negativity constraint.</strong></p>
</li>
<li>
<p><strong>least_squares : Nonlinear least squares with bounds on the variables.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>The algorithm first computes the unconstrained least-squares solution by
<code>numpy.linalg.lstsq</code> or <code>scipy.sparse.linalg.lsmr</code> depending on
<code>lsq_solver</code>. This solution is returned as optimal if it lies within the
bounds.</p>
<p>Method 'trf' runs the adaptation of the algorithm described in [STIR]_ for
a linear least-squares problem. The iterations are essentially the same as
in the nonlinear least-squares algorithm, but as the quadratic function
model is always accurate, we don't need to track or modify the radius of
a trust region. The line search (backtracking) is used as a safety net
when a selected step does not decrease the cost function. Read more
detailed description of the algorithm in <code>scipy.optimize.least_squares</code>.</p>
<p>Method 'bvls' runs a Python implementation of the algorithm described in
[BVLS]_. The algorithm maintains active and free sets of variables, on
each iteration chooses a new variable to move from the active set to the
free set and then solves the unconstrained least-squares problem on free
variables. This algorithm is guaranteed to give an accurate solution
eventually, but may require up to n iterations for a problem with n
variables. Additionally, an ad-hoc initialization procedure is
implemented, that determines which variables to set free or active
initially. It takes some number of iterations before actual BVLS starts,
but can significantly reduce the number of further iterations.</p>
<h4>References</h4>
<p>.. [STIR] M. A. Branch, T. F. Coleman, and Y. Li, 'A Subspace, Interior,
          and Conjugate Gradient Method for Large-Scale Bound-Constrained
          Minimization Problems,' SIAM Journal on Scientific Computing,
          Vol. 21, Number 1, pp 1-23, 1999.
.. [BVLS] P. B. Start and R. L. Parker, 'Bounded-Variable Least-Squares:
          an Algorithm and Applications', Computational Statistics, 10,
          129-141, 1995.</p>
<h4>Examples</h4>
<p>In this example, a problem with a large sparse matrix and bounds on the
variables is solved.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">rand</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">lsq_linear</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">lb</span> <span class="o">+</span> <span class="mi">1</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">lsq_linear</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">),</span> <span class="n">lsmr_tol</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># may vary</span>
<span class="n">The</span> <span class="n">relative</span> <span class="n">change</span> <span class="n">of</span> <span class="n">the</span> <span class="n">cost</span> <span class="n">function</span> <span class="ow">is</span> <span class="n">less</span> <span class="n">than</span> <span class="err">`</span><span class="n">tol</span><span class="err">`</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="mi">16</span><span class="p">,</span> <span class="n">initial</span> <span class="n">cost</span> <span class="mf">1.5039e+04</span><span class="p">,</span> <span class="n">final</span> <span class="n">cost</span> <span class="mf">1.1112e+04</span><span class="p">,</span>
<span class="n">first</span><span class="o">-</span><span class="n">order</span> <span class="n">optimality</span> <span class="mf">4.66e-08</span><span class="o">.</span>
</code></pre></div>

</details>
<h3 id="minimize">minimize<a class="headerlink" href="#minimize" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function minimize</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">minimize</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">hess</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T3_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">T2_point</span> <span class="o">|</span> <span class="o">`</span><span class="nc">HessianUpdateStrategy</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">hessp</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">constraints</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimization of scalar function of one or more variables.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    The objective function to be minimized.</p>
<div class="codehilite"><pre><span></span><code>``fun(x, *args) -&gt; float``
</code></pre></div>


<p>where <code>x</code> is an 1-D array with shape (n,) and <code>args</code>
is a tuple of the fixed parameters needed to completely
specify the function.</p>
</li>
<li>
<p><strong>x0 : ndarray, shape (n,)</strong>
    Initial guess. Array of real elements of size (n,),
    where 'n' is the number of independent variables.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to the objective function and its
    derivatives (<code>fun</code>, <code>jac</code> and <code>hess</code> functions).</p>
</li>
<li>
<p><strong>method : str or callable, optional</strong>
    Type of solver.  Should be one of</p>
<div class="codehilite"><pre><span></span><code>- &#39;Nelder-Mead&#39; :ref:`(see here) &lt;optimize.minimize-neldermead&gt;`
- &#39;Powell&#39;      :ref:`(see here) &lt;optimize.minimize-powell&gt;`
- &#39;CG&#39;          :ref:`(see here) &lt;optimize.minimize-cg&gt;`
- &#39;BFGS&#39;        :ref:`(see here) &lt;optimize.minimize-bfgs&gt;`
- &#39;Newton-CG&#39;   :ref:`(see here) &lt;optimize.minimize-newtoncg&gt;`
- &#39;L-BFGS-B&#39;    :ref:`(see here) &lt;optimize.minimize-lbfgsb&gt;`
- &#39;TNC&#39;         :ref:`(see here) &lt;optimize.minimize-tnc&gt;`
- &#39;COBYLA&#39;      :ref:`(see here) &lt;optimize.minimize-cobyla&gt;`
- &#39;SLSQP&#39;       :ref:`(see here) &lt;optimize.minimize-slsqp&gt;`
- &#39;trust-constr&#39;:ref:`(see here) &lt;optimize.minimize-trustconstr&gt;`
- &#39;dogleg&#39;      :ref:`(see here) &lt;optimize.minimize-dogleg&gt;`
- &#39;trust-ncg&#39;   :ref:`(see here) &lt;optimize.minimize-trustncg&gt;`
- &#39;trust-exact&#39; :ref:`(see here) &lt;optimize.minimize-trustexact&gt;`
- &#39;trust-krylov&#39; :ref:`(see here) &lt;optimize.minimize-trustkrylov&gt;`
- custom - a callable object (added in version 0.14.0),
  see below for description.
</code></pre></div>


<p>If not given, chosen to be one of <code>BFGS</code>, <code>L-BFGS-B</code>, <code>SLSQP</code>,
depending if the problem has constraints or bounds.</p>
</li>
<li>
<p><strong>jac : {callable,  '2-point', '3-point', 'cs', bool}, optional</strong>
    Method for computing the gradient vector. Only for CG, BFGS,
    Newton-CG, L-BFGS-B, TNC, SLSQP, dogleg, trust-ncg, trust-krylov,
    trust-exact and trust-constr.
    If it is a callable, it should be a function that returns the gradient
    vector:</p>
<div class="codehilite"><pre><span></span><code>``jac(x, *args) -&gt; array_like, shape (n,)``
</code></pre></div>


<p>where <code>x</code> is an array with shape (n,) and <code>args</code> is a tuple with
the fixed parameters. If <code>jac</code> is a Boolean and is True, <code>fun</code> is
assumed to return and objective and gradient as and <code>(f, g)</code> tuple.
Methods 'Newton-CG', 'trust-ncg', 'dogleg', 'trust-exact', and
'trust-krylov' require that either a callable be supplied, or that
<code>fun</code> return the objective and gradient.
If None or False, the gradient will be estimated using 2-point finite
difference estimation with an absolute step size.
Alternatively, the keywords  {'2-point', '3-point', 'cs'} can be used
to select a finite difference scheme for numerical estimation of the
gradient with a relative step size. These finite difference schemes
obey any specified <code>bounds</code>.</p>
</li>
<li>
<p><strong>hess : {callable, '2-point', '3-point', 'cs', HessianUpdateStrategy}, optional</strong>
    Method for computing the Hessian matrix. Only for Newton-CG, dogleg,
    trust-ncg,  trust-krylov, trust-exact and trust-constr. If it is
    callable, it should return the  Hessian matrix:</p>
<div class="codehilite"><pre><span></span><code>``hess(x, *args) -&gt; {LinearOperator, spmatrix, array}, (n, n)``
</code></pre></div>


<p>where x is a (n,) ndarray and <code>args</code> is a tuple with the fixed
parameters. LinearOperator and sparse matrix returns are
allowed only for 'trust-constr' method. Alternatively, the keywords
{'2-point', '3-point', 'cs'} select a finite difference scheme
for numerical estimation. Or, objects implementing
<code>HessianUpdateStrategy</code> interface can be used to approximate
the Hessian. Available quasi-Newton methods implementing
this interface are:</p>
<div class="codehilite"><pre><span></span><code>- `BFGS`;
- `SR1`.
</code></pre></div>


<p>Whenever the gradient is estimated via finite-differences,
the Hessian cannot be estimated with options
{'2-point', '3-point', 'cs'} and needs to be
estimated using one of the quasi-Newton strategies.
Finite-difference options {'2-point', '3-point', 'cs'} and
<code>HessianUpdateStrategy</code> are available only for 'trust-constr' method.</p>
</li>
<li>
<p><strong>hessp : callable, optional</strong>
    Hessian of objective function times an arbitrary vector p. Only for
    Newton-CG, trust-ncg, trust-krylov, trust-constr.
    Only one of <code>hessp</code> or <code>hess</code> needs to be given.  If <code>hess</code> is
    provided, then <code>hessp</code> will be ignored.  <code>hessp</code> must compute the
    Hessian times an arbitrary vector:</p>
<div class="codehilite"><pre><span></span><code>``hessp(x, p, *args) -&gt;  ndarray shape (n,)``
</code></pre></div>


<p>where x is a (n,) ndarray, p is an arbitrary vector with
dimension (n,) and <code>args</code> is a tuple with the fixed
parameters.</p>
</li>
<li>
<p><strong>bounds : sequence or <code>Bounds</code>, optional</strong>
    Bounds on variables for L-BFGS-B, TNC, SLSQP, Powell, and
    trust-constr methods. There are two ways to specify the bounds:</p>
<div class="codehilite"><pre><span></span><code>1. Instance of `Bounds` class.
2. Sequence of ``(min, max)`` pairs for each element in `x`. None
   is used to specify no bound.
</code></pre></div>


</li>
<li>
<p><strong>constraints : {Constraint, dict} or List of {Constraint, dict}, optional</strong>
    Constraints definition (only for COBYLA, SLSQP and trust-constr).
    Constraints for 'trust-constr' are defined as a single object or a
    list of objects specifying constraints to the optimization problem.
    Available constraints are:</p>
<div class="codehilite"><pre><span></span><code>- `LinearConstraint`
- `NonlinearConstraint`
</code></pre></div>


<p>Constraints for COBYLA, SLSQP are defined as a list of dictionaries.
Each dictionary with fields:</p>
</li>
<li>
<p><strong>type : str</strong>
            Constraint type: 'eq' for equality, 'ineq' for inequality.</p>
</li>
<li>
<p><strong>fun : callable</strong>
            The function defining the constraint.</p>
</li>
<li>
<p><strong>jac : callable, optional</strong>
            The Jacobian of <code>fun</code> (only for SLSQP).</p>
</li>
<li>
<p><strong>args : sequence, optional</strong>
            Extra arguments to be passed to the function and Jacobian.</p>
<p>Equality constraint means that the constraint function result is to
be zero whereas inequality means that it is to be non-negative.
Note that COBYLA only supports inequality constraints.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    Tolerance for termination. For detailed control, use solver-specific
    options.</p>
</li>
<li>
<p><strong>options : dict, optional</strong>
    A dictionary of solver options. All methods accept the following
    generic options:</p>
</li>
<li>
<p><strong>maxiter : int</strong>
            Maximum number of iterations to perform. Depending on the
            method each iteration may use several function evaluations.</p>
</li>
<li>
<p><strong>disp : bool</strong>
            Set to True to print convergence messages.</p>
<p>For method-specific options, see :func:<code>show_options()</code>.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration. For 'trust-constr' it is a callable with
    the signature:</p>
<div class="codehilite"><pre><span></span><code>``callback(xk, OptimizeResult state) -&gt; bool``
</code></pre></div>


<p>where <code>xk</code> is the current parameter vector. and <code>state</code>
is an <code>OptimizeResult</code> object, with the same fields
as the ones from the return. If callback returns True
the algorithm execution is terminated.
For all the other methods, the signature is:</p>
<div class="codehilite"><pre><span></span><code>``callback(xk)``
</code></pre></div>


<p>where <code>xk</code> is the current parameter vector.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : OptimizeResult</strong>
    The optimization result represented as a <code>OptimizeResult</code> object.
    Important attributes are: <code>x</code> the solution array, <code>success</code> a
    Boolean flag indicating if the optimizer exited successfully and
    <code>message</code> which describes the cause of the termination. See
    <code>OptimizeResult</code> for a description of other attributes.</li>
</ul>
<h4>See also</h4>
<ul>
<li>
<p><strong>minimize_scalar : Interface to minimization algorithms for scalar</strong>
    univariate functions</p>
</li>
<li>
<p><strong>show_options : Additional options accepted by the solvers</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>This section describes the available solvers that can be selected by the
'method' parameter. The default method is <em>BFGS</em>.</p>
<p><strong>Unconstrained minimization</strong></p>
<ul>
<li>
<p><strong>Method :ref:<code>Nelder-Mead &lt;optimize.minimize-neldermead&gt;</code> uses the</strong>
Simplex algorithm [1]<em>, [2]</em>. This algorithm is robust in many
applications. However, if numerical computation of derivative can be
trusted, other algorithms using the first and/or second derivatives
information might be preferred for their better performance in
general.</p>
</li>
<li>
<p><strong>Method :ref:<code>CG &lt;optimize.minimize-cg&gt;</code> uses a nonlinear conjugate</strong>
gradient algorithm by Polak and Ribiere, a variant of the
Fletcher-Reeves method described in [5]_ pp.120-122. Only the
first derivatives are used.</p>
</li>
<li>
<p><strong>Method :ref:<code>BFGS &lt;optimize.minimize-bfgs&gt;</code> uses the quasi-Newton</strong>
method of Broyden, Fletcher, Goldfarb, and Shanno (BFGS) [5]_
pp. 136. It uses the first derivatives only. BFGS has proven good
performance even for non-smooth optimizations. This method also
returns an approximation of the Hessian inverse, stored as
<code>hess_inv</code> in the OptimizeResult object.</p>
</li>
<li>
<p><strong>Method :ref:<code>Newton-CG &lt;optimize.minimize-newtoncg&gt;</code> uses a</strong>
Newton-CG algorithm [5]_ pp. 168 (also known as the truncated
Newton method). It uses a CG method to the compute the search
direction. See also <em>TNC</em> method for a box-constrained
minimization with a similar algorithm. Suitable for large-scale
problems.</p>
</li>
<li>
<p><strong>Method :ref:<code>dogleg &lt;optimize.minimize-dogleg&gt;</code> uses the dog-leg</strong>
trust-region algorithm [5]_ for unconstrained minimization. This
algorithm requires the gradient and Hessian; furthermore the
Hessian is required to be positive definite.</p>
</li>
<li>
<p><strong>Method :ref:<code>trust-ncg &lt;optimize.minimize-trustncg&gt;</code> uses the</strong>
Newton conjugate gradient trust-region algorithm [5]_ for
unconstrained minimization. This algorithm requires the gradient
and either the Hessian or a function that computes the product of
the Hessian with a given vector. Suitable for large-scale problems.</p>
</li>
<li>
<p><strong>Method :ref:<code>trust-krylov &lt;optimize.minimize-trustkrylov&gt;</code> uses</strong>
the Newton GLTR trust-region algorithm [14]<em>, [15]</em> for unconstrained
minimization. This algorithm requires the gradient
and either the Hessian or a function that computes the product of
the Hessian with a given vector. Suitable for large-scale problems.
On indefinite problems it requires usually less iterations than the
<code>trust-ncg</code> method and is recommended for medium and large-scale problems.</p>
</li>
<li>
<p><strong>Method :ref:<code>trust-exact &lt;optimize.minimize-trustexact&gt;</code></strong>
is a trust-region method for unconstrained minimization in which
quadratic subproblems are solved almost exactly [13]_. This
algorithm requires the gradient and the Hessian (which is
<em>not</em> required to be positive definite). It is, in many
situations, the Newton method to converge in fewer iteraction
and the most recommended for small and medium-size problems.</p>
</li>
</ul>
<p><strong>Bound-Constrained minimization</strong></p>
<ul>
<li>
<p><strong>Method :ref:<code>L-BFGS-B &lt;optimize.minimize-lbfgsb&gt;</code> uses the L-BFGS-B</strong>
algorithm [6]<em>, [7]</em> for bound constrained minimization.</p>
</li>
<li>
<p><strong>Method :ref:<code>Powell &lt;optimize.minimize-powell&gt;</code> is a modification</strong>
of Powell's method [3]<em>, [4]</em> which is a conjugate direction
method. It performs sequential one-dimensional minimizations along
each vector of the directions set (<code>direc</code> field in <code>options</code> and
<code>info</code>), which is updated at each iteration of the main
minimization loop. The function need not be differentiable, and no
derivatives are taken. If bounds are not provided, then an
unbounded line search will be used. If bounds are provided and
the initial guess is within the bounds, then every function
evaluation throughout the minimization procedure will be within
the bounds. If bounds are provided, the initial guess is outside
the bounds, and <code>direc</code> is full rank (default has full rank), then
some function evaluations during the first iteration may be
outside the bounds, but every function evaluation after the first
iteration will be within the bounds. If <code>direc</code> is not full rank,
then some parameters may not be optimized and the solution is not
guaranteed to be within the bounds.</p>
</li>
<li>
<p><strong>Method :ref:<code>TNC &lt;optimize.minimize-tnc&gt;</code> uses a truncated Newton</strong>
algorithm [5]<em>, [8]</em> to minimize a function with variables subject
to bounds. This algorithm uses gradient information; it is also
called Newton Conjugate-Gradient. It differs from the <em>Newton-CG</em>
method described above as it wraps a C implementation and allows
each variable to be given upper and lower bounds.</p>
</li>
</ul>
<p><strong>Constrained Minimization</strong></p>
<ul>
<li>
<p><strong>Method :ref:<code>COBYLA &lt;optimize.minimize-cobyla&gt;</code> uses the</strong>
Constrained Optimization BY Linear Approximation (COBYLA) method
[9]<em>, [10]</em>, [11]_. The algorithm is based on linear
approximations to the objective function and each constraint. The
method wraps a FORTRAN implementation of the algorithm. The
constraints functions 'fun' may return either a single number
or an array or list of numbers.</p>
</li>
<li>
<p><strong>Method :ref:<code>SLSQP &lt;optimize.minimize-slsqp&gt;</code> uses Sequential</strong>
Least SQuares Programming to minimize a function of several
variables with any combination of bounds, equality and inequality
constraints. The method wraps the SLSQP Optimization subroutine
originally implemented by Dieter Kraft [12]_. Note that the
wrapper handles infinite values in bounds by converting them into
large floating values.</p>
</li>
<li>
<p><strong>Method :ref:<code>trust-constr &lt;optimize.minimize-trustconstr&gt;</code> is a</strong>
trust-region algorithm for constrained optimization. It swiches
between two implementations depending on the problem definition.
It is the most versatile constrained minimization algorithm
implemented in SciPy and the most appropriate for large-scale problems.
For equality constrained problems it is an implementation of Byrd-Omojokun
Trust-Region SQP method described in [17]<em> and in [5]</em>, p. 549. When
inequality constraints  are imposed as well, it swiches to the trust-region
interior point  method described in [16]_. This interior point algorithm,
in turn, solves inequality constraints by introducing slack variables
and solving a sequence of equality-constrained barrier problems
for progressively smaller values of the barrier parameter.
The previously described equality constrained SQP method is
used to solve the subproblems with increasing levels of accuracy
as the iterate gets closer to a solution.</p>
</li>
</ul>
<p><strong>Finite-Difference Options</strong></p>
<p>For Method :ref:<code>trust-constr &lt;optimize.minimize-trustconstr&gt;</code>
the gradient and the Hessian may be approximated using
three finite-difference schemes: {'2-point', '3-point', 'cs'}.
The scheme 'cs' is, potentially, the most accurate but it
requires the function to correctly handles complex inputs and to
be differentiable in the complex plane. The scheme '3-point' is more
accurate than '2-point' but requires twice as many operations.</p>
<p><strong>Custom minimizers</strong></p>
<p>It may be useful to pass a custom minimization method, for example
when using a frontend to this method such as <code>scipy.optimize.basinhopping</code>
or a different library.  You can simply pass a callable as the <code>method</code>
parameter.</p>
<p>The callable is called as <code>method(fun, x0, args, **kwargs, **options)</code>
where <code>kwargs</code> corresponds to any other parameters passed to <code>minimize</code>
(such as <code>callback</code>, <code>hess</code>, etc.), except the <code>options</code> dict, which has
its contents also passed as <code>method</code> parameters pair by pair.  Also, if
<code>jac</code> has been passed as a bool type, <code>jac</code> and <code>fun</code> are mangled so that
<code>fun</code> returns just the function values and <code>jac</code> is converted to a function
returning the Jacobian.  The method shall return an <code>OptimizeResult</code>
object.</p>
<p>The provided <code>method</code> callable must be able to accept (and possibly ignore)
arbitrary parameters; the set of parameters accepted by <code>minimize</code> may
expand in future versions and then these parameters will be passed to
the method.  You can find an example in the scipy.optimize tutorial.</p>
<p>.. versionadded:: 0.11.0</p>
<h4>References</h4>
<p>.. [1] Nelder, J A, and R Mead. 1965. A Simplex Method for Function
    Minimization. The Computer Journal 7: 308-13.
.. [2] Wright M H. 1996. Direct search methods: Once scorned, now
    respectable, in Numerical Analysis 1995: Proceedings of the 1995
    Dundee Biennial Conference in Numerical Analysis (Eds. D F
    Griffiths and G A Watson). Addison Wesley Longman, Harlow, UK.
    191-208.
.. [3] Powell, M J D. 1964. An efficient method for finding the minimum of
   a function of several variables without calculating derivatives. The
   Computer Journal 7: 155-162.
.. [4] Press W, S A Teukolsky, W T Vetterling and B P Flannery.
   Numerical Recipes (any edition), Cambridge University Press.
.. [5] Nocedal, J, and S J Wright. 2006. Numerical Optimization.
   Springer New York.
.. [6] Byrd, R H and P Lu and J. Nocedal. 1995. A Limited Memory
   Algorithm for Bound Constrained Optimization. SIAM Journal on
   Scientific and Statistical Computing 16 (5): 1190-1208.
.. [7] Zhu, C and R H Byrd and J Nocedal. 1997. L-BFGS-B: Algorithm</p>
<ul>
<li><strong>778: L-BFGS-B, FORTRAN routines for large scale bound constrained</strong>
   optimization. ACM Transactions on Mathematical Software 23 (4):
   550-560.
.. [8] Nash, S G. Newton-Type Minimization Via the Lanczos Method.</li>
<li>SIAM Journal of Numerical Analysis 21: 770-778.
.. [9] Powell, M J D. A direct search optimization method that models
   the objective and constraint functions by linear interpolation.</li>
<li>Advances in Optimization and Numerical Analysis, eds. S. Gomez
   and J-P Hennart, Kluwer Academic (Dordrecht), 51-67.
.. [10] Powell M J D. Direct search algorithms for optimization
   calculations. 1998. Acta Numerica 7: 287-336.
.. [11] Powell M J D. A view of algorithms for optimization without
   derivatives. 2007.Cambridge University Technical Report DAMTP
   2007/NA03
.. [12] Kraft, D. A software package for sequential quadratic
   programming. 1988. Tech. Rep. DFVLR-FB 88-28, DLR German Aerospace
   Center -- Institute for Flight Mechanics, Koln, Germany.
.. [13] Conn, A. R., Gould, N. I., and Toint, P. L.
   Trust region methods. 2000. Siam. pp. 169-200.
.. [14] F. Lenders, C. Kirches, A. Potschka: 'trlib: A vector-free
   implementation of the GLTR method for iterative solution of
   the trust region problem', https://arxiv.org/abs/1611.04718
.. [15] N. Gould, S. Lucidi, M. Roma, P. Toint: 'Solving the
   Trust-Region Subproblem using the Lanczos Method',
   SIAM J. Optim., 9(2), 504--525, (1999).
.. [16] Byrd, Richard H., Mary E. Hribar, and Jorge Nocedal. 1999.
    An interior point algorithm for large-scale nonlinear  programming.
    SIAM Journal on Optimization 9.4: 877-900.
.. [17] Lalee, Marucha, Jorge Nocedal, and Todd Plantega. 1998. On the
    implementation of an algorithm for large-scale equality constrained
    optimization. SIAM Journal on Optimization 8.3: 682-706.</li>
</ul>
<h4>Examples</h4>
<p>Let us consider the problem of minimizing the Rosenbrock function. This
function (and its respective derivatives) is implemented in <code>rosen</code>
(resp. <code>rosen_der</code>, <code>rosen_hess</code>) in the <code>scipy.optimize</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span><span class="p">,</span> <span class="n">rosen</span><span class="p">,</span> <span class="n">rosen_der</span>
</code></pre></div>

<p>A simple application of the <em>Nelder-Mead</em> method is:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">])</span>
</code></pre></div>

<p>Now using the <em>BFGS</em> algorithm, using the first derivative and a few
options:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BFGS&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">rosen_der</span><span class="p">,</span>
<span class="o">...</span>                <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;gtol&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
         <span class="n">Current</span> <span class="n">function</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.000000</span>
</code></pre></div>

<ul>
<li><strong>Iterations: 26</strong>
         Function evaluations: 31
         Gradient evaluations: 31
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
<span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span><span class="o">.</span><span class="n">hess_inv</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.00749589</span><span class="p">,</span>  <span class="mf">0.01255155</span><span class="p">,</span>  <span class="mf">0.02396251</span><span class="p">,</span>  <span class="mf">0.04750988</span><span class="p">,</span>  <span class="mf">0.09495377</span><span class="p">],</span>  <span class="c1"># may vary</span>
       <span class="p">[</span> <span class="mf">0.01255155</span><span class="p">,</span>  <span class="mf">0.02510441</span><span class="p">,</span>  <span class="mf">0.04794055</span><span class="p">,</span>  <span class="mf">0.09502834</span><span class="p">,</span>  <span class="mf">0.18996269</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.02396251</span><span class="p">,</span>  <span class="mf">0.04794055</span><span class="p">,</span>  <span class="mf">0.09631614</span><span class="p">,</span>  <span class="mf">0.19092151</span><span class="p">,</span>  <span class="mf">0.38165151</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.04750988</span><span class="p">,</span>  <span class="mf">0.09502834</span><span class="p">,</span>  <span class="mf">0.19092151</span><span class="p">,</span>  <span class="mf">0.38341252</span><span class="p">,</span>  <span class="mf">0.7664427</span> <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.09495377</span><span class="p">,</span>  <span class="mf">0.18996269</span><span class="p">,</span>  <span class="mf">0.38165151</span><span class="p">,</span>  <span class="mf">0.7664427</span><span class="p">,</span>   <span class="mf">1.53713523</span><span class="p">]])</span>
</code></pre></div></li>
</ul>
<p>Next, consider a minimization problem with several constraints (namely
Example 16.4 from [5]_). The objective function is:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<p>There are three constraints defined as:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">cons</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">},</span>
<span class="o">...</span>         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">6</span><span class="p">},</span>
<span class="o">...</span>         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div>

<p>And variables must be positive, hence the following bounds:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bnds</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</code></pre></div>

<p>The optimization problem is solved using the SLSQP method as:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bnds</span><span class="p">,</span>
<span class="o">...</span>                <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">)</span>
</code></pre></div>

<p>It should converge to the theoretical solution (1.4 ,1.7).</p>
</details>
<h3 id="minimize_scalar">minimize_scalar<a class="headerlink" href="#minimize_scalar" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function minimize_scalar</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">minimize_scalar</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">bracket</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Minimization of scalar function of one variable.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    Objective function.
    Scalar function, must return a scalar.</p>
</li>
<li>
<p><strong>bracket : sequence, optional</strong>
    For methods 'brent' and 'golden', <code>bracket</code> defines the bracketing
    interval and can either have three items <code>(a, b, c)</code> so that
    <code>a &lt; b &lt; c</code> and <code>fun(b) &lt; fun(a), fun(c)</code> or two items <code>a</code> and
    <code>c</code> which are assumed to be a starting interval for a downhill
    bracket search (see <code>bracket</code>); it doesn't always mean that the
    obtained solution will satisfy <code>a &lt;= x &lt;= c</code>.</p>
</li>
<li>
<p><strong>bounds : sequence, optional</strong>
    For method 'bounded', <code>bounds</code> is mandatory and must have two items
    corresponding to the optimization bounds.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to the objective function.</p>
</li>
<li>
<p><strong>method : str or callable, optional</strong>
    Type of solver.  Should be one of:</p>
<div class="codehilite"><pre><span></span><code>- &#39;Brent&#39;     :ref:`(see here) &lt;optimize.minimize_scalar-brent&gt;`
- &#39;Bounded&#39;   :ref:`(see here) &lt;optimize.minimize_scalar-bounded&gt;`
- &#39;Golden&#39;    :ref:`(see here) &lt;optimize.minimize_scalar-golden&gt;`
- custom - a callable object (added in version 0.14.0), see below
</code></pre></div>


</li>
<li>
<p><strong>tol : float, optional</strong>
    Tolerance for termination. For detailed control, use solver-specific
    options.</p>
</li>
<li>
<p><strong>options : dict, optional</strong>
    A dictionary of solver options.</p>
</li>
<li>
<p><strong>maxiter : int</strong>
            Maximum number of iterations to perform.</p>
</li>
<li>
<p><strong>disp : bool</strong>
            Set to True to print convergence messages.</p>
</li>
<li>
<p><strong>See :func:<code>show_options()</code> for solver-specific options.</strong></p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : OptimizeResult</strong>
    The optimization result represented as a <code>OptimizeResult</code> object.
    Important attributes are: <code>x</code> the solution array, <code>success</code> a
    Boolean flag indicating if the optimizer exited successfully and
    <code>message</code> which describes the cause of the termination. See
    <code>OptimizeResult</code> for a description of other attributes.</li>
</ul>
<h4>See also</h4>
<ul>
<li>
<p><strong>minimize : Interface to minimization algorithms for scalar multivariate</strong>
    functions</p>
</li>
<li>
<p><strong>show_options : Additional options accepted by the solvers</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>This section describes the available solvers that can be selected by the
'method' parameter. The default method is <em>Brent</em>.</p>
<ul>
<li>
<p><strong>Method :ref:<code>Brent &lt;optimize.minimize_scalar-brent&gt;</code> uses Brent's</strong>
algorithm to find a local minimum.  The algorithm uses inverse
parabolic interpolation when possible to speed up convergence of
the golden section method.</p>
</li>
<li>
<p><strong>Method :ref:<code>Golden &lt;optimize.minimize_scalar-golden&gt;</code> uses the</strong>
golden section search technique. It uses analog of the bisection
method to decrease the bracketed interval. It is usually
preferable to use the <em>Brent</em> method.</p>
</li>
<li>
<p><strong>Method :ref:<code>Bounded &lt;optimize.minimize_scalar-bounded&gt;</code> can</strong>
perform bounded minimization. It uses the Brent method to find a
local minimum in the interval x1 &lt; xopt &lt; x2.</p>
</li>
</ul>
<p><strong>Custom minimizers</strong></p>
<p>It may be useful to pass a custom minimization method, for example
when using some library frontend to minimize_scalar. You can simply
pass a callable as the <code>method</code> parameter.</p>
<p>The callable is called as <code>method(fun, args, **kwargs, **options)</code>
where <code>kwargs</code> corresponds to any other parameters passed to <code>minimize</code>
(such as <code>bracket</code>, <code>tol</code>, etc.), except the <code>options</code> dict, which has
its contents also passed as <code>method</code> parameters pair by pair.  The method
shall return an <code>OptimizeResult</code> object.</p>
<p>The provided <code>method</code> callable must be able to accept (and possibly ignore)
arbitrary parameters; the set of parameters accepted by <code>minimize</code> may
expand in future versions and then these parameters will be passed to
the method. You can find an example in the scipy.optimize tutorial.</p>
<p>.. versionadded:: 0.11.0</p>
<h4>Examples</h4>
<p>Consider the problem of minimizing the following function.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<p>Using the <em>Brent</em> method, we find the local minimum as:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize_scalar</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
<span class="mf">1.28077640403</span>
</code></pre></div>

<p>Using the <em>Bounded</em> method, we find a local minimum with specified
bounds as:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bounded&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
<span class="o">-</span><span class="mf">2.0000002026</span>
</code></pre></div>

</details>
<h3 id="newton_1">newton<a class="headerlink" href="#newton_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function newton</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">newton</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime2</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Sequence</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Ndarray</span> <span class="k">of</span> <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a zero of a real or complex function using the Newton-Raphson
(or secant or Halley's) method.</p>
<p>Find a zero of the function <code>func</code> given a nearby starting point <code>x0</code>.
The Newton-Raphson method is used if the derivative <code>fprime</code> of <code>func</code>
is provided, otherwise the secant method is used. If the second order
derivative <code>fprime2</code> of <code>func</code> is also provided, then Halley's method is
used.</p>
<p>If <code>x0</code> is a sequence with more than one item, then <code>newton</code> returns an
array, and <code>func</code> must be vectorized and return a sequence or array of the
same shape as its first argument. If <code>fprime</code> or <code>fprime2</code> is given, then
its return must also have the same shape.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The function whose zero is wanted. It must be a function of a
    single variable of the form <code>f(x,a,b,c...)</code>, where <code>a,b,c...</code>
    are extra arguments that can be passed in the <code>args</code> parameter.</p>
</li>
<li>
<p><strong>x0 : float, sequence, or ndarray</strong>
    An initial estimate of the zero that should be somewhere near the
    actual zero. If not scalar, then <code>func</code> must be vectorized and return
    a sequence or array of the same shape as its first argument.</p>
</li>
<li>
<p><strong>fprime : callable, optional</strong>
    The derivative of the function when available and convenient. If it
    is None (default), then the secant method is used.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments to be used in the function call.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    The allowable error of the zero value. If <code>func</code> is complex-valued,
    a larger <code>tol</code> is recommended as both the real and imaginary parts
    of <code>x</code> contribute to <code>|x - x0|</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations.</p>
</li>
<li>
<p><strong>fprime2 : callable, optional</strong>
    The second order derivative of the function when available and
    convenient. If it is None (default), then the normal Newton-Raphson
    or the secant method is used. If it is not None, then Halley's method
    is used.</p>
</li>
<li>
<p><strong>x1 : float, optional</strong>
    Another estimate of the zero that should be somewhere near the
    actual zero. Used if <code>fprime</code> is not provided.</p>
</li>
<li>
<p><strong>rtol : float, optional</strong>
    Tolerance (relative) for termination.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False (default), the root is returned.
    If True and <code>x0</code> is scalar, the return value is <code>(x, r)</code>, where <code>x</code>
    is the root and <code>r</code> is a <code>RootResults</code> object.
    If True and <code>x0</code> is non-scalar, the return value is <code>(x, converged,
    zero_der)</code> (see Returns section for details).</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise a RuntimeError if the algorithm didn't converge, with
    the error message containing the number of iterations and current
    function value. Otherwise, the convergence status is recorded in a
    <code>RootResults</code> return object.
    Ignored if <code>x0</code> is not scalar.</p>
</li>
<li>
<p><em><strong>Note: this has little to do with displaying, however,</strong>
    the <code>disp</code> keyword cannot be renamed for backwards compatibility.</em></p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>root : float, sequence, or ndarray</strong>
    Estimated location where function is zero.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code>, optional</strong>
    Present if <code>full_output=True</code> and <code>x0</code> is scalar.
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
<li>
<p><strong>converged : ndarray of bool, optional</strong>
    Present if <code>full_output=True</code> and <code>x0</code> is non-scalar.
    For vector functions, indicates which elements converged successfully.</p>
</li>
<li>
<p><strong>zero_der : ndarray of bool, optional</strong>
    Present if <code>full_output=True</code> and <code>x0</code> is non-scalar.
    For vector functions, indicates which elements had a zero derivative.</p>
</li>
</ul>
<h4>See Also</h4>
<p>brentq, brenth, ridder, bisect</p>
<ul>
<li><strong>fsolve : find zeros in N dimensions.</strong></li>
</ul>
<h4>Notes</h4>
<p>The convergence rate of the Newton-Raphson method is quadratic,
the Halley method is cubic, and the secant method is
sub-quadratic. This means that if the function is well-behaved
the actual error in the estimated zero after the nth iteration
is approximately the square (cube for Halley) of the error
after the (n-1)th step. However, the stopping criterion used
here is the step size and there is no guarantee that a zero
has been found. Consequently, the result should be verified.
Safer algorithms are brentq, brenth, ridder, and bisect,
but they all require that the root first be bracketed in an
interval where the function changes sign. The brentq algorithm
is recommended for general use in one dimensional problems
when such an interval has been found.</p>
<p>When <code>newton</code> is used with arrays, it is best suited for the following
types of problems:</p>
<ul>
<li>The initial guesses, <code>x0</code>, are all relatively the same distance from
  the roots.</li>
<li>Some or all of the extra arguments, <code>args</code>, are also arrays so that a
  class of similar problems can be solved together.</li>
<li>The size of the initial guesses, <code>x0</code>, is larger than O(100) elements.
  Otherwise, a naive loop may perform as well or better than a vector.</li>
</ul>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># only one real root at x = 1</span>
</code></pre></div>

<p><code>fprime</code> is not provided, use the secant method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0000000000000016</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0000000000000016</span>
</code></pre></div>

<p>Only <code>fprime</code> is provided, use the Newton-Raphson method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<p>Both <code>fprime2</code> and <code>fprime</code> are provided, use Halley's method:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>                        <span class="n">fprime2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<p>When we want to find zeros for a set of related starting values and/or
function parameters, we can provide both of those as an array of inputs:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fder</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">4321</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vec_res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">fder</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">))</span>
</code></pre></div>

<p>The above is the equivalent of solving for each value in <code>(x, a)</code>
separately in a for-loop, just faster:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">loop_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">fder</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a0</span><span class="p">,))</span>
<span class="o">...</span>             <span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">vec_res</span><span class="p">,</span> <span class="n">loop_res</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>

<p>Plot the results found for all values of <code>a</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">analytical_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">analytical_result</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">vec_res</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$a$&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x$ where $f(x, a)=0$&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="newton_krylov_1">newton_krylov<a class="headerlink" href="#newton_krylov_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function newton_krylov</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">newton_krylov</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">iter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rdiff</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Cgs</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Minres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Gmres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Lgmres</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bicgstab</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">inner_maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">inner_M</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">outer_k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">verbose</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">f_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x_rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol_norm</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">line_search</span><span class="o">:[`</span><span class="nc">Armijo</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Wolfe</span> <span class="o">|</span> <span class="o">`</span><span class="nc">None</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">kw</span><span class="o">:(</span><span class="kt">string</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="kt">list</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">xin</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a function, using Krylov approximation for inverse Jacobian.</p>
<p>This method is suitable for solving large-scale problems.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>F : function(x) -&gt; f</strong>
    Function whose root to find; should take and return an array-like
    object.</p>
</li>
<li>
<p><strong>xin : array_like</strong>
    Initial guess for the solution</p>
</li>
<li>
<p><strong>rdiff : float, optional</strong>
    Relative step size to use in numerical differentiation.</p>
</li>
<li>
<p><strong>method : {'lgmres', 'gmres', 'bicgstab', 'cgs', 'minres'} or function</strong>
    Krylov method to use to approximate the Jacobian.
    Can be a string, or a function implementing the same interface as
    the iterative solvers in <code>scipy.sparse.linalg</code>.</p>
<p>The default is <code>scipy.sparse.linalg.lgmres</code>.</p>
</li>
<li>
<p><strong>inner_maxiter : int, optional</strong>
    Parameter to pass to the 'inner' Krylov solver: maximum number of
    iterations. Iteration will stop after maxiter steps even if the
    specified tolerance has not been achieved.</p>
</li>
<li>
<p><strong>inner_M : LinearOperator or InverseJacobian</strong>
    Preconditioner for the inner Krylov iteration.
    Note that you can use also inverse Jacobians as (adaptive)
    preconditioners. For example,</p>
<blockquote>
<blockquote>
<blockquote>
<p>from scipy.optimize.nonlin import BroydenFirst, KrylovJacobian
from scipy.optimize.nonlin import InverseJacobian
jac = BroydenFirst()
kjac = KrylovJacobian(inner_M=InverseJacobian(jac))</p>
</blockquote>
</blockquote>
</blockquote>
<p>If the preconditioner has a method named 'update', it will be called
as <code>update(x, f)</code> after each nonlinear step, with <code>x</code> giving
the current point, and <code>f</code> the current function value.</p>
</li>
<li>
<p><strong>outer_k : int, optional</strong>
    Size of the subspace kept across LGMRES nonlinear iterations.
    See <code>scipy.sparse.linalg.lgmres</code> for details.</p>
</li>
<li>
<p><strong>inner_kwargs : kwargs</strong>
    Keyword parameters for the 'inner' Krylov solver
    (defined with <code>method</code>). Parameter names must start with
    the <code>inner_</code> prefix which will be stripped before passing on
    the inner method. See, e.g., <code>scipy.sparse.linalg.gmres</code> for details.</p>
</li>
<li>
<p><strong>iter : int, optional</strong>
    Number of iterations to make. If omitted (default), make as many
    as required to meet tolerances.</p>
</li>
<li>
<p><strong>verbose : bool, optional</strong>
    Print status to stdout on every iteration.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations to make. If more are needed to
    meet convergence, <code>NoConvergence</code> is raised.</p>
</li>
<li>
<p><strong>f_tol : float, optional</strong>
    Absolute tolerance (in max-norm) for the residual.
    If omitted, default is 6e-6.</p>
</li>
<li>
<p><strong>f_rtol : float, optional</strong>
    Relative tolerance for the residual. If omitted, not used.</p>
</li>
<li>
<p><strong>x_tol : float, optional</strong>
    Absolute minimum step size, as determined from the Jacobian
    approximation. If the step size is smaller than this, optimization
    is terminated as successful. If omitted, not used.</p>
</li>
<li>
<p><strong>x_rtol : float, optional</strong>
    Relative minimum step size. If omitted, not used.</p>
</li>
<li>
<p><strong>tol_norm : function(vector) -&gt; scalar, optional</strong>
    Norm to use in convergence check. Default is the maximum norm.</p>
</li>
<li>
<p><strong>line_search : {None, 'armijo' (default), 'wolfe'}, optional</strong>
    Which type of a line search to use to determine the step size in the
    direction given by the Jacobian approximation. Defaults to 'armijo'.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : ndarray</strong>
    An array (of similar array type as <code>x0</code>) containing the final solution.</li>
</ul>
<h4>Raises</h4>
<p>NoConvergence
    When a solution was not found.</p>
<h4>See Also</h4>
<ul>
<li><strong>root : Interface to root finding algorithms for multivariate</strong>
       functions. See <code>method=='krylov'</code> in particular.
scipy.sparse.linalg.gmres
scipy.sparse.linalg.lgmres</li>
</ul>
<h4>Notes</h4>
<p>This function implements a Newton-Krylov solver. The basic idea is
to compute the inverse of the Jacobian with an iterative Krylov
method. These methods require only evaluating the Jacobian-vector
products, which are conveniently approximated by a finite difference:</p>
<p>.. math:: J v \approx (f(x + \omega*v/|v|) - f(x)) / \omega</p>
<p>Due to the use of iterative matrix inverses, these methods can
deal with large nonlinear problems.</p>
<p>SciPy's <code>scipy.sparse.linalg</code> module offers a selection of Krylov
solvers to choose from. The default here is <code>lgmres</code>, which is a
variant of restarted GMRES iteration that reuses some of the
information obtained in the previous Newton steps to invert
Jacobians in subsequent steps.</p>
<p>For a review on Newton-Krylov methods, see for example [1]<em>,
and for the LGMRES sparse inverse method, see [2]</em>.</p>
<h4>References</h4>
<p>.. [1] D.A. Knoll and D.E. Keyes, J. Comp. Phys. 193, 357 (2004).
       :doi:<code>10.1016/j.jcp.2003.08.010</code>
.. [2] A.H. Baker and E.R. Jessup and T. Manteuffel,
       SIAM J. Matrix Anal. Appl. 26, 962 (2005).
       :doi:<code>10.1137/S0895479803422014</code></p>
</details>
<h3 id="nnls">nnls<a class="headerlink" href="#nnls" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function nnls</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">nnls</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">([`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">*</span> <span class="kt">float</span><span class="o">)</span>
</code></pre></div>

<p>Solve <code>argmin_x || Ax - b ||_2</code> for <code>x&gt;=0</code>. This is a wrapper
for a FORTRAN non-negative least squares solver.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>A : ndarray</strong>
    Matrix <code>A</code> as shown above.</p>
</li>
<li>
<p><strong>b : ndarray</strong>
    Right-hand side vector.</p>
</li>
<li>
<p><strong>maxiter: int, optional</strong>
    Maximum number of iterations, optional.
    Default is <code>3 * A.shape[1]</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x : ndarray</strong>
    Solution vector.</p>
</li>
<li>
<p><strong>rnorm : float</strong>
    The residual, <code>|| Ax-b ||_2</code>.</p>
</li>
</ul>
<h4>See Also</h4>
<ul>
<li><strong>lsq_linear : Linear least squares with bounds on the variables</strong></li>
</ul>
<h4>Notes</h4>
<p>The FORTRAN code was published in the book below. The algorithm
is an active set method. It solves the KKT (Karush-Kuhn-Tucker)
conditions for the non-negative least squares problem.</p>
<h4>References</h4>
<p>Lawson C., Hanson R.J., (1987) Solving Least Squares Problems, SIAM</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">nnls</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nnls</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.</span> <span class="p">]),</span> <span class="mf">0.7071067811865475</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nnls</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> <span class="mf">1.7320508075688772</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="ridder_1">ridder<a class="headerlink" href="#ridder_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function ridder</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">ridder</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a root of a function in an interval using Ridder's method.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a number. f must be continuous, and f(a) and
    f(b) must have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar</strong>
    One end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>b : scalar</strong>
    The other end of the bracketing interval [a,b].</p>
</li>
<li>
<p><strong>xtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative.</p>
</li>
<li>
<p><strong>rtol : number, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter cannot be smaller than its default value of
    <code>4*np.finfo(float).eps</code>.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>apply(f, (x)+args)</code>.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in any <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Zero of <code>f</code> between <code>a</code> and <code>b</code>.</p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence.
    In particular, <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>See Also</h4>
<p>brentq, brenth, bisect, newton : 1-D root-finding</p>
<ul>
<li><strong>fixed_point : scalar fixed-point finder</strong></li>
</ul>
<h4>Notes</h4>
<p>Uses [Ridders1979]<em> method to find a zero of the function <code>f</code> between the
arguments <code>a</code> and <code>b</code>. Ridders' method is faster than bisection, but not
generally as fast as the Brent routines. [Ridders1979]</em> provides the
classic description and source of the algorithm. A description can also be
found in any recent edition of Numerical Recipes.</p>
<p>The routine used here diverges slightly from standard presentations in
order to be a bit more careful of tolerance.</p>
<h4>References</h4>
<p>.. [Ridders1979]
   Ridders, C. F. J. 'A New Algorithm for Computing a
   Single Root of a Real Continuous Function.'
   IEEE Trans. Circuits Systems 26, 979-980, 1979.</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">ridder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">ridder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="o">-</span><span class="mf">1.0</span>
</code></pre></div>

</details>
<h3 id="root_1">root<a class="headerlink" href="#root_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function root</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">root</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">jac</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">tol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">fun_</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">x0</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a vector function.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>fun : callable</strong>
    A vector function to find a root of.</p>
</li>
<li>
<p><strong>x0 : ndarray</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to the objective function and its Jacobian.</p>
</li>
<li>
<p><strong>method : str, optional</strong>
    Type of solver. Should be one of</p>
<div class="codehilite"><pre><span></span><code>- &#39;hybr&#39;             :ref:`(see here) &lt;optimize.root-hybr&gt;`
- &#39;lm&#39;               :ref:`(see here) &lt;optimize.root-lm&gt;`
- &#39;broyden1&#39;         :ref:`(see here) &lt;optimize.root-broyden1&gt;`
- &#39;broyden2&#39;         :ref:`(see here) &lt;optimize.root-broyden2&gt;`
- &#39;anderson&#39;         :ref:`(see here) &lt;optimize.root-anderson&gt;`
- &#39;linearmixing&#39;     :ref:`(see here) &lt;optimize.root-linearmixing&gt;`
- &#39;diagbroyden&#39;      :ref:`(see here) &lt;optimize.root-diagbroyden&gt;`
- &#39;excitingmixing&#39;   :ref:`(see here) &lt;optimize.root-excitingmixing&gt;`
- &#39;krylov&#39;           :ref:`(see here) &lt;optimize.root-krylov&gt;`
- &#39;df-sane&#39;          :ref:`(see here) &lt;optimize.root-dfsane&gt;`
</code></pre></div>


</li>
<li>
<p><strong>jac : bool or callable, optional</strong>
    If <code>jac</code> is a Boolean and is True, <code>fun</code> is assumed to return the
    value of Jacobian along with the objective function. If False, the
    Jacobian will be estimated numerically.
    <code>jac</code> can also be a callable returning the Jacobian of <code>fun</code>. In
    this case, it must accept the same arguments as <code>fun</code>.</p>
</li>
<li>
<p><strong>tol : float, optional</strong>
    Tolerance for termination. For detailed control, use solver-specific
    options.</p>
</li>
<li>
<p><strong>callback : function, optional</strong>
    Optional callback function. It is called on every iteration as
    <code>callback(x, f)</code> where <code>x</code> is the current solution and <code>f</code>
    the corresponding residual. For all methods but 'hybr' and 'lm'.</p>
</li>
<li>
<p><strong>options : dict, optional</strong>
    A dictionary of solver options. E.g., <code>xtol</code> or <code>maxiter</code>, see
    :obj:<code>show_options()</code> for details.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : OptimizeResult</strong>
    The solution represented as a <code>OptimizeResult</code> object.
    Important attributes are: <code>x</code> the solution array, <code>success</code> a
    Boolean flag indicating if the algorithm exited successfully and
    <code>message</code> which describes the cause of the termination. See
    <code>OptimizeResult</code> for a description of other attributes.</li>
</ul>
<h4>See also</h4>
<ul>
<li><strong>show_options : Additional options accepted by the solvers</strong></li>
</ul>
<h4>Notes</h4>
<p>This section describes the available solvers that can be selected by the
'method' parameter. The default method is <em>hybr</em>.</p>
<p>Method <em>hybr</em> uses a modification of the Powell hybrid method as
implemented in MINPACK [1]_.</p>
<p>Method <em>lm</em> solves the system of nonlinear equations in a least squares
sense using a modification of the Levenberg-Marquardt algorithm as
implemented in MINPACK [1]_.</p>
<p>Method <em>df-sane</em> is a derivative-free spectral method. [3]_</p>
<p>Methods <em>broyden1</em>, <em>broyden2</em>, <em>anderson</em>, <em>linearmixing</em>,
<em>diagbroyden</em>, <em>excitingmixing</em>, <em>krylov</em> are inexact Newton methods,
with backtracking or full line searches [2]_. Each method corresponds
to a particular Jacobian approximations. See <code>nonlin</code> for details.</p>
<ul>
<li>Method <em>broyden1</em> uses Broyden's first Jacobian approximation, it is
  known as Broyden's good method.</li>
<li>Method <em>broyden2</em> uses Broyden's second Jacobian approximation, it
  is known as Broyden's bad method.</li>
<li>Method <em>anderson</em> uses (extended) Anderson mixing.</li>
<li>Method <em>Krylov</em> uses Krylov approximation for inverse Jacobian. It
  is suitable for large-scale problem.</li>
<li>Method <em>diagbroyden</em> uses diagonal Broyden Jacobian approximation.</li>
<li>Method <em>linearmixing</em> uses a scalar Jacobian approximation.</li>
<li>Method <em>excitingmixing</em> uses a tuned diagonal Jacobian
  approximation.</li>
</ul>
<p>.. warning::</p>
<div class="codehilite"><pre><span></span><code>The algorithms implemented for methods *diagbroyden*,
*linearmixing* and *excitingmixing* may be useful for specific
problems, but whether they will work may depend strongly on the
problem.
</code></pre></div>


<p>.. versionadded:: 0.11.0</p>
<h4>References</h4>
<p>.. [1] More, Jorge J., Burton S. Garbow, and Kenneth E. Hillstrom.
   1980. User Guide for MINPACK-1.
.. [2] C. T. Kelley. 1995. Iterative Methods for Linear and Nonlinear
   Equations. Society for Industrial and Applied Mathematics.
   <a href="https://archive.siam.org/books/kelley/fr16/">https://archive.siam.org/books/kelley/fr16/</a>
.. [3] W. La Cruz, J.M. Martinez, M. Raydan. Math. Comp. 75, 1429 (2006).</p>
<h4>Examples</h4>
<p>The following functions define a system of nonlinear equations and its
jacobian.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="o">...</span>             <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">jac</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>                       <span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
<span class="o">...</span>                      <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>                       <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>
</code></pre></div>

<p>A solution can be obtained as follows.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hybr&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.8411639</span><span class="p">,</span>  <span class="mf">0.1588361</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="root_scalar">root_scalar<a class="headerlink" href="#root_scalar" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function root_scalar</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">root_scalar</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">bracket</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">fprime2</span><span class="o">:[`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x0</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">x1</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:</span><span class="kt">float</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Find a root of a scalar function.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : callable</strong>
    A function to find a root of.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Extra arguments passed to the objective function and its derivative(s).</p>
</li>
<li>
<p><strong>method : str, optional</strong>
    Type of solver.  Should be one of</p>
<div class="codehilite"><pre><span></span><code>- &#39;bisect&#39;    :ref:`(see here) &lt;optimize.root_scalar-bisect&gt;`
- &#39;brentq&#39;    :ref:`(see here) &lt;optimize.root_scalar-brentq&gt;`
- &#39;brenth&#39;    :ref:`(see here) &lt;optimize.root_scalar-brenth&gt;`
- &#39;ridder&#39;    :ref:`(see here) &lt;optimize.root_scalar-ridder&gt;`
- &#39;toms748&#39;    :ref:`(see here) &lt;optimize.root_scalar-toms748&gt;`
- &#39;newton&#39;    :ref:`(see here) &lt;optimize.root_scalar-newton&gt;`
- &#39;secant&#39;    :ref:`(see here) &lt;optimize.root_scalar-secant&gt;`
- &#39;halley&#39;    :ref:`(see here) &lt;optimize.root_scalar-halley&gt;`
</code></pre></div>


</li>
<li>
<p><strong>bracket: A sequence of 2 floats, optional</strong>
    An interval bracketing a root.  <code>f(x, *args)</code> must have different
    signs at the two endpoints.</p>
</li>
<li>
<p><strong>x0 : float, optional</strong>
    Initial guess.</p>
</li>
<li>
<p><strong>x1 : float, optional</strong>
    A second guess.</p>
</li>
<li>
<p><strong>fprime : bool or callable, optional</strong>
    If <code>fprime</code> is a boolean and is True, <code>f</code> is assumed to return the
    value of the objective function and of the derivative.
    <code>fprime</code> can also be a callable returning the derivative of <code>f</code>. In
    this case, it must accept the same arguments as <code>f</code>.</p>
</li>
<li>
<p><strong>fprime2 : bool or callable, optional</strong>
    If <code>fprime2</code> is a boolean and is True, <code>f</code> is assumed to return the
    value of the objective function and of the
    first and second derivatives.
    <code>fprime2</code> can also be a callable returning the second derivative of <code>f</code>.
    In this case, it must accept the same arguments as <code>f</code>.</p>
</li>
<li>
<p><strong>xtol : float, optional</strong>
    Tolerance (absolute) for termination.</p>
</li>
<li>
<p><strong>rtol : float, optional</strong>
    Tolerance (relative) for termination.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    Maximum number of iterations.</p>
</li>
<li>
<p><strong>options : dict, optional</strong>
    A dictionary of solver options. E.g., <code>k</code>, see
    :obj:<code>show_options()</code> for details.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>sol : RootResults</strong>
    The solution represented as a <code>RootResults</code> object.
    Important attributes are: <code>root</code> the solution , <code>converged</code> a
    boolean flag indicating if the algorithm exited successfully and
    <code>flag</code> which describes the cause of the termination. See
    <code>RootResults</code> for a description of other attributes.</li>
</ul>
<h4>See also</h4>
<ul>
<li>
<p><strong>show_options : Additional options accepted by the solvers</strong></p>
</li>
<li>
<p><strong>root : Find a root of a vector function.</strong></p>
</li>
</ul>
<h4>Notes</h4>
<p>This section describes the available solvers that can be selected by the
'method' parameter.</p>
<p>The default is to use the best method available for the situation
presented.
If a bracket is provided, it may use one of the bracketing methods.
If a derivative and an initial value are specified, it may
select one of the derivative-based methods.
If no method is judged applicable, it will raise an Exception.</p>
<h4>Examples</h4>
<p>Find the root of a simple cubic</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># only one real root at x = 1</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fprime</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div>

<p>The <code>brentq</code> method takes as input a bracket</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;brentq&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">iterations</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">function_calls</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</code></pre></div>

<p>The <code>newton</code> method takes as input a single point and uses the derivative(s)</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">fprime</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;newton&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">iterations</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">function_calls</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
</code></pre></div>

<p>The function can provide the value and derivative(s) in a single call.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f_p_pp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">f_p_pp</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;newton&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">iterations</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">function_calls</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">f_p_pp</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fprime2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;halley&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">iterations</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">function_calls</span>
<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="rosen_1">rosen<a class="headerlink" href="#rosen_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">float</span>
</code></pre></div>

<p>The Rosenbrock function.</p>
<p>The function computed is::</p>
<ul>
<li><strong>sum(100.0*(x[1:] - x[:-1]</strong>2.0)<strong>2.0 + (1 - x[:-1])</strong>2.0)**</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-D array of points at which the Rosenbrock function is to be computed.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>f : float</strong>
    The value of the Rosenbrock function.</li>
</ul>
<h4>See Also</h4>
<p>rosen_der, rosen_hess, rosen_hess_prod</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="mf">76.56</span>
</code></pre></div>

</details>
<h3 id="rosen_der_1">rosen_der<a class="headerlink" href="#rosen_der_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen_der</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen_der</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>The derivative (i.e. gradient) of the Rosenbrock function.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-D array of points at which the derivative is to be computed.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>rosen_der : (N,) ndarray</strong>
    The gradient of the Rosenbrock function at <code>x</code>.</li>
</ul>
<h4>See Also</h4>
<p>rosen, rosen_hess, rosen_hess_prod</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen_der</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen_der</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">2.</span> <span class="p">,</span>  <span class="mf">10.6</span><span class="p">,</span>  <span class="mf">15.6</span><span class="p">,</span>  <span class="mf">13.4</span><span class="p">,</span>   <span class="mf">6.4</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">12.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.4</span><span class="p">,</span>  <span class="mf">62.</span> <span class="p">])</span>
</code></pre></div>

</details>
<h3 id="rosen_hess_1">rosen_hess<a class="headerlink" href="#rosen_hess_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen_hess</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen_hess</span> <span class="o">:</span>
  <span class="o">[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>The Hessian matrix of the Rosenbrock function.</p>
<h4>Parameters</h4>
<ul>
<li><strong>x : array_like</strong>
    1-D array of points at which the Hessian matrix is to be computed.</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>rosen_hess : ndarray</strong>
    The Hessian matrix of the Rosenbrock function at <code>x</code>.</li>
</ul>
<h4>See Also</h4>
<p>rosen, rosen_der, rosen_hess_prod</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen_hess</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen_hess</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">38.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">134.</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.</span><span class="p">,</span> <span class="mf">130.</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">]])</span>
</code></pre></div>

</details>
<h3 id="rosen_hess_prod_1">rosen_hess_prod<a class="headerlink" href="#rosen_hess_prod_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function rosen_hess_prod</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">rosen_hess_prod</span> <span class="o">:</span>
  <span class="n">x</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">p</span><span class="o">:[&gt;`</span><span class="nc">Ndarray</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">[`</span><span class="nc">ArrayLike</span><span class="o">|`</span><span class="nc">Ndarray</span><span class="o">|`</span><span class="nc">Object</span><span class="o">]</span> <span class="nn">Np</span><span class="p">.</span><span class="nn">Obj</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Product of the Hessian matrix of the Rosenbrock function with a vector.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>x : array_like</strong>
    1-D array of points at which the Hessian matrix is to be computed.</p>
</li>
<li>
<p><strong>p : array_like</strong>
    1-D array, the vector to be multiplied by the Hessian matrix.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>rosen_hess_prod : ndarray</strong>
    The Hessian matrix of the Rosenbrock function at <code>x</code> multiplied
    by the vector <code>p</code>.</li>
</ul>
<h4>See Also</h4>
<p>rosen, rosen_der, rosen_hess</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen_hess_prod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rosen_hess_prod</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span>  <span class="o">-</span><span class="mf">0.</span><span class="p">,</span>   <span class="mf">27.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">10.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">95.</span><span class="p">,</span> <span class="o">-</span><span class="mf">192.</span><span class="p">,</span> <span class="o">-</span><span class="mf">265.</span><span class="p">,</span> <span class="o">-</span><span class="mf">278.</span><span class="p">,</span> <span class="o">-</span><span class="mf">195.</span><span class="p">,</span> <span class="o">-</span><span class="mf">180.</span><span class="p">])</span>
</code></pre></div>

</details>
<h3 id="shgo">shgo<a class="headerlink" href="#shgo" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function shgo</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">shgo</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">constraints</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">n</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">iters</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">callback</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">minimizer_kwargs</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">options</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">sampling_method</span><span class="o">:[`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Callable</span> <span class="k">of</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">func</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">bounds</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Finds the global minimum of a function using SHG optimization.</p>
<p>SHGO stands for 'simplicial homology global optimization'.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>func : callable</strong>
    The objective function to be minimized.  Must be in the form
    <code>f(x, *args)</code>, where <code>x</code> is the argument in the form of a 1-D array
    and <code>args</code> is a tuple of any additional fixed parameters needed to
    completely specify the function.</p>
</li>
<li>
<p><strong>bounds : sequence</strong>
    Bounds for variables.  <code>(min, max)</code> pairs for each element in <code>x</code>,
    defining the lower and upper bounds for the optimizing argument of
    <code>func</code>. It is required to have <code>len(bounds) == len(x)</code>.
    <code>len(bounds)</code> is used to determine the number of parameters in <code>x</code>.
    Use <code>None</code> for one of min or max when there is no bound in that
    direction. By default bounds are <code>(None, None)</code>.</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    Any additional fixed parameters needed to completely specify the
    objective function.</p>
</li>
<li>
<p><strong>constraints : dict or sequence of dict, optional</strong>
    Constraints definition.
    Function(s) <code>R**n</code> in the form::</p>
<div class="codehilite"><pre><span></span><code>g(x) &gt;= 0 applied as g : R^n -&gt; R^m
h(x) == 0 applied as h : R^n -&gt; R^p
</code></pre></div>


<p>Each constraint is defined in a dictionary with fields:</p>
</li>
<li>
<p><strong>type : str</strong>
            Constraint type: 'eq' for equality, 'ineq' for inequality.</p>
</li>
<li>
<p><strong>fun : callable</strong>
            The function defining the constraint.</p>
</li>
<li>
<p><strong>jac : callable, optional</strong>
            The Jacobian of <code>fun</code> (only for SLSQP).</p>
</li>
<li>
<p><strong>args : sequence, optional</strong>
            Extra arguments to be passed to the function and Jacobian.</p>
<p>Equality constraint means that the constraint function result is to
be zero whereas inequality means that it is to be non-negative.
Note that COBYLA only supports inequality constraints.</p>
<p>.. note::</p>
<p>Only the COBYLA and SLSQP local minimize methods currently
   support constraint arguments. If the <code>constraints</code> sequence
   used in the local optimization problem is not defined in
   <code>minimizer_kwargs</code> and a constrained method is used then the
   global <code>constraints</code> will be used.
   (Defining a <code>constraints</code> sequence in <code>minimizer_kwargs</code>
   means that <code>constraints</code> will not be added so if equality
   constraints and so forth need to be added then the inequality
   functions in <code>constraints</code> need to be added to
   <code>minimizer_kwargs</code> too).</p>
</li>
<li>
<p><strong>n : int, optional</strong>
    Number of sampling points used in the construction of the simplicial
    complex. Note that this argument is only used for <code>sobol</code> and other
    arbitrary <code>sampling_methods</code>.</p>
</li>
<li>
<p><strong>iters : int, optional</strong>
    Number of iterations used in the construction of the simplicial complex.</p>
</li>
<li>
<p><strong>callback : callable, optional</strong>
    Called after each iteration, as <code>callback(xk)</code>, where <code>xk</code> is the
    current parameter vector.</p>
</li>
<li>
<p><strong>minimizer_kwargs : dict, optional</strong>
    Extra keyword arguments to be passed to the minimizer
    <code>scipy.optimize.minimize</code> Some important options could be:</p>
<div class="codehilite"><pre><span></span><code>* method : str
    The minimization method (e.g. ``SLSQP``).
* args : tuple
    Extra arguments passed to the objective function (``func``) and
    its derivatives (Jacobian, Hessian).
* options : dict, optional
    Note that by default the tolerance is specified as
    ``{ftol: 1e-12}``
</code></pre></div>


</li>
<li>
<p><strong>options : dict, optional</strong>
    A dictionary of solver options. Many of the options specified for the
    global routine are also passed to the scipy.optimize.minimize routine.
    The options that are also passed to the local routine are marked with
    '(L)'.</p>
<p>Stopping criteria, the algorithm will terminate if any of the specified
criteria are met. However, the default algorithm does not require any to
be specified:</p>
<ul>
<li>maxfev : int (L)
    Maximum number of function evaluations in the feasible domain.
    (Note only methods that support this option will terminate
    the routine at precisely exact specified value. Otherwise the
    criterion will only terminate during a global iteration)</li>
<li>f_min
    Specify the minimum objective function value, if it is known.</li>
<li>f_tol : float
    Precision goal for the value of f in the stopping
    criterion. Note that the global routine will also
    terminate if a sampling point in the global routine is
    within this tolerance.</li>
<li>maxiter : int
    Maximum number of iterations to perform.</li>
<li>maxev : int
    Maximum number of sampling evaluations to perform (includes
    searching in infeasible points).</li>
<li>maxtime : float
    Maximum processing runtime allowed</li>
<li>minhgrd : int
    Minimum homology group rank differential. The homology group of the
    objective function is calculated (approximately) during every
    iteration. The rank of this group has a one-to-one correspondence
    with the number of locally convex subdomains in the objective
    function (after adequate sampling points each of these subdomains
    contain a unique global minimum). If the difference in the hgr is 0
    between iterations for <code>maxhgrd</code> specified iterations the
    algorithm will terminate.</li>
</ul>
<p>Objective function knowledge:</p>
<ul>
<li>
<p>symmetry : bool
    Specify True if the objective function contains symmetric variables.
    The search space (and therefore performance) is decreased by O(n!).</p>
</li>
<li>
<p>jac : bool or callable, optional
    Jacobian (gradient) of objective function. Only for CG, BFGS,
    Newton-CG, L-BFGS-B, TNC, SLSQP, dogleg, trust-ncg. If <code>jac</code> is a
    boolean and is True, <code>fun</code> is assumed to return the gradient along
    with the objective function. If False, the gradient will be
    estimated numerically. <code>jac</code> can also be a callable returning the
    gradient of the objective. In this case, it must accept the same
    arguments as <code>fun</code>. (Passed to <code>scipy.optimize.minmize</code> automatically)</p>
</li>
<li>
<p>hess, hessp : callable, optional
    Hessian (matrix of second-order derivatives) of objective function
    or Hessian of objective function times an arbitrary vector p.
    Only for Newton-CG, dogleg, trust-ncg. Only one of <code>hessp</code> or
    <code>hess</code> needs to be given. If <code>hess</code> is provided, then
    <code>hessp</code> will be ignored. If neither <code>hess</code> nor <code>hessp</code> is
    provided, then the Hessian product will be approximated using
    finite differences on <code>jac</code>. <code>hessp</code> must compute the Hessian
    times an arbitrary vector. (Passed to <code>scipy.optimize.minmize</code>
    automatically)</p>
</li>
</ul>
<p>Algorithm settings:</p>
<ul>
<li>minimize_every_iter : bool
    If True then promising global sampling points will be passed to a
    local minimization routine every iteration. If False then only the
    final minimizer pool will be run. Defaults to False.</li>
<li>local_iter : int
    Only evaluate a few of the best minimizer pool candidates every
    iteration. If False all potential points are passed to the local
    minimization routine.</li>
<li>infty_constraints: bool
    If True then any sampling points generated which are outside will
    the feasible domain will be saved and given an objective function
    value of <code>inf</code>. If False then these points will be discarded.
    Using this functionality could lead to higher performance with
    respect to function evaluations before the global minimum is found,
    specifying False will use less memory at the cost of a slight
    decrease in performance. Defaults to True.</li>
</ul>
<p>Feedback:</p>
<ul>
<li>disp : bool (L)
    Set to True to print convergence messages.</li>
</ul>
</li>
<li>
<p><strong>sampling_method : str or function, optional</strong>
    Current built in sampling method options are <code>sobol</code> and
    <code>simplicial</code>. The default <code>simplicial</code> uses less memory and provides
    the theoretical guarantee of convergence to the global minimum in finite
    time. The <code>sobol</code> method is faster in terms of sampling point
    generation at the cost of higher memory resources and the loss of
    guaranteed convergence. It is more appropriate for most 'easier'
    problems where the convergence is relatively fast.
    User defined sampling functions must accept two arguments of <code>n</code>
    sampling points of dimension <code>dim</code> per call and output an array of
    sampling points with shape <code>n x dim</code>.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li><strong>res : OptimizeResult</strong>
    The optimization result represented as a <code>OptimizeResult</code> object.
    Important attributes are:
    <code>x</code> the solution array corresponding to the global minimum,
    <code>fun</code> the function output at the global solution,
    <code>xl</code> an ordered list of local minima solutions,
    <code>funl</code> the function output at the corresponding local solutions,
    <code>success</code> a Boolean flag indicating if the optimizer exited
    successfully,
    <code>message</code> which describes the cause of the termination,
    <code>nfev</code> the total number of objective function evaluations including
    the sampling calls,
    <code>nlfev</code> the total number of objective function evaluations
    culminating from all local search optimizations,
    <code>nit</code> number of iterations performed by the global routine.</li>
</ul>
<h4>Notes</h4>
<p>Global optimization using simplicial homology global optimization [1]_.
Appropriate for solving general purpose NLP and blackbox optimization
problems to global optimality (low-dimensional problems).</p>
<p>In general, the optimization problems are of the form::</p>
<div class="codehilite"><pre><span></span><code>minimize f(x) subject to

g_i(x) &gt;= 0,  i = 1,...,m
h_j(x)  = 0,  j = 1,...,p
</code></pre></div>


<p>where x is a vector of one or more variables. <code>f(x)</code> is the objective
function <code>R^n -&gt; R</code>, <code>g_i(x)</code> are the inequality constraints, and
<code>h_j(x)</code> are the equality constraints.</p>
<p>Optionally, the lower and upper bounds for each element in x can also be
specified using the <code>bounds</code> argument.</p>
<p>While most of the theoretical advantages of SHGO are only proven for when
<code>f(x)</code> is a Lipschitz smooth function, the algorithm is also proven to
converge to the global optimum for the more general case where <code>f(x)</code> is
non-continuous, non-convex and non-smooth, if the default sampling method
is used [1]_.</p>
<p>The local search method may be specified using the <code>minimizer_kwargs</code>
parameter which is passed on to <code>scipy.optimize.minimize</code>. By default,
the <code>SLSQP</code> method is used. In general, it is recommended to use the
<code>SLSQP</code> or <code>COBYLA</code> local minimization if inequality constraints
are defined for the problem since the other methods do not use constraints.</p>
<p>The <code>sobol</code> method points are generated using the Sobol (1967) [2]<em>
sequence. The primitive polynomials and various sets of initial direction
numbers for generating Sobol sequences is provided by [3]</em> by Frances Kuo
and Stephen Joe. The original program sobol.cc (MIT) is available and
described at https://web.maths.unsw.edu.au/~fkuo/sobol/ translated to
Python 3 by Carl Sandrock 2016-03-31.</p>
<h4>References</h4>
<p>.. [1] Endres, SC, Sandrock, C, Focke, WW (2018) 'A simplicial homology
       algorithm for lipschitz optimisation', Journal of Global Optimization.
.. [2] Sobol, IM (1967) 'The distribution of points in a cube and the
       approximate evaluation of integrals', USSR Comput. Math. Math. Phys.
       7, 86-112.
.. [3] Joe, SW and Kuo, FY (2008) 'Constructing Sobol sequences with
       better  two-dimensional projections', SIAM J. Sci. Comput. 30,
       2635-2654.
.. [4] Hoch, W and Schittkowski, K (1981) 'Test examples for nonlinear
       programming codes', Lecture Notes in Economics and Mathematical
       Systems, 187. Springer-Verlag, New York.</p>
<ul>
<li><strong>http://www.ai7.uni-bayreuth.de/test_problem_coll.pdf</strong>
.. [5] Wales, DJ (2015) 'Perspective: Insight into reaction coordinates and
       dynamics from the potential energy landscape',
       Journal of Chemical Physics, 142(13), 2015.</li>
</ul>
<h4>Examples</h4>
<p>First consider the problem of minimizing the Rosenbrock function, <code>rosen</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen</span><span class="p">,</span> <span class="n">shgo</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]),</span> <span class="mf">2.9203923741900809e-18</span><span class="p">)</span>
</code></pre></div>

<p>Note that bounds determine the dimensionality of the objective
function and is therefore a required input, however you can specify
empty bounds using <code>None</code> or objects like <code>np.inf</code> which will be
converted to large float numbers.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.99999851</span><span class="p">,</span>  <span class="mf">0.99999704</span><span class="p">,</span>  <span class="mf">0.99999411</span><span class="p">,</span>  <span class="mf">0.9999882</span> <span class="p">])</span>
</code></pre></div>

<p>Next, we consider the Eggholder function, a problem with several local
minima and one global minimum. We will demonstrate the use of arguments and
the capabilities of <code>shgo</code>.
(https://en.wikipedia.org/wiki/Test_functions_for_optimization)</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">eggholder</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">47.0</span><span class="p">)</span>
<span class="o">...</span>             <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">47.0</span><span class="p">))))</span>
<span class="o">...</span>             <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">47.0</span><span class="p">))))</span>
<span class="o">...</span>             <span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)]</span>
</code></pre></div>

<p><code>shgo</code> has two built-in low discrepancy sampling sequences. First, we will
input 30 initial sampling points of the Sobol sequence:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">eggholder</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">sampling_method</span><span class="o">=</span><span class="s1">&#39;sobol&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mf">512.</span>        <span class="p">,</span>  <span class="mf">404.23180542</span><span class="p">]),</span> <span class="o">-</span><span class="mf">959.64066272085051</span><span class="p">)</span>
</code></pre></div>

<p><code>shgo</code> also has a return for any other local minima that was found, these
can be called using:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">xl</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">512.</span>        <span class="p">,</span>  <span class="mf">404.23180542</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">283.07593402</span><span class="p">,</span> <span class="o">-</span><span class="mf">487.12566542</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">294.66820039</span><span class="p">,</span> <span class="o">-</span><span class="mf">462.01964031</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">105.87688985</span><span class="p">,</span>  <span class="mf">423.15324143</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">242.97923629</span><span class="p">,</span>  <span class="mf">274.38032063</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">506.25823477</span><span class="p">,</span>    <span class="mf">6.3131022</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">408.71981195</span><span class="p">,</span> <span class="o">-</span><span class="mf">156.10117154</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">150.23210485</span><span class="p">,</span>  <span class="mf">301.31378508</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">91.00922754</span><span class="p">,</span> <span class="o">-</span><span class="mf">391.28375925</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">202.8966344</span> <span class="p">,</span> <span class="o">-</span><span class="mf">269.38042147</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">361.66625957</span><span class="p">,</span> <span class="o">-</span><span class="mf">106.96490692</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">219.40615102</span><span class="p">,</span> <span class="o">-</span><span class="mf">244.06022436</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">151.59603137</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.61082677</span><span class="p">]])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">funl</span>
<span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">959.64066272</span><span class="p">,</span> <span class="o">-</span><span class="mf">718.16745962</span><span class="p">,</span> <span class="o">-</span><span class="mf">704.80659592</span><span class="p">,</span> <span class="o">-</span><span class="mf">565.99778097</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">559.78685655</span><span class="p">,</span> <span class="o">-</span><span class="mf">557.36868733</span><span class="p">,</span> <span class="o">-</span><span class="mf">507.87385942</span><span class="p">,</span> <span class="o">-</span><span class="mf">493.9605115</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">426.48799655</span><span class="p">,</span> <span class="o">-</span><span class="mf">421.15571437</span><span class="p">,</span> <span class="o">-</span><span class="mf">419.31194957</span><span class="p">,</span> <span class="o">-</span><span class="mf">410.98477763</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">202.53912972</span><span class="p">])</span>
</code></pre></div>

<p>These results are useful in applications where there are many global minima
and the values of other global minima are desired or where the local minima
can provide insight into the system (for example morphologies
in physical chemistry [5]_).</p>
<p>If we want to find a larger number of local minima, we can increase the
number of sampling points or the number of iterations. We'll increase the
number of sampling points to 60 and the number of iterations from the
default of 1 to 5. This gives us 60 x 5 = 300 initial sampling points.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">result_2</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">eggholder</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">iters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sampling_method</span><span class="o">=</span><span class="s1">&#39;sobol&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">xl</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_2</span><span class="o">.</span><span class="n">xl</span><span class="p">)</span>
<span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">39</span><span class="p">)</span>
</code></pre></div>

<p>Note the difference between, e.g., <code>n=180, iters=1</code> and <code>n=60, iters=3</code>.
In the first case the promising points contained in the minimiser pool
is processed only once. In the latter case it is processed every 60 sampling
points for a total of 3 times.</p>
<p>To demonstrate solving problems with non-linear constraints consider the
following example from Hock and Schittkowski problem 73 (cattle-feed) [4]_::</p>
<ul>
<li>
<p><strong>minimize: f = 24.55 * x_1 + 26.75 * x_2 + 39 * x_3 + 40.50 * x_4</strong></p>
<p>subject to: 2.3 * x_1 + 5.6 * x_2 + 11.1 * x_3 + 1.3 * x_4 - 5     &gt;= 0,</p>
<div class="codehilite"><pre><span></span><code>        12 * x_1 + 11.9 * x_2 + 41.8 * x_3 + 52.1 * x_4 - 21
            -1.645 * sqrt(0.28 * x_1**2 + 0.19 * x_2**2 +
                          20.5 * x_3**2 + 0.62 * x_4**2)       &gt;= 0,

        x_1 + x_2 + x_3 + x_4 - 1                              == 0,

        1 &gt;= x_i &gt;= 0 for all i
</code></pre></div>


</li>
</ul>
<p>The approximate answer given in [4]_ is::</p>
<div class="codehilite"><pre><span></span><code>f([0.6355216, -0.12e-11, 0.3127019, 0.05177655]) = 29.894378
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># (cattle-feed)</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mf">24.55</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">26.75</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">39</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">40.50</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">g1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mf">2.3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">5.6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">11.1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span>  <span class="c1"># &gt;=0</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">g2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">11.9</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mf">41.8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">52.1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">21</span>
<span class="o">...</span>             <span class="o">-</span> <span class="mf">1.645</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.28</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.19</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="o">...</span>                             <span class="o">+</span> <span class="mf">20.5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.62</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="o">...</span>             <span class="p">)</span> <span class="c1"># &gt;=0</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">h1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># == 0</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cons</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">g1</span><span class="p">},</span>
<span class="o">...</span>         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">g2</span><span class="p">},</span>
<span class="o">...</span>         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">h1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),]</span><span class="o">*</span><span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">iters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span>
</code></pre></div>

<ul>
<li>
<p><strong>fun: 29.894378159142136</strong></p>
</li>
<li>
<p><strong>funl: array([29.89437816])</strong></p>
</li>
<li>
<p><strong>message: 'Optimization terminated successfully.'</strong></p>
</li>
<li>
<p><strong>nfev: 114</strong></p>
</li>
<li>
<p><strong>nit: 3</strong></p>
</li>
<li>
<p><strong>nlfev: 35</strong></p>
</li>
<li>
<p><strong>nlhev: 0</strong></p>
</li>
<li>
<p><strong>nljev: 5</strong></p>
</li>
<li>
<p><strong>success: True</strong></p>
</li>
<li>
<p><strong>x: array([6.35521569e-01, 1.13700270e-13, 3.12701881e-01, 5.17765506e-02])</strong></p>
</li>
<li>
<p><strong>xl: array([[6.35521569e-01, 1.13700270e-13, 3.12701881e-01, 5.17765506e-02]])</strong></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">g1</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">g2</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">h1</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="p">(</span><span class="o">-</span><span class="mf">5.0626169922907138e-14</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9594104944408173e-12</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="show_options_1">show_options<a class="headerlink" href="#show_options_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function show_options</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">show_options</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">solver</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">method_</span><span class="o">:</span><span class="kt">string</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span>
</code></pre></div>

<p>Show documentation for additional options of optimization solvers.</p>
<p>These are method-specific options that can be supplied through the
<code>options</code> dict.</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>solver : str</strong>
    Type of optimization solver. One of 'minimize', 'minimize_scalar',
    'root', or 'linprog'.</p>
</li>
<li>
<p><strong>method : str, optional</strong>
    If not given, shows all methods of the specified solver. Otherwise,
    show only the options for the specified method. Valid values
    corresponds to methods' names of respective solver (e.g., 'BFGS' for
    'minimize').</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    Whether to print the result rather than returning it.</p>
</li>
</ul>
<h4>Returns</h4>
<p>text
    Either None (for disp=True) or the text string (disp=False)</p>
<h4>Notes</h4>
<p>The solver-specific methods are:</p>
<p><code>scipy.optimize.minimize</code></p>
<ul>
<li>:ref:<code>Nelder-Mead &lt;optimize.minimize-neldermead&gt;</code></li>
<li>:ref:<code>Powell      &lt;optimize.minimize-powell&gt;</code></li>
<li>:ref:<code>CG          &lt;optimize.minimize-cg&gt;</code></li>
<li>:ref:<code>BFGS        &lt;optimize.minimize-bfgs&gt;</code></li>
<li>:ref:<code>Newton-CG   &lt;optimize.minimize-newtoncg&gt;</code></li>
<li>:ref:<code>L-BFGS-B    &lt;optimize.minimize-lbfgsb&gt;</code></li>
<li>:ref:<code>TNC         &lt;optimize.minimize-tnc&gt;</code></li>
<li>:ref:<code>COBYLA      &lt;optimize.minimize-cobyla&gt;</code></li>
<li>:ref:<code>SLSQP       &lt;optimize.minimize-slsqp&gt;</code></li>
<li>:ref:<code>dogleg      &lt;optimize.minimize-dogleg&gt;</code></li>
<li>:ref:<code>trust-ncg   &lt;optimize.minimize-trustncg&gt;</code></li>
</ul>
<p><code>scipy.optimize.root</code></p>
<ul>
<li>:ref:<code>hybr              &lt;optimize.root-hybr&gt;</code></li>
<li>:ref:<code>lm                &lt;optimize.root-lm&gt;</code></li>
<li>:ref:<code>broyden1          &lt;optimize.root-broyden1&gt;</code></li>
<li>:ref:<code>broyden2          &lt;optimize.root-broyden2&gt;</code></li>
<li>:ref:<code>anderson          &lt;optimize.root-anderson&gt;</code></li>
<li>:ref:<code>linearmixing      &lt;optimize.root-linearmixing&gt;</code></li>
<li>:ref:<code>diagbroyden       &lt;optimize.root-diagbroyden&gt;</code></li>
<li>:ref:<code>excitingmixing    &lt;optimize.root-excitingmixing&gt;</code></li>
<li>:ref:<code>krylov            &lt;optimize.root-krylov&gt;</code></li>
<li>:ref:<code>df-sane           &lt;optimize.root-dfsane&gt;</code></li>
</ul>
<p><code>scipy.optimize.minimize_scalar</code></p>
<ul>
<li>:ref:<code>brent       &lt;optimize.minimize_scalar-brent&gt;</code></li>
<li>:ref:<code>golden      &lt;optimize.minimize_scalar-golden&gt;</code></li>
<li>:ref:<code>bounded     &lt;optimize.minimize_scalar-bounded&gt;</code></li>
</ul>
<p><code>scipy.optimize.linprog</code></p>
<ul>
<li>:ref:<code>simplex         &lt;optimize.linprog-simplex&gt;</code></li>
<li>:ref:<code>interior-point  &lt;optimize.linprog-interior-point&gt;</code></li>
</ul>
<h4>Examples</h4>
<p>We can print documentations of a solver in stdout:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">show_options</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">show_options</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>

<p>Specifying a method is possible:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">show_options</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>

<p>We can also get the documentations as a string:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">show_options</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Minimization</span> <span class="n">of</span> <span class="n">scalar</span> <span class="n">function</span> <span class="n">of</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">variables</span> <span class="n">using</span> <span class="n">the</span> <span class="o">...</span>
</code></pre></div>

</details>
<h3 id="toms748_1">toms748<a class="headerlink" href="#toms748_1" title="Permanent link">&para;</a></h3>
<details class="note" open="open"><summary>function toms748</summary><div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">toms748</span> <span class="o">:</span>
  <span class="o">?</span><span class="n">args</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">k</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">xtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">rtol</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">maxiter</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">full_output</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="o">?</span><span class="n">disp</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
  <span class="n">f</span><span class="o">:</span><span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
  <span class="n">a</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="n">b</span><span class="o">:[`</span><span class="nc">F</span> <span class="k">of</span> <span class="kt">float</span> <span class="o">|</span> <span class="o">`</span><span class="nc">I</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">|</span> <span class="o">`</span><span class="nc">Bool</span> <span class="k">of</span> <span class="kt">bool</span> <span class="o">|</span> <span class="o">`</span><span class="nc">S</span> <span class="k">of</span> <span class="kt">string</span><span class="o">]</span> <span class="o">-&gt;</span>
  <span class="kt">unit</span> <span class="o">-&gt;</span>
  <span class="o">(</span><span class="kt">float</span> <span class="o">*</span> <span class="nn">Py</span><span class="p">.</span><span class="nn">Object</span><span class="p">.</span><span class="n">t</span><span class="o">)</span>
</code></pre></div>

<p>Find a zero using TOMS Algorithm 748 method.</p>
<p>Implements the Algorithm 748 method of Alefeld, Potro and Shi to find a
zero of the function <code>f</code> on the interval <code>[a , b]</code>, where <code>f(a)</code> and
<code>f(b)</code> must have opposite signs.</p>
<p>It uses a mixture of inverse cubic interpolation and
'Newton-quadratic' steps. [APS1995].</p>
<h4>Parameters</h4>
<ul>
<li>
<p><strong>f : function</strong>
    Python function returning a scalar. The function :math:<code>f</code>
    must be continuous, and :math:<code>f(a)</code> and :math:<code>f(b)</code>
    have opposite signs.</p>
</li>
<li>
<p><strong>a : scalar,</strong>
    lower boundary of the search interval</p>
</li>
<li>
<p><strong>b : scalar,</strong>
    upper boundary of the search interval</p>
</li>
<li>
<p><strong>args : tuple, optional</strong>
    containing extra arguments for the function <code>f</code>.
    <code>f</code> is called by <code>f(x, *args)</code>.</p>
</li>
<li>
<p><strong>k : int, optional</strong>
    The number of Newton quadratic steps to perform each
    iteration. <code>k&gt;=1</code>.</p>
</li>
<li>
<p><strong>xtol : scalar, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root. The
    parameter must be nonnegative.</p>
</li>
<li>
<p><strong>rtol : scalar, optional</strong>
    The computed root <code>x0</code> will satisfy <code>np.allclose(x, x0,
    atol=xtol, rtol=rtol)</code>, where <code>x</code> is the exact root.</p>
</li>
<li>
<p><strong>maxiter : int, optional</strong>
    If convergence is not achieved in <code>maxiter</code> iterations, an error is
    raised. Must be &gt;= 0.</p>
</li>
<li>
<p><strong>full_output : bool, optional</strong>
    If <code>full_output</code> is False, the root is returned. If <code>full_output</code> is
    True, the return value is <code>(x, r)</code>, where <code>x</code> is the root, and <code>r</code> is
    a <code>RootResults</code> object.</p>
</li>
<li>
<p><strong>disp : bool, optional</strong>
    If True, raise RuntimeError if the algorithm didn't converge.
    Otherwise, the convergence status is recorded in the <code>RootResults</code>
    return object.</p>
</li>
</ul>
<h4>Returns</h4>
<ul>
<li>
<p><strong>x0 : float</strong>
    Approximate Zero of <code>f</code></p>
</li>
<li>
<p><strong>r : <code>RootResults</code> (present if <code>full_output = True</code>)</strong>
    Object containing information about the convergence. In particular,
    <code>r.converged</code> is True if the routine converged.</p>
</li>
</ul>
<h4>See Also</h4>
<p>brentq, brenth, ridder, bisect, newton</p>
<ul>
<li><strong>fsolve : find zeroes in N dimensions.</strong></li>
</ul>
<h4>Notes</h4>
<p><code>f</code> must be continuous.
Algorithm 748 with <code>k=2</code> is asymptotically the most efficient
algorithm known for finding roots of a four times continuously
differentiable function.
In contrast with Brent's algorithm, which may only decrease the length of
the enclosing bracket on the last step, Algorithm 748 decreases it each
iteration with the same asymptotic efficiency as it finds the root.</p>
<p>For easy statement of efficiency indices, assume that <code>f</code> has 4
continuouous deriviatives.
For <code>k=1</code>, the convergence order is at least 2.7, and with about
asymptotically 2 function evaluations per iteration, the efficiency
index is approximately 1.65.
For <code>k=2</code>, the order is about 4.6 with asymptotically 3 function
evaluations per iteration, and the efficiency index 1.66.
For higher values of <code>k</code>, the efficiency index approaches
the kth root of <code>(3k-2)</code>, hence <code>k=1</code> or <code>k=2</code> are
usually appropriate.</p>
<h4>References</h4>
<p>.. [APS1995]
   Alefeld, G. E. and Potra, F. A. and Shi, Yixun,
   <em>Algorithm 748: Enclosing Zeros of Continuous Functions</em>,
   ACM Trans. Math. Softw. Volume 221(1995)
   doi = {10.1145/210089.210111}</p>
<h4>Examples</h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># only one real root at x = 1</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">toms748</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span>
<span class="mf">1.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">results</span>
</code></pre></div>

<ul>
<li>
<p><strong>converged: True</strong></p>
</li>
<li>
<p><strong>flag: 'converged'</strong></p>
</li>
<li>
<p><strong>function_calls: 11</strong></p>
</li>
<li>
<p><strong>iterations: 5</strong></p>
</li>
<li>
<p><strong>root: 1.0</strong></p>
</li>
</ul>
</details>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../Odr/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Odr
              </div>
            </div>
          </a>
        
        
          <a href="../Setup/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Setup
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['instant', 'tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>