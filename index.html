


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    
      
        <title>OCaml scikit-learn interface</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-support-vector-regresion-with-rbf-kernel" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="." title="OCaml scikit-learn interface" class="md-header-nav__button md-logo" aria-label="OCaml scikit-learn interface">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OCaml scikit-learn interface
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              scikit-learn for OCaml, version 0.22-0.1.3
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/lehy/ocaml-sklearn/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lehy/ocaml-sklearn
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="OCaml scikit-learn interface" class="md-nav__button md-logo" aria-label="OCaml scikit-learn interface">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    OCaml scikit-learn interface
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/lehy/ocaml-sklearn/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lehy/ocaml-sklearn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        scikit-learn for OCaml, version 0.22-0.1.3
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="." title="scikit-learn for OCaml, version 0.22-0.1.3" class="md-nav__link md-nav__link--active">
      scikit-learn for OCaml, version 0.22-0.1.3
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-support-vector-regresion-with-rbf-kernel" class="md-nav__link">
    Example : support vector regresion with RBF kernel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finding-pythons-scikit-learn-at-runtime" class="md-nav__link">
    Finding Python's scikit-learn at runtime
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-notes" class="md-nav__link">
    Development notes
  </a>
  
    <nav class="md-nav" aria-label="Development notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-requirements" class="md-nav__link">
    Python requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests" class="md-nav__link">
    Running tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-documentation" class="md-nav__link">
    Generating documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="base/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="calibration/" title="Calibration" class="md-nav__link">
      Calibration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="cluster/" title="Cluster" class="md-nav__link">
      Cluster
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="compose/" title="Compose" class="md-nav__link">
      Compose
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="conftest/" title="Conftest" class="md-nav__link">
      Conftest
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="covariance/" title="Covariance" class="md-nav__link">
      Covariance
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="cross_decomposition/" title="Cross decomposition" class="md-nav__link">
      Cross decomposition
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="datasets/" title="Datasets" class="md-nav__link">
      Datasets
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="decomposition/" title="Decomposition" class="md-nav__link">
      Decomposition
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="discriminant_analysis/" title="Discriminant analysis" class="md-nav__link">
      Discriminant analysis
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="dummy/" title="Dummy" class="md-nav__link">
      Dummy
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="ensemble/" title="Ensemble" class="md-nav__link">
      Ensemble
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="exceptions/" title="Exceptions" class="md-nav__link">
      Exceptions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="experimental/" title="Experimental" class="md-nav__link">
      Experimental
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="externals/" title="Externals" class="md-nav__link">
      Externals
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="feature_extraction/" title="Feature extraction" class="md-nav__link">
      Feature extraction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="feature_selection/" title="Feature selection" class="md-nav__link">
      Feature selection
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="gaussian_process/" title="Gaussian process" class="md-nav__link">
      Gaussian process
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="impute/" title="Impute" class="md-nav__link">
      Impute
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="inspection/" title="Inspection" class="md-nav__link">
      Inspection
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="isotonic/" title="Isotonic" class="md-nav__link">
      Isotonic
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="kernel_approximation/" title="Kernel approximation" class="md-nav__link">
      Kernel approximation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="kernel_ridge/" title="Kernel ridge" class="md-nav__link">
      Kernel ridge
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="linear_model/" title="Linear model" class="md-nav__link">
      Linear model
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="manifold/" title="Manifold" class="md-nav__link">
      Manifold
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="metrics/" title="Metrics" class="md-nav__link">
      Metrics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="mixture/" title="Mixture" class="md-nav__link">
      Mixture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="model_selection/" title="Model selection" class="md-nav__link">
      Model selection
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="multiclass/" title="Multiclass" class="md-nav__link">
      Multiclass
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="multioutput/" title="Multioutput" class="md-nav__link">
      Multioutput
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="naive_bayes/" title="Naive bayes" class="md-nav__link">
      Naive bayes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="neighbors/" title="Neighbors" class="md-nav__link">
      Neighbors
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="neural_network/" title="Neural network" class="md-nav__link">
      Neural network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="pipeline/" title="Pipeline" class="md-nav__link">
      Pipeline
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="preprocessing/" title="Preprocessing" class="md-nav__link">
      Preprocessing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="random_projection/" title="Random projection" class="md-nav__link">
      Random projection
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="semi_supervised/" title="Semi supervised" class="md-nav__link">
      Semi supervised
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="svm/" title="Svm" class="md-nav__link">
      Svm
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="tests/" title="Tests" class="md-nav__link">
      Tests
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="tree/" title="Tree" class="md-nav__link">
      Tree
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="utils/" title="Utils" class="md-nav__link">
      Utils
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-support-vector-regresion-with-rbf-kernel" class="md-nav__link">
    Example : support vector regresion with RBF kernel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finding-pythons-scikit-learn-at-runtime" class="md-nav__link">
    Finding Python's scikit-learn at runtime
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-notes" class="md-nav__link">
    Development notes
  </a>
  
    <nav class="md-nav" aria-label="Development notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-requirements" class="md-nav__link">
    Python requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests" class="md-nav__link">
    Running tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-documentation" class="md-nav__link">
    Generating documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/lehy/ocaml-sklearn/edit/master/docs/README.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <h1>scikit-learn for OCaml, version 0.22-0.1.3</h1>
<p>ocaml-sklearn allows using Python's
<a href="https://scikit-learn.org/">scikit-learn</a> machine learning library
from OCaml.</p>
<p><a href="https://lehy.github.io/ocaml-sklearn/">Read the online scikit-learn OCaml API documentation
here.</a></p>
<p>If you are not familiar with scikit-learn, consult its Python <a href="https://scikit-learn.org/stable/getting_started.html">getting
started documentation</a>
and <a href="https://scikit-learn.org/stable/user_guide.html">user guide</a>.</p>
<p><strong>The current OCaml API is not complete. Some functions may be hard or
impossible to use. Also, the existing API is not stable, it may change
to accomodate more functionality or make things easier to use.</strong></p>
<h2 id="example-support-vector-regresion-with-rbf-kernel">Example : support vector regresion with RBF kernel<a class="headerlink" href="#example-support-vector-regresion-with-rbf-kernel" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">let</span> <span class="n">n_samples</span><span class="o">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">5</span> <span class="k">in</span>
<span class="nn">Random</span><span class="p">.</span><span class="n">init</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nn">Sklearn</span><span class="p">.</span><span class="nn">Ndarray</span><span class="p">.</span><span class="n">of_bigarray</span> <span class="o">@@</span> <span class="nn">Owl</span><span class="p">.</span><span class="nn">Arr</span><span class="p">.</span><span class="n">uniform</span> <span class="o">[|</span><span class="n">n_samples</span><span class="o">|]</span> <span class="k">in</span>
<span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nn">Sklearn</span><span class="p">.</span><span class="nn">Ndarray</span><span class="p">.</span><span class="n">of_bigarray</span> <span class="o">@@</span> <span class="nn">Owl</span><span class="p">.</span><span class="nn">Dense</span><span class="p">.</span><span class="nn">Matrix</span><span class="p">.</span><span class="nn">D</span><span class="p">.</span><span class="n">uniform</span> <span class="n">n_samples</span> <span class="n">n_features</span> <span class="k">in</span>
<span class="k">let</span> <span class="k">open</span> <span class="nn">Sklearn</span><span class="p">.</span><span class="nc">Svm</span> <span class="k">in</span>
<span class="k">let</span> <span class="n">clf</span> <span class="o">=</span> <span class="nn">SVR</span><span class="p">.</span><span class="n">create</span> <span class="o">~</span><span class="n">c</span><span class="o">:</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">~</span><span class="n">epsilon</span><span class="o">:</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span> <span class="bp">()</span> <span class="k">in</span>
<span class="nn">Format</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%a</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="nn">SVR</span><span class="p">.</span><span class="n">pp</span> <span class="o">@@</span> <span class="nn">SVR</span><span class="p">.</span><span class="n">fit</span> <span class="n">clf</span> <span class="o">~</span><span class="n">x</span><span class="o">:(`</span><span class="nc">Ndarray</span> <span class="n">x</span><span class="o">)</span> <span class="o">~</span><span class="n">y</span><span class="o">;</span>
<span class="nn">Format</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%a</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="nn">Sklearn</span><span class="p">.</span><span class="nn">Ndarray</span><span class="p">.</span><span class="n">pp</span> <span class="o">@@</span> <span class="nn">SVR</span><span class="p">.</span><span class="n">support_vectors_</span> <span class="n">clf</span><span class="o">;;</span>
</code></pre></div>

<p>This outputs:
<div class="highlight"><pre><span></span><code>SVR(C=1.0, cache_size=200, coef0=0.0, degree=3, epsilon=0.2, gamma=&#39;scale&#39;,
    kernel=&#39;rbf&#39;, max_iter=-1, shrinking=True, tol=0.001, verbose=False)
[[0.14509922 0.16277752 0.99033894 0.84013554 0.96508279]
 [0.8865312  0.80655193 0.07459775 0.36058768 0.22130337]
 [0.21844203 0.09612442 0.49908686 0.1154579  0.98202969]
 [0.07306658 0.97225754 0.20558949 0.16423512 0.57400651]
 [0.08153976 0.41462111 0.66190418 0.70208221 0.3600998 ]
 [0.20502873 0.04244781 0.21800856 0.28184598 0.4282653 ]
 [0.89211037 0.51466381 0.23432621 0.29850877 0.13323457]]
</code></pre></div></p>
<p>There are more examples in
<a href="https://github.com/lehy/ocaml-sklearn/blob/master/examples/auto/"><code>examples/auto</code></a>,
for instance
<a href="https://github.com/lehy/ocaml-sklearn/blob/master/examples/auto/svm.ml"><code>examples/auto/svm.ml</code></a>.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>opam install sklearn
</code></pre></div>

<h2 id="finding-pythons-scikit-learn-at-runtime">Finding Python's scikit-learn at runtime<a class="headerlink" href="#finding-pythons-scikit-learn-at-runtime" title="Permanent link">&para;</a></h2>
<p>At runtime, ocaml-sklearn expects to load the right version of
Python's scikit-learn. One way to do that is to create a virtualenv,
install scikit-learn version 0.22.2.post1 inside, and run
your OCaml program in the activated virtualenv.</p>
<p>Do this once to create the virtualenv in <code>.venv</code> and install
scikit-learn inside:</p>
<div class="highlight"><pre><span></span><code>python3 -mvenv .venv
<span class="nb">source</span> .venv/bin/activate
pip install scikit-learn<span class="o">==</span><span class="m">0</span>.22.2.post1 pytest
</code></pre></div>

<p>Then run your compiled OCaml program inside the virtualenv:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> .venv/bin/activate
./my_ocaml_program.exe
</code></pre></div>

<p>A version of ocaml-sklearn is tied to a version of Python's
sklearn. For instance, a version of ocaml-sklearn for Python's
scikit-learn 0.22.2 will refuse to initialize (by throwing an
exception) if scikit-learn's version is not 0.22 (it can be 0.22.1,
0.22.2 or 0.22.2.post1).</p>
<h2 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h2>
<p>We attempt to bind all of scikit-learn's APIs. However, not all of the
APIs are currently tested, and some are probably hard to use or
unusable at the moment.</p>
<p>Each Python module or class gets its own OCaml module. For instance
Python class <code>sklearn.svm.SVC</code> can be found in OCaml module
<code>Sklearn.Svm.SVC</code>. This module has a <code>create</code> function to construct an
<code>SVC</code> and functions corresponding to the Python methods and
attributes.</p>
<p>Most data is passed in and out of sklearn through a binding to Numpy's
<code>Ndarray</code>. This is a tensor type that can contain integers, floats, or
strings (as exposed in the current OCaml API). The way to get data
into or out of an <code>Ndarray.t</code> is to go through OCaml arrays or
bigarrays. A way to create bigarrays is to use <code>Owl</code>'s facilities. At
the moment, the <code>Ndarray</code> functions exposed here are extremely minimal
(no <code>np.zeros</code> or <code>np.ones</code>).</p>
<p>Bunches (as returned from the sklearn.datasets APIs) are exposed as
objects.</p>
<p>Arguments taking string values are converted (in most cases) to
polymorphic variants.</p>
<p>Each module has a conversion function to <code>Py.Object.t</code>, so that you
can always escape and use <code>pyml</code> directly if the API provided here is
incomplete.</p>
<h2 id="development-notes">Development notes<a class="headerlink" href="#development-notes" title="Permanent link">&para;</a></h2>
<p>ocaml-sklearn's sources are generated using a Python program (see
<code>lib/skdoc.py</code>) that loads up sklearn and uses introspection to
generate bindings based on <code>pyml</code>. To determine types, it parses
scikit-learn's documentation.</p>
<h3 id="python-requirements">Python requirements<a class="headerlink" href="#python-requirements" title="Permanent link">&para;</a></h3>
<p>The requirements for developing (not using) the bindings are in file
<code>requirements-dev.txt</code>. Install it using:</p>
<div class="highlight"><pre><span></span><code>python3 -mvenv .venv
<span class="nb">source</span> .venv/bin/activate
pip install -r requirements-dev.txt
</code></pre></div>

<h3 id="running-tests">Running tests<a class="headerlink" href="#running-tests" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>dune runtest
</code></pre></div>

<p>The tests are in <code>examples/auto</code>. They are based on examples extracted
from the Python documentation. A good way to develop is to pick one of
the files and start porting examples. One can refer to
<code>examples/auto/svm.ml</code> or <code>examples/auto/pipeline.ml</code>, whose examples
have already been ported (almost) completely.</p>
<h3 id="generating-documentation">Generating documentation<a class="headerlink" href="#generating-documentation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>lib/build-doc
</code></pre></div>

<p>Documentation can then be found in <code>html_doc/</code>. Serve
it locally with something like:</p>
<div class="highlight"><pre><span></span><code>python3 -mhttp.server --directory html_doc
xdg-open http://localhost:8000
</code></pre></div>

<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">&para;</a></h2>
<p>BSD-3. See file <a href="LICENSE">LICENSE</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
        
          <a href="base/" title="Base" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Base
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: ["instant"],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>